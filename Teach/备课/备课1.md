# ç¬¬ä¸€å¤©











## å— ä¸ inode



ä¸€å—ç£ç›˜ä¼šè¢«åˆ’åˆ†ä¸ºè®¸å¤šæ‰‡åŒºï¼Œæ¯ä¸ªæ‰‡åŒºæ˜¯æœ€å°çš„å¯å¯»å€è¯»å†™å•å…ƒï¼›



ç¡¬ç›˜åˆ†æˆç›¸åŒå¤§å°çš„å•å…ƒï¼Œæˆ‘ä»¬ç§°ä¸ºå—ã€‚ä¸€å—çš„å¤§å°é€šå¸¸æ˜¯æ‰‡åŒºï¼ˆ512Bï¼‰çš„æ•´æ•°å€ï¼Œé»˜è®¤æ˜¯4Kï¼ˆ8ä¸ªæ‰‡åŒºï¼‰ï¼Œæ–‡ä»¶ç³»ç»Ÿçš„å—ä¸èƒ½å°äºæ‰‡åŒºï¼Œå¦åˆ™ä¼šé€ æˆæ— æ³•ç²¾ç¡®æ˜ å°„



## å—å¤§å°æ˜¯åœ¨æ ¼å¼åŒ–æ—¶è®¾å®šçš„

æ–‡ä»¶ç³»ç»Ÿæ ¼å¼åŒ–æ—¶ï¼Œå¯ä»¥æŒ‡å®šå—å¤§å°

å¦‚ext4:

```bash
mkfs.ext4 -b 4096 /dev/sdX
```

å—è¶Šå¤§ï¼Œ**é¡ºåºè¯»å†™æ•ˆç‡è¶Šé«˜**ï¼Œä½†ä¼šæµªè´¹ç©ºé—´ï¼ˆ**å†…å­˜ç¢ç‰‡**ï¼‰ï¼›

- é€‚åˆå¤§æ–‡ä»¶ â†’ å—å¤§ï¼›
- é€‚åˆå°æ–‡ä»¶ â†’ å—å°ï¼›



## **æ‰‡åŒºå¤§å°æ˜¯ç¡¬ç›˜ç¡¬ä»¶å›ºå®šçš„ï¼Œä¸å¯æ›´æ”¹**

- æ‰‡åŒºå¤§å°ç”±ç¡¬ç›˜å›ºä»¶å†™æ­»ï¼Œç”¨æˆ·æ— æ³•æ›´æ”¹ï¼›
- ä½¿ç”¨å‘½ä»¤å¦‚ `fdisk -l` æˆ– `lsblk -t` å¯ä»¥æŸ¥çœ‹å½“å‰ç¡¬ç›˜æ‰‡åŒºå¤§å°ï¼›
- æœ‰äº› SSD å’Œé«˜çº§ç¡¬ç›˜æ”¯æŒ **çœŸå® 4K æ‰‡åŒºï¼ˆ4096Bï¼‰**ï¼Œæ€§èƒ½æ›´å¥½ã€‚





## æŸ¥çœ‹ç¡¬ç›˜æ‰‡åŒº/å—å¤§å°çš„å‘½ä»¤ï¼ˆLinuxï¼‰

```bash
# æŸ¥çœ‹æ‰‡åŒºå¤§å°
cat /sys/block/sdX/queue/hw_sector_size
cat /sys/block/sdX/queue/logical_block_size

# æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿå—å¤§å°
sudo blockdev --getbsz /dev/sdX
sudo tune2fs -l /dev/sdX1 | grep "Block size"
```

> **é€šå¸¸æƒ…å†µä¸‹ï¼Œæ“ä½œç³»ç»Ÿä¼šè¦æ±‚å†…å­˜é¡µå¤§å°ä¸æ–‡ä»¶ç³»ç»Ÿå—å¤§å°ä¿æŒå¯¹é½å…³ç³»**ï¼Œå³ï¼š
>
> > **å†…å­˜é¡µå¤§å° â‰¥ å—å¤§å°ï¼Œä¸”é€šå¸¸æ˜¯å—å¤§å°çš„æ•´æ•°å€**
> >  ä»¥ç¡®ä¿**é¡µä¸å—ä¹‹é—´å¯ä»¥é«˜æ•ˆæ˜ å°„**ï¼Œé¿å…æµªè´¹æˆ–æ‹†åˆ†ã€‚







# ç¬¬äºŒå¤©







## ä»€ä¹ˆæ˜¯Shell

Shell æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œè§£é‡Šå™¨ï¼Œå®ƒæ˜¯ç”¨æˆ·ä¸æ“ä½œç³»ç»Ÿï¼ˆç‰¹åˆ«æ˜¯å†…æ ¸ï¼‰ä¹‹é—´çš„æ¥å£ï¼Œè´Ÿè´£è§£é‡Šç”¨æˆ·å‘½ä»¤ã€è°ƒåº¦ç¨‹åºæ‰§è¡Œã€æ§åˆ¶è¾“å…¥è¾“å‡ºç­‰ã€‚

Shell æ˜¯æ“ä½œç³»ç»Ÿï¼ˆå°¤å…¶æ˜¯å†…æ ¸ï¼‰å’Œç”¨æˆ·ä¹‹é—´çš„ä¸€ä¸ªå‘½ä»¤è§£é‡Šå™¨/ç¿»è¯‘å·¥å…·ï¼Œä¸»è¦è´Ÿè´£æŠŠäººç±»å¯è¯»çš„å‘½ä»¤ç¿»è¯‘æˆç³»ç»Ÿè°ƒç”¨æˆ–ç¨‹åºæ‰§è¡Œã€‚





## ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ï¼š

å½“ä½ åœ¨ç»ˆç«¯ä¸­è¾“å…¥ï¼š

```bash
ls -l /home/user
```

Shell ä¼šåšä»€ä¹ˆï¼Ÿ

1. **è§£æå‘½ä»¤**ï¼šå°†å‘½ä»¤è§£æä¸ºç¨‹åºå `ls` å’Œå‚æ•° `-l /home/user`
2. **æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶**ï¼šåœ¨ `$PATH` ä¸­æ‰¾åˆ° `/bin/ls`
3. **è°ƒç”¨ç³»ç»Ÿè°ƒç”¨**ï¼š
   - ä½¿ç”¨ `fork()` åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹
   - åœ¨å­è¿›ç¨‹ä¸­ `exec()` æ‰§è¡Œ `/bin/ls`
4. **ls ç¨‹åºè¿è¡Œæ—¶è®¿é—®å†…æ ¸æä¾›çš„æ–‡ä»¶ç³»ç»Ÿä¿¡æ¯**
5. **å°†è¾“å‡ºæ‰“å°å›ç»ˆç«¯**







## Shell ä¸ç”¨æˆ· & å†…æ ¸çš„äº¤äº’å›¾ï¼š

```css
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ç”¨æˆ·ï¼ˆUserï¼‰        â”‚
â”‚  âŒ¨ é”®ç›˜è¾“å…¥ã€ğŸ‘€ æŸ¥çœ‹è¾“å‡º     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ç»ˆç«¯ï¼ˆTerminalï¼‰       â”‚
â”‚  å›¾å½¢ç»ˆç«¯/TTY/SSH/PTTY     â”‚
â”‚  æä¾›è¾“å…¥è¾“å‡ºç•Œé¢ï¼ˆ/dev/ttyï¼‰â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Shellï¼ˆå¦‚ bashï¼‰       â”‚
â”‚ ğŸ§  è§£æå‘½ä»¤ã€è„šæœ¬           â”‚
â”‚ ğŸ“¦ è°ƒç”¨å†…æ ¸ç³»ç»ŸæœåŠ¡         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      å†…æ ¸ï¼ˆKernelï¼‰        â”‚
â”‚ ğŸ§© è¿›ç¨‹è°ƒåº¦ã€æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œ â”‚
â”‚ ğŸ› ï¸ æä¾›ç³»ç»Ÿè°ƒç”¨æ¥å£         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¡¬ä»¶èµ„æºï¼ˆç£ç›˜/CPU/ç½‘å¡ç­‰ï¼‰â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```



## Shell å’Œç»ˆç«¯çš„åŒºåˆ«

å¾ˆå¤šäººä¼šæ··æ·† **Shell** å’Œ **ç»ˆç«¯**ï¼Œå®ƒä»¬æ˜¯**ä¸¤ä¸ªä¸åŒå±‚æ¬¡çš„ç»„ä»¶**ï¼š

| é¡¹ç›® | Shell                            | ç»ˆç«¯ï¼ˆTerminalï¼‰                  |
| ---- | -------------------------------- | --------------------------------- |
| æœ¬è´¨ | å‘½ä»¤è§£é‡Šå™¨ç¨‹åº                   | æä¾›ç”¨æˆ·ä¸è®¡ç®—æœºäº¤äº’çš„ç•Œé¢ï¼ˆTTYï¼‰ |
| ä¸¾ä¾‹ | bash, zsh, fish                  | xterm, gnome-terminal, tty        |
| ä½œç”¨ | è§£é‡Šæ‰§è¡Œç”¨æˆ·è¾“å…¥çš„å‘½ä»¤           | æ¥æ”¶é”®ç›˜è¾“å…¥ & æ˜¾ç¤ºç¨‹åºè¾“å‡º       |
| å±äº | åº”ç”¨å±‚ç¨‹åº                       | æ›´æ¥è¿‘è®¾å¤‡é©±åŠ¨/ç•Œé¢å±‚             |
| åœ°ä½ | **ç”¨æˆ·å’Œå†…æ ¸ä¹‹é—´çš„å‘½ä»¤è§£é‡Šæ¡¥æ¢** | **ç”¨æˆ·å’Œ Shell ä¹‹é—´çš„æ¥å£æ¡¥æ¢**   |





## ç»ˆç«¯çš„ä¸¤ç§ç±»å‹

### â–¶ï¸ ç‰©ç†ç»ˆç«¯ï¼ˆttyï¼‰

- é”®ç›˜ + å±å¹• + tty é©±åŠ¨
- åœ¨ Linux ä¸‹å« `/dev/tty1`, `/dev/tty2` ...

### â–¶ï¸ è™šæ‹Ÿç»ˆç«¯ï¼ˆpseudo terminalï¼ŒPTYï¼‰

- å›¾å½¢ç»ˆç«¯æˆ–è¿œç¨‹ç»ˆç«¯æ¨¡æ‹Ÿå‡ºæ¥çš„ TTYï¼Œå¦‚ï¼š
  - `xterm`, `gnome-terminal`, `ssh`
  - å®é™…è®¾å¤‡ï¼š`/dev/pts/0`, `/dev/pts/1`...





## ä»€ä¹ˆæ˜¯ç»ˆç«¯

**Terminalï¼ˆç»ˆç«¯ï¼‰æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¿è¡Œåœ¨ç”¨æˆ·æ€çš„åº”ç”¨ç¨‹åº**ï¼Œ
 ä½œç”¨æ˜¯**æä¾›ä¸€ä¸ªå­—ç¬¦è¾“å…¥/è¾“å‡ºç•Œé¢**ï¼Œå¹¶æŠŠç”¨æˆ·è¾“å…¥ä¼ é€’ç»™ Shellï¼ˆä¹Ÿæ˜¯ä¸€ä¸ªç”¨æˆ·æ€ç¨‹åºï¼‰ã€‚





## ä»€ä¹ˆæ˜¯PTYï¼Ÿ

**å®ç° PTY çš„ä»£ç ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ Linux å†…æ ¸ä¸­å®šä¹‰çš„ä¸€ç»„â€œé©±åŠ¨å‡½æ•°â€**ï¼Œè¿™äº›å‡½æ•°è¿è¡Œåœ¨å†…æ ¸æ€ï¼Œç”¨äºå“åº”ç³»ç»Ÿè°ƒç”¨ï¼Œæ˜¯å†…æ ¸é©±åŠ¨æ¡†æ¶ä¸­çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†

PTY æ˜¯å†…æ ¸æä¾›çš„ä¸€ç§**å­—ç¬¦è®¾å¤‡æœºåˆ¶**ï¼Œä¸æ˜¯å•ç‹¬çš„â€œå†…æ ¸æ€ç¨‹åºâ€ï¼Œä¹Ÿ**ä¸æ˜¯æŸä¸ªç³»ç»Ÿè°ƒç”¨å‡½æ•°æœ¬èº«**ï¼Œä½†å®ƒç¡®å®ç”±å†…æ ¸è´Ÿè´£ç»´æŠ¤ã€è°ƒåº¦å’Œæä¾›æ¥å£ã€‚

ä¹Ÿå°±æ˜¯è¯´PTYæ˜¯å†…æ ¸å­—ç¬¦è®¾å¤‡

åœ¨ç±» Unix ç³»ç»Ÿä¸­ï¼š

- PTYï¼ˆä¼ªç»ˆç«¯ï¼‰æ¨¡æ‹Ÿä¸€ä¸ªç‰©ç†ç»ˆç«¯è®¾å¤‡ï¼ˆæ¯”å¦‚ä½ æ’çš„ä¸²å£ç»ˆç«¯ï¼‰ï¼Œç”¨äºå®ç°å›¾å½¢ç»ˆç«¯ã€è¿œç¨‹ç»ˆç«¯ç­‰
- PTY ç”±å†…æ ¸ç»´æŠ¤ï¼Œåˆ†ä¸ºä¸¤ç«¯ï¼š

| ç«¯å£               | ä½œç”¨                                           | è¡¨ç°ä¸º                          |
| ------------------ | ---------------------------------------------- | ------------------------------- |
| **Masterï¼ˆä¸»ç«¯ï¼‰** | ç”±ç»ˆç«¯ç¨‹åºæŒæœ‰ï¼Œç”¨äºå‘é€ç”¨æˆ·è¾“å…¥ã€è¯»å–ç¨‹åºè¾“å‡º | `/dev/ptmx`ï¼ˆä¼ªç»ˆç«¯åˆ†é…å™¨ï¼‰     |
| **Slaveï¼ˆä»ç«¯ï¼‰**  | æä¾›ç»™ Shell æˆ–è¿è¡Œç¨‹åºï¼Œæ¨¡æ‹Ÿæ ‡å‡†ç»ˆç«¯æ¥å£      | `/dev/pts/N`ï¼ˆå¦‚ `/dev/pts/0`ï¼‰ |





## æ‰§è¡Œç»ˆç«¯ç¨‹åºåå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

æ¯æ‰§è¡Œä¸€æ¬¡ç»ˆç«¯ç¨‹åºï¼ˆå¦‚ `xterm`ã€`ssh`ã€`script`ã€`tmux` ç­‰ï¼‰æ—¶ï¼Œç³»ç»Ÿéƒ½ä¼šä¸ºå…¶åˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„ pty master/slave å¯¹ã€‚

å†…æ ¸å°†ï¼š

1. åˆ†é…ä¸€ä¸ªæ–°çš„ **pty master è®¾å¤‡ï¼ˆåŒ¿åï¼‰**
2. è‡ªåŠ¨åˆ›å»ºå¹¶æ³¨å†Œå¯¹åº”çš„ **slave è®¾å¤‡ `/dev/pts/N`**
3. ç»‘å®šè¿™ä¸¤ä¸ªè®¾å¤‡ï¼Œç»´æŠ¤ä¸€ä¸ªå¯¹åº”çš„å…±äº«ç¼“å†²åŒº
4. è¿”å›ä½ æ‹¿åˆ°çš„ **`master_fd` æ˜¯å”¯ä¸€çš„**



## ä½ è¾“å…¥ä¸€è¡Œå‘½ä»¤å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

ä»¥ç”¨æˆ·åœ¨ç»ˆç«¯ï¼ˆæ¯”å¦‚ scriptã€xtermã€sshï¼‰è¾“å…¥å‘½ä»¤ `ls -l` ä¸ºä¾‹ï¼š

0. ç”¨æˆ·åœ¨ç‰©ç†é”®ç›˜ä¸Šè¾“å…¥å­—ç¬¦ï¼›æ“ä½œç³»ç»Ÿçš„è¾“å…¥è®¾å¤‡é©±åŠ¨æ•è·æŒ‰é”®äº‹ä»¶ï¼›å›¾å½¢ç»ˆç«¯ç¨‹åºï¼ˆå¦‚ `xterm` / `gnome-terminal` / `script`ï¼‰è¿è¡Œåœ¨**ç”¨æˆ·æ€**ï¼Œç›‘å¬æŒ‰é”®äº‹ä»¶ï¼›å®ƒæŒæœ‰ master ç«¯çš„æ–‡ä»¶æè¿°ç¬¦ `master_fd`ï¼ˆæ‰“å¼€ `/dev/ptmx` å¾—åˆ°ï¼‰ï¼›å®ƒå°†å­—ç¬¦å†™å…¥ `master_fd` â†’ æ•°æ®é€šè¿‡å†…æ ¸ç¼“å†²åŒºæµå‘ slave

   ```bash
   ç”¨æˆ·åœ¨ç‰©ç†é”®ç›˜ä¸Šè¾“å…¥å­—ç¬¦
   â¬‡
   æ“ä½œç³»ç»Ÿçš„è¾“å…¥è®¾å¤‡é©±åŠ¨æ•è·æŒ‰é”®äº‹ä»¶
   â¬‡
   å›¾å½¢ç»ˆç«¯ç¨‹åºï¼ˆå¦‚ xterm / gnome-terminal / scriptï¼‰è¿è¡Œåœ¨ç”¨æˆ·æ€ï¼Œç›‘å¬æŒ‰é”®äº‹ä»¶
   â¬‡
   å®ƒæŒæœ‰ master ç«¯çš„æ–‡ä»¶æè¿°ç¬¦ master_fdï¼ˆæ‰“å¼€ /dev/ptmx å¾—åˆ°ï¼‰
   â¬‡
   å®ƒå°†å­—ç¬¦å†™å…¥ master_fd â†’ æ•°æ®é€šè¿‡å†…æ ¸ç¼“å†²åŒºæµå‘ slave
   â¬‡
   slave æ˜¯ä¸€ä¸ªä¼ªç»ˆç«¯ï¼ˆ/dev/pts/Nï¼‰ï¼Œshell ç»‘å®šåœ¨ slave ä¸Šï¼Œä»ä¸­è¯»å–æ•°æ®
   â¬‡
   shell æ‰§è¡Œå‘½ä»¤ã€è¾“å‡ºç»“æœå†™å…¥ slave
   â¬‡
   master è¯»å–è¿™äº›ç»“æœ â†’ å›åˆ°ç»ˆç«¯ç¨‹åº â†’ æ˜¾ç¤ºåœ¨å±å¹•ä¸Š
   ```

1. ç”¨æˆ·çš„ **æŒ‰é”®æ•°æ®**ï¼ˆä¾‹å¦‚å­—ç¬¦ `'l'`, `'s'`, `'\n'`ï¼‰æ˜¯é€šè¿‡ **è¾“å…¥è®¾å¤‡é©±åŠ¨**é€å…¥ç”¨æˆ·æ€ç¨‹åºï¼ˆå¦‚ `xterm`ã€`script`ï¼‰

   > **`pty master/slave` å¯¹å…±äº«ä¸€ä¸ªå†…æ ¸ç¼“å†²åŒº** â€”â€” å®ƒä»¬ä¹‹é—´é€šä¿¡çš„æœ¬è´¨æ˜¯ï¼š**master ç«¯å’Œ slave ç«¯ä¹‹é—´é€šè¿‡ä¸€ä¸ªç¯å½¢ç¼“å†²åŒºè¿›è¡Œæ•°æ®äº¤äº’**ï¼Œè¿™ä¸ªç¼“å†²åŒºç”±å†…æ ¸ç®¡ç†ã€‚
   >
   > `pty master`ï¼ˆä¸»ç«¯ï¼‰æ¨¡æ‹Ÿä¸€ä¸ªç»ˆç«¯è®¾å¤‡çš„æ§åˆ¶ç«¯ï¼ˆé€šå¸¸ç”± sshã€tmuxã€xterm ç­‰æ§åˆ¶ç¨‹åºä½¿ç”¨ï¼‰
   >
   > `pty slave`ï¼ˆä»ç«¯ï¼‰æ¨¡æ‹Ÿä¸€ä¸ªå®é™…çš„ç»ˆç«¯è®¾å¤‡ï¼ˆè¢« shell æˆ–ç”¨æˆ·ç¨‹åºæ„ŸçŸ¥ï¼‰
   >
   > 
   >
   > **ç¼“å†²åŒºç»†èŠ‚**
   >
   > - å†…æ ¸ä¸­ä¸ºæ¯ä¸ª `pty` å¯¹åˆ†é…ä¸€ä¸ªç¼“å†²åŒºï¼ˆé€šå¸¸æ˜¯**åŒå‘ç¼“å†²ç¯**ï¼‰
   > - æ•°æ®æµæ–¹å‘ï¼š
   >   - **å†™å…¥ masterï¼Œæ•°æ®å‡ºç°åœ¨ slave çš„è¯»å–ç«¯**ï¼ˆå°±åƒé”®ç›˜è¾“å…¥ï¼‰
   >   - **å†™å…¥ slaveï¼Œæ•°æ®å‡ºç°åœ¨ master çš„è¯»å–ç«¯**ï¼ˆæ¯”å¦‚ shell è¾“å‡ºï¼‰
   >
   > è¿™ä¸ªç¼“å†²åŒºåœ¨ Linux å†…æ ¸é‡Œç”± `tty` å­ç³»ç»Ÿç»Ÿä¸€è°ƒåº¦å’Œç»´æŠ¤ã€‚
   >
   > æƒ…å¢ƒï¼šä½ è¿è¡Œ `script`ï¼Œshell ä½¿ç”¨ä¼ªç»ˆç«¯ slave
   >
   > ```bash
   > script -q /dev/null
   > ```
   >
   > ```text
   > ç”¨æˆ·é”®ç›˜ â”€â–¶ master â”€â–¶ [å†…æ ¸ç¼“å†²] â”€â–¶ slave â”€â–¶ bash
   >                                    â–²         â”‚
   >                                    â”‚         â–¼
   >                                script â—€â”€â”€â”€â”€ slave è¾“å‡ºï¼ˆbashæ‰§è¡Œç»“æœï¼‰
   > ```
   >
   > ```ABAP
   > ç”¨æˆ·è¾“å…¥å‘½ä»¤ç»™masterï¼Œmasterå°†å‘½ä»¤å­˜å‚¨åœ¨å†…æ ¸ç¼“å†²åŒºï¼Œbashä»slaveè¯»å–è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œè§£æå‡ºå‘½ä»¤ï¼Œæ‰¾åˆ°å‘½ä»¤åï¼Œä¸ºè¿™ä¹ˆå‘½ä»¤forkå­è¿›ç¨‹å¹¶æ‰§è¡Œï¼Œç¨‹åºæ‰§è¡Œåå°†è¾“å‡ºç»“æœå‘é€ç»™slaveï¼Œæ•°æ®ä»masterä¸­è¯»å‡ºï¼Œè¾“å‡ºåœ¨å±å¹•ä¸Š
   > ```

2. fork å‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ‰§è¡Œ `/bin/bash`
3. å­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥ã€è¾“å‡ºã€é”™è¯¯ éƒ½æŒ‡å‘ `/dev/pts/0`ï¼ˆä¹Ÿå°±æ˜¯ pty slaveï¼‰
4. ç”¨æˆ·åœ¨ç»ˆç«¯ä¸­é”®å…¥ `ls -l`
   - ç»ˆç«¯ç¨‹åºå°†å­—ç¬¦å†™å…¥ **pty master**
   - å†…æ ¸å°†è¿™äº›å­—ç¬¦ç¼“å†²åœ¨ **pty slave çš„è¯»ç¼“å†²åŒº**
5. Shell ä» pty slave ä¸­è¯»å–è¿™è¡Œå‘½ä»¤ï¼Œè§£é‡Šæ‰§è¡Œ
6. è¾“å‡ºé€šè¿‡ stdout å†™å…¥ pty slave â†’ å†…æ ¸è½¬å‘ç»™ pty master â†’ ç»ˆç«¯ç¨‹åºè¯»å–åæ˜¾ç¤º





## é©±åŠ¨å‡½æ•°æ˜¯ä»€ä¹ˆ

æ‰€è°“é©±åŠ¨å‡½æ•°ï¼Œå®é™…æ˜¯å†…æ ¸ä¸­çš„ä¸€ç»„å›è°ƒå‡½æ•°ï¼Œå®ƒä»¬é€šè¿‡ç»“æ„ä½“ `file_operations` æ³¨å†Œç»™ VFSï¼ˆè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼‰

```C
static const struct file_operations ptmx_fops = {
    .open = ptmx_open,
    .read = tty_read,
    .write = tty_write,
    .ioctl = tty_ioctl,
    ...
};
```

å½“ç”¨æˆ·æ€ç¨‹åºè°ƒç”¨ `open("/dev/ptmx")`ï¼š

- ç³»ç»Ÿè°ƒç”¨è¿›å…¥å†…æ ¸
- å†…æ ¸æ ¹æ®è®¾å¤‡èŠ‚ç‚¹æŸ¥æ‰¾åˆ°å¯¹åº”çš„ `file_operations`
- ç„¶åè°ƒç”¨ `.open = ptmx_open` è¿™ä¸ªå†…æ ¸å‡½æ•°ï¼ˆé©±åŠ¨å‡½æ•°ï¼‰



**é©±åŠ¨å‡½æ•°çš„â€œç”Ÿå‘½å‘¨æœŸâ€ï¼š**

| äº‹ä»¶            | ç”¨æˆ·æ€è°ƒç”¨                   | è¿›å…¥å†…æ ¸åå®é™…è°ƒç”¨çš„é©±åŠ¨å‡½æ•° |
| --------------- | ---------------------------- | ---------------------------- |
| æ‰“å¼€ PTY master | `open("/dev/ptmx")`          | `ptmx_open()`                |
| è¯»æ•°æ®          | `read(fd, ...)`              | `tty_read()`                 |
| å†™æ•°æ®          | `write(fd, ...)`             | `tty_write()`                |
| è®¾ç½®ç»ˆç«¯å±æ€§    | `ioctl(fd, TIOCSWINSZ, ...)` | `tty_ioctl()`                |



`ptmx_open()` é©±åŠ¨å‡½æ•°åŸå‹

```C
static int ptmx_open(struct inode *inode, struct file *filp) {
    return tty_open(inode, filp);
}
```

è¿™ä¸ªå‡½æ•°æ˜¯ `/dev/ptmx` è®¾å¤‡çš„ open handler

æ˜¯ç³»ç»Ÿè°ƒç”¨ `open()` æœ€ç»ˆè°ƒç”¨åˆ°çš„å‡½æ•°



**é©±åŠ¨å‡½æ•°æ˜¯é¢å‘â€œè®¾å¤‡æ“ä½œâ€çš„æœ€åº•å±‚å†…æ ¸å‡½æ•°æ¥å£ä¹‹ä¸€ï¼Œå®ƒæ˜¯ç³»ç»Ÿè°ƒç”¨é€šå¾€ç¡¬ä»¶ï¼ˆæˆ–è™šæ‹Ÿè®¾å¤‡ï¼‰çš„å…³é”®æ¡¥æ¢ã€‚**



## åˆ†å±‚ç†è§£ Linux è®¾å¤‡é©±åŠ¨ç»“æ„ï¼š

```css
   ç”¨æˆ·æ€åº”ç”¨ç¨‹åº
        â”‚
    ç³»ç»Ÿè°ƒç”¨ (open, read, write, ioctl, ...)
        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼ˆVFSï¼‰ â”‚   â† ç»Ÿä¸€ç®¡ç†æ‰€æœ‰è®¾å¤‡çš„è®¿é—®
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
   file_operations
        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é©±åŠ¨å‡½æ•°ï¼ˆé©±åŠ¨ç¨‹åºï¼‰ â”‚ â† ä½ æåˆ°çš„â€œé©±åŠ¨å‡½æ•°â€å°±å¤„äºè¿™ä¸€å±‚
â”‚  å¦‚ .open, .read      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
  è®¾å¤‡æ§åˆ¶å±‚ï¼ˆä¾‹å¦‚ï¼šä¸²å£æ§åˆ¶ã€I2Cæ§åˆ¶ã€TTYæ ¸å¿ƒå±‚ï¼‰
        â”‚
  ç¡¬ä»¶æŠ½è±¡æ¥å£ï¼ˆI/O æ˜ å°„ã€MMIOã€ç«¯å£IOï¼‰
        â”‚
  ç¡¬ä»¶å¯„å­˜å™¨ã€ä¸­æ–­çº¿ã€DMA æ§åˆ¶å™¨ç­‰
```







ä»**çº¯ç²¹çš„ä»£ç å®ç°è§’åº¦æ¥çœ‹ Linux æ“ä½œç³»ç»Ÿçš„æ•´ä½“ç»“æ„**

| ä½ æåˆ°çš„å±‚ | æ˜¯å¦å‡†ç¡® | è¡¥å……è¯´æ˜                                                     | è¯­è¨€å®ç° |
| ---------- | -------- | ------------------------------------------------------------ | -------- |
| ç”¨æˆ·æ€ç¨‹åº | âœ…        | å‘èµ·ç³»ç»Ÿè°ƒç”¨ï¼Œè§¦å‘ä¸Šä¸‹æ–‡åˆ‡æ¢                                 | é«˜çº§è¯­è¨€ |
| ç³»ç»Ÿè°ƒç”¨   | âœ…        | æ˜¯ç”¨æˆ·æ€è®¿é—®å†…æ ¸æ€çš„å”¯ä¸€å…¥å£                                 | C        |
| æŠ½è±¡å±‚     | âœ…        | VFSã€ç½‘ç»œåè®®æ ˆã€è¿›ç¨‹è°ƒåº¦å™¨ã€å†…å­˜ç®¡ç†ã€IPCå­ç³»ç»Ÿï¼ˆç®¡é“ï¼Œä¿¡å·ï¼Œå…±äº«å†…å­˜ï¼‰ç­‰ | C        |
| é©±åŠ¨å±‚     | âœ…        | å®ç°ç¡¬ä»¶æ§åˆ¶é€»è¾‘ã€æ³¨å†Œæ¥å£ï¼Œå¦‚å­—ç¬¦è®¾å¤‡é©±åŠ¨ï¼ˆ`/dev/ttyS0`, `/dev/input/mouse0`ï¼‰å—è®¾åˆ«é©±åŠ¨ï¼ˆNVMeã€SATAã€MMCï¼‰ï¼Œç½‘ç»œè®¾å¤‡é©±åŠ¨ï¼ˆe1000e, r8169ï¼‰ï¼Œæ˜¾å¡é©±åŠ¨ï¼ˆi915, amdgpuï¼‰ | C        |
| åº•å±‚æ§åˆ¶å±‚ | âœ…        | é©±åŠ¨å†…éƒ¨ç›´æ¥æ“ä½œç¡¬ä»¶çš„ä»£ç ï¼šå¯¹å¯„å­˜å™¨è¯»å†™ã€DMAã€ä¸­æ–­å“åº”ç­‰ã€‚  | C/æ±‡ç¼–   |
| ç‰©ç†å±‚     | âœ…        | çœŸæ­£çš„ç¡¬ä»¶è®¾å¤‡ï¼Œä¸å±äºä»£ç èŒƒç•´ï¼Œä½†æ˜¯æ“ä½œç›®æ ‡                 | N/A      |





**ä»Linuxå®˜æ–¹æ¨¡å—ç»„ç»‡è§†è§’**









## Linuxç™»å½•

Linuxç™»å½•æµç¨‹ï¼š`/etc/login.defs`ã€`PAM`æ¨¡å—ã€`getty` å’Œ `login`







# ç¬¬ä¸‰å¤©





![image-20250611113334930](D:\git_repository\cyber_security_learning\markdown_img\image-20250611113334930.png)



## ç½‘ç»œ

ä»€ä¹ˆæ˜¯äº’è”ç½‘ï¼Œå®ƒçš„ç»„æˆæ˜¯ä»€ä¹ˆ

ç½‘ç»œä¸­æ”¯æ’‘ç½‘ç»œå·¥ä½œçš„éå¸¸é‡è¦çš„ä¸œè¥¿å«åè®® protocolï¼Œä»€ä¹ˆæ˜¯åè®®

ç½‘ç»œåˆ†ä¸º3ä¸ªéƒ¨åˆ†ï¼Œè¾¹ä¸Šï¼ˆedgeï¼‰ï¼Œä¸­é—´ï¼ˆcoreæ ¸å¿ƒï¼‰å’ŒæŠŠè¾¹ä¸Šå’Œä¸­é—´æ¥åœ¨ä¸€èµ·çš„æ¥å…¥ç½‘ï¼ˆaccessï¼‰ï¼Œ

3ä¸ªéƒ¨é—¨çš„ç»„æˆï¼Œä½œç”¨å’ŒåŸºæœ¬åŸç†

ç½‘ç»œçš„è¾¹ç¼˜ï¼Œå°†è¾¹ç¼˜æ¥å…¥æ ¸å¿ƒçš„æ¥å…¥ç½‘ä»¥åŠæ”¯æ’‘æ¥å…¥ç½‘çš„mediaåª’ä»‹ï¼Œæ ¸å¿ƒï¼Œæ ¸å¿ƒçš„å·¥ä½œæ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€ä¸ªæ˜¯çº¿è·¯äº¤æ¢ï¼Œä¸€ä¸ªæ˜¯åˆ†ç»„äº¤æ¢

ä»€ä¹ˆæ˜¯çº¿è·¯äº¤æ¢

ä»€ä¹ˆæ˜¯åˆ†ç»„äº¤æ¢


å®é™…ä¸Šäº’è”ç½‘æ˜¯ä¸€å †ç½‘ç»œæ„æˆçš„ï¼Œä»–ä¸æ˜¯ä¸€ä¸ªå¹³é¢ï¼Œä¸€ä¸ªç½‘ç»œï¼Œå®ƒæ˜¯ç”±ä¸€å †ç½‘ç»œé€šè¿‡ç½‘ç»œäº’è”è®¾å¤‡ï¼ˆè·¯ç”±å™¨ï¼‰è¿åœ¨ä¸€èµ·çš„ç½‘ç»œçš„ç½‘ç»œï¼Œæˆ‘ä»¬å«äº’è”ç½‘

ä¸åŒçš„ç½‘ï¼Œå¤„åœ¨æ•´ä¸ªäº’è”ç½‘çš„å±‚æ¬¡ä¹Ÿä¸ä¸€æ ·ï¼Œæœ‰çš„æ˜¯level1ï¼Œæœ‰çš„Level2ï¼ŒLevel3...,



### ç½‘ç»œ

ç½‘ç»œçš„å±‚æ¬¡ç»“æ„


ä¹‹åæˆ‘ä»¬ä»‹ç»ï¼Œç½‘ç»œé‚£ä¹ˆå¤æ‚ï¼Œä¸æ˜¯ä¸€ä¸ªå¹³é¢å°±èƒ½å¤Ÿè§£å†³çš„ï¼Œå®ƒæ˜¯ä¸€å±‚ä¸€å±‚è§£å†³çš„ï¼Œæ¯ä¸€å±‚å®ç°ä¸€ç»„ç‰¹å®šçš„åŠŸèƒ½ï¼Œä¸Šä¸€å±‚åˆå€ŸåŠ©ä¸‹ä¸€æ¬¡æä¾›çš„æœåŠ¡ï¼Œé€šè¿‡å’Œå¯¹ç­‰å±‚çš„åè®®å®ä½“ç›¸äº’äº¤æ¢åè®®çš„æŠ¥æ–‡æ¥å®ç°çš„ï¼Œå®ç°çš„ç›®çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸ºäº†å‘ä¸Šå±‚æä¾›æ›´å¥½çš„æœåŠ¡ï¼Œç„¶åä¸€å±‚è½ä¸€å±‚ï¼Œä¸€å±‚è½ä¸€å±‚ï¼Œæœ€åè½åˆ°äº†ä¼ è¾“å±‚

åº”ç”¨å±‚æ˜¯å€ŸåŠ©ä¼ è¾“å±‚æä¾›çš„æœåŠ¡ï¼Œäº¤æ¢åº”ç”¨æŠ¥æ–‡ï¼Œå®ç°å„ç§å„æ ·çš„ç½‘ç»œåº”ç”¨ï¼Œæ•´ä¸ªå·¥ä½œçš„è¿‡ç¨‹å¤§è‡´å°±æ˜¯è¿™æ ·çš„è¿‡ç¨‹

å±‚æ¬¡æ€§çš„åŸç†æ˜¯éå¸¸é‡è¦çš„ç†è§£è®¡ç®—æœºç½‘ç»œå·¥ä½œçš„æ ¸å¿ƒæ€æƒ³ï¼Œå¸Œæœ›å¤§å®¶èƒ½å¤ŸæŠŠæ¡




1. ä»€ä¹ˆæ˜¯ç½‘ç»œ -> è®¡ç®—æœºç½‘ç»œ -> äº’è”ç½‘

ä¸¾å‡ ä¸ªç½‘ç»œçš„ä¾‹å­ï¼šç”µè¯ç½‘ï¼Œèœ˜è››ç½‘ï¼Œèœ˜è››ç½‘ä¹Ÿæ˜¯ç½‘ç»œï¼Œæ‰€ä»¥ç½‘ç»œæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿï¼ŒèŠ‚ç‚¹å’Œè¾¹æ˜¯å§ï¼Œ

 ![image-20250611095517824](D:\git_repository\cyber_security_learning\markdown_img\image-20250611095517824.png) è¿™ä¸¤ä¸ªç½‘ç»œæ˜¯ä¸æ˜¯ä¸€ç§ç½‘ç»œï¼Œæ‰€ä»¥ç½‘ç»œæ˜¯ç½‘ç»œå°±æ˜¯å’Œå¤§å°æ— å…³çš„ï¼ŒèŠ‚ç‚¹å’Œè¾¹çš„å…³ç³»ï¼Œå’Œå½¢çŠ¶æ— å…³ï¼Œå¦‚è¿™ä¸ªå›¾é‡Œçš„èŠ‚ç‚¹ï¼Œå¯ä»¥æ˜¯ä¸ªäººï¼Œé‚£è¿™ä¸ªè¾¹å¯èƒ½å°±æ˜¯ä»–ä»¬çš„æœ‹å‹å…³ç³»ï¼Œè¿™ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªèœ˜è››ç½‘çš„å‡ ç‚¹åˆ°å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸­é—´æ˜¯èœ˜è››çº¿ï¼Œè¿™ä¹Ÿæ˜¯ç½‘ç»œï¼Œåˆæˆ–è€…ç¥ç»å…ƒå³å®ƒçš„æ ‘çªç­‰ï¼Œä¹Ÿæ˜¯ç½‘ç»œ

 å†æ‹‰å›åˆ°èœ˜è››ç½‘ï¼Œèœ˜è››ç½‘å°±æ˜¯ä¸å¤§å°ï¼Œå½¢çŠ¶æ— å…³çš„ç½‘ç»œçš„æ‹“æ‰‘ï¼Œè¿™å«ç½‘ç»œã€‚é‚£ä»€ä¹ˆæ˜¯è®¡ç®—æœºç½‘ç»œ



### è®¡ç®—æœºç½‘ç»œ

è®¡ç®—æœºç½‘ç»œï¼šè®¡ç®—æœºç½‘ç»œæ˜¯è”ç½‘çš„è®¡ç®—æœºï¼Œæ‰€æ„æˆçš„ç³»ç»Ÿã€‚æˆ‘ä»¬éƒ½çŸ¥é“ç½‘ç»œæœ‰èŠ‚ç‚¹å’Œçº¿æ„æˆï¼Œé‚£ä¹ˆè®¡ç®—æœºç½‘ç»œä¸­ï¼ŒèŠ‚ç‚¹éƒ½æ˜¯ä»€ä¹ˆï¼Ÿ

åŒ…æ‹¬

- **ä¸»æœºèŠ‚ç‚¹**ï¼Œæ¯”å¦‚ï¼šç¬”è®°æœ¬ï¼Œæ‰‹æœºï¼Œipadï¼Œè”ç½‘çš„å†°ç®±ï¼Œæœºé¡¶ç›’ç­‰ç­‰ï¼Œå®ƒæ˜¯æ•°æ®çš„æºï¼Œä¹Ÿæ˜¯æ•°æ®çš„ç›®æ ‡

æ¯”å¦‚å®ƒæ˜¯ä¸€ä¸ªwebæœåŠ¡å™¨ï¼Œç®—ä¸ç®—ä¸€ä¸ªä¸»æœºèŠ‚ç‚¹ï¼Œä¹Ÿç®—ä¸€ä¸ªèŠ‚ç‚¹ã€‚



- å¦å¤–ä¸€ç§æ˜¯**æ•°æ®äº¤æ¢èŠ‚ç‚¹**ï¼Œæ¯”å¦‚äº¤æ¢æœºï¼Œè·¯ç”±å™¨ï¼Œå®ƒå³ä¸æ˜¯æ•°æ®çš„æºï¼Œä¹Ÿä¸æ˜¯æ•°æ®çš„ç›®æ ‡ï¼Œæ¥ä¸€ä¸ªåˆ†ç»„ä»ä¸€ä¸ªç«¯å£è¿›æ¥ï¼ŒæŒ‰ç…§ä¸€å®šçš„å·¥ä½œæ–¹å¼ï¼Œå¦‚æœæ˜¯**äº¤æ¢æœº**çš„è¯å°±æ˜¯æŒ‰ç…§ç›®æ ‡macåœ°å€ï¼Œå†³å®šä»æŸä¸ªæ–¹å‘è½¬ï¼Œå¦‚æœæ˜¯ä¸€ä¸ª**è·¯ç”±å™¨**çš„è¯ï¼Œæ¥ä¸€ä¸ªåˆ†ç»„ï¼Œä»ä¸€ä¸ªç«¯å£é€šè¿‡ç½‘å¡æ”¶è¿›æ¥ï¼Œæ”¶è¿›æ¥ä¹‹åï¼Œé€šè¿‡æŸ¥è·¯ç”±è¡¨ï¼Œå†³å®šä»å¦ä¸€ä¸ªæ–¹å‘æ”¾å‡ºå»ï¼Œå®ƒæ˜¯è½¬å‘æ•°æ®çš„ï¼Œå®ƒæ—¢ä¸æ˜¯æºï¼Œä¹Ÿä¸æ˜¯ç›®æ ‡ã€‚
  - åˆšæ‰æˆ‘ä»¬ä»‹ç»äº†è·¯ç”±å™¨å’Œäº¤æ¢æœºï¼Œæœ‰ä¸¤ä¸ªæœ¯è¯­äº†ï¼Œä»–åªæ˜¯å±‚æ¬¡ä¸åŒï¼Œä½œç”¨ä¸åŒï¼Œè·¯ç”±å™¨æ˜¯å·¥ä½œåœ¨ç½‘ç»œå±‚ï¼Œäº¤æ¢æœºå·¥ä½œåœ¨é“¾è·¯å±‚ï¼Œå½“ç„¶è¿˜æœ‰æ›´é«˜å±‚çš„ç½‘ç»œäº¤æ¢è®¾åˆ«ï¼Œæ¯”å¦‚è¿˜æœ‰ç¬¬4å±‚ï¼Œç¬¬5å±‚çš„è´Ÿè½½å‡è¡¡è®¾å¤‡ç­‰ç­‰ï¼Œè¿™äº›è®¾å¤‡æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿå®ƒä¹Ÿæ˜¯èŠ‚ç‚¹ï¼Œä½†æ˜¯å®ƒæ—¢ä¸æ˜¯æ•°æ®çš„æºï¼Œä¹Ÿä¸æ˜¯æ•°æ®çš„ç›®æ ‡ï¼Œå®ƒæ˜¯æ•°æ®çš„ä¸­è½¬èŠ‚ç‚¹ã€‚æ”¶åˆ°æ•°æ®åå°†å®ƒè½¬èµ°ï¼Œåˆ°ä¸‹ä¸€èŠ‚ç‚¹åï¼Œæ”¶åˆ°ä¹‹åè½¬èµ°ï¼Œé€šè¿‡è¿™äº›ä¸­è½¬èŠ‚ç‚¹çš„ç›¸äº’é…åˆï¼Œæœ€ç»ˆå®ç°ä»æºèŠ‚ç‚¹åˆ°ç›®æ ‡èŠ‚ç‚¹ã€‚



æ‰€ä»¥å®ƒæœ‰ä¸¤ç§ç±»å‹çš„èŠ‚ç‚¹ï¼Œç”»æ–¹çš„æ˜¯ä¸»æœºèŠ‚ç‚¹ï¼Œç”»å›­çš„æ˜¯æ•°æ®äº¤æ¢èŠ‚ç‚¹ã€‚æ•°æ®äº¤æ¢èŠ‚ç‚¹æ ¹æ®å®ƒå·¥ä½œçš„å±‚æ¬¡ä¸åŒï¼Œå¯ä»¥åˆ†ä¸ºï¼Œä¸­ç»§å™¨ï¼Œäº¤æ¢æœºï¼ˆäºŒå±‚ï¼‰ï¼Œè·¯ç”±å™¨ï¼ˆä¸‰å±‚ï¼‰ï¼Œè¿˜æœ‰ä¸€äº›è´Ÿè½½å‡è¡¡è®¾å¤‡ï¼Œæ›´é«˜å±‚ã€‚å®ƒçš„ä½œç”¨å°±æ˜¯ä»ä¸€ä¸ªåœ°æ–¹è¿›ï¼Œä»ä¸¤ä¸€ä¸ªåœ°æ–¹å‡ºï¼Œé€šè¿‡è¿™äº›ä¸­è½¬èŠ‚ç‚¹çš„ç›¸äº’é…åˆï¼Œä»è€Œå®ç°æ•°æ®ä»æºä¸»æœºåˆ°ç›®æ ‡ä¸»æœºã€‚



æŠŠèŠ‚ç‚¹è¿åœ¨ä¸€èµ·çš„æ˜¯ä»€ä¹ˆï¼Ÿå«é“¾è·¯ã€‚æŠŠä¸»æœºè·Ÿäº¤æ¢èŠ‚ç‚¹è¿åœ¨ä¸€èµ·ï¼ŒæŠŠäº¤æ¢èŠ‚ç‚¹å’Œäº¤æ¢èŠ‚ç‚¹è¿åœ¨ä¸€èµ·ï¼Œæœ€åæ„æˆä¸€ä¸ªç½‘ï¼Œç„¶åä¹‹é—´æ‰èƒ½å¤Ÿç›¸äº’é€šä¿¡ï¼Œè¿™ä¸ªå«é“¾è·¯ï¼Œå°±æ˜¯è¾¹



æ‰€ä»¥è¯´ï¼Œè¿ç½‘çš„è®¡ç®—æœºç³»ç»Ÿï¼Œç”±èŠ‚ç‚¹å’Œè¾¹æ„æˆçš„è¿™æ ·ä¸€ä¸ªç³»ç»Ÿï¼Œæˆ‘ä»¬æŠŠå®ƒå«åšè®¡ç®—æœºç½‘ç»œ



è¾¹å‘¢ä¹Ÿåˆ†ä¸ºä¸¤ç±»

- ç¬¬ä¸€ç±»ï¼šæˆ‘çš„ä¸»æœºé€šè¿‡ä»¥å¤ªç½‘çš„ç½‘çº¿ï¼Œæ¥åˆ°æœ€è¿‘çš„ä¸€ä¸ªäº¤æ¢æœºï¼Œæ‰€ä»¥å«æ¥å…¥ç½‘ï¼Œæ¥å…¥çš„é“¾è·¯(link)
- ç¬¬äºŒç±»ï¼šè·¯ç”±å™¨å’Œè·¯ç”±å™¨ï¼Œè·¯ç”±å™¨å’Œäº¤æ¢æœºï¼Œäº¤æ¢æœºå’Œäº¤æ¢æœºï¼Œä¹Ÿå°±æ˜¯äº¤æ¢èŠ‚ç‚¹ä¹‹é—´çš„éª¨å¹²é“¾è·¯



æ€»ç»“èµ·æ¥å°±æ˜¯æ–¹çš„å’Œå›­çš„è¿åœ¨ä¸€èµ·çš„ï¼Œä¸»è¦å’Œä¸»æœºç›¸å…³ï¼Œå®ƒå°±æ˜¯æ¥å…¥é“¾è·¯ï¼Œå¦‚æœä¸¤ä¸ªåœ†çš„æ¥åœ¨ä¸€èµ·ï¼Œå°±æ˜¯éª¨å¹²é“¾è·¯ï¼Œå› æ­¤æ€»çš„åˆ†ä¸ºæ¥å…¥é“¾è·¯ï¼ˆaccessï¼‰å’Œéª¨å¹²é“¾è·¯(backbone)



è®¡ç®—æœºç½‘ç»œï¼Œä»æ„æˆçš„è§’åº¦ï¼šèŠ‚ç‚¹å’Œè¾¹

èŠ‚ç‚¹åŒ…æ‹¬ä¸»æœºå’Œäº¤æ¢èŠ‚ç‚¹ï¼Œæ•°æ®äº¤æ¢èŠ‚ç‚¹å·¥ä½œçš„å±‚æ¬¡ä¸åŒæœ‰åˆ†ä¸ºäº¤æ¢æœºï¼Œè·¯ç”±å™¨ï¼Œä¸€äº›é«˜å±‚çš„è´Ÿè½½å‡è¡¡è®¾å¤‡ç­‰ç­‰

 

é“¾è·¯çš„æŒ‰ç…§å®ƒè¿æ¥çš„ä¸»æœºå’Œè·¯ç”±å™¨ï¼Œè¿˜æ˜¯äº¤æ¢èŠ‚ç‚¹ä¹‹é—´é“¾è·¯å¯ä»¥åˆ†ä¸ºaccesså’Œbackboneï¼Œå°±æ¥å…¥é“¾è·¯å’Œéª¨å¹²é“¾è·¯









#### åè®®

å½“ç„¶é™¤äº†äº’è”ç½‘æ„æˆçš„è¿™æ ·ä¸€äº›é›¶ä»¶çš„ç»„æˆï¼ŒèŠ‚ç‚¹å’Œè¾¹ä¹‹å¤–çš„ï¼Œè¿˜æœ‰å¦å¤–ä¸€äº›æ„æˆï¼Œä¸€äº›è½¯çš„ï¼Œæ¯”å¦‚åè®®ã€‚åè®®æŒ‡çš„æ˜¯æ”¯æ’‘äº’è”ç½‘å·¥ä½œçš„æ ‡å‡†ã€‚å„ä¸ªå‚å•†æŒ‰ç…§æ ‡å‡†å’Œåè®®æ¥åˆ¶ä½œå®ƒçš„ç½‘ç»œè®¾å¤‡ï¼Œè¿™äº›ä¸åŒçš„ç½‘ç»œè®¾å¤‡ä¹‹é—´ï¼Œå°±å¯ä»¥å½¢æˆäº’æ“ä½œï¼Œå«inter-operativeã€‚å°±æ˜¯æˆ‘è¿™ä¸ªç½‘å¡å’Œä½ è¿™ä¸ªç½‘å¡ï¼Œè™½ç„¶æ¥è‡ªä¸åŒçš„å‚å•†ï¼Œä½†åªè¦æŒ‰ç…§åŒæ ·çš„æ ‡å‡†ï¼Œå°±å¯ä»¥å·¥ä½œã€‚å½“ç„¶ï¼Œåè®®æŒ‰ç…§å®ƒçš„å±‚æ¬¡ä¸åŒåˆå¯ä»¥åˆ†ä¸ºç‰©ç†å±‚åè®®ï¼Œé“¾è·¯å±‚åè®®ï¼Œç½‘ç»œå±‚åè®®ï¼Œä¼ è¾“å±‚åè®®ï¼Œåº”ç”¨å±‚åè®®ï¼Œè€Œæ¯å±‚åè®®åˆåˆ†ä¸ºè‹¥å¹²ç§ï¼Œæ¯”å¦‚ä¼ è¾“å±‚çš„TCPï¼ŒUDP.ç½‘ç»œå±‚æœ‰IPè¿˜æœ‰ä¸€äº›è·¯ç”±é€‰æ‹©åè®®ã€‚è¿™äº›éƒ½æ˜¯åè®®ï¼Œä¹Ÿå°±æ˜¯æ ‡å‡†



åè®®çš„å®šä¹‰ï¼šå¯¹ç­‰å±‚å®ä½“åœ¨é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥éµå¾ªçš„è§„åˆ™çš„é›†åˆï¼ŒåŒ…æ‹¬è¯­æ³•ï¼Œè¯­ä¹‰å’Œæ—¶åºã€‚å½“ç„¶å’±ä»¬ä¸å¤ªé€‚åˆè¿™ä¹ˆè®²ï¼Œæ€•ä½ ä»¬æƒŠæ…Œè¯•é”™ï¼Œè½è’è€Œé€ƒã€‚

å¬ç€å¥½åƒå¾ˆå¤æ‚ï¼Œä½†æ˜¯å¬åç»­å’±ä»¬å¨“å¨“é“æ¥ï¼Œå…¶å®ä¹Ÿæ²¡é‚£ä¹ˆå¤æ‚



è®¡ç®—æœºç½‘ç»œè®²æ¸…æ¥šäº†ï¼Œé‚£äº’è”ç½‘æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ



### äº’è”ç½‘

äº’è”ç½‘æ˜¯ä»¥TCPåè®®å’ŒIPåè®®ä¸ºä¸»çš„ä¸€ç°‡åè®®ã€‚å°±åè®®æ—ï¼Œåè®®å¥—ï¼Œæœ‰è¿™äº›åè®®æ„æˆçš„é‚£ä¸ªç½‘ç»œï¼Œå°±æˆ‘ä»¬ç›®å‰åœ¨ç”¨çš„ï¼Œè§„æ¨¡æœ€å¤§çš„ç½‘ç»œå°±å«äº’è”ç½‘ï¼ˆinternetï¼‰ã€‚





å½“ç„¶ä½ è¯´æˆ‘ä¹ŸæŒ‰è¿™ä¸ªæ–¹å¼å·¥ä½œï¼Œä¹Ÿæ˜¯ä»¥TCPå’ŒIPåè®®æ—ä¸ºä¸»çš„ï¼Œä½†æ˜¯æˆ‘å’Œåˆ«äººä¸è¿ï¼Œæˆ‘å‚é‡Œè‡ªå·±ç”¨ï¼Œä¹Ÿè¡Œï¼Œã€‚è¿™ä¸ªä¸å«Internetï¼Œè¿™ä¸ªå«intronetï¼Œå«ä¼ä¸šç½‘ï¼Œä¹Ÿå«å†…éƒ¨ç½‘





ä»æ„æˆçš„è§’åº¦æ¥çœ‹ï¼Œè®¡ç®—æœºç½‘ç»œï¼Œäº’è”ç½‘ï¼Œäº’è”ç½‘å½“ç„¶ä¹Ÿæ˜¯è®¡ç®—æœºç½‘ç»œä¸­çš„ä¸€ç§ï¼Œäº’è”ç½‘æœ‰å“ªäº›ç«¯èŠ‚ç‚¹ï¼ŒPCï¼Œä¸»æœºï¼Œserverï¼Œæ‰‹æœºï¼Œipadç­‰ç­‰...ä»¥åŠä¸€äº›æœ‰è¶£çš„ç«¯ç³»ç»Ÿï¼Œèµ‹äºˆåäº¿è®¡çš„ç«¯ç³»ç»Ÿã€‚



é‚£ä¹ˆç«¯ç³»ç»ŸåŒ…æ‹¬ä»€ä¹ˆå‘¢ï¼Ÿè®¡ç®—æœºæœ¬èº«â€”ç¡¬ä»¶ï¼Œèƒ½å¤ŸæŠŠç¡¬ä»¶ç®¡ç†èµ·æ¥çš„æ“ä½œç³»ç»Ÿï¼Œè¿™ä¸ªæ“ä½œç³»ç»Ÿè¦æ”¯æŒé€šè®¯å§ï¼›ç„¶ååœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šé©»ç•™çš„æµè§ˆå™¨ï¼ŒwebæœåŠ¡å™¨ï¼Œä¸Šé¢çš„ä¸€äº›appç­‰ç½‘ç»œåº”ç”¨ç¨‹åºã€‚



æ‰€ä»¥æ•´ä¸ªç«¯ç³»ç»Ÿåˆ†ä¸ºï¼Œç¡¬ä»¶æœ¬èº«ï¼Œæ”¯æŒç½‘ç»œé€šè®¯çš„æ“ä½œç³»ç»Ÿï¼Œä»¥åŠåŸºäºæ“ä½œç³»ç»Ÿï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œçš„å„ç§ç½‘ç»œåº”ç”¨ç¨‹åºï¼›è¿™äº›æ„æˆäº†ç«¯ç³»ç»Ÿ,è¿™ä¸ªç«¯ç³»ç»Ÿæˆ‘ä»¬é€šå¸¸ç§°ä½œ`end System` æˆ–è€… `host`







è¾¹ç¼˜ï¼šè¾¹ç¼˜ç³»ç»Ÿä¸Šé¢çš„åº”ç”¨æ˜¯ç½‘ç»œå­˜åœ¨çš„ç†ç”±ï¼Œä¸‹é¢çš„è®¾å¤‡æ˜¯æ”¯æ’‘ç½‘ç»œé€šè®¯çš„åè®®æ ˆ

æ¥å…¥ï¼šå°†è¾¹ç¼˜çš„ä¸»æœºç³»ç»Ÿæ¥å…¥åˆ°ç½‘ç»œæ ¸å¿ƒ

æ ¸å¿ƒï¼šæŠŠæ‰€æœ‰çš„è¾¹ç¼˜èŠ‚ç‚¹æ¥åœ¨ä¸€èµ·ï¼Œä»è€Œè®©ä»»æ„ä¸¤ä¸ªç«¯ç³»ç»Ÿä¹‹é—´èƒ½å¤Ÿç›¸äº’é€šä¿¡ï¼Œæ‰€ä»¥ç½‘ç»œæ ¸å¿ƒçš„ä½œç”¨å°±æ˜¯æ•°æ®äº¤æ¢



#### ç½‘ç»œè¾¹ç¼˜

åº”ç”¨è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ¨¡å¼

- CSæ¨¡å¼
- P2Pæ¨¡å¼
  

ä¸ç®¡æ˜¯CSæ¨¡å¼ï¼Œè¿˜æ˜¯P2Pæ¨¡å¼ï¼Œå®ƒä»¬éƒ½è¦å€ŸåŠ©äºåŸºç¡€è®¾æ–½æä¾›çš„é€šè®¯æœåŠ¡æ‰èƒ½å®ç°ç›¸äº’é€šä¿¡ã€‚

åŸºç¡€è®¾æ–½ä¸ºç½‘ç»œåº”ç”¨æä¾›çš„é€šä¿¡æœåŠ¡æœ‰ä¸¤ç§æ–¹å¼

- **é¢å‘è¿æ¥çš„é€šä¿¡æ–¹å¼**
  - ä¾‹å¦‚ï¼šTCPåè®®å®ä½“å‘åº”ç”¨è¿›ç¨‹æä¾›çš„æœåŠ¡å°±æ˜¯é¢å‘è¿æ¥çš„æœåŠ¡
  - ç‰¹ç‚¹ï¼šåˆ†å¸ƒå¼åº”ç”¨ä¹‹é—´ç›¸äº’é€šä¿¡ï¼Œé¦–å…ˆè¦å»ºç«‹è¿æ¥ï¼Œåº•å±‚çš„åè®®æ ˆè¦ä¸ºä¸¤ä¸ªåº”ç”¨è¿›ç¨‹ä»¥åçš„é€šä¿¡å‡†å¤‡å¥½ç›¸åº”çš„èµ„æºï¼Œåšå¥½æ ‡è®°ï¼ˆæ¯”å¦‚å‡†å¤‡ç¼“å†²åŒºï¼Œæ ‡è®°ä½ç½®ä½ï¼Œè¶…æ—¶å®šæ—¶å™¨è®¾ç½®ç­‰ï¼‰`ä¸¤ä¸ªåº”ç”¨è¿›ç¨‹åœ¨é€šä¿¡å‰ï¼Œä¸¤è€…è¦åšå¥½å‡†å¤‡ï¼Œåº•å±‚åè®®æ ˆä¹Ÿè¦åšå¥½å‡†å¤‡`ã€‚
  - é¢å‘è¿æ¥å’Œæœ‰è¿æ¥çš„åŒºåˆ«
    - é¢å‘è¿æ¥æ˜¯ï¼šé€šä¿¡åŒæ–¹åŠå…¶åº•å±‚åè®®æ ˆçŸ¥é“ï¼Œç½‘ç»œä¸çŸ¥é“ã€‚é€šè®¯çŠ¶æ€åªåœ¨ç«¯ç³»ç»Ÿä¸­ç»´æŠ¤
    - æœ‰è¿æ¥ï¼šä¸æ­¢é€šä¿¡åŒæ–¹è¦ç»´æŒé€šä¿¡çŠ¶æ€ï¼Œä¸­é—´èŠ‚ç‚¹ä¹Ÿè¦ç»´æŠ¤é€šä¿¡çŠ¶æ€ï¼ˆå…¸å‹çš„æœ‰è¿æ¥ï¼š**PSTNç”µè¯ç½‘ç»œ**ï¼Œä¸€æ—¦å»ºç«‹é€šè¯ï¼Œç½‘ç»œä¸­æ¯ä¸ªäº¤æ¢èŠ‚ç‚¹éƒ½ä¸ºè¿™æ¬¡é€šè¯åˆ†é…å›ºå®šèµ„æºï¼ˆç”µè·¯æ—¶éš™ï¼‰ï¼‰



TCPå‘ä¸Šå±‚æä¾›çš„æœåŠ¡çš„ç‰¹æ€§ï¼šå¯é çš„ï¼Œä¿åºçš„ï¼Œæµé‡æ§åˆ¶ï¼Œæ‹¥å¡æ§åˆ¶

å¯é çš„ï¼šä¸é‡å¤ï¼Œä¸å¤±åºï¼Œä¸ä¹±åºï¼Œä¸å‡ºé”™ã€‚æ€»ç»“ï¼šå°±æ˜¯åŸåŸæœ¬æœ¬ï¼Œå‘å‡ºçš„æ˜¯ä»€ä¹ˆï¼Œæ”¶åˆ°çš„å°±æ˜¯ä»€ä¹ˆã€‚

æµé‡æ§åˆ¶ï¼šæ¯”å¦‚ä½ æ˜¯ä¸€ä¸ªæ€§èƒ½å¼ºå¤§çš„æœåŠ¡å™¨ï¼Œè‡³å¼ºã€‚è€Œå¦ä¸€ç«¯æ˜¯æ€§èƒ½å¾ˆå·®çš„æœºå™¨ã€‚å¦‚æœä½ å‘é€å¤ªå¿«ï¼Œå¯¹æ–¹æ— æ³•å¤„ç†ï¼Œåˆ™ä¼šå‡ºç°é—®é¢˜ã€‚æµé‡æ§åˆ¶å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚åè°ƒå‘é€æ–¹å‘é€é€Ÿåº¦å’Œæ¥æ”¶æ–¹æ¥æ”¶é€Ÿåº¦ï¼Œä»è€Œè®©ä¸¤è€…èƒ½å¤Ÿæœ‰æ•ˆé€šä¿¡ã€‚

æ‹¥å¡æ§åˆ¶ï¼šç½‘ç»œè·¯å¾„æœ‰å µå¡ï¼Œé™¤äº†è¦è€ƒè™‘æ¥æ”¶æ–¹çš„æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œè¿˜è¦è€ƒè™‘åˆ°ç½‘ç»œè·¯å¾„çš„é€šè¡Œèƒ½åŠ›ã€‚æ ¹æ®è·¯å¾„çš„é˜»å¡ç¨‹åº¦ï¼Œåè°ƒå‘é€æ–¹çš„å‘é€é€Ÿåº¦ï¼Œé˜²æ­¢æ•°æ®äº¤æ¢èŠ‚ç‚¹å¤„ç†ä¸äº†å¯¼è‡´ä¸¢åŒ…ã€‚





- **é‡‡ç”¨åŸºç¡€è®¾æ–½çš„æ— è¿æ¥æœåŠ¡**
  - ä¾‹å¦‚ï¼šUDP-ç”¨æˆ·æ•°æ®æŠ¥åè®®
    - æ— è¿æ¥
    - ä¸å¯é æ•°æ®ä¼ è¾“
    - æ— æµé‡æ§åˆ¶ä¸æ— æ‹¥å¡æ§åˆ¶





#### ç½‘ç»œæ ¸å¿ƒ

ç½‘ç»œæ ¸å¿ƒçš„ç»„æˆï¼šç”±äº¤æ¢èŠ‚ç‚¹ä¸äº¤æ¢èŠ‚ç‚¹å®ƒä»¬çš„é“¾è·¯æ„æˆçš„ã€‚æœ€ä¸»è¦çš„ä½œç”¨æ˜¯æ•°æ®äº¤æ¢çš„åŠŸèƒ½ï¼Œæºä¸»æœºå‘å‡ºå»ï¼Œæ­£ç¡®çš„åˆ°è¾¾ç›®æ ‡ä¸»æœºã€‚



**åˆ†ç»„äº¤æ¢**

```bat
	ä¸ºäº†ä»æºç«¯ç³»ç»Ÿå‘ç›®çš„ç«¯ç³»ç»Ÿå‘é€ä¸€ä¸ªæŠ¥æ–‡ï¼Œæºå°†é•¿æŠ¥æ–‡åˆ’åˆ†ä¸ºè¾ƒå°çš„æ•°æ®å—ï¼Œç§°ä¹‹ä¸ºåˆ†ç»„  ï¼ˆpacketï¼‰ 
åœ¨æºå’Œç›®çš„åœ°ä¹‹é—´ï¼Œæ¯ä¸ªåˆ†ç»„éƒ½é€šè¿‡é€šä¿¡é“¾è·¯å’Œåˆ†ç»„äº¤æ¢æœºï¼ˆpacket switch ï¼‰ä¼ é€ã€‚ï¼ˆäº¤æ¢æœºä¸»è¦æœ‰ä¸¤ç±»ï¼šè·¯ç”±å™¨ï¼ˆrouterï¼‰å’Œé“¾è·¯å±‚äº¤æ¢æœºï¼ˆlink-layer* switchï¼‰ã€‚ï¼‰åˆ†ç»„ä»¥ç­‰äºè¯¥é“¾è·¯æœ€å¤§ä¼ è¾“é€Ÿç‡çš„é€Ÿåº¦ä¼ è¾“é€šè¿‡é€šä¿¡é“¾è·¯ã€‚  â€”â€” ã€Šè®¡ç®—æœºç½‘ç»œâ€”è‡ªé¡¶å‘ä¸‹ã€‹
```



![image-20250612115408514](D:\git_repository\cyber_security_learning\markdown_img\image-20250612115408514.png)

ä»¥åˆ†ç»„ä¸ºå•ä½å­˜å‚¨-è½¬å‘æ–¹å¼

- ç½‘ç»œå¸¦å®½èµ„æºä¸å†åˆ†ä¸ºä¸€ä¸ªä¸ªç‰‡ï¼Œä¼ è¾“æ—¶ä½¿ç”¨å…¨éƒ¨å¸¦å®½
- ä¸»æœºä¹‹é—´ä¼ è¾“çš„æ•°æ®è¢«åˆ†ä¸ºä¸€ä¸ªä¸ªåˆ†ç»„



**ä»€ä¹ˆæ˜¯åˆ†ç»„**

åˆ†ç»„äº¤æ¢æ˜¯ä¸€ç§é€šä¿¡æ–¹å¼ï¼Œæ•°æ®åœ¨å‘é€å‰è¢«**åˆ†å‰²æˆè¾ƒå°çš„å•å…ƒï¼ˆåˆ†ç»„ï¼‰**ï¼Œé€ä¸ªä¼ è¾“ã€‚

è¿™äº›åˆ†ç»„å…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š

- ç‹¬ç«‹è·¯ç”±ï¼ˆå¯èƒ½èµ°ä¸åŒè·¯å¾„ï¼‰
- ç‹¬ç«‹å°è£…
- æ¯ä¸ªåˆ†ç»„åŒ…å«å®Œæ•´çš„ç›®æ ‡åœ°å€ä¿¡æ¯



**å­˜å‚¨è½¬å‘**

![image-20250612143716393](D:\git_repository\cyber_security_learning\markdown_img\image-20250612143716393.png)

å­˜å‚¨è½¬å‘ä¼ è¾“æ˜¯æŒ‡åœ¨äº¤æ¢æœºèƒ½å¤Ÿå¼€å§‹å‘è¾“å²€é“¾è·¯ä¼ è¾“è¯¥åˆ†ç»„çš„ç¬¬ä¸€ä¸ªæ¯”ç‰¹ä¹‹å‰ï¼Œå¿…é¡»æ¥æ”¶åˆ°æ•´ä¸ªåˆ†ç»„ã€‚

> å­˜å‚¨è½¬å‘ï¼Œä¸ºé“¾è·¯å…±äº«æä¾›äº†åŸºç¡€ã€‚





**ä¸¢åŒ…**

è·¯ç”±å™¨ä¸­çš„æ’é˜Ÿé˜Ÿåˆ—æ‰€å®¹çº³çš„åˆ†ç»„æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥ç­‰åˆ°è·¯ç”±å™¨é˜Ÿåˆ—å †æ»¡åï¼Œæ–°åˆ°è¾¾çš„åˆ†ç»„å°±æ— æ³•è¢«å®¹çº³ï¼Œå¯¼è‡´è·¯ç”±å™¨ `ä¸¢å¼ƒ(drop)` è¯¥åˆ†ç»„ï¼Œå³åˆ†ç»„ä¼š `ä¸¢å¤±(lost)`ã€‚











### Internetç»“æ„å’ŒISP

å‰é¢æˆ‘ä»¬ä»‹ç»äº†äº’è”ç½‘å¯ä»¥åˆ†ä¸ºèŠ‚ç‚¹å’Œé“¾è·¯ï¼Œç„¶åæˆ‘ä»¬å°†ä¸»æœºç³»ç»Ÿæ„æˆäº†è¾¹ç¼˜ç³»ç»Ÿï¼Œç”±ç½‘ç»œäº¤æ¢èŠ‚ç‚¹ä¹‹é—´æ„æˆçš„å­ç³»ç»Ÿï¼Œå«ç½‘ç»œæ ¸å¿ƒï¼Œå°†è¾¹ç¼˜æ¥å…¥ç½‘ç»œæ ¸å¿ƒï¼Œæˆ‘ä»¬å«æ¥å…¥accessï¼Œè¿™æ˜¯ä¸€ç§åˆ’åˆ†æ–¹å¼



è¿˜æœ‰ä¸€ç§åˆ’åˆ†æ–¹å¼ï¼šæˆ‘ä»¬æŠŠå…³ç³»æ¯”è¾ƒå¯†é›†çš„ï¼Œä¸€ä¸ªç½‘ç»œä¾›åº”å•†çš„ç½‘ç»œä½œä¸ºä¸€ä¸ªç½‘ç»œã€‚æ¯”å¦‚ï¼šé«˜æ ¡çš„æ ¡å›­ç½‘ï¼Œè¿™é‡Œæœ‰äº¤æ¢è®¾å¤‡ï¼Œæœ‰é“¾è·¯ï¼Œæœ‰ä¸»æœºã€‚è¿™æ„æˆä¸€ä¸ªå­ç³»ç»Ÿï¼Œè¿™ä¸ªå­ç³»ç»Ÿå«ä¸€ä¸ªISPç½‘ç»œã€‚å½“ç„¶è¿˜æœ‰å…¶ä»–ISPçš„ç½‘ç»œã€‚äº’è”ç½‘å°±æ˜¯ç”±è¿™äº›ISPçš„ç½‘ç»œé€šè¿‡ç½‘ç»œäº’è”è®¾å¤‡ï¼Œæ¯”å¦‚è·¯ç”±å™¨æ¥æ„å»ºæˆçš„ã€‚



ä¹‹å‰çš„åˆ’åˆ†æ˜¯æŒ‰ç…§ç½‘ç»œèŠ‚ç‚¹å’Œé“¾è·¯çš„åˆ†ç±»ï¼Œåˆ†ä¸ºäº†è¾¹ç¼˜ï¼Œæ¥å…¥ï¼Œæ ¸å¿ƒ

ç°åœ¨ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸€ä¸ªèŒƒå›´å†…ï¼Œå…³ç³»å¯†é›†çš„ä¸€ä¸ªç½‘ç»œä¸­çš„è®¾å¤‡ï¼Œç§°ä¹‹ä¸ºä¸€ä¸ªISPç½‘ç»œï¼Œäº’è”ç½‘æ˜¯æœ‰å¾ˆå¤šISPçš„ç½‘ç»œæ„æˆçš„ï¼Œå½“ç„¶ISPé‡Œè¿˜åŒ…æ‹¬å¾ˆå¤šå°ISPã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯´äº’è”ç½‘æ˜¯ç”±ä¸€å †ISPç½‘ç»œæ„æˆçš„ï¼Œé€šè¿‡ç½‘ç»œäº’è”è®¾å¤‡ï¼Œé€šè¿‡è·¯ç”±å™¨è¿åœ¨ä¸€èµ·çš„ï¼Œæ˜¯ç½‘ç»œçš„ç½‘ç»œã€‚



æˆ‘ä»¬ä½¿ç”¨æ¸è¿›æ¼”åŒ–çš„æ–¹æ³•ï¼Œæ¥æè¿°äº’è”ç½‘å½“ä»Šçš„ç»“æ„ã€‚



æˆ‘ä»¬å¾ˆå¤šçš„ç«¯ç³»ç»Ÿï¼Œéƒ½æ˜¯é€šè¿‡æ¥å…¥ISPè®¿é—®çš„äº’è”ç½‘ã€‚æ¯”å¦‚ç§»åŠ¨æ‰‹æœºï¼Œæ˜¯é€šè¿‡ç§»åŠ¨ISPæ¥å…¥äº’è”ç½‘ã€‚ä»»ä½•ä¸€ä¸ªç«¯ç³»ç»Ÿéƒ½æ˜¯é€šè¿‡æ¥å…¥ISPæ¥æ¥å…¥äº’è”ç½‘çš„ã€‚æ¯”å¦‚æˆ‘ä»¬å®¶ç”¨çš„ä¸»æœºï¼Œé€šå¸¸æ˜¯ä¸ä¼šç§»åŠ¨çš„ï¼Œä½†æ˜¯ç§»åŠ¨æ¥å…¥æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä½ æ‹¿ç€ä¸€ä¸ªæ‰‹æœºï¼Œåœ¨å¾ˆå¤šæœ‰è”é€šåŸºç«™çš„åœ°æ–¹éƒ½èƒ½æŠŠä½ æ¥å…¥ã€‚ä¸ç®¡æ€æ ·ä½ æ˜¯é€šè¿‡ç§»åŠ¨ï¼Œè”é€šåŸºç«™æ¥å…¥äº’è”ç½‘ã€‚æœ‰å¾ˆå¤šå¾ˆå¤šçš„æ¥å…¥ISPï¼Œæœ‰å¤šå°‘ï¼Ÿå‡ åä¸‡ï¼Œä¸Šç™¾ä¸‡æ¥å…¥ISPï¼Œæ¥å…¥ISPä¹‹é—´è¦ä¸è¦äº’è”ã€‚



æˆ‘é€šè¿‡æ¥å…¥ISPæ¥å…¥äº’è”ç½‘ï¼Œä»–é€šè¿‡å¦ä¸€ä¸ªæ¥å…¥ISPæ¥å…¥äº’è”ç½‘ã€‚å¦‚æœæ¥å…¥ISPä¹‹é—´ä¸èƒ½äº’è”ï¼Œæ˜¯ä¸æ˜¯æˆ‘å’Œä»–ä¹‹é—´çš„è®¿é—®å°±ä¼šæœ‰é—®é¢˜ã€‚



å› æ­¤è¿™äº›æ¥å…¥ISPéƒ½è¦äº’è”çš„ã€‚ä½†æ˜¯è¿™äº›æ¥å…¥ISPæ˜¯æ€æ ·äº’è”çš„ã€‚

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œå‘å±•å’Œæ¼”åŒ–æ˜¯é€šè¿‡ä¸€äº›ç»æµçš„å’Œæ”¿æ²»ç­–ç•¥æ¥é©±åŠ¨å®ƒæ¼”åŒ–åˆ°å½“å‰çš„æƒ…å†µã€‚æˆ‘ä»¬çœ‹ä¸‹å®ƒæ˜¯å¦‚ä½•æ¼”åŒ–çš„ã€‚



ç”¨æˆ·æ˜¯é€šè¿‡æ¥å…¥ISPæ¥è®¿é—®äº’è”ç½‘ã€‚è¿™äº›æ¥å…¥ISPè¦ç›¸äº’äº’è”ï¼Œé—®é¢˜æ˜¯ä»–ä»¬æ€ä¹ˆäº’è”ã€‚

æœ‰ä¸€ç§æ–¹å¼ï¼ŒæŠŠå®ƒä»¬å…¨è¿æ¥å¯ä»¥å—ï¼Ÿå½“ç„¶ä¸å¯ä»¥ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æœ‰Nä¸ªISPï¼Œé‚£ä¹ˆå…¨è¿æ¥å°±æ˜¯n(n-1)/2ï¼ŒåŸºæœ¬ä¸Šæ˜¯nçš„å¹³æ–¹çš„çº§åˆ«ã€‚å¦‚æœæœ‰10wä¸ªISPï¼Œå…¨è¿æ¥å°±æ˜¯10wçš„å¹³æ–¹ï¼Œè¿™ä¸ªæ˜¯ä¸å¯ç›¸ä¿¡çš„ï¼Œä»£ä»·å¤ªå¤§äº†ã€‚è¿™ç§æ–¹å¼æ˜¯ä¸å¯æ‰©å±•çš„ã€‚



é‚£æ€ä¹ˆåŠå‘¢ï¼Ÿå¯¹äºISPæ¥è¯´ï¼Œä½ æ¥å…¥äº’è”ç½‘æ˜¯ä¸æ˜¯è¦ç»™ISPä»˜è´¹ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯ä¸æ˜¯æœ‰åˆ©å¯å›¾çš„ã€‚é‚£å°±æ„å‘³ç€æœ‰äº›ä¾›åº”å•†ä¼šæŠŠå…¨çƒçš„è¿™äº›æ¥å…¥ISPéƒ½è¿åœ¨ä¸€èµ·ï¼Œåœ¨å…¨çƒèŒƒå›´å†…ï¼Œéƒ¨ç½²è‡ªå·±çš„è·¯ç”±å™¨å’Œçº¿è·¯ï¼ŒæŠŠè¿™äº›è·¯ç”±å™¨å’Œè®¾å¤‡éƒ½è¿åœ¨ä¸€èµ·ã€‚ç„¶åè¿™ä¸ªå…¨çƒçš„ISPä¼šæŠŠæ¥å…¥ISPéƒ½è¿åœ¨ä¸€èµ·ï¼Œä¹Ÿå°±æ˜¯è¿™äº›æ¥å…¥ISPï¼Œéƒ½è¿åœ¨è¿™ä¸ªGLOBAL ISPä¸Šã€‚è¿™æ ·çš„è¯ï¼Œæ¥å…¥ISPä¹‹é—´çš„é€šä¿¡ï¼Œå°±å¯ä»¥å€ŸåŠ©äºGLOBAL ISPè¿åœ¨ä¸€èµ·ã€‚



æœ‰åˆ©å¯å›¾ï¼Œæ¯”å¦‚æœ‰äººä¼šæŠ•èµ„ï¼Œè¿™å°±æ˜¯ç»æµé©±åŠ¨çš„å¿…ç„¶ã€‚



æˆ‘ä»¬æŠŠå¾ˆå¤šæ¥å…¥ISPè¿åœ¨ä¸€èµ·ï¼Œåœ¨ä»–ä»¬ä¹‹é—´å®Œæˆæ•°æ®çš„æ”¶å‘ï¼Œé‚£ä¹ˆæˆ‘åœ¨å…¨çƒéƒ¨ç½²æˆ‘çš„è¿™äº›èŠ‚ç‚¹ï¼Œä¹Ÿæ˜¯æŠ€æœ¯ä¸Šå¯è¡Œçš„ï¼Œåœ¨ç»æµä¸Šä¹Ÿæ˜¯æœ‰æ”¶ç›Šçš„ã€‚é‚£ä¸€å®šæœ‰GLOBAL ISPå»åšè¿™ä¸ªäº‹æƒ…ï¼Œ



ä½ çš„access netæ˜¯é€šè¿‡ä¸€äº›ç»æµåˆçº¦å’ŒGLOBAL ISPè°ˆå¥½ï¼Œæ¯”å¦‚æµé‡ä¸Šè¡Œä¸‹è¡Œæ˜¯å¤šå°‘ï¼Œæ€ä¹ˆç»“ç®—ï¼Œæ˜¯åŒ…æœˆè¿˜æ˜¯æŒ‰é‡ä»˜è´¹ç­‰ç­‰ã€‚å› æ­¤access netå’ŒGLOBAL ISPä¹‹é—´é€šå¸¸æœ‰åˆçº¦ï¼Œæ¥çº¦æŸå®ƒä»¬çš„è¡Œä¸ºã€‚



ä½†æ˜¯å¦‚æœåªæœ‰ä¸€ä¸ªGLOBAL ISPï¼Œé‚£æœåŠ¡è´¨é‡å¿…ç„¶ä¸ä¼šé«˜ï¼Œä½†æ˜¯ä»·æ ¼ä¸€å®šå¾ˆé«˜ã€‚è¿™æ—¶å€™å¿…ç„¶ä¼šæœ‰ä¸€äº›å…¶ä»–ISPå‚ä¸åˆ°è¿™ä¸ªç«äº‰ã€‚



å› æ­¤å°±æœ‰å¤šä¸ªGLOBAL ISPï¼ŒæŠŠä¸€äº›æ¥å…¥ISPæ¥å…¥è¿›æ¥ã€‚ä¸åŒçš„æ¥å…¥ISPï¼Œæ¥å…¥ä¸åŒçš„GLOBAL ISPã€‚



å¦ä¸€æ–¹é¢ï¼Œé™¤äº†æœ‰ç«äº‰è¿˜æœ‰åˆä½œï¼Œæ¯”å¦‚æˆ‘æ¥å¦‚åˆ€è¿™äº›access netï¼Œä½ æ¥å…¥é‚£äº›access netã€‚æˆ‘è¦æŠŠä½ çš„å®¢æˆ·æ¥è¿›æ¥ï¼Œä»£ä»·æ˜¯å¾ˆé«˜çš„ã€‚è¿™æ—¶æˆ‘æœ‰ä¸€ä¸ªé€‰æ‹©ï¼Œæˆ‘é€šè¿‡ä½ æ¥å…¥ä½ çš„å®¢æˆ·ï¼Œä½ é€šè¿‡æˆ‘æ¥å…¥æˆ‘çš„å®¢æˆ·ï¼Œè¿™æ ·çš„è¯ã€‚æˆ‘å¯¹æˆ‘çš„æ–°å®¢æˆ·è€Œè¨€ï¼Œæˆ‘è¯´æˆ‘å¯ä»¥æ¥å…¥æ‰€æœ‰çš„access netï¼Œä½ ä¹Ÿå¯ä»¥å’Œä½ çš„ç”¨æˆ·è¯´ï¼Œä½ å¯ä»¥æ¥å…¥æ‰€æœ‰access netã€‚

é‚£è¿™æ ·å°±æœ‰ä¸€ä¸ªåˆä½œçš„æ¦‚å¿µã€‚åˆä½œå¯èƒ½æ¶‰åŠåˆ°ç»“ç®—ã€‚ä¹Ÿå¯èƒ½ä¸æ¶‰åŠæµé‡çš„ç»“ç®—ã€‚æˆ‘ä»¬æ˜¯å¯¹ç­‰çš„ï¼Œå¦‚æœå¤§å®¶æ¥å…¥çš„å„è‡ªçš„access netå·®ä¸å¤šï¼Œå‘è¿‡å»çš„å’Œå›æ¥çš„æµé‡å·®ä¸å¤šï¼Œé‚£å°±ä¸ç”¨ä»˜è´¹äº†ï¼Œå¯¹å†²äº†ã€‚å¯¹äºè¿è¥å•†è€Œè¨€ï¼Œæˆ‘ä¸ç”¨èŠ±é’±ï¼Œå’Œä½ è°ˆä¸ªåˆçº¦ï¼Œå‡ºä¸€ä¸ªæ¡è·¯ç”±å™¨ï¼Œå‡ºä¸ªé“¾è·¯ï¼Œå°±èƒ½å’Œä½ ç›¸è¿ï¼Œä»è€Œæ‰©å±•æˆ‘ä¸šåŠ¡çš„ç‰©ç†èŒƒå›´ã€‚



è¿™æ ·ï¼Œæ—¢æœ‰ç«äº‰ä¹Ÿæœ‰åˆä½œã€‚è¿™ç§è¿æ¥å«åšå¯¹ç­‰çš„è¿æ¥ã€‚



è¿˜æœ‰ä¸€ç§è¿æ¥æ˜¯å¤§å®¶éƒ½æ¥å…¥åˆ°IXPï¼Œä¹Ÿå°±æ˜¯äº’è”ç½‘è¿æ¥äº¤æ¢ç‚¹ï¼Œåœ¨è¿™äº›äº¤æ¢ç‚¹ä¹‹é—´ï¼Œå®Œæˆaåˆ°bï¼Œbåˆ°cï¼Œcåˆ°açš„æ•°æ®äº¤æ¢ã€‚



è¿™ä¸ªäº¤æ¢ç‚¹å½“ç„¶éå¸¸é‡è¦ï¼Œå¾ˆå¤šéª¨å¹²çš„ISPï¼Œå®ƒçš„æµé‡éƒ½é€šè¿‡IXPçš„äº¤æ¢ç‚¹ï¼Œå®Œæˆç½‘é—´æµé‡çš„äº¤æ¢ã€‚



å½“ç„¶ä¸šåŠ¡è¿˜æœ‰ä¸ªç»†åˆ†çš„é—®é¢˜ã€‚ISPAæ˜¯å®Œæˆå…¨çƒèŒƒå›´å†…çš„access netæ¥å…¥ï¼Œå½“ç„¶ä¹Ÿæœ‰ä¸€äº›å°çš„è¿è¥å•†ï¼Œå¯ä»¥åšç²¾ç»†åŒ–çš„æœåŠ¡ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªå›½å®¶æˆ–è€…å‡ ä¸ªå¤§å·ä¹‹é—´ï¼Œæˆ‘æœ‰æˆ‘çš„åŠ¿åŠ›èŒƒå›´ï¼Œæˆ‘å¯ä»¥åšç²¾ç»†åŒ–çš„æœåŠ¡ï¼Œæˆ‘å¯ä»¥éƒ¨ç½²å¾ˆå¤šè·¯ç”±å™¨ï¼Œé“¾è·¯ä»è€ŒæŠŠæ›´å¤šçš„ç”¨æˆ·æ¥è¿›æ¥ã€‚æ‰€ä»¥å°±æœ‰ä¸šåŠ¡ç»†åˆ†ã€‚



global ISP å®Œæˆå…¨çƒæ–¹ä½å†…çš„äº¤æ¢ï¼Œè€ŒReginalï¼Œè¦å®ŒæˆåŒºåŸŸèŒƒå›´å†…ï¼ŒæŠŠè¿™äº›access netæ¥è¿›æ¥ï¼Œå®ƒä»¬ä¹‹é—´è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œå¦‚æœè¦è®¿é—®äº’è”ç½‘å…¶ä»–åœ°æ–¹çš„ï¼Œå†é€šè¿‡global ISPå®Œæˆå…¨çƒèŒƒå›´çš„äº¤æ¢ã€‚



ç°åœ¨æƒ…å†µæ›´åŠ å¤æ‚ï¼Œäº’è”ç½‘æœ‰å¾ˆå¤šè§’è‰²ï¼Œç«¯ç³»ç»Ÿæœ‰ç”¨æˆ·ï¼Œè¿˜æœ‰æœåŠ¡æä¾›å•†ISPï¼Œè¿˜æœ‰ICPå°±äº’è”ç½‘å†…å®¹æä¾›å•†ï¼Œæ¯”å¦‚googleï¼Œbaiduç­‰ã€‚æä¾›ä¸Šå±‚ä¸šåŠ¡çš„ã€‚



åƒGoogleè¿™æ ·çš„ICPï¼Œæœ‰åå‡ äº¿ç”¨æˆ·æä¾›æœåŠ¡çš„ICPï¼Œè¿™äº›å†…å®¹æä¾›å•†å½“ç„¶ä¹Ÿéœ€è¦é€šè¿‡ISPæ¥å…¥äº’è”ç½‘ã€‚ä½†æ˜¯æˆ‘ä½œä¸ºå†…å®¹æä¾›å•†ï¼Œæ¥å…¥äº’è”ç½‘ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿéœ€è¦å‘ISPä»˜è´¹ï¼Œè€Œä¸”ä»˜è´¹è¿˜å¾ˆé«˜ã€‚å¯¹äºGoogleæ¥è¯´ï¼Œå¦‚æœä»˜è´¹éå¸¸é«˜ã€‚è€Œä¸”æœåŠ¡è´¨é‡ä¹Ÿæ²¡åŠæ³•ä¿è¯ã€‚æ¯”å¦‚æˆ‘æ˜¯ç¾æ´²çš„ISPï¼Œç„¶åå—éçš„ç”¨æˆ·è®¿é—®æˆ‘ï¼Œè¿™ä¸ªè·ç¦»å°±å¾ˆè¿œï¼Œä¸­é—´è¦ç»è¿‡å¾ˆå¤šæ•°æ®äº¤æ¢è®¾å¤‡ã€‚å°±å¾ˆéº»çƒ¦ã€‚æ€ä¹ˆåŠå‘¢ã€‚


åƒGoogleè¿™æ ·çš„å†…å®¹æä¾›å•†å°±ä¼šåœ¨å…¨çƒå„åœ°å¸ƒç½®æ•°æ®ä¸­å¿ƒæœºæˆ¿ã€‚æˆ‘é€šè¿‡æˆ‘è‡ªå·±éƒ¨ç½²çš„ä¸“ç½‘ï¼Œæˆ–è€…ç§Ÿç”¨çº¿ç¼†ã€‚æŠŠè¿™äº›æ•°æ®ä¸­å¿ƒæœºæˆ¿è¿åœ¨ä¸€èµ·ã€‚è€Œä¸”è¿™äº›æ•°æ®ä¸­å¿ƒé€šå¸¸å¸ƒç½®åœ¨ç¦»ISPçš„æ•°æ®ä¸­å¿ƒæœºæˆ¿æ¯”è¾ƒè¿‘çš„åœ°æ–¹ã€‚è¿™æ ·ç”¨æˆ·é€šè¿‡ISPæ¥è¿›æ¥ï¼Œå¾ˆå¿«å°±èƒ½æ¥å…¥googleçš„æ•°æ®ä¸­å¿ƒæœºæˆ¿ã€‚ç„¶åè¿”å›å»ï¼Œè¿™æ ·ä½“éªŒå°±å¾ˆå¥½ã€‚è€Œä¸”å› ä¸ºåœ¨å¾ˆå¤šé“¾è·¯ä¸Šï¼Œæˆ‘ç”¨çš„è‡ªå·±çš„ä¸“ç½‘ï¼Œå› æ­¤å‘ISPæ”¯ä»˜çš„è´¹ç”¨å°±ä¼šå¾ˆå°‘ã€‚



æ‰€ä»¥ä¸€ä¸ªæˆæœ¬åŸå› ï¼Œä¸€ä¸ªç”¨æˆ·ä½“éªŒçš„åŸå› ï¼Œä¿ƒä½¿Googleéƒ¨ç½²è‡ªå·±çš„æ•°æ®ä¸­å¿ƒæœºæˆ¿ã€‚



é€šå¸¸æ¥è¯´å…¨çƒèŒƒå›´å†…çš„è¦†ç›–ç‚¹ä¼šå°‘ä¸€äº›ï¼Œå› ä¸ºæˆæœ¬å¤ªé«˜ï¼Œç‚¹å’Œç‚¹ä¹‹é—´ï¼Œå¸¦å®½ä¼šå¾ˆå®½ã€‚å› ä¸ºä»˜äº†é‚£ä¹ˆå¤§ä»£ä»·ï¼Œä½¿ç”¨æµ·åº•ç”µç¼†è¿æ¥æ´›æ‰çŸ¶åˆ°ä¸Šæµ·ã€‚å¸¦å®½æä¸€ä¸ª1kï¼Œé‚£ä¸æ˜¯æœ‰ç—…å—ã€è‡ªå·±ç”¨ä¸äº†è¿˜å¯ä»¥ç§Ÿå‡ºå»å˜›â€¦â€¦



åƒ















### åè®®å±‚æ¬¡å’ŒæœåŠ¡æ¨¡å‹



#### æ¨¡å—åŒ–åˆ†å±‚æ€è·¯

æˆ‘ä»¬é¦–å…ˆè¦æ‰¿è®¤ä¸€ç‚¹ï¼šç½‘ç»œæ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„ç³»ç»Ÿã€‚æœ‰å„ç§å„æ ·çš„ç»ˆç«¯è®¾å¤‡ï¼Œå„ç§å„æ ·çš„é“¾è·¯ï¼Œå„ç§å„æ ·çš„åº”ç”¨ã€‚é‚£ä¹ˆä½œä¸ºä¸€ä¸ªç§‘å­¦å®¶æˆ–è€…å·¥ç¨‹å¸ˆå®ä½“ï¼Œå¦‚ä½•è®¾è®¡å’Œå®ç°ç»„ç»‡å¤æ‚çš„ç½‘ç»œåŠŸèƒ½ï¼Ÿ



è§£å†³è¿™ä¸ªé—®é¢˜çš„æ€è·¯ï¼šæ¨¡å—åŒ–çš„æ€è·¯ã€‚



ä»€ä¹ˆæ˜¯æ¨¡å—åŒ–çš„æ€è·¯å‘¢ï¼Ÿå°±æ˜¯æŠŠä¸€ä¸ªå¤æ‚çš„åŠŸèƒ½ï¼Œåˆ†è§£æˆä¸€ä¸ªä¸ªæ¨¡å—ï¼Œæ¨¡å—ä¹‹é—´ç›¸äº’è°ƒç”¨ï¼Œè€Œä¸”å¹³é¢æ€§çš„è°ƒç”¨ï¼Œä»»ä½•ä¸€ä¸ªæ¨¡å—éƒ½å¯ä»¥è°ƒç”¨ä»»ä½•æ¨¡å—æä¾›çš„åŠŸèƒ½å’ŒæœåŠ¡ï¼Œè¿™æ ·å°±å¯ä»¥ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„åŠŸèƒ½é€šè¿‡æ¨¡å—åŒ–çš„åˆ†è§£æ¥è¿›è¡Œå®ç°ã€‚

![image-20250613100710715](D:\git_repository\cyber_security_learning\markdown_img\image-20250613100710715.png)



å…¶ä¸­ä¸€ä¸ªæ¨¡å—åŒ–çš„åˆ†è§£æ€è·¯å°±æ˜¯åˆ†å±‚çš„æ–¹æ³•æ¥è§£å†³ã€‚

å°†ä¸€ä¸ªå¤æ‚çš„åŠŸèƒ½åˆ†ä¸ºä¸€ä¸ªä¸ªæ¨¡å—ï¼Œæ¨¡å—ä¹‹é—´çš„è°ƒç”¨å’Œè¢«è°ƒç”¨å…³ç³»æ˜¯**ä»ä»…ç›¸é‚»**çš„ä¸¤å±‚çš„æ¨¡å—ä¹‹é—´èƒ½å¤Ÿè°ƒç”¨å’Œè¢«è°ƒç”¨ï¼Œä»–ä¸å…è®¸æˆ–è€…è¯´ä¸æ¨èè·¨å±‚è°ƒç”¨ã€‚

è€Œ**è®¡ç®—æœºç½‘ç»œå®ç°**è¿™ç§å¤æ‚çš„é—®é¢˜ï¼Œå°±æ˜¯é‡‡ç”¨åˆ†å±‚çš„æ¨¡å—åŒ–çš„æ–¹å¼æ¥è§£å†³ï¼Œè®¾è®¡å’Œå®ç°çš„ã€‚å°†åŠŸèƒ½éå¸¸å¤æ‚çš„è®¡ç®—æœºç½‘ç»œçš„åŠŸèƒ½åˆ†è§£ä¸ºä¸€ä¸ªä¸ªåŠŸèƒ½æ˜ç¡®çš„å­æ¨¡å—ï¼Œæ¯ä¸€å±‚å®ç°ä¸€ä¸ªæˆ–ä¸€ç»„åŠŸèƒ½ã€‚æ¯ä¸€å±‚çš„åŠŸèƒ½é€šè¿‡å±‚é—´çš„æ¥å£ï¼Œå‘ä¸Šå±‚æä¾›æœåŠ¡ã€‚åƒè¿™æ ·ä¸€å±‚è½ä¸€å±‚ï¼Œä¸€æ¬¡è½ä¸€å±‚ï¼Œæœ€åå®ç°æ¯”è¾ƒå¤æ‚çš„è®¡ç®—æœºç½‘ç»œçš„åŠŸèƒ½









#### å¼‚åœ°å“²å­¦å®¶äº¤æµå“²å­¦æ€æƒ³

è®¡ç®—æœºç½‘ç»œä½¿ç”¨åˆ†å±‚çš„æ–¹å¼å¦‚ä½•è§£å†³æ¯”è¾ƒå¤æ‚çš„è®¡ç®—æœºç½‘ç»œçš„åŠŸèƒ½å®ç°ï¼Œå¯ä»¥é€šè¿‡ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼ˆå¼‚åœ°å“²å­¦å®¶ä½¿ç”¨ä¸åŒè¯­è¨€è¿›è¡Œå“²å­¦æ€æƒ³äº¤æµçš„å¤æ‚é—®é¢˜ï¼‰ï¼Œæ¥æ–¹ä¾¿å¤§å®¶çš„ç†è§£

![image-20250613094506502](D:\git_repository\cyber_security_learning\markdown_img\image-20250613094506502.png)

 

- æœ€ä¸‹é¢æ˜¯ç§˜ä¹¦å±‚ï¼šè§£å†³çš„æ˜¯å¼‚åœ°é€šè®¯çš„é—®é¢˜ã€‚ï¼ˆåè®®ï¼šçº¦å®šé€šä¿¡çš„æ–¹å¼ï¼‰
- ç¬¬äºŒå±‚æ˜¯ç¿»è¯‘å±‚ï¼šè§£å†³çš„æ˜¯è¡¨ç¤ºè½¬æ¢çš„é—®é¢˜ã€‚å°†ä¸¤ä½å“²å­¦å®¶ä¸åŒçš„è¯­è¨€è½¬æ¢ä¸ºå…±ç”¨çš„è¯­è¨€è¿›è¡Œäº¤æµï¼ˆåè®®ï¼šçº¦å®šå…±ç”¨çš„è¯­è¨€ï¼‰
- æœ€ä¸Šé¢æ˜¯å“²å­¦å®¶å±‚ï¼šä¸¤ä¸ªå“²å­¦å®¶äº¤æ¢å“²å­¦æ€æƒ³ï¼Œä»è€Œå®Œæˆæ·±å±‚æ¬¡çš„å­¦æœ¯äº¤æµ



é€šè¿‡ä¸Šè¿°è¿‡ç¨‹ç±»æ¯”ï¼šä¸¤ä¸ªåº”ç”¨è¿›ç¨‹é€šè¿‡äº¤æ¢åº”ç”¨æŠ¥æ–‡æ¥å®ç°å„ç§å„æ ·çš„ç½‘ç»œåº”ç”¨ã€‚åŒ…æ‹¬ï¼šç”µå­å•†åŠ¡ï¼ŒåŸŸåè§£æï¼Œæ–‡ä»¶ä¸‹è½½ç­‰ã€‚



ä¸Šè¿°åˆ†å±‚è§£å†³é—®é¢˜çš„ä¼˜åŠ¿ï¼š

- æŠŠä¸€ä¸ªå¤æ‚çš„é—®é¢˜è½¬æ¢æˆ3ä¸ªå­é—®é¢˜ï¼Œæ¯ä¸ªé—®é¢˜çš„è§£å†³ç›¸å¯¹ç‹¬ç«‹ï¼Œå•ä¸€ã€‚
- æ¯ä¸€å±‚ç‹¬ç«‹è¿›è¡ŒæŠ€æœ¯æ›´æ–°ï¼Œä¸ä¼šå½±å“å…¶ä»–å±‚ã€‚



å±‚æ¬¡åŒ–æ–¹å¼å®ç°å¤æ‚ç½‘ç»œåŠŸèƒ½ï¼š

- å°†ç½‘ç»œå¤æ‚çš„åŠŸèƒ½åˆ†å±‚åŠŸèƒ½æ˜ç¡®çš„å±‚æ¬¡ï¼Œæ¯ä¸€å±‚å®ç°äº†å…¶ä¸­ä¸€ä¸ªæˆ–ä¸€ç»„åŠŸèƒ½ï¼ŒåŠŸèƒ½ä¸­æœ‰å…¶ä¸Šå±‚å¯ä»¥ä½¿ç”¨çš„åŠŸèƒ½ï¼š**æœåŠ¡**ï¼ˆæœ¬å±‚åŠŸèƒ½çš„å­é›†ï¼Œèƒ½å¤Ÿä¸ºä¸Šå±‚æä¾›æœåŠ¡çš„éƒ¨åˆ†ï¼‰
- æœ¬å±‚åè®®ï¼ˆæ¯ä¸€å±‚äº¤äº’åº”è¯¥éµå®ˆçš„è§„åˆ™çš„é›†åˆï¼‰å®ä½“ç›¸äº’äº¤äº’æ‰§è¡Œæœ¬å±‚çš„åè®®åŠ¨ä½œï¼Œç›®çš„æ˜¯å®ç°æœ¬å±‚çš„åŠŸèƒ½ï¼Œé€šè¿‡æ¥å£**ä¸ºä¸Šå±‚æä¾›æ›´å¥½çš„æœåŠ¡**
- æœ¬å±‚çš„æœåŠ¡ï¼šå€ŸåŠ©ä¸‹å±‚æœåŠ¡å®ç°çš„æœ¬å±‚åè®®å®ä½“ä¹‹é—´äº¤äº’å¸¦æ¥çš„æ–°åŠŸèƒ½ï¼ˆä¸Šå±‚å¯ä»¥é‡Œåˆ©ç”¨ï¼‰+æ›´æ–°å±‚æä¾›çš„æœåŠ¡ã€‚





#### åè®®å’ŒæœåŠ¡çš„å…³ç³»

åè®®çš„ç›®çš„ï¼šä¸ºä¸Šå±‚æä¾›æ›´å¥½çš„æœåŠ¡

åè®®çš„å®ç°ï¼šé€šè¿‡å±‚é—´çš„æ¥å£ï¼Œå€ŸåŠ©äºä¸‹å±‚æä¾›çš„æœåŠ¡ï¼Œäº¤æ¢å¯¹ç­‰å±‚ç›¸åº”çš„PDUï¼Œä»è€Œå®ç°æ–°çš„åè®®åŠ¨ä½œï¼Œç›®çš„æ˜¯ä¸ºä¸Šå±‚æä¾›æ›´å¥½çš„æœåŠ¡

```bat
æ¯ä¸€å±‚å‘ä¸Šå±‚æä¾›çš„æœåŠ¡ï¼ŒåŒ…æ‹¬äº†æ‰€æœ‰ä¸‹å±‚æä¾›æœåŠ¡çš„æ€»å’Œï¼ŒåŠ ä¸Šå’Œå¯¹ç­‰å±‚å®ä½“äº¤äº’è¿‡ç¨‹ä¸­å½¢æˆçš„æ–°çš„æœåŠ¡ç‰¹æ€§ï¼Œé€šè¿‡å±‚é—´æ¥å£å‘ä¸Šå±‚æä¾›æ›´å¥½çš„æœåŠ¡
```







#### äº’è”ç½‘ä¸­çš„åˆ†å±‚ç»“æ„ â€” TCP/IPåè®®æ ˆ

![image-20250613141157388](D:\git_repository\cyber_security_learning\markdown_img\image-20250613141157388.png)



**å„å±‚çš„ä½œç”¨**

- **åº”ç”¨ç¨‹ï¼š**ç½‘ç»œåº”ç”¨

  > ä¸ºäººç±»ç”¨æˆ·æˆ–è€…å…¶ä»–åº”ç”¨è¿›ç¨‹æä¾›ç½‘ç»œåº”ç”¨æœåŠ¡
  >
  > FTPï¼ŒSMTPï¼ŒHTTPï¼ŒDNS

- **ä¼ è¾“å±‚ï¼š**ä¸»æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“

  > åœ¨ç½‘ç»œå±‚æä¾›çš„ç«¯åˆ°ç«¯é€šä¿¡åŸºç¡€ä¸Šï¼Œ1. ç»†åˆ†ä¸ºè¿›ç¨‹åˆ°è¿›ç¨‹ï¼Œ2. å°†ç½‘ç»œå±‚ä¸å¯é çš„é€šä¿¡å˜æˆå¯é åœ°é€šä¿¡

- **ç½‘ç»œå±‚ï¼š**ä¸ºæ•°æ®æŠ¥ï¼ˆPackageï¼‰ä»æºåˆ°ç›®çš„é€‰æ‹©è·¯ç”±

  > ä¸»æœºä¸»æœºä¹‹é—´çš„é€šä¿¡ï¼Œç«¯åˆ°ç«¯é€šä¿¡ï¼Œä¸å¯é 
  >
  > IPï¼Œè·¯ç”±åè®®

- **æ•°æ®é“¾è·¯å±‚ï¼š**ç›¸é‚»ç½‘ç»œèŠ‚ç‚¹é—´çš„æ•°æ®ä¼ è¾“

  > **æ•°æ®é“¾è·¯å±‚çš„ä¸»è¦ä½œç”¨**æ˜¯ï¼šä»¥**å¸§ï¼ˆFrameï¼‰ä¸ºå•ä½åœ¨ç›¸é‚»èŠ‚ç‚¹ä¹‹é—´å¯é ä¼ è¾“æ•°æ®ã€‚ å®ƒè´Ÿè´£å°†æ¥è‡ªç‰©ç†å±‚çš„è¿ç»­æ¯”ç‰¹æµï¼ˆbit streamï¼‰åˆ’åˆ†ä¸ºæœ‰ç•Œçš„å¸§ï¼Œè¯†åˆ«å‡ºæ¯ä¸€å¸§çš„\**èµ·å§‹å’Œç»“æŸä½ç½®**ï¼Œä»è€Œå®ç°å¯¹æ•°æ®çš„ç»„ç»‡å’Œç®¡ç†ã€‚
  >
  > ç‚¹å¯¹å¯¹åè®®PPPï¼Œ802.11(wifi)ï¼ŒEthernet

- **ç‰©ç†å±‚ï¼š**åœ¨çº¿è·¯ä¸Šä¼ é€’bitï¼ˆæä¾›ç›¸é‚»ä¸¤ç‚¹ï¼Œå°†æ•°å­—ä¿¡å·å’Œç‰©ç†ä¿¡å·ä¹‹é—´çš„ç›¸äº’è½¬æ¢ï¼‰

  > å‘é€ç«¯ï¼šä¸Šå±‚ä¼ ä¸‹æ¥çš„å¸§ï¼Œå˜ä¸ºç‰©ç†ä¿¡å·ï¼Œåœ¨ä»‹è´¨ä¸­è½¬æ’­ç»™å¯¹ç«¯ã€‚
  >
  > æ¥æ”¶ç«¯ï¼šå°†åª’ä½“ä¸­æ‰¿è½½çš„ç”µç£æ³¢æˆ–è€…å…‰ä¿¡å·è¿˜åŸå›æ•°å­—ä¿¡å·ã€‚





#### ISO/OSI å‚è€ƒæ¨¡å‹



- **è¡¨ç¤ºå±‚**ï¼šå…è®¸åº”ç”¨è§£é‡Šä¼ è¾“çš„æ•°æ®ã€‚egï¼šåŠ å¯†ï¼Œå‹ç¼©ï¼ŒåŠå…¶ç›¸å…³çš„è½¬æ¢
- **ä¼šè¯å±‚ï¼š**æ•°æ®äº¤æ¢çš„åŒæ­¥ï¼Œæ£€æŸ¥ç‚¹ï¼Œæ¢å¤ã€‚



äº’è”ç½‘åè®®æ ˆæ²¡æœ‰è¿™ä¸¤å±‚ï¼è¿™äº›æœåŠ¡ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œå¿…é¡»è¢«**åº”ç”¨å®ç°**ã€‚





#### æœåŠ¡å’ŒæœåŠ¡è®¿é—®ç‚¹

- **æœåŠ¡ï¼ˆServiceï¼‰ï¼š**ä½å±‚å®ç°å‘ä¸Šå±‚å®ä½“æä¾›å®ƒä»¬ä¹‹é—´çš„é€šä¿¡èƒ½åŠ›
  - æœåŠ¡ç”¨æˆ·ï¼ˆService Userï¼‰
  - æœåŠ¡æä¾›è€…ï¼ˆService Providerï¼‰



- **åŸè¯­ï¼ˆPrimitiveï¼‰ï¼š**ä¸Šå±‚ä½¿ç”¨ä¸‹å±‚æœåŠ¡çš„å½¢å¼ï¼Œé«˜å±‚ä½¿ç”¨åº•å±‚æä¾›çš„æœåŠ¡ï¼Œä»¥åŠä½å±‚å‘é«˜å±‚æä¾›æœåŠ¡éƒ½æ˜¯é€šè¿‡æœåŠ¡è®¿é—®åŸè¯­æ¥è¿›è¡Œäº¤äº’çš„ --- å½¢å¼

  > æ¯”å¦‚ï¼šä¼ è¾“å±‚å‘åº”ç”¨ç¨‹æä¾›æœåŠ¡çš„å½¢å¼æ˜¯Socketï¼Œä¸Šå±‚å‘ä¸‹å±‚å‘é€SDUæ—¶ï¼Œè¿›è¡Œæ ‡æ³¨ã€‚åœ¨å¯¹ç­‰ç«¯ï¼Œä¸‹å±‚å‘ä¸Šå±‚æ ¹æ®æ ‡æ³¨ä¿¡æ¯é€‰æ‹©å¯¹åº”çš„åº”ç”¨æ¥æ”¶æ•°æ®



- **æœåŠ¡è®¿é—®ç‚¹SAPï¼ˆService Access Pointï¼‰ï¼š**ä¸Šå±‚ä½¿ç”¨ä¸‹å±‚æä¾›çš„æœåŠ¡é€šè¿‡å±‚é—´çš„æ¥å£â€”åœ°ç‚¹ï¼š
  - ä¸‹å±‚çš„ä¸€ä¸ªå®ä½“æ”¯æ’‘ç€ä¸Šå±‚çš„å¤šä¸ªå®ä½“ï¼ŒSAPæœ‰æ ‡å¿—ä¸åŒä¸Šå±‚å®ä½“çš„ä½œç”¨ã€‚
  - ä¾‹å­ï¼šä¼ è¾“å±‚çš„SAPï¼Œç«¯å£ï¼ˆPortï¼‰

![image-20250613113513040](D:\git_repository\cyber_security_learning\markdown_img\image-20250613113513040.png)



#### å°è£…å’Œè§£å°è£…

 

â€‹                                          ![image-20250613145928480](D:\git_repository\cyber_security_learning\markdown_img\image-20250613145928480.png)





ä»æºä¸»æœºåˆ°ç›®æ ‡ä¸»æœºå‘é€çš„æŠ¥æ–‡ï¼Œé€»è¾‘ä¸Šæ¥çœ‹ï¼Œæ˜¯åº”ç”¨è¿›ç¨‹**ç›´æ¥**å‘å¯¹ç«¯çš„åº”ç”¨è¿›ç¨‹å‘é€æŠ¥æ–‡ï¼Œä½†è¿™ä¸ªç›´æ¥æ˜¯è¦æ‰“ä¸Šå¼•å·çš„ã€‚æ˜¯é€»è¾‘ä¸Šé€šä¿¡çš„ã€‚çœ‹ä¼¼å¥½åƒæ˜¯å®¢æˆ·ç«¯æµè§ˆå™¨ç›´æ¥å‘ç»™webæœåŠ¡ç«¯è¯·æ±‚æŠ¥æ–‡ï¼ŒwebæœåŠ¡ç«¯å‘å®¢æˆ·ç«¯è¿”å›å“åº”æŠ¥æ–‡ã€‚å¥½åƒæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç›´æ¥é€šä¿¡ï¼Œä½†æ˜¯å®é™…ä¸Šmessageæ˜¯ä¸å¯ä»¥ç›´æ¥ä¼ é€ç»™ç›®æ ‡çš„åº”ç”¨è¿›ç¨‹çš„ã€‚

å®é™…ä¸Šæ˜¯é€šè¿‡å±‚é—´çš„æ¥å£ï¼Œå€ŸåŠ©äºä¸‹å±‚æä¾›çš„æœåŠ¡æ¥å®ç°çš„ã€‚

ä¹Ÿå°±æ˜¯æºä¸»æœºçš„åº”ç”¨å±‚å°†messageå‘é€ç»™ä¸‹å±‚çš„ä¼ è¾“å±‚ï¼Œä¼ è¾“å±‚åœ¨SDUåŸºç¡€ä¸Šï¼ŒåŠ ä¸Šæœ¬å±‚çš„æ§åˆ¶ä¿¡æ¯å¤´ï¼Œç”Ÿæˆæœ¬å±‚çš„PDUã€‚åœ¨ä¼ è¾“å±‚å«åšæŠ¥æ–‡æ®µsegmentã€‚

æŠ¥æ–‡æ®µä¹Ÿæ— æ³•ç›´æ¥ä¼ è¾“ç»™å¯¹ç«¯çš„ä¼ è¾“å±‚å®ä½“ã€‚å› æ­¤è¦é€šè¿‡å±‚é—´çš„æ¥å£å€ŸåŠ©äºä¸‹å±‚çš„ç½‘ç»œå±‚çš„æœåŠ¡å®ç°ã€‚æ‰€ä»¥è¦å°†æ•°æ®å‘é€ç½‘ç»œå±‚ï¼Œç½‘ç»œå±‚æ”¶åˆ°æŠ¥æ–‡åï¼ŒåŠ ä¸Šæœ¬å±‚çš„å¤´éƒ¨æ§åˆ¶ä¿¡æ¯ï¼ˆæºIPï¼Œç›®æ ‡IPç­‰æ•°æ®ï¼‰ï¼Œç”Ÿæˆæœ¬å±‚çš„PDUï¼Œä¹Ÿå°±æ˜¯åˆ†ç»„ï¼ˆPackageï¼‰ã€‚

> å¤´éƒ¨ä¿¡æ¯æ˜¯ä¸Šå±‚ä¼ ä¸‹æ¥çš„ICIï¼Œé€šè¿‡è§£æè½¬æ¢ç”Ÿæˆæœ¬å±‚çš„å¤´éƒ¨æ§åˆ¶ä¿¡æ¯

ç½‘ç»œå±‚ä¹Ÿå¯èƒ½æ— æ³•ç›´æ¥ä¼ è¾“ç»™å¯¹ç«¯çš„ç½‘ç»œå±‚å®ä½“ï¼Œå› æ­¤è¦é€šè¿‡å±‚é—´çš„æ¥å£å€ŸåŠ©äºä¸‹å±‚çš„æ•°æ®é“¾è·¯å±‚çš„æœåŠ¡å®ç°ã€‚æ‰€ä»¥è¿˜è¦å°†æ•°æ®å‘é€ç»™é“¾è·¯å±‚ï¼Œåœ¨é“¾è·¯å±‚æ”¶åˆ°æŠ¥æ–‡åï¼ŒåŠ ä¸Šæœ¬å±‚çš„å¤´éƒ¨ä¿¡æ¯ï¼ˆæºMACåœ°å€ï¼Œç›®æ ‡MACåœ°å€ï¼‰ï¼Œç”Ÿæˆæœ¬å±‚çš„PDUï¼Œä¹Ÿå°±æ˜¯åˆ†ç»„ï¼ˆå¸§ï¼‰ã€‚

ç‰©ç†å±‚æ”¶åˆ°é“¾è·¯å±‚ä¼ ä¸‹çš„æ•°æ®åï¼Œå°†æ•°å­—ä¿¡å·è½¬æ¢ä¸ºç”µä¿¡å·æˆ–è€…å…‰ä¿¡å·ï¼Œä»è€Œé€šè¿‡åª’ä½“ä»‹è´¨ï¼Œå°†æ•°æ®å‘é€ç»™å¯¹ç«¯ã€‚

 











## æ›´æ”¹ç½‘å¡å â€” é…ç½®å¯åŠ¨é¡¹

Rocky9ä»¥ä¸Šï¼Œé»˜è®¤ä½¿ç”¨åŠŸèƒ½BLSï¼ˆBoot Loader Specificationï¼‰é…ç½®æ–¹å¼ï¼Œä¸ä¼šä½¿ç”¨ `/etc/default/grub` ä¸­çš„ `GRUB_CMDLINE_LINUX` å‚æ•°ã€‚



### ä»€ä¹ˆæ˜¯BLS

**BLS æ˜¯ä¸€å¥—æ ‡å‡†**ï¼Œç”±ç³»ç»Ÿå¼•å¯¼ç¨‹åºï¼ˆå¦‚ GRUBï¼‰ä½¿ç”¨ï¼Œç”¨æ¥ **ç®¡ç†æ¯ä¸ªå†…æ ¸å¯åŠ¨é¡¹çš„é…ç½®**ï¼Œä»¥ **æ–‡ä»¶å½¢å¼**å­˜å‚¨åœ¨ `/boot/loader/entries/` ç›®å½•ä¸‹ï¼Œæ¯ä¸€ä¸ªå¯åŠ¨é¡¹éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„ `.conf` æ–‡ä»¶ã€‚

> âœ… æœ¬è´¨ä¸Šï¼š
>  BLS æ˜¯ Linux æ–°çš„â€œå¯åŠ¨é…ç½®æ–¹å¼â€ï¼Œç›®çš„æ˜¯ **æ›´æ¨¡å—åŒ–ã€æ˜“äºè‡ªåŠ¨ç®¡ç†å’Œå‡çº§å†…æ ¸å¯åŠ¨é¡¹**ã€‚



### BLS ä¸ä¼ ç»Ÿ grub.cfg æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

| ç‰¹æ€§               | ä¼ ç»Ÿ grub.cfg                          | BLS æ¨¡å¼                                      |
| ------------------ | -------------------------------------- | --------------------------------------------- |
| å¯åŠ¨é¡¹é…ç½®å­˜å‚¨ä½ç½® | `/boot/grub2/grub.cfg`                 | `/boot/loader/entries/*.conf`                 |
| ç®¡ç†æ–¹å¼           | å…¨éƒ¨å†…æ ¸ç‰ˆæœ¬å…±äº«ä¸€ä¸ª grub.cfg          | æ¯ä¸ªå†…æ ¸ç‰ˆæœ¬éƒ½æœ‰ç‹¬ç«‹å¯åŠ¨é¡¹é…ç½®æ–‡ä»¶            |
| å‚æ•°è®¾ç½®æ–¹å¼       | `/etc/default/grub` + `grub2-mkconfig` | `.conf` æ–‡ä»¶ç›´æ¥å†™å…¥ `options=...` è¡Œ         |
| ä¼˜åŠ¿               | çµæ´»ä½†å®¹æ˜“ä¹±                           | æ¨¡å—åŒ–ã€é€‚åˆè‡ªåŠ¨æ›´æ–°ï¼ˆå¦‚ dnf install kernelï¼‰ |
| æ˜¯å¦ä½¿ç”¨ BLS       | `GRUB_ENABLE_BLSCFG=true` æ—¶å¯ç”¨       | å¦æ—¶ç”¨ä¼ ç»Ÿ grub.cfg                           |



### ä¸€ä¸ªå…¸å‹çš„ BLS å¯åŠ¨é¡¹æ–‡ä»¶ï¼ˆç¤ºä¾‹ï¼‰

è·¯å¾„ï¼š`/boot/loader/entries/rocky-5.14.0-427.el9.x86_64.conf`

```ini
title Rocky Linux (5.14.0-427.el9.x86_64) 9.4
version 5.14.0-427.el9.x86_64
linux /vmlinuz-5.14.0-427.el9.x86_64
initrd /initramfs-5.14.0-427.el9.x86_64.img
options root=/dev/mapper/rl-root ro crashkernel=auto net.ifnames=0 biosdevname=0 quiet
```

- `title`ï¼šæ˜¾ç¤ºåœ¨å¼•å¯¼èœå•ä¸­çš„åç§°
- `linux`ï¼šå†…æ ¸é•œåƒè·¯å¾„
- `initrd`ï¼šå†…æ ¸åˆå§‹æ–‡ä»¶ç³»ç»Ÿ
- `options`ï¼šå†…æ ¸å¯åŠ¨å‚æ•° â† å°±æ˜¯ä½ è¦åŠ  `net.ifnames=0 biosdevname=0` çš„åœ°æ–¹ï¼





### BLSç›¸å…³æ“ä½œ

#### æ£€æŸ¥æ˜¯å¦å¯ç”¨ BLS æ¨¡å¼

```bash
cat /etc/default/grub | grep GRUB_ENABLE_BLSCFG
```

ä¸º `true` è¡¨ç¤ºå¯ç”¨äº† BLS



#### ä¸´æ—¶ä¿®æ”¹å†…æ ¸å‚æ•°ï¼ˆä¸å»ºè®®ï¼‰

ç¼–è¾‘å½“å‰é»˜è®¤å†…æ ¸çš„å¯åŠ¨é¡¹ï¼š

```bash
vim /boot/loader/entries/xxx.conf
```

åœ¨ `options=` è¡Œå°¾åŠ ä¸Šä½ çš„å‚æ•°



#### æ°¸ä¹…å…³é—­ BLS

```bash
sed -i 's/GRUB_ENABLE_BLSCFG=true/GRUB_ENABLE_BLSCFG=false/' /etc/default/grub
grub2-mkconfig -o /boot/grub2/grub.cfg
```





#### ç¡®è®¤å½“å‰å†…æ ¸å‚æ•°æ˜¯å¦ç”Ÿæ•ˆ

```bash
# æŸ¥çœ‹/proc/cmdline
[root@localhost ~]# cat /proc/cmdline 
BOOT_IMAGE=/vmlinuz-5.14.0-427.13.1.el9_4.x86_64 root=/dev/mapper/rl-root ro crashkernel=1G-4G:192M,4G-64G:256M,64G-:512M resume=/dev/mapper/rl-swap rd.lvm.lv=rl/root rd.lvm.lv=rl/swap rhgb quiet net.ifnames=0 biosdevname=0
```



## é…ç½®é™æ€IP â€” é…ç½®ç½‘ç»œæœåŠ¡



### Rocky

**å…¼å®¹æ€§è¯´æ˜ï¼š**

| ç³»ç»Ÿç‰ˆæœ¬      | é»˜è®¤æ–¹å¼                         | æ˜¯å¦å…¼å®¹ ifcfg-* | å»ºè®®           |
| ------------- | -------------------------------- | ---------------- | -------------- |
| CentOS 7      | NetworkManager + network-scripts | âœ…                | å¯ç»§ç»­ä½¿ç”¨è„šæœ¬ |
| Rocky 8       | NetworkManager + è„šæœ¬å…¼å®¹æ¨¡å¼    | âœ…                | é€æ­¥è¿‡æ¸¡       |
| Rocky 9/RHEL9 | NetworkManager + `.nmconnection` | âš ï¸ï¼ˆéƒ¨åˆ†å…¼å®¹ï¼‰    | æ¨èå…¨é¢è¿ç§»   |



**NetworkManageré™æ€IPçš„`.nmconnection`æ–‡ä»¶é…ç½®**

```bash
[connection]
id=eth0
uuid=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx   # uuidgenç”Ÿæˆï¼Œä½œä¸ºç½‘å¡å”¯ä¸€æ ‡è¯†
type=ethernet
interface-name=eth0
autoconnect=true

[ethernet]
mac-address-blacklist=

[ipv4]
method=manual
address1=192.168.1.100/24,192.168.1.1        # é…ç½®é™æ€IPå’Œç½‘å…³
dns=8.8.8.8;114.114.114.114;
dns-search=
may-fail=false

[ipv6]
method=ignore             # ç¦ç”¨ipv6
```

```bash
nmcli conn reload
nmcli conn up eth0   # å¯ç”¨é…ç½®
```



- NetworkManagerå®¢æˆ·ç«¯å·¥å…· â€” nmcliï¼ˆåŠŸèƒ½å¼ºå¤§ï¼Œå¯ä»¥é€šè¿‡å®¢æˆ·ç«¯å·¥å…·ä¿®æ”¹ç½‘ç»œé…ç½®ï¼‰



### Ubuntu

- **Netplan æ˜¯ Ubuntu çš„ç»Ÿä¸€ç½‘ç»œé…ç½®å‰ç«¯**

- ç”¨æˆ·åªéœ€è¦ç¼–å†™ **YAML æ–‡ä»¶**ï¼ˆä½ç½®ï¼š`/etc/netplan/*.yaml`ï¼‰

- ç„¶åè¿è¡Œï¼š

```bash
sudo netplan apply
```

- Netplan ä¼šæ ¹æ® YAML ä¸­æŒ‡å®šçš„ `renderer` å­—æ®µï¼š

  - å¦‚æœæ˜¯ `NetworkManager`ï¼š
    - å°±æŠŠé…ç½®â€œä¼ é€’â€ç»™ NetworkManagerï¼ˆé€šè¿‡ D-Busï¼Œ**ä¸ä¼šç”Ÿæˆ .nmconnection æ–‡ä»¶**ï¼‰

  - å¦‚æœæ˜¯ `systemd-networkd`ï¼š
    - å°±è‡ªåŠ¨ç”Ÿæˆ `.network` æ–‡ä»¶ï¼Œæ”¾åœ¨ `/run/systemd/network/` ä¸‹ï¼ˆ**ä¸æ˜¯ /etc/systemd/network/**ï¼‰



- Netplan æœ¬èº« **ä¸è´Ÿè´£ç®¡ç†ç½‘å¡**ï¼Œå®ƒåªæ˜¯ **ç¿»è¯‘å™¨**ï¼ŒçœŸæ­£è´Ÿè´£ç®¡ç†çš„æ˜¯ï¼š
  - `systemd-networkd`ï¼ˆè½»é‡ï¼‰
  - `NetworkManager`ï¼ˆåŠŸèƒ½å¤šï¼Œå¦‚ Wi-Fiã€VPNï¼‰





#### NetworkManager

Netplanä¼šæŠŠé…ç½®â€œä¼ é€’â€ç»™ NetworkManagerï¼ˆé€šè¿‡ D-Busï¼ˆä¸€ç§IPCé€šä¿¡æœºåˆ¶ï¼‰ï¼Œ**ä¸ä¼šç”Ÿæˆ .nmconnection æ–‡ä»¶**ï¼‰



#### systemd-networkd

ç”±netplanè‡ªåŠ¨ç”Ÿæˆ

```bash
/run/systemd/network/10-netplan-eth0.network
```



- systemd-networkçš„å®¢æˆ·ç«¯å·¥å…· â€” networkctlï¼ˆåªè¯»ï¼‰
  - `systemd-networkd` çš„é…ç½®æ˜¯é€šè¿‡ç¼–å†™é…ç½®æ–‡ä»¶å®Œæˆçš„ï¼š
  - é…ç½®è·¯å¾„ï¼š`/etc/systemd/network`
    - `*.netdev`ï¼šå®šä¹‰è™šæ‹Ÿè®¾å¤‡ï¼ˆå¦‚ bridge, bond, vlanï¼‰
    - `*.network`ï¼šå®šä¹‰ç½‘ç»œæ¥å£é…ç½®ï¼ˆIPåœ°å€ã€è·¯ç”±ã€DNSç­‰ï¼‰
    - `*.link`ï¼šå®šä¹‰æ¥å£å‘½åå’Œå±æ€§ï¼ˆMAC åœ°å€ç­–ç•¥ç­‰ï¼‰









## HTTPåè®®

### HTTPåè®®ä»‹ç»

HTTPï¼šï¼ˆHyperText Transfer Protocolï¼‰è¶…æ–‡æœ¬ä¼ è¾“åè®®

HTTP æ˜¯ä¸€ä¸ªå·¥ä½œåœ¨åº”ç”¨å±‚çš„é€šä¿¡åè®®ï¼Œå®ƒå…è®¸å°†è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼ˆHTMLï¼‰æ–‡æ¡£ä» WEB æœåŠ¡å™¨ä¼ é€åˆ° å®¢æˆ·ç«¯çš„æµè§ˆå™¨





### HTTP åè®®ç‰ˆæœ¬å’Œå‘å±•å†å²









### Cookie ä¸ Session



#### Cookieçš„æ ¼å¼ä¸çº¦æŸ

Cookieæ˜¯å‰ç«¯ç¼–ç¨‹ä¸­ç»å¸¸ä½¿ç”¨çš„æ¦‚å¿µã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨cookieåˆ©ç”¨æµè§ˆå™¨å¸®åŠ©æˆ‘ä»¬å­˜æ”¾ç”¨æˆ·çš„ç›¸å…³çŠ¶æ€ä¿¡æ¯ï¼Œä¿å­˜ç”¨æˆ·å·²ç»åšäº†å“ªäº›äº‹æƒ…ã€‚

- Cookieçš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

- Cookieçš„é™åˆ¶åˆæ˜¯ä»€ä¹ˆï¼Ÿ

- Sessionæ˜¯æœåŠ¡å™¨ç«¯æ‰€ç»´æŠ¤çš„ä¼šè¯çŠ¶æ€ï¼ŒSessionåˆæ€æ ·ä¸Cookieå…³è”èµ·æ¥ï¼Ÿ 





##### Cookieæ˜¯ä»€ä¹ˆï¼Ÿ

![image-20250618091730167](D:\git_repository\cyber_security_learning\markdown_img\image-20250618091730167.png)



**RFC6265ï¼ŒHTTP State Management Mechanism**



Cookieä¿æŒåœ¨å®¢æˆ·ç«¯ï¼Œç”±æµè§ˆå™¨ç»´æŠ¤ï¼ˆä½†æ˜¯æ˜¯ç”±æœåŠ¡ç«¯ç”Ÿæˆçš„ï¼‰ï¼Œè¡¨ç¤ºåº”ç”¨çŠ¶æ€çš„HTTPå¤´éƒ¨

- å­˜æ”¾åœ¨å†…å­˜æˆ–è€…ç£ç›˜ä¸­
- æœåŠ¡å™¨ç«¯ç”ŸæˆCookieåœ¨å“åº”ä¸­é€šè¿‡Set-Cookieå¤´éƒ¨å‘ŠçŸ¥å®¢æˆ·ç«¯ï¼ˆå…è®¸å¤šä¸ªSet-Cookieå¤´éƒ¨ä¼ é€’å¤šä¸ªå€¼ï¼‰
- å®¢æˆ·ç«¯å¾—åˆ°Cookieåï¼Œåç»­è¯·æ±‚éƒ½ä¼šè‡ªåŠ¨å°†Cookieå¤´éƒ¨æºå¸¦è‡³è¯·æ±‚ä¸­





##### Cookie ä¸ Set-Cookieå¤´éƒ¨çš„å®šä¹‰

Cookie å¤´éƒ¨ä¸­å¯ä»¥å­˜æ”¾å¤šä¸ª **name/value** åå€¼å¯¹

```haskell
cookie-header = "Cookie:" OWS cookie-string OWS
  cookie-string = cookie-pai r*( ";" SP cookie-pair )
  cookie-pair = cookie-name "=" cookie-value
```



Set-Cookieå¤´éƒ¨ä¸€æ¬¡åªèƒ½ä¼ é€’1ä¸ª **name/value** åå€¼å¯¹ï¼Œå“åº”ä¸­å¯ä»¥å«å¤šä¸ªå¤´éƒ¨

```haskell
set-cookie-header = "Set-Cookie:" SP set-cookie-string
  set-cookie-string = cookie-pair *( ";" SP cookie-av )
  cookie-pair = cookie-name "=" cookie-value
  cookie-av: æè¿° cookie-pair çš„å¯é€‰å±æ€§
```



æµè§ˆå™¨æŸ¥çœ‹Set-Cookie

![image-20250618093022285](D:\git_repository\cyber_security_learning\markdown_img\image-20250618093022285.png)



##### Set-Cookie ä¸­æè¿°cookie-pairçš„å±æ€§

![image-20250618093427872](D:\git_repository\cyber_security_learning\markdown_img\image-20250618093427872.png)



##### Cookie ä½¿ç”¨çš„é™åˆ¶

RFCè§„èŒƒå¯¹æµè§ˆå™¨ä½¿ç”¨Cookieçš„è¦æ±‚

- æ¯æ¡Cookieçš„é•¿åº¦ï¼ˆåŒ…æ‹¬ name, value ä»¥åŠæè¿°çš„å±æ€§ç­‰æ€»é•¿åº¦ï¼‰è‡³å°‘è¦æ”¯æŒè¾¾åˆ° 4KB
- æ¯ä¸ªåŸŸåä¸‹è‡³å°‘æ”¯æŒ50 ä¸ª Cookie
- è‡³å°‘è¦æ”¯æŒ 3000 ä¸ª Cookie



ä»£ç†æœåŠ¡å™¨ä¼ é€’Cookieæ—¶ä¼šæœ‰é™åˆ¶ï¼ˆNginxé»˜è®¤32kï¼‰



##### Cookie åœ¨åè®®è®¾è®¡ä¸Šçš„é—®é¢˜

- Cookieä¼šè¢«é™„åŠ åœ¨æ¯ä¸ªHTTPè¯·æ±‚ä¸­ï¼Œæ‰€ä»¥æ— å½¢ä¸­å¢åŠ äº†æµé‡
- ç”±äºåœ¨HTTPè¯·æ±‚ä¸­çš„ Cookie æ˜¯æ˜æ–‡ä¼ é€’çš„ï¼Œæ‰€ä»¥å®‰å…¨æ€§æˆé—®é¢˜ï¼ˆé™¤éç”¨HTTPSï¼‰
- Cookieçš„å¤§å°ä¸åº”è¶…è¿‡4KBï¼Œå› ä¸ºå¯¹äºå¤æ‚çš„å­˜å‚¨éœ€æ±‚æ¥è¯´æ˜¯ä¸å¤Ÿç”¨çš„ã€‚





#### Session åŠç¬¬ä¸‰æ–¹Cookieçš„å·¥ä½œåŸç†

##### ç™»å½•åœºæ™¯ä¸‹ Cookieä¸Sessionçš„å¸¸è§ç”¨æ³•

![image-20250618094437692](D:\git_repository\cyber_security_learning\markdown_img\image-20250618094437692.png)

- é¦–å…ˆç™»å½•è¯·æ±‚å‘èµ·ä¸€ä¸ªPOSTè¡¨å•çš„loginæ“ä½œã€‚
- æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œä»è¡¨å•ä¸­è¯»å–ç”¨æˆ·åå’Œå¯†ç ï¼Œå’ŒæŒä¹…åŒ–æ•°æ®ä¸­çš„æ•°æ®è¿›è¡Œæ¯”å¯¹ï¼Œæ¯”å¯¹é€šè¿‡åï¼ŒæŠŠç™»å½•çŠ¶æ€ç”Ÿæˆsessionï¼ˆè¿™ä¸ªsessionæ˜¯æœ‰æ—¶æ•ˆçš„ï¼‰ã€‚
- å°†æœ‰æ—¶æ•ˆçš„sessionæ•°æ®å†™å…¥å†…å­˜æ•°æ®åº“
- å°†sessionä¸­çš„session_IDåœ¨å“åº”ä¸­è¿”å›ç»™æµè§ˆå™¨ï¼ŒSESSIOINè¿”å›çš„æ–¹å¼æ˜¯Set-Cookie
- æµè§ˆå™¨åœ¨å®ƒçš„Storageä¸­ä¿å­˜æ”¶åˆ°çš„Cookie
- æµè§ˆå™¨å‘èµ·çš„åç»­è¯·æ±‚ä¼šæºå¸¦è¿™ä¸ªCookieä¿¡æ¯
- æœåŠ¡å™¨æ”¶åˆ°æºå¸¦Cookieçš„ä¿¡æ¯åï¼Œä¼šåœ¨åç«¯è§£æCookieæºå¸¦çš„Session_IDï¼Œåˆ¤æ–­è¯¥ç”¨æˆ·æ˜¯å¦æ˜¯ç™»å½•çš„ï¼Œå¦‚æœåˆ¤æ–­æˆåŠŸï¼Œåˆ™æ‰§è¡Œè¯¥ç”¨æˆ·çš„ç›¸å…³ä¸šåŠ¡ï¼Œå¹¶å°†ç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚

| æ­¥éª¤                                    | å»ºè®®æˆ–è¡¥å……                                                   |
| --------------------------------------- | ------------------------------------------------------------ |
| 1. ç”¨æˆ·å‘é€ POST /login è¯·æ±‚            | å¯ä»¥å¸¦è¡¨å•æˆ– JSON æ ¼å¼ç™»å½•ä¿¡æ¯                               |
| 2. æœåŠ¡ç«¯è¯»å–ç”¨æˆ·åå¯†ç ï¼Œä¸æŒä¹…åŒ–åº“æ¯”å¯¹ | å®é™…ä¸Šå¯ä½¿ç”¨æ•°æ®åº“æˆ–è®¤è¯ä¸­å¿ƒï¼ˆå¦‚ LDAPï¼‰                      |
| 3. éªŒè¯é€šè¿‡ï¼Œç”Ÿæˆ sessionï¼ˆå«æœ‰æ•ˆæœŸï¼‰   | é€šå¸¸ `session = { user_id, expires_at, ... }`                |
| 4. å°† session å­˜å…¥â€œå†…å­˜æ•°æ®åº“â€          | é€šå¸¸æ˜¯ Redisï¼Œæˆ–è€…å†…å­˜ hashmapï¼ˆå¦‚ Java `HttpSession`ï¼‰      |
| 5. è¿”å› Set-Cookieï¼Œè®¾ç½® `session_id`   | ç¤ºä¾‹ï¼š`Set-Cookie: session=abc123; Path=/; HttpOnly; Secure` |
| 6. æµè§ˆå™¨æ¥æ”¶å¹¶ä¿å­˜ Cookie              | æµè§ˆå™¨è‡ªåŠ¨ä¿å­˜ï¼Œå¹¶æ ¹æ® Path/Domain æ§åˆ¶ä½•æ—¶å‘é€              |
| 7. åç»­è¯·æ±‚è‡ªåŠ¨å¸¦ä¸Š Cookie              | æµè§ˆå™¨è‡ªåŠ¨åŠ ä¸Š `Cookie: session=abc123`                      |
| 8. æœåŠ¡ç«¯è¯»å– Cookie å¹¶éªŒè¯ session     | æŸ¥ Redis åˆ¤æ–­ session æ˜¯å¦å­˜åœ¨ã€æ˜¯å¦è¿‡æœŸ                     |
| 9. æ‰§è¡Œä¸šåŠ¡å¹¶è¿”å›ç»“æœ                   | æ­¤æ—¶è¯´æ˜ç”¨æˆ·å·²è®¤è¯ï¼ŒæŒ‰æƒé™æ‰§è¡Œå¯¹åº”ä¸šåŠ¡                       |











## Webç«™ç‚¹ç¯å¢ƒéƒ¨ç½²



### å¸¸è§WebæœåŠ¡ä»‹ç»











# ç¬¬å››å¤©

## æ–‡ä»¶ç³»ç»Ÿ

**æ–‡ä»¶å†…éƒ¨çš„æ•°æ®åº”è¯¥æ€æ ·ç»„ç»‡èµ·æ¥**

æ— ç»“æ„æ–‡ä»¶ï¼ˆå¦‚æ–‡æœ¬æ–‡ä»¶ï¼‰- ç”±ä¸€äº›äºŒè¿›åˆ¶æˆ–å­—ç¬¦æµç»„æˆï¼Œåˆç§°ä¸ºâ€œæµå¼æ–‡ä»¶â€

æœ‰ç»“æ„æ–‡ä»¶ï¼ˆå¦‚æ•°æ®åº“è¡¨ï¼‰- ç”±ä¸€ç»„ç›¸ä¼¼çš„è®°å½•ç»„æˆï¼Œåˆç§°ä¸ºâ€œè®°å½•å¼æ–‡ä»¶â€

- å…¶ä¸­è®°å½•æ˜¯ä¸€ç»„ç›¸å…³æ•°æ®é¡¹(field)çš„é›†åˆï¼Œæ•°æ®é¡¹æ˜¯æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬å•ä½
- è®°å½•é—´å…·æœ‰ç›¸ä¼¼æ€§
- æ•°æ®é¡¹æ˜¯æ–‡ä»¶ç³»ç»Ÿæœ€åŸºæœ¬çš„æ•°æ®å•ä½
- ç›®å½•å…¶å®æ˜¯ä¸€ç§ç‰¹æ®Šçš„æœ‰ç»“æ„æ–‡ä»¶ï¼ˆç”±è®°å½•ç»„æˆ ï¼‰

### ç›®å½•

ç›®å½•å°±æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå…¶å†…å®¹æ˜¯ä¸€ä¸ªä¸ªâ€œç›®å½•é¡¹è®°å½•â€ï¼ˆdirectory entriesï¼‰ç»„æˆçš„ç»“æ„æ•°ç»„ï¼Œç”¨äºè¡¨ç¤ºâ€œæ–‡ä»¶å â†’ inodeå·â€çš„æ˜ å°„å…³ç³»ã€‚



#### ç›®å½•é¡¹ï¼ˆdirectory entryï¼‰çš„åŸºæœ¬ç»„æˆ

ä»¥ **ext2/ext3/ext4 æ–‡ä»¶ç³»ç»Ÿ**ä¸ºä¾‹ï¼Œæ¯ä¸ªç›®å½•é¡¹ï¼ˆ`struct ext4_dir_entry`ï¼‰ä¸€èˆ¬åŒ…å«ä»¥ä¸‹å­—æ®µï¼š

| å­—æ®µå      | è¯´æ˜                               |
| ----------- | ---------------------------------- |
| `inode`     | å¯¹åº”æ–‡ä»¶çš„ inode ç¼–å·ï¼ˆ`inum`ï¼‰    |
| `rec_len`   | å½“å‰ç›®å½•é¡¹å ç”¨çš„æ€»å­—èŠ‚æ•°ï¼ˆå«å¡«å……ï¼‰ |
| `name_len`  | æ–‡ä»¶åçš„é•¿åº¦                       |
| `file_type` | æ–‡ä»¶ç±»å‹ï¼ˆå¦‚æ™®é€šæ–‡ä»¶/ç›®å½•/é“¾æ¥ï¼‰   |
| `name`      | æ–‡ä»¶åå­—ç¬¦ä¸²ï¼ˆä¸å«ç»“æŸç¬¦ `\\0`ï¼‰   |



#### ç¤ºä¾‹ç»“æ„ä½“ï¼ˆext4ï¼‰

```C
struct ext4_dir_entry {
    __le32 inode;        // 4 bytes
    __le16 rec_len;      // 2 bytesï¼šå½“å‰ç›®å½•é¡¹æ€»é•¿åº¦
    __u8   name_len;     // 1 byteï¼šæ–‡ä»¶åé•¿åº¦
    __u8   file_type;    // 1 byteï¼šæ–‡ä»¶ç±»å‹ï¼ˆext4 ä¸“æœ‰ï¼‰
    char   name[];       // ä¸å®šé•¿ï¼šæ–‡ä»¶åï¼ˆä¸å« '\\0' ç»“å°¾ï¼‰
};
```

 **å­—æ®µè§£æè¯´æ˜ï¼š**

1. **`inode`ï¼ˆinumï¼‰**

- è¡¨ç¤ºè¯¥æ–‡ä»¶/ç›®å½•å¯¹åº”çš„ inode ç¼–å·
- æ“ä½œç³»ç»Ÿå¯ç”¨å®ƒè®¿é—®è¯¥æ–‡ä»¶çš„å…·ä½“å…ƒä¿¡æ¯

2. **`rec_len`ï¼ˆrecord lengthï¼‰**

- å½“å‰ç›®å½•é¡¹åœ¨ç›®å½•æ–‡ä»¶ä¸­å®é™…å æ®çš„æ€»å­—èŠ‚æ•°
- ç”±äºæ–‡ä»¶åé•¿åº¦å¯å˜ï¼Œä¸ºäº†ä¿æŒå¯¹é½ï¼Œrec_len é€šå¸¸ä¼š > å®é™…æ‰€éœ€ç©ºé—´ï¼ˆå†…å«å¡«å……ï¼‰

3. **`name_len`**

- å®é™…æ–‡ä»¶åçš„é•¿åº¦ï¼Œå•ä½æ˜¯å­—èŠ‚
- ä¸åŒ…æ‹¬ `\\0` ç»“å°¾å­—ç¬¦

4. **`file_type`ï¼ˆext4 ä¸“æœ‰ï¼Œext2/3 ä¸ä¸€å®šæœ‰ï¼‰**

- è¡¨ç¤ºè¯¥ç›®å½•é¡¹æ˜¯æ™®é€šæ–‡ä»¶ã€ç›®å½•ã€ç¬¦å·é“¾æ¥ç­‰
- ç±»å‹ä»£ç ä¾‹å¦‚ï¼š
  - `1`ï¼šæ™®é€šæ–‡ä»¶
  - `2`ï¼šç›®å½•
  - `7`ï¼šsocketï¼ˆUnix åŸŸï¼‰

5. **`name[]`**

- å­—ç¬¦ä¸²å½¢å¼çš„æ–‡ä»¶å
- ç´§è·Ÿåœ¨ç»“æ„ä½“åé¢ï¼Œ**å˜é•¿å­—æ®µ**



#### ç¤ºä¾‹ï¼šç›®å½•ç»“æ„ä¸­çš„è®°å½•å†…å®¹ï¼ˆå‡è®¾æ˜¯ ext4ï¼‰

ä¸€ä¸ªç›®å½•æ–‡ä»¶å†…å®¹ç¤ºä¾‹ï¼ˆåå…­è¿›åˆ¶ï¼‰å¯è§£æå‡ºå¦‚ä¸‹å†…å®¹ï¼š

| inode | rec_len | name_len | file_type | name  |
| ----- | ------- | -------- | --------- | ----- |
| 12    | 12      | 1        | 2         | .     |
| 2     | 12      | 2        | 2         | ..    |
| 1002  | 24      | 5        | 1         | readm |

ğŸ‘‰ è¯´æ˜ï¼š

- `.` è¡¨ç¤ºå½“å‰ç›®å½•
- `..` è¡¨ç¤ºä¸Šçº§ç›®å½•
- `readm` æ˜¯æ™®é€šæ–‡ä»¶ï¼ˆå®é™…æ˜¯ `readme`ï¼Œå› å¯¹é½å¯èƒ½è¢«æˆªæ–­æ˜¾ç¤ºï¼‰



#### å¦‚ä½•æ‰‹åŠ¨ç”¨ `hexdump` åˆ†æ ext4 çš„ç›®å½•ç»“æ„

**æ•´ä½“æµç¨‹æ¦‚è§ˆ**

1. æ‰¾åˆ°ç›®æ ‡ç›®å½•å¯¹åº”çš„ inodeï¼ˆä½¿ç”¨ `debugfs`ï¼‰
2. è·å–è¯¥ inode æŒ‡å‘çš„æ•°æ®å—åœ°å€
3. ä»è®¾å¤‡ä¸­æå–å¯¹åº”æ•°æ®å—å†…å®¹
4. ç”¨ `hexdump` æŸ¥çœ‹ï¼Œå¹¶æ‰‹åŠ¨è§£æç›®å½•é¡¹ç»“æ„



##### å®éªŒæ­¥éª¤è¯¦è§£

> å‡è®¾æˆ‘ä»¬çš„æŒ‚è½½è®¾å¤‡æ˜¯ `/dev/vda1`ï¼ŒæŒ‚è½½ç‚¹ä¸º `/`ï¼Œè¦åˆ†æçš„ç›®å½•ä¸º `/home`

**ç¬¬ 1 æ­¥ï¼šè¿›å…¥ debugfs æŸ¥çœ‹ç›®æ ‡ç›®å½• inode ä¿¡æ¯**

```bash
debugfs /dev/vda1
```

è¿›å…¥äº¤äº’åï¼š

```bash
debugfs: stat /home
```

```bash
Inode: 1518   Type: directory    Mode:  0755   Flags: 0x80000
Generation: 2375206807    Version: 0x00000000:00000002
User:     0   Group:     0   Project:     0   Size: 4096
File ACL: 0
Links: 3   Blockcount: 8
Fragment:  Address: 0    Number: 0    Size: 0
 ctime: 0x64be8b93:0a7d8c00 -- Mon Jul 24 14:32:51 2023
 atime: 0x683ca913:e6065518 -- Sun Jun  1 19:25:07 2025
 mtime: 0x64be8b93:0a7d8c00 -- Mon Jul 24 14:32:51 2023
crtime: 0x64ae0bd7:e5c38f74 -- Wed Jul 12 02:11:35 2023
Size of extra inode fields: 32
Inode checksum: 0xeeec52cf
EXTENTS:
(0):16735
```

**è¯¦ç»†è§£é‡Šï¼š**

ğŸ“Œ `EXTENTS:` æ˜¯ ext4 æ–‡ä»¶ç³»ç»Ÿçš„å—å¯»å€æ–¹å¼ä¹‹ä¸€

- ext2/ext3 ä½¿ç”¨ã€Œç›´æ¥å— + é—´æ¥å—ã€æ–¹å¼ï¼ˆæœ€å¤š 15 ä¸ªæŒ‡é’ˆï¼‰
- ext4 é»˜è®¤ä½¿ç”¨ **Extent treeï¼ˆæ‰©å±•æ ‘ï¼‰**ï¼Œæ›´é€‚åˆå¤§æ–‡ä»¶ã€é«˜è¿ç»­æ€§

ğŸ“Œ `(0):16735` çš„å«ä¹‰æ˜¯ï¼š

- `0` è¡¨ç¤ºè¿™æ˜¯ç¬¬ 0 ä¸ª extentï¼ˆèµ·å§‹åç§»å—å·ä¸º 0ï¼‰
- `16735` æ˜¯è¯¥ extent åœ¨ç‰©ç†è®¾å¤‡ä¸­çš„ç¬¬ä¸€ä¸ªå®é™… **ç‰©ç†å—å·**



**ç¬¬ 2 æ­¥ï¼šæ ¹æ®ä¸Šæ–‡çš„è¾“å‡ºï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯**

```ABAP
è¿™æ˜¯ä¸€ä¸ª ext4 æ–‡ä»¶ç³»ç»Ÿ
è¯¥ inode ä½¿ç”¨ Extentï¼ˆæ‰©å±•å—æ˜ å°„ï¼‰æ ¼å¼
ç¬¬ä¸€ä¸ªæ•°æ®å—å·æ˜¯ 16735

å­—èŠ‚åç§» = 16735 Ã— 4096 = 68575232 å­—èŠ‚
```



**ç¬¬ 3 æ­¥ï¼šä»è®¾å¤‡ä¸­æå–è¿™ä¸ªæ•°æ®å—**

```bash
dd if=/dev/vda1 bs=4096 skip=16735 count=1 of=dirblock.bin
```



**ç¬¬ 4 æ­¥ï¼šä½¿ç”¨ hexdump åˆ†æç›®å½•å—å†…å®¹**

```bash
hexdump -C dirblock.bin | less
```

```bash
00000000  ee 05 00 00 0c 00 01 02  2e 00 00 00 02 00 00 00  |................|
00000010  0c 00 02 02 2e 2e 00 00  01 f0 03 00 dc 0f 06 02  |................|
00000020  75 62 75 6e 74 75 00 00  00 00 00 00 00 00 00 00  |ubuntu..........|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
00000ff0  00 00 00 00 00 00 00 00  0c 00 00 de 14 63 1c 37  |.............c.7|
00001000
```



##### æ‰‹åŠ¨è§£æè§„åˆ™ï¼ˆåŸºäº `ext4_dir_entry`ï¼‰

æ¯ä¸ªç›®å½•é¡¹æ ¼å¼å¦‚ä¸‹ï¼š

| å­—èŠ‚åç§» | å­—æ®µå    | é•¿åº¦   | å«ä¹‰                             |
| -------- | --------- | ------ | -------------------------------- |
| 0        | inode     | 4B     | æ–‡ä»¶/ç›®å½•çš„ inode ç¼–å·           |
| 4        | rec_len   | 2B     | å½“å‰ç›®å½•é¡¹å ç”¨çš„æ€»é•¿åº¦           |
| 6        | name_len  | 1B     | æ–‡ä»¶åé•¿åº¦ï¼ˆä¸å«ç»“å°¾ï¼‰           |
| 7        | file_type | 1B     | æ–‡ä»¶ç±»å‹ï¼ˆ1: æ™®é€šæ–‡ä»¶, 2: ç›®å½•ï¼‰ |
| 8        | name      | N å­—èŠ‚ | æ–‡ä»¶åï¼ˆå˜é•¿ï¼‰                   |



**ç¤ºä¾‹è§£æ**

```bash
 01 f0 03 00 dc 0f 06 02  # 
 75 62 75 6e 74 75        # Ubuntu(æ–‡ä»¶å)
```

é€é¡¹è§£é‡Šï¼š

- `01 f0 03 00` â†’ `inode = 0x0003f001 = 258,049`
- `dc 0f` â†’ `rec_len = 0x0fdc = 4060`
- `06` â†’ name_len = 6ï¼ˆUbuntuï¼Œ6ä¸ªå­—ç¬¦ï¼‰
- `02` â†’ file_type = 2 ï¼ˆç›®å½•ï¼‰
- `2e` â†’ æ–‡ä»¶å = "."ï¼ˆASCIIï¼‰

```bash
[root@devops-custom ~]# ll -i /home
æ€»è®¡ 12
  1518 drwxr-xr-x  3 root   root   4096  7æœˆ 24  2023 ./
     2 drwxr-xr-x 19 root   root   4096  5æœˆ 26 08:53 ../
258049 drwxr-x--- 17 ubuntu ubuntu 4096  5æœˆ  4 12:53 ubuntu/
```



### ä»€ä¹ˆæ˜¯ Extentsï¼Ÿ

#### ä½¿ç”¨è€…ï¼šext4ã€xfsã€btrfs ç­‰ç°ä»£æ–‡ä»¶ç³»ç»Ÿ

âœ… å®šä¹‰ï¼š

> **Extent æ˜¯ä¸€ä¸ªç»“æ„ï¼šè¡¨ç¤ºâ€œæŸä¸ªé€»è¾‘å—èŒƒå›´ â†’ å¯¹åº”çš„ç‰©ç†å—èŒƒå›´â€æ˜ å°„ã€‚**
>  ç®€åŒ–å­˜å‚¨ï¼š**ä¸å­˜å‚¨æ¯ä¸ªå—åœ°å€ï¼Œè€Œæ˜¯å­˜ä¸€æ®µè¿ç»­å—çš„èµ·å§‹åœ°å€å’Œé•¿åº¦ã€‚**



Extent ç»“æ„ï¼ˆç®€åŒ–ç¤ºæ„ï¼‰

```C
struct ext4_extent {
  __le32 ee_block;      // æ–‡ä»¶ä¸­çš„èµ·å§‹é€»è¾‘å—å·
  __le16 ee_len;        // è¿ç»­å—æ•°é‡
  __le16 ee_start_hi;   // èµ·å§‹ç‰©ç†å—é«˜16ä½
  __le32 ee_start_lo;   // èµ·å§‹ç‰©ç†å—ä½32ä½
};
```

ä¸€ä¸ª extent å°±è¡¨ç¤ºï¼š

> â€œä»æ–‡ä»¶çš„ç¬¬ N ä¸ªå—å¼€å§‹ï¼Œæœ‰ X ä¸ªè¿ç»­å—ï¼Œåœ¨ç£ç›˜ä¸Šçš„èµ·å§‹ç‰©ç†å—å·æ˜¯ Yã€‚â€



**ä¸¾ä¾‹ï¼š**

å¦‚æœä¸€ä¸ªæ–‡ä»¶çš„å‰ 1 MB æ˜¯è¿ç»­çš„ï¼Œå®ƒåªéœ€è¦ä¸€ä¸ª extentï¼š

```C
(é€»è¾‘å—)0 â†’ 255  â†’ (ç‰©ç†å—) 5000 â†’ 5255
```

åªéœ€ä¸€æ¡è®°å½•ï¼Œè€Œæ—§å¼é—´æ¥å—éœ€è¦å†™ 256 ä¸ªæŒ‡é’ˆï¼



#### Extents ä¸ é—´æ¥ç´¢å¼•å—çš„åŒºåˆ«æ€»ç»“

| å¯¹æ¯”é¡¹           | Extents                      | é—´æ¥å—ç´¢å¼•               |
| ---------------- | ---------------------------- | ------------------------ |
| ä½¿ç”¨è€…           | ext4ï¼ˆé»˜è®¤ï¼‰ã€xfsã€btrfs     | ext2ã€ext3               |
| æ•°æ®ç»“æ„         | `é€»è¾‘èµ·ç‚¹ + é•¿åº¦ + ç‰©ç†èµ·ç‚¹` | ä¸€ä¸ªä¸ªæŒ‡é’ˆæ•°ç»„           |
| è®¿é—®æ•ˆç‡         | âœ… é«˜ï¼ŒæŸ¥ä¸€æ¬¡å°±æ˜¯ä¸€æ®µ         | âŒ æŸ¥å¤šæ¬¡ï¼ŒæŒ‡é’ˆè·³è½¬å¤š     |
| å¯¹è¿ç»­æ–‡ä»¶çš„æ•ˆç‡ | âœ… éå¸¸é«˜                     | âŒ æ•ˆç‡ä½ï¼Œæµªè´¹ç©ºé—´       |
| ç©ºé—´ä½¿ç”¨         | âœ… ç´§å‡‘ï¼Œä»…éœ€å°‘é‡å…ƒæ•°æ®       | âŒ å¤šçº§æŒ‡é’ˆå ç”¨å¤§é‡ç´¢å¼•å— |
| æ–‡ä»¶ç¢ç‰‡å¤„ç†     | âœ… å‡å°‘ç¢ç‰‡                   | âŒ å®¹æ˜“äº§ç”Ÿç¢ç‰‡           |
| æ”¯æŒæœ€å¤§æ–‡ä»¶å¤§å° | æ›´å¤§ï¼ˆæ”¯æŒ extent treeï¼‰     | è¾ƒå°ï¼Œå—é™äºæŒ‡é’ˆå±‚æ•°     |
| å…ƒæ•°æ®ç»´æŠ¤å¤æ‚åº¦ | è¾ƒå¤æ‚ï¼ˆæ ‘ç»“æ„ï¼‰             | ç®€å•ï¼ˆçº¿æ€§ç»“æ„ï¼‰         |



#### å››ã€Extent Treeï¼ˆæ‰©å±•æ ‘ï¼‰

å½“ä¸€ä¸ªæ–‡ä»¶åŒ…å«å¤šä¸ª extentï¼ˆä¸è¿ç»­å—ï¼‰æ—¶ï¼Œext4 ä¼šå°†è¿™äº› extents ç»„ç»‡ä¸ºä¸€æ£µ B+ æ ‘ï¼š

- inode ä¸­å­˜çš„æ˜¯ **Extent root**
- æ¯ä¸ªä¸­é—´èŠ‚ç‚¹ç§°ä¸º `index node`
- å¶å­èŠ‚ç‚¹æ˜¯ extent entry
- æ‰€ä»¥è¯»å–æ–‡ä»¶æ—¶ï¼šå…ˆæŸ¥æ ¹ â†’ ä¸­é—´ â†’ å¶ â†’ æ•°æ®å—

ğŸ“Œ å°±åƒ ext3 çš„ä¸‰çº§é—´æ¥å—ï¼Œä½†ä½¿ç”¨çš„æ˜¯ **B+ æ ‘ç»“æ„ï¼Œæ›´çµæ´»ã€æ•ˆç‡é«˜**



#### äº”ã€ä½ åœ¨ debugfs çœ‹åˆ°çš„ `(0):16735` æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

```C
EXTENTS:
(0):16735
```

è¡¨ç¤ºï¼š

- è¿™æ˜¯ extent æ ‘ä¸­çš„ç¬¬ 0 ä¸ªå¶èŠ‚ç‚¹
- å®ƒèµ·å§‹äºæ–‡ä»¶é€»è¾‘å—å· 0ï¼Œå¯¹åº”çš„ç£ç›˜ç‰©ç†å—å·ä¸º 16735
- å®ƒè¿˜åŒ…å«å¤šå°‘ä¸ªè¿ç»­å—ï¼Ÿä½ å¯ä»¥é€šè¿‡ `debugfs` çš„ `stat` çœ‹ `Blockcount`

> **é—´æ¥å—ç´¢å¼•æ˜¯â€œä¸€ä¸ªå—ä¸€ä¸ªæŒ‡é’ˆâ€ï¼Œè€Œ Extent æ˜¯â€œä¸€æ¡è®°å½•æ˜ å°„ä¸€æ•´æ®µå—â€ã€‚**
>  Ext4 ä½¿ç”¨ Extent æ˜¯ä¸ºäº†æ›´å¿«ã€æ›´èŠ‚çœã€æ›´é€‚åˆå¤§æ–‡ä»¶ï¼Œæ˜¯ç°ä»£æ–‡ä»¶ç³»ç»Ÿæ¼”è¿›çš„é‡è¦æ ‡å¿—ã€‚









### æ“ä½œç³»ç»Ÿä¸­é€šè¿‡æ–‡ä»¶è®¿é—®æ•°æ®çš„è¿‡ç¨‹(ç®€å•ç‰ˆ)

**å®é™…æµç¨‹å¦‚ä¸‹ï¼š**

1. **inode â†’ å—å·ï¼ˆç£ç›˜å—å·ï¼‰**
2. **æ–‡ä»¶ç³»ç»Ÿå±‚å°†å—å· â†’ é€»è¾‘æ‰‡åŒºå·**
3. **I/Oè°ƒåº¦å±‚è½¬åŒ–ä¸ºç‰©ç†è®¾å¤‡çš„æ‰‡åŒºè®¿é—®è¯·æ±‚**
4. **ç¡¬ç›˜æ§åˆ¶å™¨ï¼ˆå¦‚SATA/NVMeï¼‰æ”¶åˆ°è¯·æ±‚ â†’ è®¿é—®ç£ç›˜**

```css
[ inode ]
   |
   |â€”> ç›´æ¥å— â†’ [ ç‰©ç†å—åœ°å€(é€»è¾‘å—å·) ]
   |
   |â€”> é—´æ¥å— â†’ [ å—å·æ•°ç»„ ] â†’ [ å¤šä¸ªç‰©ç†å—åœ°å€ ]
                         â†“
                æ–‡ä»¶ç³»ç»Ÿè®¡ç®—åç§»ï¼ˆç‰©ç†å—å·->é€»è¾‘æ‰‡åŒºï¼‰
                         â†“
              è®¾å¤‡é©±åŠ¨æ¢ç®—ä¸ºæ‰‡åŒºåœ°å€ï¼ˆé€»è¾‘æ‰‡åŒº-> ç‰©ç†æ‰‡åŒºï¼‰
                         â†“
            ç¡¬ç›˜æ§åˆ¶å™¨è¯»å–ç£ç›˜æ‰‡åŒºçš„æ•°æ®
```

```ABAP
æ–‡ä»¶é€šè¿‡ inode ä¸­çš„æ˜ å°„ç»“æ„ï¼ˆå¦‚ extents æˆ–å—æŒ‡é’ˆï¼‰ï¼Œå°†è¿ç»­çš„é€»è¾‘å—å·æ˜ å°„ä¸ºä¸è¿ç»­çš„ç£ç›˜å—å·ã€‚æ–‡ä»¶ç³»ç»Ÿæ ¹æ®ç£ç›˜å—å·è®¡ç®—å‡ºå¯¹åº”çš„é€»è¾‘æ‰‡åŒºå·ï¼Œç”±å†…æ ¸å—è®¾å¤‡é©±åŠ¨å‘å‡º I/O è¯·æ±‚ï¼Œå†ç”±ç¡¬ç›˜æ§åˆ¶å™¨ï¼ˆå¦‚ SATAã€NVMeï¼‰å°†é€»è¾‘æ‰‡åŒºè½¬æ¢ä¸ºå®é™…ç‰©ç†æ‰‡åŒºæˆ– Flash é¡µé¢ï¼Œæœ€åè®¿é—®ç£ç›˜å®Œæˆæ•°æ®è¯»å–ã€‚
```





### è®¿é—®ä¸€ä¸ªæ–‡ä»¶æ—¶çš„å®Œæ•´è¿‡ç¨‹ï¼ˆä»¥ ext4 ä¸ºä¾‹ï¼‰

#### 1. **è·¯å¾„è§£æ â†’ æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶çš„ inode**

- **ä»æ ¹ç›®å½• `/` å¼€å§‹**ï¼Œé€å±‚è§£æè·¯å¾„ï¼š

  ```bash
  /home/zhangyifeng/secret.txt
  ```

- æ¯ä¸€å±‚ç›®å½•é¡¹ï¼ˆå¦‚ `home`ï¼‰æ˜¯ä¸€ä¸ª**ç›®å½•æ–‡ä»¶**ï¼Œå…¶å†…å®¹æ˜¯è‹¥å¹²ä¸ªç›®å½•é¡¹è®°å½•ï¼ˆå«å­æ–‡ä»¶/ç›®å½•çš„ inode ç¼–å· + åå­—ï¼‰ã€‚

- ç³»ç»Ÿä¼šï¼š

  - æ‰“å¼€ `/` å¯¹åº”çš„ inodeï¼Œè¯»å–å…¶æ•°æ®å—ï¼ˆå«ç›®å½•é¡¹ï¼‰
  - æ‰¾åˆ°åä¸º `home` çš„ç›®å½•é¡¹ï¼Œæå–å…¶ inode ç¼–å·
  - æ‰“å¼€ `home` çš„ inodeï¼Œé‡å¤ä¸Šè¿°æ“ä½œï¼Œç›´åˆ° `secret.txt` çš„ inode è¢«æ‰¾åˆ°

> ğŸ” è¿™ä¸ªè¿‡ç¨‹ç”¨åˆ°äº† `dentry` å’Œ `inode` ç¼“å­˜ï¼ˆslab æœºåˆ¶æå‡é€Ÿåº¦ï¼‰



#### 2. **è®¿é—®ç›®æ ‡æ–‡ä»¶ inode â†’ è·å–é€»è¾‘å—æ˜ å°„**

- æ‰¾åˆ° `secret.txt` çš„ inode åï¼Œè¯»å–å…¶ä¸­çš„ï¼š
  - æ–‡ä»¶å¤§å°ã€ç±»å‹ã€æƒé™ç­‰å…ƒæ•°æ®
  - æŒ‡å‘å†…å®¹æ•°æ®çš„å—æŒ‡é’ˆï¼ˆç›´æ¥å— / é—´æ¥å— / extentsï¼‰



#### 3. **æ–‡ä»¶ç³»ç»Ÿå±‚ï¼šé€»è¾‘å—å· â†’ ç£ç›˜å—å· â†’ é€»è¾‘æ‰‡åŒºå·**

- ä» inode å¾—åˆ°çš„â€œå—æŒ‡é’ˆâ€å…¶å®æ˜¯**ç£ç›˜å—å·**
- å°†ç£ç›˜å—å· Ã— å—å¤§å°ï¼ˆå¦‚ 4KBï¼‰ â†’ æ–‡ä»¶å†…å®¹åœ¨ç£ç›˜ä¸Šçš„åç§»åœ°å€ï¼ˆé€»è¾‘æ‰‡åŒºå·ï¼‰



#### 4. **å†…æ ¸å—è®¾å¤‡å±‚ï¼šæ„é€  bio è¯·æ±‚ï¼Œäº¤ç»™é©±åŠ¨**

- æ„é€  bio â†’ å˜æˆ I/O è¯·æ±‚ï¼ˆå¯èƒ½åˆå¹¶å¤šä¸ªï¼‰
- ä¼ é€’ç»™è®¾å¤‡é©±åŠ¨å±‚ï¼ˆå¦‚ `sd.c`ã€`nvme.c`ï¼‰



####  5. **ç¡¬ç›˜æ§åˆ¶å™¨ï¼šé€»è¾‘æ‰‡åŒº â†’ ç‰©ç†æ‰‡åŒº**

- æ§åˆ¶å™¨ï¼ˆSATA/NVMeï¼‰æ¥æ”¶åˆ°è¯·æ±‚åï¼š
  - å¦‚æœæ˜¯ HDDï¼šç›´æ¥è·³è½¬åˆ°æ‰‡åŒºè¯»å–
  - å¦‚æœæ˜¯ SSDï¼šFTL æœºåˆ¶æ˜ å°„åˆ° NAND Flash ä¸­çš„é¡µå—



#### 6. **è¿”å›æ•°æ®ç»™ç”¨æˆ·æ€ç¨‹åº**

- æ•°æ®å…ˆè¿›å…¥ **é¡µç¼“å­˜ï¼ˆPage Cacheï¼‰**
- ç„¶åé€šè¿‡ `read()` ç³»ç»Ÿè°ƒç”¨å°†æ•°æ®æ‹·è´ç»™ç”¨æˆ·ç©ºé—´







## buff/cache

### buff/cache çš„ç»„æˆï¼š

| ç±»åˆ«               | æè¿°                            | æ˜¯å¦åæ˜ åœ¨ meminfo ä¸­ï¼Ÿ         |
| ------------------ | ------------------------------- | ------------------------------- |
| âœ… **Page Cache**   | ç¼“å­˜ç£ç›˜æ–‡ä»¶å†…å®¹ï¼ˆæœ€ä¸»è¦éƒ¨åˆ†ï¼‰  | âŒ æ²¡æœ‰å•ç‹¬åˆ—å‡º                  |
| âœ… **Slab Cache**   | ç¼“å­˜å†…æ ¸ç»“æ„ä½“ï¼ˆinodeã€dentryï¼‰ | âœ… `SReclaimable` + `SUnreclaim` |
| âœ… **Buffer Cache** | å—è®¾å¤‡å…ƒæ•°æ®ç¼“å­˜                | âœ… `Buffers` å­—æ®µ                |





### æŸ¥çœ‹å®ƒä»¬çš„ç‹¬ç«‹å€¼ï¼ˆæ¥è‡ª /proc/meminfoï¼‰ï¼š

```bash
grep -E 'Buffers|Cached|Slab' /proc/meminfo
```

ä½ ä¼šçœ‹åˆ°ç±»ä¼¼ï¼š

```bash
Buffers:          20000 kB   # å—è®¾å¤‡ buffer cache
Cached:          300000 kB   # page cache
Slab:             97972 kB   # = SReclaimable + SUnreclaim
```

ç„¶åï¼š

```bash
buff/cache â‰ˆ Buffers + Cached + Slab
```

> **`Buffers` è¡¨ç¤ºå—è®¾å¤‡çš„å…ƒæ•°æ®ç¼“å­˜**ï¼Œæ¯”å¦‚ superblockã€inode bitmapã€block bitmapã€ç›®å½•é¡¹ç­‰ï¼Œè¿™äº›å±äºæ–‡ä»¶ç³»ç»Ÿçš„ç»“æ„å…ƒä¿¡æ¯ï¼Œä¸æ˜¯ç”¨æˆ·æ–‡ä»¶æ•°æ®æœ¬èº«ã€‚





### Slab

#### ä»€ä¹ˆæ˜¯ Slabï¼Ÿï¼ˆæ ¸å¿ƒæ¦‚å¿µï¼‰

**å®šä¹‰ï¼š**

**slab æ˜¯ç¼“å­˜æŸ¥æ‰¾æ–‡ä»¶æ‰€éœ€çš„ç»“æ„ä½“æ•°æ®ï¼ˆå¦‚ dentryã€inode ç­‰ï¼‰æ¥æå‡æ–‡ä»¶æŸ¥æ‰¾æ•ˆç‡**

> **Slab æ˜¯ Linux å†…æ ¸ç”¨äºç®¡ç†å†…å­˜å¯¹è±¡åˆ†é…çš„ä¸€ç§é«˜æ•ˆç¼“å­˜æœºåˆ¶ï¼Œ**
>  ä¸“é—¨ç”¨äºé‡å¤åˆ†é…/é‡Šæ”¾ç›¸åŒå¤§å°å’Œç»“æ„çš„å†…æ ¸å¯¹è±¡ã€‚

**ä¸¾ä¾‹ï¼š**

- `dentry`ï¼ˆç›®å½•é¡¹ç¼“å­˜ï¼‰
- `inode`ï¼ˆæ–‡ä»¶ inode ç¼“å­˜ï¼‰
- `vm_area_struct`ï¼ˆè¿›ç¨‹è™šæ‹Ÿå†…å­˜æ˜ å°„ï¼‰
- `ext4_inode_cache`ï¼ˆæ–‡ä»¶ç³»ç»Ÿä¸­çš„ inode ç¼“å­˜ï¼‰



#### Slabä½œç”¨çš„ä¸¾ä¾‹è¯´æ˜

```bash
ls /etc/
```

**è¿™ä¸ªå‘½ä»¤åœ¨èƒŒåä¼šï¼š**

1. æŸ¥ / â†’ æŸ¥æ‰¾ /etc çš„ dentry
2. å¦‚æœå·²ç»ç¼“å­˜ï¼ˆåœ¨ slab çš„ dentry_cache ä¸­ï¼‰ï¼Œç›´æ¥è¿”å›
3. ç„¶åè¯»å– /etc çš„ inodeï¼ˆä» inode_cache slabï¼‰
4. å±•ç¤ºå†…å®¹ï¼Œæ— éœ€å†æ¬¡ä»ç£ç›˜è¯»å–å…ƒä¿¡æ¯

â¡ï¸ **å¦‚æœè¿™äº›ç¼“å­˜éƒ½ä¸åœ¨ slab ä¸­ï¼Œå°±ä¼šï¼š**

- æŸ¥ç£ç›˜ inode è¡¨
- æŸ¥ç£ç›˜ç›®å½•é¡¹è¡¨
- å¢åŠ è®¿é—®å»¶è¿Ÿ



#### åˆ¤æ–­å“ªäº› slab å¯æ¸…ç†ï¼Ÿ

ä½ å¯ä»¥æ‰§è¡Œï¼š

```bash
grep -A 3 "slab_reclaimable" /proc/meminfo
```

- `SReclaimable`ï¼šå¯ä»¥å›æ”¶çš„ slabï¼ˆå¦‚ dentry/inodeï¼‰
- `SUnreclaim`ï¼šä¸å¯å›æ”¶ï¼ˆæ¯”å¦‚ anon_vmaã€vm_structï¼‰



#### å…³äºSlabç¼“å­˜çš„å®éªŒ

```bash
# æ¸…ç©ºæœªåˆ©ç”¨çš„slabç¼“å­˜
[root@devops-custom ~]# echo 3 > /proc/sys/vm/drop_caches

# æŸ¥çœ‹
[root@devops-custom ~]# grep -E 'dentry_cache|inode_cache' /proc/slabinfo | awk '{printf "  %-20s objs=%-10s size=%s\n", $1, $2, $8}'
  mqueue_inode_cache   objs=17         size=tunables
  ecryptfs_inode_cache objs=0          size=tunables
  fat_inode_cache      objs=21         size=tunables
  squashfs_inode_cache objs=622        size=tunables
  ext4_inode_cache     objs=1216       size=tunables       # è§‚å¯Ÿè¿™ä¸ªå€¼
  hugetlbfs_inode_cache objs=24         size=tunables
  sock_inode_cache     objs=855        size=tunables
  proc_inode_cache     objs=482        size=tunables
  shmem_inode_cache    objs=2282       size=tunables
  inode_cache          objs=16375      size=tunables
  
  
# è®¿é—®/bin
[root@devops-custom ~]# ls -l /bin/ > /dev/null

# å†æ¬¡æŸ¥çœ‹
[root@devops-custom ~]# grep -E 'dentry_cache|inode_cache' /proc/slabinfo | awk '{printf "  %-20s objs=%-10s size=%s\n", $1, $2, $8}'
  mqueue_inode_cache   objs=17         size=tunables
  ecryptfs_inode_cache objs=0          size=tunables
  fat_inode_cache      objs=21         size=tunables
  squashfs_inode_cache objs=622        size=tunables
  ext4_inode_cache     objs=2883       size=tunables    # æ˜æ˜¾å˜å¤šï¼Œå¤šäº†2883-1216=1667
  hugetlbfs_inode_cache objs=24         size=tunables
  sock_inode_cache     objs=855        size=tunables
  proc_inode_cache     objs=482        size=tunables
  shmem_inode_cache    objs=2282       size=tunables
  inode_cache          objs=16375      size=tunables
  
```









### **è¯»ç¼“å­˜ï¼ˆpage cacheï¼‰** ä¸ **å†™ç¼“å†²ï¼ˆwrite-back bufferï¼‰**

#### **è¯»æ“ä½œä¸ºä½•è¦è¿›å…¥ç¼“å­˜ï¼ˆPage Cacheï¼‰ï¼Ÿ**

> ä¸ºäº† **é¿å…é¢‘ç¹ç£ç›˜è®¿é—®ã€æé«˜è¯»å–æ•ˆç‡**ï¼Œå†…æ ¸ä¼šæŠŠ**è¯»è¿‡çš„æ•°æ®é¡µ**ç¼“å­˜è¿›å†…å­˜ï¼ˆPage Cacheï¼‰ã€‚ä¸‹æ¬¡è®¿é—®æ—¶ç›´æ¥ä»å†…å­˜è¯»ï¼Œé€Ÿåº¦å¿«æ•°ç™¾å€ã€‚

- è¿™éƒ¨åˆ†æ•°æ®ç”± `/proc/meminfo` ä¸­çš„ `Cached:` å­—æ®µç»Ÿè®¡
- å±äº **åªè¯»é¡µç¼“å­˜ï¼ˆclean pagesï¼‰**ï¼Œå¯ä»¥éšæ—¶è¢«å›æ”¶



#### **å†™æ“ä½œä¸ºä½•å…ˆè¿›å…¥å†…å­˜ç¼“å†²åŒºï¼Ÿ**

> ä¸ºäº† **é¿å…é¢‘ç¹ I/O ç³»ç»Ÿè°ƒç”¨ã€å‡å°‘ç£ç›˜å†™å…¥æ¬¡æ•°ã€æé«˜ååé‡**ï¼Œå†™æ“ä½œä¸æ˜¯ç›´æ¥è½ç›˜ï¼Œè€Œæ˜¯è¿›å…¥ Page Cacheï¼Œå¹¶æ ‡è®°ä¸º dirtyï¼ˆè„é¡µï¼‰

- è¿™äº›å†™å…¥æ•°æ®æš‚å­˜åœ¨ç¼“å­˜ä¸­
- åç»­ç”±å†…æ ¸çš„ **å†™å›çº¿ç¨‹**ï¼ˆ`pdflush`/`kupdate`/`kswapd`ï¼‰æ‰¹é‡è½ç›˜
- å†™å…¥æ—¶ä½ çœ‹åˆ°çš„ â€œç¼“å­˜è¡Œä¸ºâ€ä¹Ÿè¢«è®°å½•ä¸º `Cached` å­—æ®µï¼ˆä½†å®ƒä»¬æ˜¯ **dirty cache**ï¼‰





è¯»å†™ä¸¤ç§æ•°æ®ç¼“å­˜åœ¨ç¼“å­˜åŒº**éƒ½ç®—åœ¨ `/proc/meminfo` ä¸­çš„ `Cached:` é‡Œï¼Œä½†ç±»å‹ä¸åŒ**ï¼š

| æ“ä½œç±»å‹ | ç¼“å­˜ç±»å‹         | æ˜¯å¦ç®—è¿› Cached | ç‰¹ç‚¹                   |
| -------- | ---------------- | --------------- | ---------------------- |
| è¯»æ–‡ä»¶   | Page Cache       | âœ… æ˜¯            | å¹²å‡€é¡µï¼Œå¯ç›´æ¥å›æ”¶     |
| å†™æ–‡ä»¶   | Dirty Page Cache | âœ… æ˜¯            | è„é¡µï¼Œä¸è½ç›˜å‰ä¸å¯å›æ”¶ |



#### æ€ä¹ˆçŸ¥é“ `Cached` ä¸­åŒ…å«äº†å¤šå°‘è„é¡µï¼Ÿ

æŸ¥çœ‹ `/proc/meminfo` ä¸­çš„ä»¥ä¸‹å­—æ®µï¼š

```bash
grep -E 'Cached|Dirty|Writeback' /proc/meminfo
```

| å­—æ®µ        | å«ä¹‰                                 |
| ----------- | ------------------------------------ |
| `Cached`    | æ‰€æœ‰é¡µç¼“å­˜æ€»é‡ï¼ˆåŒ…æ‹¬ clean + dirtyï¼‰ |
| `Dirty`     | æ­£åœ¨ç­‰å¾…è½ç›˜çš„è„é¡µ                   |
| `Writeback` | æ­£åœ¨è¢«å†™å…¥ç£ç›˜çš„è„é¡µ                 |

ä½ ä¼šå‘ç°ï¼š

```bash
Cached:    400000 kB
Dirty:      20000 kB
Writeback:   5000 kB
```

â¡ï¸ è¯´æ˜ `Cached` ä¸­çš„ **20000 + 5000 = 25000 kB æ˜¯è„é¡µå†™ç¼“å­˜**ï¼Œå…¶ä»–çš„æ˜¯æ­£å¸¸è¯»ç¼“å­˜ã€‚



### free -h ä¸­å„æŒ‡æ ‡çš„å…³ç³»

```ABAP
otal = used + free + buff/cache âœ…
available â‰ˆ free + å¯å›æ”¶çš„ buff/cache éƒ¨åˆ† âœ…
```







## å®éªŒ

### å®éªŒ1ï¼šLinux æ–‡ä»¶ç³»ç»Ÿå–è¯å®æ“ï¼šé€šè¿‡ inode æ‰‹åŠ¨æ¢å¤å·²åˆ é™¤æ–‡ä»¶



#### å®éªŒç¯å¢ƒå‡†å¤‡

**åˆ›å»ºè™šæ‹Ÿç£ç›˜å¹¶æ ¼å¼åŒ–ä¸º ext4**

> **ext4 å¯ç”¨æ—¥å¿—åçš„åˆ é™¤è¡Œä¸º**
>
> `rm file` åœ¨ journal ext4 ä¸­è§¦å‘äº†ä»€ä¹ˆï¼Ÿ
>
> | å†…å®¹ç±»å‹       | æ˜¯å¦è®°å½•æ—¥å¿—    | è¯´æ˜                                      |
> | -------------- | --------------- | ----------------------------------------- |
> | æ–‡ä»¶å†…å®¹æ•°æ®å— | âŒï¼ˆé»˜è®¤ä¸è®°å½•ï¼‰ | æ•°æ®å—ç›´æ¥å†™å…¥ç£ç›˜ï¼ˆé journalï¼‰          |
> | inode å…ƒæ•°æ®   | âœ…               | åˆ é™¤æ“ä½œä¼šå°† inodeã€dentry çš„å˜æ›´å†™å…¥æ—¥å¿— |
> | block bitmap   | âœ…               | bitmap çš„é‡Šæ”¾ä¹Ÿä¼šåŒæ­¥åˆ° journal           |
>
> 
>
> è¿™æ„å‘³ç€ï¼š
>
> - `inode` åœ¨è¢«åˆ é™¤æ—¶ï¼Œä¼šå°†**åŸå§‹ inode æ¸…ç©ºåŠ¨ä½œ**å†™å…¥æ—¥å¿—åŒº
> - journal commit åï¼ŒåŸå§‹ inode è¡¨ä¸­çš„å†…å®¹å°†è¢«æ¸…ç©º
> - block bitmap ä¹Ÿä¼šæ›´æ–°ï¼Œæ•°æ®å—æ ‡è®°ä¸ºç©ºé—²

```bash
fallocate -l 200M /tmp/ext4.img
mkfs.ext4 -O ^has_journal /tmp/ext4.img  # å…³é—­æ—¥å¿—
mkdir /mnt/ext4test
mount -o loop /tmp/ext4.img /mnt/ext4test
```



#### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæµ‹è¯•æ–‡ä»¶

```bash
mkdir test
cd test
echo 'Secret Data in file' > secret.txt
sync  # ç¡®ä¿æ•°æ®è½ç›˜
```



#### ç¬¬äºŒæ­¥ï¼šåˆ é™¤æµ‹è¯•æ–‡ä»¶

```bash
rm secret.txt
sync
```

æ­¤æ—¶ `secret.txt` å·²è¢«åˆ é™¤ï¼Œæ— æ³•é€šè¿‡æ™®é€šæ‰‹æ®µæ‰¾åˆ°ã€‚



#### ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨ debugfs æŸ¥æ‰¾ inode å’Œæ•°æ®å—

```bash
debugfs /dev/vda1

lsdel

# è¾“å‡ºç±»ä¼¼
 Inode  Owner  Mode    Size   Blocks   Time Deleted
  12     0    100644   22     1        2024-06-01

# è®°å½•è¯¥ inode ç¼–å·ï¼ˆå¦‚ï¼š12ï¼‰ï¼Œç„¶åæŸ¥çœ‹ inode å†…å®¹ï¼š
stat <12>

# æ‰¾åˆ°ï¼š
EXTENTS:
(0): 42   # è¡¨ç¤ºæ•°æ®å­˜å‚¨åœ¨ç¬¬ 42 ä¸ªå—ä¸­ï¼ˆè¿™æ˜¯é€»è¾‘å—å·ï¼‰
```



#### ç¬¬å››æ­¥ï¼šè®¡ç®—å¹¶æå–æ•°æ®å—å†…å®¹ï¼ˆæ–¹æ³•ä¸€ï¼šä½¿ç”¨ ddï¼‰

### è®¡ç®—åç§»ï¼š

å—å¤§å°é€šå¸¸ä¸º 4096 å­—èŠ‚ï¼Œåç§» = 42 Ã— 4096 = 172032

### æå–å†…å®¹ï¼š

```bash
dd if=/tmp/ext4.img of=recovered.txt bs=4096 skip=42 count=1
cat recovered.txt
```

åº”è¾“å‡ºï¼š

```
Secret Data in file
```

âœ… æˆåŠŸæ¢å¤å·²åˆ é™¤æ–‡ä»¶çš„å†…å®¹ï¼





# ç¬¬äº”å¤©

## vimç”¨æ³•



- **æ­£å¸¸ï¼ˆnormalï¼‰æ¨¡å¼**

  > ï¼ˆä¹Ÿç§°ä¸ºæ™®é€šæ¨¡å¼ï¼‰ï¼Œç¼ºçœçš„ç¼–è¾‘æ¨¡å¼ï¼›å¦‚æœä¸åŠ ç‰¹æ®Šè¯´æ˜ï¼Œä¸€èˆ¬æåˆ°çš„å‘½ä»¤éƒ½ç›´æ¥åœ¨æ­£å¸¸æ¨¡å¼ä¸‹è¾“å…¥ï¼›åœ¨ä»»ä½•å…¶ä»–æ¨¡å¼ä¸­ï¼Œéƒ½å¯ä»¥é€šè¿‡é”®ç›˜ä¸Šçš„ Esc é”®å›åˆ°æ­£å¸¸æ¨¡å¼ã€‚

- **æ’å…¥ï¼ˆinsertï¼‰æ¨¡å¼**

  > è¾“å…¥æ–‡æœ¬æ—¶ä½¿ç”¨ï¼›æ¯”å¦‚åœ¨æ­£å¸¸æ¨¡å¼ä¸‹é”®å…¥ iï¼ˆinsertï¼‰æˆ– aï¼ˆappendï¼‰å³å¯è¿›å…¥æ’å…¥æ¨¡å¼ã€‚

- **å¯è§†ï¼ˆvisualï¼‰æ¨¡å¼**

  > ç”¨äºé€‰å®šæ–‡æœ¬å—ï¼›æ•™ç¨‹ä¸­å·²ç»æåˆ°å¯ä»¥ç”¨é”® vï¼ˆå°å†™ï¼‰æ¥æŒ‰å­—ç¬¦é€‰å®šï¼ŒVim é‡Œä¹Ÿæä¾›å…¶ä»–ä¸åŒçš„é€‰å®šæ–¹æ³•ï¼ŒåŒ…æ‹¬æŒ‰è¡Œå’ŒæŒ‰åˆ—å—ã€‚

- **å‘½ä»¤è¡Œï¼ˆcommand-lineï¼‰æ¨¡å¼**

  > ç”¨äºæ‰§è¡Œè¾ƒé•¿ã€è¾ƒå¤æ‚çš„å‘½ä»¤ï¼›åœ¨æ­£å¸¸æ¨¡å¼ä¸‹é”®å…¥å†’å·ï¼ˆ:ï¼‰å³å¯è¿›å…¥è¯¥æ¨¡å¼ï¼›ä½¿ç”¨æ–œæ ï¼ˆ/ï¼‰å’Œé—®å·ï¼ˆ?ï¼‰å¼€å§‹æœç´¢ä¹Ÿç®—ä½œå‘½ä»¤è¡Œæ¨¡å¼ã€‚å‘½ä»¤è¡Œæ¨¡å¼ä¸‹çš„å‘½ä»¤è¦è¾“å…¥å›è½¦é”®ï¼ˆEnterï¼‰æ‰ç®—å®Œæˆã€‚





### vimæ ‡å‡†é”®æè¿°æ–¹å¼



- `<Esc>` è¡¨ç¤º Esc é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ‹â€
- `<CR>` è¡¨ç¤ºå›è½¦é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ†©â€
- `<Space>` è¡¨ç¤ºç©ºæ ¼é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ£â€
- `<Tab>` è¡¨ç¤º Tab é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ‡¥â€
- `<BS>` è¡¨ç¤ºé€€æ ¼é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâŒ«â€
- `<Del>` è¡¨ç¤ºåˆ é™¤é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâŒ¦â€
- `<lt>` è¡¨ç¤º < é”®ï¼›æ˜¾ç¤ºä¸ºâ€œ<â€
- `<Up>` è¡¨ç¤ºå…‰æ ‡ä¸Šç§»é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ‡¡â€
- `<Down>` è¡¨ç¤ºå…‰æ ‡ä¸‹ç§»é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ‡£â€
- `<Left>` è¡¨ç¤ºå…‰æ ‡å·¦ç§»é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ‡ â€
- `<Right>` è¡¨ç¤ºå…‰æ ‡å³ç§»é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ‡¢â€
- `<PageUp>` è¡¨ç¤º Page Up é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ‡â€
- `<PageDown>` è¡¨ç¤º Page Down é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ‡Ÿâ€
- `<Home>` è¡¨ç¤º Home é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ†–â€
- `<End>` è¡¨ç¤º End é”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ†˜â€
- `<F1> - <F12>` è¡¨ç¤ºåŠŸèƒ½é”® 1 åˆ° 12ï¼›æ˜¾ç¤ºä¸ºâ€œF1â€åˆ°â€œF12â€
- `<S-â€¦>` Shift ç»„åˆé”®ï¼›æ˜¾ç¤ºä¸ºâ€œâ‡§â€ï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦å†™ ! è€Œä¸æ˜¯ `<S-1>`ï¼›å’Œç‰¹æ®Šé”®ç»„åˆæ—¶ä»ç„¶æœ‰ç”¨ï¼‰
- `<C-â€¦>` Control ç»„åˆé”®ï¼›æ˜¾ç¤ºä¸ºâ€œâŒƒâ€<M-â€¦> Alt ç»„åˆé”®ï¼›æ˜¾ç¤ºä¸ºâ€œâŒ¥â€ï¼ˆå¯¹äºå¤§éƒ¨åˆ†ç”¨æˆ·ï¼Œå®ƒçš„åŸå§‹é”®å Meta åº”è¯¥åªå…·æœ‰å†å²æ„ä¹‰ï¼‰
- `<D-â€¦>` Command ç»„åˆé”®ï¼›æ˜¾ç¤ºä¸ºâ€œâŒ˜â€ï¼ˆMac é”®ç›˜ï¼‰



### vimé…ç½®

ä½œä¸ºä¸€ä¸ªå¯ä»¥è¶Šç”¨è¶Šé¡ºæ‰‹çš„åº”ç”¨ç¨‹åºï¼ŒVim æ˜¯éœ€è¦é…ç½®çš„ã€‚

æ ¹æ® Unix ä¸‹çš„æƒ¯ä¾‹ï¼ŒVim çš„é…ç½®æ–‡ä»¶æ”¾åœ¨ç”¨æˆ·çš„ä¸»ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åé€šå¸¸æ˜¯ `.vimrc`ï¼›è€Œå®ƒåœ¨ Windows ä¸‹åå­—æ˜¯ `_vimrc`ã€‚



åŸºæœ¬é…ç½®

```bash
set undodir=~/.vim/undodir                # è¿™æ ·ä¸€å®šè¦å†™åœ¨åˆ›å»ºç›®å½•å‰é¢
let undodir_path = expand(&undodir)
if !isdirectory(undodir_path)
    call mkdir(undodir_path, 'p', 0700)
endif

syntax on
set background=dark
set enc=utf-8                          # è®¾ç½®ç¼–è¾‘æ–‡ä»¶çš„å†…ç æ˜¯ UTF-8
set nocompatible                       # è®¾ç½® Vim ä¸éœ€è¦å’Œ vi å…¼å®¹(ç›®å‰å¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿™æ˜¯ç¼ºçœæƒ…å†µ)
source $VIMRUNTIME/vimrc_example.vim   # å¯¼å…¥ Vim çš„ç¤ºä¾‹é…ç½®ï¼ˆè¿™ä¼šæ‰“å¼€ä¸€äº›æœ‰ç”¨çš„é€‰é¡¹ï¼Œå¦‚è¯­æ³•åŠ äº®ã€æœç´¢åŠ äº®ã€å‘½ä»¤å†å²ã€è®°ä½ä¸Šæ¬¡çš„æ–‡ä»¶ä½ç½®ï¼Œç­‰ç­‰ï¼‰
set nobackup                           # ä¸å¤‡ä»½
set scrolloff=1
colorscheme murphy
```



### vimä½¿ç”¨

#### å…‰æ ‡ç§»åŠ¨

Vim é‡Œçš„åŸºæœ¬å…‰æ ‡ç§»åŠ¨æ˜¯é€šè¿‡ **hã€jã€kã€l** å››ä¸ªé”®å®ç°çš„ã€‚ä¹‹æ‰€ä»¥ä½¿ç”¨è¿™å››ä¸ªé”®ï¼Œæ˜¯æœ‰å†å²åŸå› çš„ã€‚ä½ çœ‹ä¸€ä¸‹ Bill Joy å¼€å‘ vi æ—¶ä½¿ç”¨çš„é”®ç›˜å°±æ˜ç™½äº†ï¼šè¿™ä¸ªé”®ç›˜ä¸Šæ²¡æœ‰ç‹¬ç«‹çš„å…‰æ ‡é”®ï¼Œè€Œå››ä¸ªå…‰æ ‡ç¬¦å·ç›´æ¥æ ‡æ³¨åœ¨ Hã€Jã€Kã€L å››ä¸ªå­—æ¯æŒ‰é”®ä¸Šã€‚

<img src="D:\git_repository\cyber_security_learning\markdown_img\image-20250610103229515.png" alt="image-20250610103229515" style="zoom:1150%;" />

å½“ç„¶ï¼Œé™¤äº†å†å²åŸå› å¤–ï¼Œè¿™å››ä¸ªé”®ä¸€ç›´ä½¿ç”¨è‡³ä»Šï¼Œè¿˜æ˜¯æœ‰å…¶åˆç†æ€§çš„ã€‚å®ƒä»¬éƒ½å¤„äºæ‰“å­—æœºçš„æœ¬ä½æ’ï¼ˆhome rowï¼‰ä¸Šï¼Œè¿™æ ·æ‰“å­—çš„æ—¶å€™ï¼Œæ‰‹æŒ‡åŸºæœ¬ä¸ç”¨ç§»åŠ¨å°±å¯ä»¥æ•²å‡»åˆ°ã€‚å› æ­¤ï¼Œå³ä½¿åˆ°äº†é”®ç›˜ä¸Šå…¨éƒ½æœ‰äº†å…‰æ ‡ç§»åŠ¨é”®çš„ä»Šå¤©ï¼Œå¾ˆå¤š Vim çš„ç”¨æˆ·ä»ç„¶ä¼šä½¿ç”¨è¿™å››ä¸ªé”®æ¥ç§»åŠ¨å…‰æ ‡ã€‚



Vim è·³è½¬åˆ°è¡Œé¦–çš„å‘½ä»¤æ˜¯ **0**ï¼Œè·³è½¬åˆ°è¡Œå°¾çš„å‘½ä»¤æ˜¯ **$**ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ **^**ï¼Œç”¨æ¥è·³è½¬åˆ°è¡Œé¦–çš„ç¬¬ä¸€ä¸ªéç©ºç™½å­—ç¬¦ã€‚



å¯¹äºä¸€æ¬¡ç§»åŠ¨è¶…è¿‡ä¸€ä¸ªå­—ç¬¦çš„æƒ…å†µï¼ŒVim æ”¯æŒä½¿ç”¨ **b/w** å’Œ **B/W**ï¼Œæ¥è¿›è¡Œä»¥å•è¯ä¸ºå•ä½çš„è·³è½¬ã€‚å°å†™å’Œå¤§å†™å‘½ä»¤çš„åŒºåˆ«åœ¨äºï¼Œå°å†™çš„è·Ÿç¼–ç¨‹è¯­è¨€é‡Œçš„æ ‡è¯†ç¬¦çš„è§„åˆ™ç›¸ä¼¼ï¼Œè®¤ä¸ºä¸€ä¸ªå•è¯æ˜¯ç”±å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ç»„æˆçš„ï¼ˆä¸ä¸¥æ ¼çš„è¯´æ³•ï¼‰ï¼Œè€Œå¤§å†™çš„å‘½ä»¤åˆ™è®¤ä¸ºéç©ºæ ¼å­—ç¬¦éƒ½æ˜¯å•è¯ã€‚



ä½¿ç”¨ **fï¼ˆfindï¼‰**å’Œ **tï¼ˆtillï¼‰**äº†ã€‚å®ƒä»¬çš„ä½œç”¨éƒ½æ˜¯æ‰¾åˆ°ä¸‹ä¸€ä¸ªï¼ˆå¦‚æœåœ¨è¾“å…¥å®ƒä»¬ä¹‹å‰å…ˆè¾“å…¥æ•°å­— n çš„è¯ï¼Œé‚£å°±æ˜¯ä¸‹é¢ç¬¬ n ä¸ªï¼‰ç´§æ¥ç€è¾“å…¥çš„å­—ç¬¦ã€‚å¦‚æœéœ€è¦åæ–¹å‘æœç´¢çš„è¯ï¼Œä½¿ç”¨å¤§å†™çš„ **F** å’Œ **T** å°±å¯ä»¥ã€‚



- `(` å’Œ `)` ç§»åˆ°ä¸Šä¸€å¥å’Œä¸‹ä¸€å¥
- `{` å’Œ `}` ç§»åˆ°ä¸Šä¸€æ®µå’Œä¸‹ä¸€æ®µ

- `gg`è·³è½¬åˆ°å¼€å¤´ï¼Œ`G`è·³è½¬åˆ°ç»“å°¾



#### æ–‡æœ¬ä¿®æ”¹

- `d` åŠ åŠ¨ä½œæ¥è¿›è¡Œåˆ é™¤ï¼ˆ`dd` åˆ é™¤æ•´è¡Œï¼‰ï¼›`D` åˆ™ç›¸å½“äº `d$`ï¼Œåˆ é™¤åˆ°è¡Œå°¾ã€‚
- `c` åŠ åŠ¨ä½œæ¥è¿›è¡Œä¿®æ”¹ï¼ˆ`cc` ä¿®æ”¹æ•´è¡Œï¼‰ï¼›`C` åˆ™ç›¸å½“äº `c$`ï¼Œåˆ é™¤åˆ°è¡Œå°¾ç„¶åè¿›å…¥æ’å…¥æ¨¡å¼ã€‚
- `s` ç›¸å½“äº `cl`ï¼Œåˆ é™¤ä¸€ä¸ªå­—ç¬¦ç„¶åè¿›å…¥æ’å…¥æ¨¡å¼ï¼›`S` ç›¸å½“äº `cc`ï¼Œæ›¿æ¢æ•´è¡Œçš„å†…å®¹ã€‚
- `i` åœ¨å½“å‰å­—ç¬¦å‰é¢è¿›å…¥æ’å…¥æ¨¡å¼ï¼›`I` åˆ™ç›¸å½“äº `^i`ï¼ŒæŠŠå…‰æ ‡ç§»åˆ°è¡Œé¦–éç©ºç™½å­—ç¬¦ä¸Šç„¶åè¿›å…¥æ’å…¥æ¨¡å¼ã€‚
- `a` åœ¨å½“å‰å­—ç¬¦åé¢è¿›å…¥æ’å…¥æ¨¡å¼ï¼›`A` ç›¸å½“äº `$a`ï¼ŒæŠŠå…‰æ ‡ç§»åˆ°è¡Œå°¾ç„¶åè¿›å…¥æ’å…¥æ¨¡å¼ã€‚
- `o` åœ¨å½“å‰è¡Œä¸‹æ–¹æ’å…¥ä¸€ä¸ªæ–°è¡Œï¼Œç„¶ååœ¨è¿™è¡Œè¿›å…¥æ’å…¥æ¨¡å¼ï¼›`O` åœ¨å½“å‰è¡Œä¸Šæ–¹æ’å…¥ä¸€ä¸ªæ–°è¡Œï¼Œç„¶ååœ¨è¿™è¡Œè¿›å…¥æ’å…¥æ¨¡å¼ã€‚
- `r` æ›¿æ¢å…‰æ ‡ä¸‹çš„å­—ç¬¦ï¼›`R` åˆ™è¿›å…¥æ›¿æ¢æ¨¡å¼ï¼Œæ¯æ¬¡æŒ‰é”®ï¼ˆç›´åˆ° ï¼‰æ›¿æ¢ä¸€ä¸ªå­—ç¬¦ã€‚
- `u` æ’¤é”€æœ€è¿‘çš„ä¸€ä¸ªä¿®æ”¹åŠ¨ä½œï¼› `U` æ’¤é”€å½“å‰è¡Œä¸Šçš„æ‰€æœ‰ä¿®æ”¹ã€‚



#### æ–‡æœ¬å¯¹è±¡é€‰æ‹©

```bash
if (message == "sesame open")
```

æˆ‘ä»¬è¿›ä¸€æ­¥å‡è®¾å…‰æ ‡åœåœ¨â€œsesameâ€çš„â€œaâ€ä¸Šï¼Œé‚£ä¹ˆï¼ˆå’Œä¸€èˆ¬çš„è¡Œæ–‡æƒ¯ä¾‹ä¸åŒï¼Œä¸‹é¢åœ¨å‘½ä»¤å¤–é¢ä¹ŸåŠ ä¸Šäº†å¼•å·ï¼Œé¿å…å¯èƒ½çš„æ­§ä¹‰ï¼‰

- `dw`ï¼ˆç†è§£ä¸º delete wordï¼‰ä¼šåˆ é™¤â€œameâ£â€ï¼Œç»“æœæ˜¯â€œif (message == "sesopen")â€
- `diw`ï¼ˆç†è§£ä¸º delete inside wordï¼‰ä¼šåˆ é™¤â€œsesameâ€ï¼Œç»“æœæ˜¯â€œif (message == " open")â€
- `daw`ï¼ˆç†è§£ä¸º delete a wordï¼‰ä¼šåˆ é™¤â€œsesameâ£â€ï¼Œç»“æœæ˜¯â€œif (message == "open")â€
- `diW` ä¼šåˆ é™¤â€œ"sesameâ€ï¼Œç»“æœæ˜¯â€œif (message == open")â€
- `daW` ä¼šåˆ é™¤â€œ"sesameâ£â€ï¼Œç»“æœæ˜¯â€œif (message == open")â€
- `di"` ä¼šåˆ é™¤â€œsesame openâ€ï¼Œç»“æœæ˜¯â€œif (message == "")â€
- `da"` ä¼šåˆ é™¤â€œ"sesame open"â€ï¼Œç»“æœæ˜¯â€œif (message ==)â€
- `di(` æˆ– `di)`ä¼šåˆ é™¤â€œmessage == "sesame open"â€ï¼Œç»“æœæ˜¯â€œif ()â€
- `da(` æˆ–  `da)`ä¼šåˆ é™¤â€œ(message == "sesame open")â€ï¼Œç»“æœæ˜¯â€œifâ£â€



ä¸Šé¢æ¼”ç¤ºäº† aã€i å’Œ wã€åŒå¼•å·ã€åœ†æ‹¬å·æ­é…ä½¿ç”¨ï¼Œè¿™äº›å¯¹äºä»»ä½•è¯­è¨€çš„ä»£ç ç¼–è¾‘éƒ½æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚å®é™…ä¸Šï¼Œå¯ä»¥æ­é…çš„è¿˜æœ‰æ›´å¤šï¼š

- æ­é… `s`ï¼ˆsentenceï¼‰å¯¹å¥å­è¿›è¡Œæ“ä½œâ€”â€”é€‚åˆè¥¿æ–‡æ–‡æœ¬ç¼–è¾‘
- æ­é… `p`ï¼ˆparagraph) å¯¹æ®µè½è¿›è¡Œæ“ä½œâ€”â€”é€‚åˆè¥¿æ–‡æ–‡æœ¬ç¼–è¾‘ï¼ŒåŠå¸¦ç©ºè¡Œçš„ä»£ç ç¼–è¾‘
- æ­é… `t`ï¼ˆtagï¼‰å¯¹ HTML/XML æ ‡ç­¾è¿›è¡Œæ“ä½œâ€”â€”é€‚åˆ HTMLã€XML ç­‰è¯­è¨€çš„ä»£ç ç¼–è¾‘
- æ­é… \` å’Œ `'` å¯¹è¿™ä¸¤ç§å¼•å·é‡Œçš„å†…å®¹è¿›è¡Œæ“ä½œâ€”â€”é€‚åˆä½¿ç”¨è¿™äº›å¼•å·çš„ä»£ç ï¼Œå¦‚ shell å’Œ Python
- æ­é…æ–¹æ‹¬å·ï¼ˆ`[` å’Œ `]`ï¼‰å¯¹æ–¹æ‹¬å·é‡Œçš„å†…å®¹è¿›è¡Œæ“ä½œâ€”â€”é€‚åˆå„ç§è¯­è¨€ï¼ˆå¤§éƒ¨åˆ†éƒ½ä¼šç”¨åˆ°æ–¹æ‹¬å·å§ï¼‰
- æ­é…èŠ±æ‹¬å·ï¼ˆ`{` å’Œ `}`å¯¹èŠ±æ‹¬å·é‡Œçš„å†…å®¹è¿›è¡Œæ“ä½œâ€”â€”é€‚åˆç±» C çš„è¯­è¨€
- æ­é…è§’æ‹¬å·ï¼ˆ`<` å’Œ `>`ï¼‰å¯¹è§’æ‹¬å·é‡Œçš„å†…å®¹è¿›è¡Œæ“ä½œâ€”â€”é€‚åˆ C++ çš„æ¨¡æ¿ä»£ç 



ä½ çŸ¥é“å‡ºé”™ä½ç½®çš„è¡Œå·ï¼Œé‚£ä½ å¯ä»¥ç”¨`æ•°å­—åŠ  G` æ¥è·³è½¬åˆ°æŒ‡å®šè¡Œã€‚ç±»ä¼¼åœ°ï¼Œä½ å¯ä»¥ç”¨æ•°å­—åŠ  `|` æ¥è·³è½¬åˆ°æŒ‡å®šåˆ—ã€‚è¿™åœ¨è°ƒè¯•ä»£ç çš„æ—¶å€™éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶é€‚åˆè¿›è¡Œè‡ªåŠ¨åŒ–ã€‚





#### å±å¹•æ»šåŠ¨

vimrc_example æœ‰ä¸€ä¸ªè®¾å®šï¼Œæˆ‘ä¸å¤ªå–œæ¬¢ï¼šå®ƒä¼šè®¾ set scrolloff=5ï¼Œå¯¼è‡´åªè¦å±å¹•èƒ½æ»šåŠ¨ï¼Œå…‰æ ‡å°±ç§»ä¸åˆ°æœ€ä¸Šé¢çš„ 4 è¡Œå’Œæœ€ä¸‹é¢çš„ 4 è¡Œé‡Œï¼Œå› ä¸ºä¸€ç§»è¿›å»å±å¹•å°±ä¼šè‡ªåŠ¨æ»šåŠ¨ã€‚è¿™åŒæ ·ä¹Ÿä¼šå¯¼è‡´ H å’Œ L çš„åŠŸèƒ½å‘ç”Ÿå˜åŒ–ï¼šæœ¬æ¥æ˜¯ç§»åŠ¨å…‰æ ‡åˆ°å±å¹•çš„æœ€ä¸Šé¢å’Œæœ€ä¸‹é¢ï¼Œç°åœ¨åˆ™å˜æˆäº†ç§»åŠ¨åˆ°ä¸Šæ•°ç¬¬ 6 è¡Œå’Œä¸‹æ•°ç¬¬ 6 è¡Œï¼Œå’Œæ²¡æœ‰è¿™ä¸ªè®¾å®šæ—¶çš„ 6H ä¸ 6L ä¸€æ ·äº†ã€‚æ‰€ä»¥æˆ‘ä¸€èˆ¬ä¼šåœ¨ Vim é…ç½®æ–‡ä»¶é‡Œè®¾ç½® set scrolloff=1ï¼ˆä½ ä¹Ÿå¯ä»¥è€ƒè™‘è®¾æˆ 0ï¼‰ï¼Œå‡å°‘è¿™ä¸ªè®¾ç½®çš„å¹²æ‰°ã€‚



åªè¦å…‰æ ‡è¿˜åœ¨å±å¹•ä¸Šï¼Œä½ ä¹Ÿå¯ä»¥æ»šåŠ¨å±å¹•è€Œä¸ç§»åŠ¨å…‰æ ‡ï¼ˆä¸åƒæŸäº›å…¶ä»–ç¼–è¾‘å™¨ï¼ŒVim ä¸å…è®¸å…‰æ ‡åœ¨å½“å‰å±å¹•ä»¥å¤–ï¼‰ã€‚éœ€è¦çš„æŒ‰é”®æ˜¯ `<C-E>` å’Œ `<C-Y>` ã€‚

å¦å¤–ä¸€ç§å¯èƒ½æ›´å®ç”¨çš„æ»šåŠ¨å±å¹•æ–¹å¼æ˜¯ï¼ŒæŠŠå½“å‰è¡Œâ€œæ»šåŠ¨â€åˆ°å±å¹•çš„é¡¶éƒ¨ã€ä¸­éƒ¨æˆ–åº•éƒ¨ã€‚Vim é‡Œçš„å¯¹åº”æŒ‰é”®æ˜¯ `zt`ã€`zz` å’Œ `zb`ã€‚å’Œä¸Šé¢çš„å‡ ä¸ªæ»šåŠ¨ç›¸å…³çš„æŒ‰é”®ä¸€æ ·ï¼Œå®ƒä»¬åŒæ ·å—é€‰é¡¹ scrolloff çš„å½±å“ã€‚





#### é‡å¤

- `;` é‡å¤æœ€è¿‘çš„å­—ç¬¦æŸ¥æ‰¾ï¼ˆ`f`ã€`t` ç­‰ï¼‰æ“ä½œ
- `,` é‡å¤æœ€è¿‘çš„å­—ç¬¦æŸ¥æ‰¾æ“ä½œï¼Œåæ–¹å‘
- `n` é‡å¤æœ€è¿‘çš„å­—ç¬¦ä¸²æŸ¥æ‰¾æ“ä½œï¼ˆ`/` å’Œ `?`ï¼‰
- `N` é‡å¤æœ€è¿‘çš„å­—ç¬¦ä¸²æŸ¥æ‰¾æ“ä½œï¼ˆ`/` å’Œ `?`ï¼‰ï¼Œåæ–¹å‘
- `.` é‡å¤æ‰§è¡Œæœ€è¿‘çš„ä¿®æ”¹æ“ä½œ





### å®šåˆ¶ vim åˆçº§

#### vimçš„ç›®å½•ç»“æ„

Vim çš„å·¥ä½œç¯å¢ƒæ˜¯ç”±è¿è¡Œæ”¯æŒæ–‡ä»¶æ¥è®¾å®šçš„ã€‚å¦‚æœä½ æƒ³è¦å®šåˆ¶ Vimï¼Œå°±è¦ç†ŸçŸ¥ Vim æœ‰å“ªäº›ä¸åŒç±»å‹çš„è¿è¡Œæ”¯æŒæ–‡ä»¶ï¼Œåˆ†åˆ«å­˜æ”¾åœ¨å“ªé‡Œï¼Œæ€æ ·èƒ½å¿«æ·åœ°æ‰¾åˆ°å®ƒä»¬ã€‚Vim æ¯”è¾ƒæœ‰æ„æ€çš„ä¸€ç‚¹çš„æ˜¯ï¼Œè™½ç„¶è¿è¡Œæ”¯æŒæ–‡ä»¶æ˜¯åœ¨ Vim çš„å®‰è£…ç›®å½•ä¸‹ï¼Œä½†ç”¨æˆ·è‡ªå·±æ˜¯å¯ä»¥â€œå…‹éš†â€è¿™ä¸ªç›®å½•ç»“æ„çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ è‡ªå·±ç›®å½•ä¸‹çš„ç”¨æˆ·é…ç½®ï¼Œåˆ°ä½ æ·±åº¦å®šåˆ¶çš„æ—¶å€™ï¼Œä¹Ÿæœ‰ç›¸ä¼¼çš„ç›®å½•ç»“æ„ã€‚æ‰€ä»¥ï¼Œæˆ‘å°±å…ˆä»è¿™äº›æ–‡ä»¶çš„ç›®å½•ç»“æ„å¼€å§‹è®²èµ·ã€‚



##### å®‰è£…ç›®å½•ä¸‹çš„è¿è¡Œæ”¯æŒæ–‡ä»¶

Vim çš„è¿è¡Œæ”¯æŒæ–‡ä»¶åœ¨ä¸åŒçš„å¹³å°ä¸Šæœ‰ç€ç›¸ä¼¼çš„ç›®å½•ç»“æ„ã€‚ä»¥ Vim 8.2 ä¸ºä¾‹ï¼Œå®ƒä»¬çš„æ ‡å‡†å®‰è£…ä½ç½®åˆ†åˆ«åœ¨ï¼š

- å¤§éƒ¨åˆ† Unix ä¸‹é¢ï¼š`/usr/share/vim/vim82`
- macOS Homebrew ä¸‹ï¼š`/usr/local/opt/macvim/MacVim.app/Contents/Resources/vim/runtime`
- Windows ä¸‹ï¼š`C:\Program Files (x86)\Vim\vim82`



åœ¨è¿™ä¸ªç›®å½•ä¸‹é¢ï¼Œä½ å¯ä»¥çœ‹åˆ°å¾ˆå¤šå­ç›®å½•ï¼Œå¦‚ autoloadã€colorsã€docã€packã€pluginã€syntax ç­‰ç­‰ã€‚è¿™äº›å­ç›®å½•ä¸‹é¢å°±æ˜¯åˆ†ç±»æ”¾ç½®çš„ Vim æ”¯æŒæ–‡ä»¶ã€‚æœ€å¸¸ç”¨çš„å­ç›®å½•åº”è¯¥æ˜¯ä¸‹é¢è¿™å‡ ä¸ªï¼š

- syntaxï¼šVim çš„è¯­æ³•åŠ äº®æ–‡ä»¶
- docï¼šVim çš„å¸®åŠ©æ–‡ä»¶
- colorsï¼šVim çš„é…è‰²æ–¹æ¡ˆ
- pluginï¼šVim çš„â€œæ’ä»¶â€ï¼Œå³ç”¨æ¥å¢å¼º Vim åŠŸèƒ½çš„å·¥å…·



**syntax ç›®å½•**

![image-20250610142943631](D:\git_repository\cyber_security_learning\markdown_img\image-20250610142943631.png)

è¿™é‡Œé¢çš„æ–‡ä»¶å»æ‰â€œ.vimâ€åç¼€åï¼Œå°±æ˜¯æ–‡ä»¶ç±»å‹çš„åå­—ï¼Œä½ å¯ä»¥ç”¨ç±»ä¼¼ `:setfiletype java` è¿™æ ·çš„å‘½ä»¤æ¥è®¾ç½®æ–‡ä»¶çš„ç±»å‹ï¼Œä»è€Œè¿›è¡Œè¯­æ³•åŠ äº®ã€‚



**docç›®å½•**

æˆ‘ä»¬ç”¨â€œ:helpâ€å‘½ä»¤æŸ¥çœ‹çš„å¸®åŠ©æ–‡ä»¶å°±æ”¾åœ¨ doc ç›®å½•ä¸‹ã€‚



**colors ç›®å½•**

æˆ‘ä»¬å¯ä»¥ç”¨èœå•â€œç¼–è¾‘ > é…è‰²æ–¹æ¡ˆâ€ï¼ˆâ€œEdit > Color Schemeâ€ï¼‰æµè§ˆé…è‰²æ–¹æ¡ˆï¼Œç›¸åº”çš„æ–‡ä»¶å°±åœ¨ colors ç›®å½•ä¸‹ã€‚

> vimé…è‰²æ–¹æ¡ˆä½¿ç”¨
>
> è¾“å…¥:colorschemeå‘½ä»¤ï¼Œç´§æ¥ç€ä¸€ä¸ªç©ºæ ¼åï¼Œç„¶åç‚¹å‡»Tabé”®ï¼Œå°†å¯ä»¥éå†æ‰€æœ‰å·²å®‰è£…çš„é…è‰²æ–¹æ¡ˆï¼ŒæŒ‰ä¸‹Enteré”®å¯ä»¥åº”ç”¨é€‰ä¸­çš„é…è‰²æ–¹æ¡ˆã€‚
>
> å¦‚æœä½ å¸Œæœ›åœ¨Vimå¯åŠ¨æ—¶å¯ç”¨æŒ‡å®šçš„é…è‰²æ–¹æ¡ˆï¼Œé‚£ä¹ˆå¯ä»¥åœ¨[vimrc](https://link.zhihu.com/?target=http%3A//yyq123.blogspot.com/2012/01/vim-vimrc.html)æ–‡ä»¶ä¸­ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
>
> ```bash
> :colorscheme name
> ```

![image-20250610160036317](D:\git_repository\cyber_security_learning\markdown_img\image-20250610160036317.png)



**plugin ç›®å½•**

<img src="D:\git_repository\cyber_security_learning\markdown_img\image-20250610160537331.png" alt="image-20250610160537331" style="zoom:150%;" />

åœ¨ plugin ç›®å½•ä¸‹çš„ç³»ç»Ÿå†…ç½®æ’ä»¶ä¸å¤šï¼Œæˆ‘ä»¬ä¸‹é¢å°±å¿«é€Ÿè®²è§£ä¸€ä¸‹

- **getscriptPlugin**ï¼šè·å¾—æœ€æ–°çš„ Vim è„šæœ¬çš„æ’ä»¶ï¼ˆåœ¨ç›®å‰å¹¿æ³›ä½¿ç”¨ Git çš„å¹´ä»£ï¼Œè¿™ä¸ªæ’ä»¶è¿‡æ—¶äº†ï¼Œæˆ‘ä»¬ä¸è®²ï¼‰
- **gzip**ï¼šç¼–è¾‘ .gz å‹ç¼©æ–‡ä»¶ï¼ˆèƒ½åœ¨ç¼–è¾‘åç¼€ä¸º .gz çš„æ–‡ä»¶æ—¶è‡ªåŠ¨è§£å‹å’Œå‹ç¼©ï¼Œä½ ä¼šæ„Ÿè§‰ä¸åˆ°è¿™ä¸ªæ–‡ä»¶æ˜¯å‹ç¼©çš„ï¼‰
- **logiPat**ï¼šæ¨¡å¼åŒ¹é…çš„é€»è¾‘è¿ç®—ç¬¦ï¼ˆå…è®¸ä»¥é€»è¾‘è¿ç®—ã€è€Œéæ ‡å‡†æ­£åˆ™è¡¨è¾¾å¼çš„æ–¹å¼æ¥å†™æ¨¡å¼åŒ¹é…è¡¨è¾¾å¼ï¼‰
- **manpager**ï¼šä½¿ç”¨ Vim æ¥æŸ¥çœ‹ man å¸®åŠ©ï¼ˆå¼ºçƒˆå»ºè®®è¯•ä¸€ä¸‹ï¼Œè®°å¾—ä½¿ç”¨ Vim çš„è·³è½¬é”® C-] å’Œ C-Tï¼‰
- **matchparen**ï¼šå¯¹æ‹¬å·è¿›è¡Œé«˜äº®åŒ¹é…ï¼ˆç°ä»£ç¼–è¾‘å™¨åŸºæœ¬éƒ½æœ‰ç±»ä¼¼çš„åŠŸèƒ½ï¼‰
- **netrwPlugin**ï¼šä»ç½‘ç»œä¸Šç¼–è¾‘æ–‡ä»¶å’Œæµè§ˆï¼ˆè¿œç¨‹ï¼‰ç›®å½•ï¼ˆæ”¯æŒå¤šç§å¸¸è§åè®®å¦‚ ftp å’Œ scpï¼Œå¯ç›´æ¥æ‰“å¼€ç›®å½•æ¥é€‰æ‹©æ–‡ä»¶ï¼‰
- **rrhelper**ï¼šç”¨äºæ”¯æŒ --remote-wait ç¼–è¾‘ï¼ˆVim çš„å¤šæœåŠ¡å™¨ä¼šç”¨åˆ°è¿™ä¸€åŠŸèƒ½ï¼‰
- **spellfile**ï¼šåœ¨æ‹¼å†™æ–‡ä»¶ç¼ºå¤±æ—¶è‡ªåŠ¨ä¸‹è½½ï¼ˆVim ä¸€èˆ¬åªå®‰è£…äº†è‹±æ–‡çš„æ‹¼å†™æ–‡ä»¶ï¼‰
- **tarPlugin**ï¼šç¼–è¾‘ï¼ˆå‹ç¼©çš„ï¼‰tar æ–‡ä»¶ï¼ˆæ³¨æ„ï¼Œå’Œ gzip æƒ…å†µä¸åŒï¼Œè¿™å„¿ä¸æ”¯æŒå†™å…¥ï¼‰
- **tohtml**ï¼šæŠŠè¯­æ³•åŠ äº®çš„ç»“æœè½¬æˆ HTMLï¼ˆè‡ªå·±æ‰“å¼€ä¸ªæ–‡ä»¶ï¼Œè¾“å…¥å‘½ä»¤â€œ**:TOhtml**â€å°±çŸ¥é“æ•ˆæœäº†ï¼‰
- **vimballPlugin**ï¼šåˆ›å»ºå’Œè§£å¼€ .vba æ–‡ä»¶ï¼ˆè¿™ä¸ªç›®å‰ä¹Ÿç•¥è¿‡æ—¶äº†ï¼Œæˆ‘ä»¬ä¸è®²ï¼‰
- **zipPlugin**ï¼šç¼–è¾‘ zip æ–‡ä»¶ï¼ˆå’Œ tar æ–‡ä»¶ä¸åŒï¼Œzip æ–‡ä»¶å¯æ”¯æŒå†™å…¥ï¼‰



é™¤äº† rrhelper å’Œ spellfile å±äºåŠŸèƒ½æ”¯æŒæ’ä»¶ï¼Œæ²¡æœ‰è‡ªå·±çš„å¸®åŠ©é¡µé¢ï¼Œå…¶ä»–åŠŸèƒ½éƒ½å¯ä»¥ä½¿ç”¨â€œ`:help`â€å‘½ä»¤æ¥æŸ¥çœ‹å¸®åŠ©ã€‚æŸ¥çœ‹å¸®åŠ©æ—¶ï¼Œæ’ä»¶åç§°ä¸­çš„â€œPluginâ€åç¼€éœ€è¦å»æ‰ï¼šæŸ¥çœ‹ zip æ–‡ä»¶ç¼–è¾‘çš„å¸®åŠ©æ—¶ï¼Œåº”å½“ä½¿ç”¨â€œ`:help zip`â€è€Œä¸æ˜¯â€œ`:help zipPlugin`â€ã€‚



**netwæ’ä»¶çš„ç”¨æ³•**

```bash
# æ³¨æ„äº‹é¡¹1ï¼šç”¨æˆ·åå’Œå½“å‰ç”¨æˆ·åä¸€è‡´ï¼Œæˆ–è€…vim scp://user@www.mysticalrecluse.com//www/wwwroot/www.mysticalrecluse.com/script/
# æ³¨æ„äº‹é¡¹2ï¼šå¦‚æœæ˜¯è®¿é—®ç›®å½•ï¼Œç»“å°¾è¦åŠ /
# æ³¨æ„äº‹é¡¹3ï¼šå»ºè®®å†™ç»å¯¹è·¯å¾„ï¼švim scp://user@url/<ç»å¯¹è·¯å¾„>
[root@magedu ~]# vim scp://www.mysticalrecluse.com//www/wwwroot/www.mysticalrecluse.com/script/
```

![image-20250610164613309](D:\git_repository\cyber_security_learning\markdown_img\image-20250610164613309.png)



**ä½¿ç”¨vimæŸ¥çœ‹manæ‰‹å†Œ**

```bash
[root@magedu ~]# export MANPAGER="vim -M +MANPAGER -"
```

![image-20250610170738176](D:\git_repository\cyber_security_learning\markdown_img\image-20250610170738176.png)



#### ç”¨æˆ·çš„vimé…ç½®ç›®å½•

Vim çš„å®‰è£…ç›®å½•ä½ æ˜¯ä¸åº”è¯¥å»ä¿®æ”¹çš„ã€‚é¦–å…ˆï¼Œä½ å¯èƒ½æ²¡æœ‰æƒé™å»ä¿®æ”¹è¿™ä¸ªç›®å½•ï¼›å…¶æ¬¡ï¼Œå³ä½¿ä½ æœ‰ä¿®æ”¹æƒé™ï¼Œè¿™ä¸ªç›®å½•ä¼šåœ¨ Vim å‡çº§æ—¶è¢«è¦†ç›–ï¼Œä½ åšçš„ä¿®æ”¹ä¹Ÿä¼šä¸¢å¤±ã€‚ç”¨æˆ·è‡ªå·±çš„é…ç½®åº”å½“æ”¾åœ¨è‡ªå·±çš„ç›®å½•ä¸‹ï¼Œè¿™ä¹Ÿå°±æ˜¯ç”¨æˆ·è‡ªå·±çš„ä¸»ç›®å½•ä¸‹çš„ Vim é…ç½®ç›®å½•ï¼ˆUnix ä¸‹çš„ **.vim**ï¼ŒWindows ä¸‹çš„ **vimfiles**ï¼‰ã€‚è¿™ä¸ªç›®å½•åº”å’Œ Vim å®‰è£…ç›®å½•ä¸‹çš„è¿è¡Œæ”¯æŒæ–‡ä»¶ç›®å½•æœ‰ç›¸åŒçš„ç»“æ„ï¼Œä½†ä¸‹é¢çš„å­ç›®å½•ä½ åœ¨éœ€è¦ä¿®æ”¹ Vim çš„ç›¸å…³è¡Œä¸ºæ—¶æ‰æœ‰å¿…è¦åˆ›å»ºã€‚å¦‚æœä¸€ä¸ªåŒåæ–‡ä»¶å‡ºç°ç”¨æˆ·è‡ªå·±çš„ Vim é…ç½®ç›®å½•é‡Œå’Œ Vim çš„å®‰è£…ç›®å½•é‡Œï¼Œ**ç”¨æˆ·çš„æ–‡ä»¶ä¼˜å…ˆ**ã€‚



å…³äº Vim çš„å…¬ç”¨è„šæœ¬ï¼Œè¿™å„¿å†å¤šè¯´å‡ å¥ã€‚Vim çš„ç½‘ç«™è¿‡å»æ˜¯ç”¨æ¥é›†ä¸­è·å–å„ç§è„šæœ¬â€”â€”å¦‚æ’ä»¶å’Œé…è‰²æ–¹æ¡ˆâ€”â€”çš„åœ°æ–¹ï¼Œè€Œ getscriptPlugin å¯ä»¥å¸®åŠ©ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚ä»Šå¤©ä½ ä»ç„¶å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä½† Git å’Œ GitHub çš„å¹¿æ³›ä½¿ç”¨å·²ç»æ”¹å˜äº†äººä»¬è·å–å’Œæ›´æ–°è„šæœ¬çš„æ–¹å¼ã€‚ç°åœ¨ï¼Œæœ€ä¸»æµçš„åˆ†å‘ Vim è„šæœ¬çš„æ–¹å¼æ˜¯åˆ©ç”¨ GitHubï¼Œè€Œç”¨æˆ·åˆ™ä½¿ç”¨åŒ…ç®¡ç†å™¨æ¥è°ƒç”¨ Git ä» GitHubï¼ˆæˆ–ç±»ä¼¼çš„ Git åº“ï¼‰è·å–å’Œæ›´æ–°è„šæœ¬ã€‚







#### vim8 æ–°åŠŸèƒ½



##### vimè½¯ä»¶åŒ… (é‡è¦)

vimçš„é…ç½®ç›®å½•ç»“æ„

```bat
.
â”œâ”€â”€ colors
â”œâ”€â”€ doc
â”œâ”€â”€ pack
â”‚   â”œâ”€â”€ minpac
â”‚   â”‚   â”œâ”€â”€ opt
â”‚   â”‚   â”‚   â”œâ”€â”€ minpac
â”‚   â”‚   â”‚   â”œâ”€â”€ vim-airline
â”‚   â”‚   â”‚   â””â”€â”€ vimcdoc
â”‚   â”‚   â””â”€â”€ start
â”‚   â”‚       â”œâ”€â”€ VimExplorer
â”‚   â”‚       â”œâ”€â”€ asyncrun.vim
â”‚   â”‚       â”œâ”€â”€ fzf.vim
â”‚   â”‚       â”œâ”€â”€ gruvbox
â”‚   â”‚       â”œâ”€â”€ killersheep
â”‚   â”‚       â”œâ”€â”€ nerdcommenter
â”‚   â”‚       â”œâ”€â”€ nerdtree
â”‚   â”‚       â”œâ”€â”€ tagbar
â”‚   â”‚       â”œâ”€â”€ undotree
â”‚   â”‚       â”œâ”€â”€ vim-fugitive
â”‚   â”‚       â”œâ”€â”€ vim-matrix-screensaver
â”‚   â”‚       â”œâ”€â”€ vim-rainbow
â”‚   â”‚       â”œâ”€â”€ vim-repeat
â”‚   â”‚       â”œâ”€â”€ vim-rhubarb
â”‚   â”‚       â””â”€â”€ vim-surround
â”‚   â””â”€â”€ my
â”‚       â”œâ”€â”€ opt
â”‚       â”‚   â”œâ”€â”€ YouCompleteMe
â”‚       â”‚   â”œâ”€â”€ ale
â”‚       â”‚   â”œâ”€â”€ clang_complete
â”‚       â”‚   â”œâ”€â”€ cvsmenu
â”‚       â”‚   â””â”€â”€ syntastic
â”‚       â””â”€â”€ start
â”‚           â”œâ”€â”€ vim-gitgutter
â”‚           â””â”€â”€ ycmconf
â”œâ”€â”€ plugin
â”œâ”€â”€ syntax
â””â”€â”€ undodir
```

Vim 8 åœ¨å¯åŠ¨æ—¶ä¼šåŠ è½½æ‰€æœ‰ pack/*/start ä¸‹é¢çš„åŒ…ï¼Œè€Œç”¨æˆ·å¯ä»¥ç”¨ :packadd å‘½ä»¤æ¥åŠ è½½æŸä¸ª opt ç›®å½•ä¸‹çš„åŒ…ï¼Œå¦‚ `:packadd vimcdoc` å‘½ä»¤å¯åŠ è½½ vimcdoc åŒ…ï¼Œæ¥æ˜¾ç¤ºä¸­æ–‡å¸®åŠ©ä¿¡æ¯ã€‚

æœ‰äº†è¿™æ ·çš„ç›®å½•ç»“æ„ï¼Œç”¨æˆ·è¦è‡ªå·±å®‰è£…ã€ç®¡ç†åŒ…å°±æ–¹ä¾¿å¤šäº†ã€‚æ¨èä¸€ä¸ªåŒ…ç®¡ç†å™¨ `minpac`ã€‚åŒ…ç®¡ç†å™¨å¯ä»¥å¸¦æ¥ä¸‹é¢çš„å¥½å¤„ï¼š

- æ ¹æ®æ–‡æœ¬çš„é…ç½®ï¼ˆä¸€èˆ¬å†™åœ¨ vimrc é…ç½®æ–‡ä»¶é‡Œï¼‰å†³å®šè¦å®‰è£…å“ªäº›åŒ…
- è‡ªåŠ¨åŒ–å®‰è£…ã€å‡çº§å’Œå¸è½½ï¼ŒåŒ…æ‹¬å¸®åŠ©æ–‡ä»¶çš„ç´¢å¼•ç”Ÿæˆ



###### å®‰è£…minpac

```ABAP
ä»è¿™é‡Œä¹‹åçš„æ“ä½œï¼Œè¦æ±‚ç§‘å­¦ä¸Šç½‘
```

æ ¹æ® minpac ç½‘é¡µä¸Šçš„è¯´æ˜ï¼Œæˆ‘ä»¬åœ¨ Windows ä¸‹å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤

```bash
cd /d %USERPROFILE%
git clone https://github.com/k-takata/minpac.git ^
    vimfiles\pack\minpac\opt\minpac
```

åœ¨ Linux å’Œ macOS ä¸‹åˆ™å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š

```bash
git clone https://github.com/k-takata/minpac.git \
    ~/.vim/pack/minpac/opt/minpac
```

ç„¶åï¼Œæˆ‘ä»¬åœ¨ vimrc é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼ˆå…ˆä¸ç”¨ç†è§£å…¶å«ä¹‰ï¼‰ï¼š

```bash
if exists('*minpac#init')
  " Minpac is loaded.
  call minpac#init()
  call minpac#add('k-takata/minpac', {'type': 'opt'})

  " Other plugins
endif

if has('eval')
  " Minpac commands
  command! PackUpdate packadd minpac | source $MYVIMRC | call minpac#update('', {'do': 'call minpac#status()'})
  command! PackClean  packadd minpac | source $MYVIMRC | call minpac#clean()
  command! PackStatus packadd minpac | source $MYVIMRC | call minpac#status()
endif
```

å­˜ç›˜ã€é‡å¯ Vim ä¹‹åï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸‰ä¸ªæ–°çš„å‘½ä»¤ï¼Œå¯ä»¥ç”¨æ¥æ›´æ–°ï¼ˆå®‰è£…ï¼‰åŒ…ã€æ¸…ç†åŒ…å’Œæ£€æŸ¥å½“å‰åŒ…çš„çŠ¶æ€



###### é€šè¿‡ minpac å®‰è£…æ‰©å±•åŒ…

è¯•éªŒä¸€ä¸‹é€šè¿‡ minpac æ¥å®‰è£…æ‰©å±•åŒ…ã€‚åœ¨â€œOther pluginsâ€é‚£è¡Œä¸‹é¢åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼š

```bash
call minpac#add('tpope/vim-eunuch')
```

ä¿å­˜æ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨ `:PackUpdate` å‘½ä»¤ã€‚ç•¥å¾®ç­‰å¾…ä¹‹åï¼Œå®‰è£…æˆåŠŸåï¼Œä½¿ç”¨`:PackStatus`æŸ¥çœ‹ï¼Œæˆ‘ä»¬å°±èƒ½çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„ç•Œé¢

![image-20250610195213333](D:\git_repository\cyber_security_learning\markdown_img\image-20250610195213333.png)



###### æœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶

å®‰è£…å¥½ Vim è½¯ä»¶åŒ…ä¹‹åï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥æ¥å®ç°ä¸€ä¸ªå°åŠŸèƒ½ã€‚

Vim çš„ç¼ºçœå®‰è£…ç¼ºäº†ä¸€ä¸ªå¾ˆå¤šç¼–è¾‘å™¨éƒ½æœ‰çš„åŠŸèƒ½ï¼šæœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶ã€‚

æˆ‘ä»¬å°±æŠŠè¿™ä¸ªåŠŸèƒ½è¡¥ä¸Šå§ã€‚ä½ åªéœ€è¦æŒ‰ç…§ä¸Šä¸€èŠ‚çš„æ­¥éª¤å®‰è£… yegappan/mru åŒ…å°±å¯ä»¥äº†ï¼ˆMRU ä»£è¡¨ most recently usedï¼‰ã€‚å®‰è£…å®Œä¹‹åï¼Œé‡æ–°æ‰“å¼€ vimrc æ–‡ä»¶ï¼Œä½ å°±å¯ä»¥åœ¨å›¾å½¢ç•Œé¢é‡Œçœ‹åˆ°ä¸‹é¢çš„èœå•äº†ï¼š

```bash
[root@magedu ~]# vim .vimrc
......
  " Other plugins
  call minpac#add('tpope/vim-eunuch')
  call minpac#add('yegappan/mru')     # æ·»åŠ è¿™è¡Œï¼Œåæ‰§è¡Œ:PackUpdate
......
```

```bat
å¦‚æœæ‰§è¡ŒPackUpdateæ˜¾ç¤ºè·¯å¾„ä¸å¯¹ï¼Œä¿®æ”¹ä¸‹é¢è·¯å¾„ä¸‹æ–‡ä»¶ï¼Œå°†å…¶æ”¹ä¸ºgithubåœ°å€å³å¯
[root@magedu ~]# vim /root/.vim/pack/minpac/opt/minpac/.git/config
[core]
        repositoryformatversion = 0
        filemode = true
        bare = false
        logallrefupdates = true
[remote "origin"]
        url = https://github.com/k-takata/minpac.git     # è¿™é‡Œè¦æ”¹ä¸ºgithubåœ°å€
        fetch = +refs/heads/*:refs/remotes/origin/*
[branch "master"]
        remote = origin
        merge = refs/heads/master
```



å®‰è£…æˆåŠŸåï¼Œåœ¨`.vimrc`é‡Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼ˆæˆ‘ä»¬æš‚æ—¶å…ˆä¸ç”¨å»ç†è§£å…¶æ„ä¹‰ï¼‰

```bash
if !has('gui_running')
  " è®¾ç½®æ–‡æœ¬èœå•
  if has('wildmenu')
    set wildmenu
    set cpoptions-=<
    set wildcharm=<C-Z>
    nnoremap <F10>      :emenu <C-Z>
    inoremap <F10> <C-O>:emenu <C-Z>
  endif
endif
```

åœ¨å¢åŠ ä¸Šé¢çš„é…ç½®ä¹‹åï¼Œä½ å°±å¯ä»¥ä½¿ç”¨é”® `<F10>`ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ¢ç”¨å…¶ä»–é”®ï¼‰åŠ  `<Tab>`æ¥å”¤èµ· Vim çš„æ–‡æœ¬èœå•äº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20250610201716910](D:\git_repository\cyber_security_learning\markdown_img\image-20250610201716910.png)



### å¤šæ–‡ä»¶æ‰“å¼€ä¸ç¼“å†²åŒº

#### å¤šæ–‡ä»¶çš„æ‰“å¼€æ–¹å¼

```ABAP
å‡è®¾ä¸€ä¸ªç®€å•çš„ä½¿ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬ç°åœ¨éœ€è¦åœ¨æŸä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰ .cpp å’Œ .h æ–‡ä»¶å¼€å¤´è´´å…¥ä¸€æ®µç‰ˆæƒå£°æ˜ï¼Œè¯¥å¦‚ä½•æ“ä½œï¼Ÿ
```



é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ï¼ŒVim æ”¯æŒä¸€æ¬¡æ€§æ‰“å¼€å¤šä¸ªæ–‡ä»¶ï¼Œä½ åªéœ€è¦åœ¨å‘½ä»¤è¡Œä¸Šå†™å‡ºå¤šä¸ªæ–‡ä»¶å³å¯ï¼Œæˆ–è€…ä½¿ç”¨é€šé…ç¬¦ã€‚æ¯”å¦‚ï¼Œå°±æˆ‘ä»¬åˆšæ‰æ‰€è¯´çš„ç¼–è¾‘åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ vim *.cpp *.hã€‚

```bash
[root@magedu ~/test]# vim *.txt
```



ä¸ºäº†ç¡®ä¿åœ¨é…ç½®è¾ƒå·®çš„ç¯å¢ƒé‡Œä»ç„¶èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼ŒVim ç»å¯¹ä¸ä¼šä¸å¿…è¦åœ°æ¶ˆè€—å†…å­˜ï¼ŒåŒ…æ‹¬æ‰“å¼€ä¸å¿…è¦ç«‹å³æ‰“å¼€çš„æ–‡ä»¶ã€‚æ‰€ä»¥åœ¨ä¸Šé¢çš„å‘½ä»¤åï¼ŒVim å»ºç«‹äº†ä¸€ä¸ªæ–‡ä»¶åˆ—è¡¨ï¼Œå¹¶ä¸”æš‚æ—¶åªæ‰“å¼€å…¶ä¸­çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ã€‚æ¥ä¸‹æ¥ï¼Œç”¨æˆ·å¯ä»¥å†³å®šï¼Œè¦ç¼–è¾‘å“ªä¸ªæ–‡ä»¶ï¼Œæˆ–è€…æŸ¥çœ‹åˆ—è¡¨ï¼Œæˆ–è€…æå‰é€€å‡ºï¼Œç­‰ç­‰ã€‚



ä¸ºæ­¤ï¼ŒVim æä¾›äº†ä»¥ä¸‹å‘½ä»¤ï¼š

- `:args`ï¼šå¯ä»¥æ˜¾ç¤ºâ€œå‚æ•°â€ï¼Œå³éœ€è¦ç¼–è¾‘çš„å¤šä¸ªæ–‡ä»¶çš„åˆ—è¡¨
- **`:args æ–‡ä»¶å`**ï¼šä½¿ç”¨æ–°çš„æ–‡ä»¶åæ›¿æ¢å‚æ•°åˆ—è¡¨
- `:next`ï¼ˆå¯ç¼©å†™ä¸º **`:n`**ï¼‰ï¼šæ‰“å¼€ä¸‹ä¸€ä¸ªæ–‡ä»¶ï¼›å¦‚å½“å‰æ–‡ä»¶ä¿®æ”¹ï¼ˆæœªå­˜ç›˜ï¼‰åˆ™ä¼šæŠ¥é”™ä¸­æ­¢ï¼Œä½†å¦‚æœå‘½ä»¤åé¢åŠ  ! åˆ™ä¼šæ”¾å¼ƒä¿®æ”¹å†…å®¹ï¼Œå…¶ä»–å‘½ä»¤ä¹Ÿç±»ä¼¼
- `:Next`ï¼ˆç¼©å†™ **`:N`**ï¼‰æˆ– :previousï¼ˆç¼©å†™ `:prev`ï¼‰ï¼šæ‰“å¼€ä¸Šä¸€ä¸ªæ–‡ä»¶
- `:first` æˆ– `:rewind` ï¼šå›åˆ°åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶
- `:last`ï¼šæ‰“å¼€åˆ—è¡¨ä¸­çš„æœ€åä¸€ä¸ªæ–‡ä»¶



ä½¿ç”¨è¿™äº›å‘½ä»¤ï¼Œæˆ‘ä»¬çš„å·¥ä½œæµå½“ç„¶å°±ä¼šå‘ç”Ÿå˜åŒ–äº†ï¼š

1. åœ¨ç»ˆç«¯é‡Œè¿›å…¥åˆ°ç›®æ ‡ç›®å½•ä¸‹
2. ä½¿ç”¨ `vim *.cpp *.h` æˆ– `gvim *.cpp *.h` æ¥æ‰“å¼€éœ€è¦ç¼–è¾‘çš„æ–‡ä»¶
3. å¯¹äºç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨ä¹‹å‰çš„æ–¹æ³•è´´å…¥æ‰€éœ€çš„æ–‡æœ¬
4. ä½¿ç”¨ V è¿›å…¥è¡Œé€‰æ‹©çš„å¯è§†æ¨¡å¼ï¼Œç§»åŠ¨å…‰æ ‡é€‰ä¸­æ‰€éœ€çš„æ–‡æœ¬ï¼Œç„¶åä½¿ç”¨ y å¤åˆ¶é€‰ä¸­çš„å„è¡Œ
5. æ‰§è¡Œå‘½ä»¤ `:set autowrite`ï¼Œå‘Šè¯‰ Vim åœ¨åˆ‡æ¢æ–‡ä»¶æ—¶è‡ªåŠ¨å­˜ç›˜
6. æ‰§è¡Œå‘½ä»¤ `:n|normal ggP`ï¼Œåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªæ–‡ä»¶å¹¶æ‰§è¡Œæ­£å¸¸æ¨¡å¼å‘½ä»¤ ggPï¼Œè·³è½¬åˆ°æ–‡ä»¶å¼€å¤´å¹¶è´´å…¥æ–‡æœ¬
7. ç¡®è®¤ä¿®æ”¹æ— è¯¯åï¼Œé”®å…¥` :`ã€ä¸Šç®­å¤´å’Œå›è½¦ï¼Œé‡å¤æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤
8. å¾… Vim æŠ¥é”™è¯´å·²ç»åœ¨æœ€åä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œä½¿ç”¨ :w å­˜ç›˜ï¼Œæˆ– :wqï¼ˆæŠ‘æˆ–æ›´å¿«çš„ ZZï¼‰å­˜ç›˜é€€å‡º



ç¬¬ 6 æ­¥å¯ä»¥æ‹†æˆ :n å’Œ ggP ä¸¤æ­¥ï¼Œä½†æ–‡ä»¶æ•°é‡è¾ƒå¤šæ—¶ï¼Œåå¤æ‰‹å·¥æ•² ggP ä¹ŸæŒºç´¯çš„ã€‚å› æ­¤ï¼Œæˆ‘è¿™å„¿ä½¿ç”¨äº† normal å‘½ä»¤ï¼Œåœ¨å‘½ä»¤è¡Œæ¨¡å¼ä¸‹æ‰§è¡Œæ­£å¸¸æ¨¡å¼å‘½ä»¤ï¼Œä¸‹é¢å°±å¯ä»¥ç›´æ¥é‡å¤åˆ‡æ¢å‘½ä»¤åŠ ç²˜è´´å‘½ä»¤ï¼Œæˆ‘ä»¬çš„ç¼–è¾‘æ•ˆç‡ä¹Ÿå¾—ä»¥å¤§å¤§æå‡ã€‚



Vim è¿˜èƒ½è§£å†³ä¸€ä¸ª shell ç›¸å…³çš„ä¸ä¸€è‡´æ€§é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬è¦ç¼–è¾‘çš„æ–‡ä»¶é™¤äº†å½“å‰ç›®å½•ä¸‹çš„ï¼Œè¿˜æœ‰æ‰€æœ‰å­ç›®å½•ä¸‹çš„ï¼Œåœ¨å¤§éƒ¨åˆ† shell ä¸‹ï¼ŒåŒ…æ‹¬ Linux ä¸Šç¼ºçœçš„ Bashï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨â€œ*.cpp *.h **/*.cpp **/*.hâ€æ¥æŒ‘é€‰è¿™äº›æ–‡ä»¶ï¼Œé‡å¤ã€éº»çƒ¦ã€‚Vim åœ¨æ­¤å¤„é‡‡ç”¨äº†ç±»ä¼¼äº Zsh çš„ç®€åŒ–è¯­æ³•ï¼Œâ€œ**â€ä¹ŸåŒ…å«äº†å½“å‰ç›®å½•ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬åªéœ€æŠŠä¸Šé¢ç¬¬ 2 æ­¥æ”¹æˆä¸‹é¢è¿™æ ·å³å¯ï¼š

```bash
vim
args **/*.txt
```



#### ç¼“å†²åŒºçš„ç®¡ç†å’Œåˆ‡æ¢

Vim é‡Œä¼šå¯¹æ¯ä¸€ä¸ªå·²æ‰“å¼€æˆ–è¦æ‰“å¼€çš„æ–‡ä»¶åˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œè¿™ä¸ªç¼“å†²åŒºå°±æ˜¯æ–‡ä»¶åœ¨ Vim ä¸­çš„æ˜ å°„ã€‚åœ¨å¤šæ–‡ä»¶ç¼–è¾‘çš„æ—¶å€™ä½ ä¹Ÿä¼šæœ‰åŒæ ·æ•°é‡çš„ç¼“å†²åŒºã€‚ä¸è¿‡ï¼Œç¼“å†²åŒºçš„æ•°é‡å¸¸å¸¸ä¼šæ›´é«˜ï¼Œå› ä¸ºä½ ç”¨ :e ç­‰å‘½ä»¤æ‰“å¼€çš„æ–‡ä»¶ä¸ä¼šæ”¹å˜â€œå‘½ä»¤è¡Œå‚æ•°â€ï¼ˆåªè¢«å‘½ä»¤è¡Œæˆ– :args å‘½ä»¤ä¿®æ”¹ï¼‰ï¼Œä½†åŒæ ·ä¼šå¢åŠ ç¼“å†²åŒºçš„æ•°é‡ã€‚



æ­¤å¤–ï¼Œ:args ä»£è¡¨å‚æ•°åˆ—è¡¨ / æ–‡ä»¶åˆ—è¡¨ï¼ŒçœŸçš„åªæ˜¯æ–‡ä»¶çš„åˆ—è¡¨è€Œå·²ã€‚ç¼“å†²åŒºä¸­æœ‰æ›´å¤šä¿¡æ¯çš„ï¼Œæœ€æœ€åŸºæœ¬çš„å°±æ˜¯è®°å¿†äº†å…‰æ ‡çš„ä½ç½®ã€‚åœ¨ Vim é‡Œï¼Œé™¤äº†åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªæ–‡ä»¶è¿™æ ·çš„æ‰¹å¤„ç†æ“ä½œå¤–ï¼Œæ“ä½œç¼“å†²åŒºçš„å‘½ä»¤æ¯”ç®€å•æ“ä½œæ–‡ä»¶çš„å‘½ä»¤æ›´ä¸ºæ–¹ä¾¿ã€‚ä½œä¸ºå¯¹æ¯”ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ–‡ä»¶åˆ—è¡¨å’Œç¼“å†²åŒºåˆ—è¡¨

![image-20250610221743636](D:\git_repository\cyber_security_learning\markdown_img\image-20250610221743636.png)

![image-20250610221930287](D:\git_repository\cyber_security_learning\markdown_img\image-20250610221930287.png)

å¯ä»¥çœ‹åˆ°ï¼Œä¸¤è€…éƒ½å±•ç¤ºäº†æ–‡ä»¶ï¼Œéƒ½æ ‡ç¤ºå‡ºäº†å½“å‰ç¼–è¾‘çš„æ–‡ä»¶ï¼ˆåˆ†åˆ«ä½¿ç”¨æ–¹æ‹¬å·å’Œâ€œ%aâ€ï¼‰ã€‚ä¸è¿‡ï¼Œç¼“å†²åŒºåˆ—è¡¨ä¸­æ˜æ˜¾æœ‰æ›´å¤šçš„ä¿¡æ¯ï¼š

- æ–‡ä»¶åå‰é¢æœ‰ç¼–å·ï¼›æˆ‘ä»¬ä¹Ÿé©¬ä¸Šå°±ä¼šè¯´åˆ°åˆ©ç”¨ç¼–å·çš„å‘½ä»¤ã€‚
- é™¤äº†å½“å‰æ´»è·ƒæ–‡ä»¶çš„æ ‡è®°â€œ%aâ€ï¼Œè¿˜æœ‰ä¸ªæ–‡ä»¶è¢«æ ‡æˆäº†â€œ#â€ï¼Œè¿™è¡¨ç¤ºæœ€è¿‘çš„ç¼“å†²åŒºï¼›ç¼“å†²åŒºåˆ—è¡¨é‡Œè¿˜å¯èƒ½æœ‰å…¶ä»–æ ‡è®°ï¼Œå¦‚â€œ+â€è¡¨ç¤ºç¼“å†²åŒºå·²ç»è¢«ä¿®æ”¹ã€‚
- æ–‡ä»¶ååé¢æœ‰è¡Œå·ï¼Œè¡¨ç¤ºå…‰æ ‡åœ¨æ–‡ä»¶ä¸­çš„ä½ç½®ã€‚



å¸¸ç”¨çš„ç¼“å†²åŒºå‘½ä»¤è·Ÿå‰é¢æ–‡ä»¶åˆ—è¡¨ç›¸å…³çš„å‘½ä»¤æœ‰å¾ˆå¤§çš„ç›¸ä¼¼æ€§ï¼Œå› æ­¤æˆ‘åœ¨è¿™å„¿ä¸€èµ·è®²ï¼Œå¯ä»¥å¸®åŠ©ä½ è®°å¿†ï¼š

- `:buffers` æˆ– `:ls`ï¼šå¯ä»¥æ˜¾ç¤ºç¼“å†²åŒºçš„åˆ—è¡¨
- `:buffer ç¼“å†²åŒºåˆ—è¡¨é‡Œçš„ç¼–å·`ï¼ˆ`:buffer` å¯ç¼©å†™ä¸º `:b`ï¼‰ï¼šè·³è½¬åˆ°ç¼–å·å¯¹åº”çš„ç¼“å†²åŒºï¼›å¦‚å½“å‰ç¼“å†²åŒºå·²è¢«ä¿®æ”¹ï¼ˆæœªå­˜ç›˜ï¼‰åˆ™ä¼šæŠ¥é”™ä¸­æ­¢ï¼Œä½†å¦‚æœå‘½ä»¤åé¢åŠ  ! åˆ™ä¼šæ”¾å¼ƒä¿®æ”¹å†…å®¹ï¼›å…¶ä»–å‘½ä»¤ä¹Ÿç±»ä¼¼
- `:bdelete` ç¼“å†²åŒºåˆ—è¡¨é‡Œçš„ç¼–å·ï¼ˆ`:bdelete` å¯ç¼©å†™ä¸º`:bd`ï¼‰ï¼šåˆ é™¤ç¼–å·å¯¹åº”çš„ç¼“å†²åŒºï¼›ç¼–å·çœç•¥çš„è¯åˆ é™¤å½“å‰ç¼“å†²åŒº
- `:bnext`ï¼ˆç¼©å†™ `:bn`ï¼‰ï¼šè·³è½¬åˆ°ä¸‹ä¸€ä¸ªç¼“å†²åŒº
- `:bNext`ï¼ˆç¼©å†™ `:bN`ï¼‰æˆ– :bpreviousï¼ˆç¼©å†™ :bpï¼‰ï¼šè·³è½¬åˆ°ä¸Šä¸€ä¸ªç¼“å†²åŒº
- `:bfirst` æˆ– `:brewind`ï¼šè·³è½¬åˆ°ç¼“å†²åŒºåˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶
- `:blast`ï¼šè·³è½¬åˆ°ç¼“å†²åŒºåˆ—è¡¨ä¸­çš„æœ€åä¸€ä¸ªæ–‡ä»¶



è¿˜æœ‰å¾ˆå¸¸è§çš„ä¸€ç§æƒ…å†µæ˜¯ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸¤ä¸ªæ–‡ä»¶ä¹‹é—´åˆ‡æ¢ã€‚Vim å¯¹æœ€è¿‘ç¼–è¾‘çš„æ–‡ä»¶ï¼ˆä¸Šé¢æåˆ°çš„åˆ—è¡¨é‡Œæ ‡æœ‰â€œ#â€çš„æ–‡ä»¶ï¼‰æœ‰ç‰¹æ®Šçš„æ”¯æŒï¼Œä½¿ç”¨å¿«æ·é”® `<C-^>`å¯ä»¥åœ¨æœ€è¿‘çš„ä¸¤ä¸ªç¼“å†²åŒºä¹‹é—´æ¥å›åˆ‡æ¢ã€‚è¿™ä¸ªå¿«æ·é”®è¿˜æœ‰ä¸€ä¸ªç”¨æ³•æ˜¯åœ¨å‰é¢è¾“å…¥ç¼“å†²åŒºçš„ç¼–å·ï¼šæ¯”å¦‚ï¼Œç”¨ `1<C-^>` å¯ä»¥è·³è½¬åˆ°ç¬¬ä¸€ä¸ªç¼“å†²åŒºï¼ˆè·Ÿå‘½ä»¤è¡Œæ¨¡å¼çš„å‘½ä»¤ `:bfirst` æˆ– `:b1` æ•ˆæœç›¸åŒï¼‰ã€‚



### çª—å£å’Œæ ‡ç­¾é¡µ

#### å¤šçª—å£ç¼–è¾‘







### æ–‡ä»¶ç±»å‹åˆ¤æ–­å’Œå…³è”è®¾å®š

#### æ–‡ä»¶ç±»å‹åˆ¤æ–­

Vim çš„æ–‡ä»¶ç±»å‹åˆ¤æ–­æ˜¯åœ¨ filetype.vim ä¸­æ‰§è¡Œçš„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æ‰“å¼€è¿™ä¸ªæ–‡ä»¶

```bat
:e $VIMRUNTIME/filetype.vim
```







### vimè„šæœ¬

#### æ‰“å°å’Œè¾“å‡ºå­—ç¬¦ä¸²

```bat
echo 'Hello World!'   # echo æ˜¯ Vim ç”¨æ¥æ˜¾ç¤ºä¿¡æ¯çš„å†…ç½®å‘½ä»¤ï¼Œè€Œ 'Hello world!' æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢é‡ã€‚
```

Vim é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨ " æ¥å¼•èµ·ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚' å’Œ " çš„åŒºåˆ«å’Œåœ¨ shell é‡Œæ¯”è¾ƒç›¸ä¼¼ï¼Œå‰è€…é‡Œé¢ä¸å…è®¸æœ‰ä»»ä½•è½¬ä¹‰å­—ç¬¦ï¼Œè€Œåè€…åˆ™å¯ä»¥ä½¿ç”¨å¸¸è§çš„è½¬ä¹‰å­—ç¬¦åºåˆ—ï¼Œå¦‚ \n å’Œ \u.... ç­‰ã€‚å’Œ shell ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ ' æ‹¬èµ·çš„å­—ç¬¦é‡ŒæŠŠ ' é‡å¤ä¸€æ¬¡æ¥å¾—åˆ°è¿™ä¸ªå­—ç¬¦æœ¬èº«ï¼Œå³ `'It''s'` ç›¸å½“äº `"It's"`ã€‚ä¸è¿‡ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæ˜¾ç„¶è¿˜æ˜¯åè€…æ›´æ¸…æ™°äº†ã€‚



å› ä¸º `"` è¿˜æœ‰å¼€å§‹æ³¨é‡Šçš„ä½œç”¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ¨èåœ¨ Vim è„šæœ¬é‡Œä½¿ç”¨ `'`ï¼Œé™¤éä½ éœ€è¦è½¬ä¹‰å­—ç¬¦åºåˆ—æˆ–è€…éœ€è¦æŠŠ `'` æœ¬èº«æ”¾åˆ°å­—ç¬¦ä¸²é‡Œã€‚



å­—ç¬¦ä¸²å¯ä»¥ç”¨ `.` è¿ç®—ç¬¦æ¥æ‹¼æ¥ã€‚ç”±äºå­—å…¸è®¿é—®ä¹Ÿå¯ä»¥ç”¨ `.` ï¼Œä¸ºäº†é¿å…æ­§ä¹‰ï¼ŒBram æ¨èå¼€å‘è€…åœ¨æ–°çš„ Vim è„šæœ¬ä¸­ä½¿ç”¨` .. `æ¥æ‹¼æ¥ã€‚ä½†è¦æ³¨æ„ï¼Œè¿™ä¸ªå†™æ³•åœ¨ Vim 7 åŠä¹‹å‰çš„ç‰ˆæœ¬é‡Œä¸æ”¯æŒã€‚æˆ‘ç›®å‰ä»æš‚æ—¶ä½¿ç”¨ . è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå¹¶å’Œå…¶ä»–å¤§éƒ¨åˆ†è¿ç®—ç¬¦ä¸€æ ·ï¼Œå‰åç©ºä¸€æ ¼ã€‚è¿™æ ·è·Ÿä¸ç©ºæ ¼çš„å­—å…¸ç”¨æ³•æ¯”èµ·æ¥ï¼Œå·®å¼‚å°±ç›¸å½“æ˜æ˜¾äº†ã€‚

```bat
:echo 'hello' . 'world'
# è¾“å‡ºï¼šhelloworld
```





é™¤äº† `echo`ï¼ŒVim è¿˜å¯ä»¥ç”¨ `echomsg`ï¼ˆç¼©å†™ `echom`ï¼‰å‘½ä»¤ï¼Œæ¥æ˜¾ç¤ºä¸€æ¡æ¶ˆæ¯ã€‚è·Ÿ echo ä¸åŒçš„æ˜¯ï¼Œè¿™æ¡æ¶ˆæ¯ä¸ä»…ä¼šæ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œè¿˜ä¼šä¿ç•™åœ¨æ¶ˆæ¯å†å²é‡Œï¼Œå¯ä»¥åœ¨ä¹‹åç”¨ `message` å‘½ä»¤æŸ¥çœ‹



#### å˜é‡

```bat
let answer = 42   # å˜é‡èµ‹å€¼
```

```bash
let a = 'hello'
let b = 'world'
echo a . b
# è¾“å‡ºï¼šhelloworld
```

Vim çš„å˜é‡å¯ä»¥æ‰‹å·¥å–æ¶ˆï¼Œéœ€è¦çš„å‘½ä»¤æ˜¯ `unlet`ã€‚åœ¨ä½ å†™äº† `unlet answer` ä¹‹åï¼Œä½ å°±ä¸èƒ½å†è¯»å– `answer` è¿™ä¸ªå˜é‡äº†ã€‚



#### æ•°å­—

ä¸Šé¢çš„èµ‹å€¼è¯­å¥ç”¨åˆ°äº†æ•´æ•°ã€‚Vim è„šæœ¬é‡Œçš„æ•°å­—æ”¯æŒæ•´æ•°å’Œæµ®ç‚¹æ•°ï¼Œåœ¨å¤§éƒ¨åˆ†å¹³å°ä¸Šï¼Œä¸¤è€…éƒ½æ˜¯ 64 ä½çš„æœ‰ç¬¦å·æ•°å­—ç±»å‹ï¼ŒåŸºæœ¬å¯¹åº”äºå¤§éƒ¨åˆ† C è¯­è¨€ç¯å¢ƒé‡Œçš„ int64_t å’Œ doubleã€‚è¡¨ç¤ºæ–¹å¼ä¹Ÿå’Œ C é‡Œé¢å·®ä¸å¤šï¼šæ•´æ•°å¯ä»¥ä½¿ç”¨ 0ï¼ˆå…«è¿›åˆ¶ï¼‰ã€0bï¼ˆäºŒè¿›åˆ¶ï¼‰å’Œ 0xï¼ˆåå…­è¿›åˆ¶ï¼‰å‰ç¼€ï¼›æµ®ç‚¹æ•°å«å°æ•°ç‚¹ï¼ˆä¸å¯çœç•¥ï¼‰ï¼Œå¯é€‰ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ã€‚



#### å¤æ‚æ•°æ®ç»“æ„

##### åˆ—è¡¨ï¼ˆlistï¼‰

```js
let primes = [2, 3, 5, 7, 11, 13, 17, 19]
echo primes[0]  // è¾“å‡ºï¼š2
```



##### å­—å…¸ï¼ˆmapï¼‰

```bat
let int_squares = {
      \0: 0,         # \æ˜¯ç»­è¡Œï¼Œä¸‹ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªéç©ºç™½å­—ç¬¦å¦‚æœæ˜¯ \ï¼Œåˆ™è¡¨ç¤ºè¿™ä¸€è¡Œè·Ÿä¸Šä¸€è¡Œåœ¨é€»è¾‘ä¸Šæ˜¯åŒä¸€è¡Œ
      \1: 1,
      \2: 4,
      \3: 9,
      \4: 16,
      \}
      
# è®¿é—®
int_squares['2']
int_squares.2       # äºŒè€…ç­‰ä»·
```



#### è¡¨è¾¾å¼

åœ¨æ’å…¥æ¨¡å¼å’Œå‘½ä»¤è¡Œæ¨¡å¼ä¸‹éƒ½å¯ä»¥ä½¿ç”¨æŒ‰é”® `<C-R>=`ï¼ˆä¸¤ä¸ªé”®ï¼‰åé¢è·Ÿä¸€ä¸ªè¡¨è¾¾å¼æ¥ä½¿ç”¨è¡¨è¾¾å¼çš„ç»“æœ

åœ¨æ›¿æ¢å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬åœ¨ `\=` åé¢ä¹ŸåŒæ ·å¯ä»¥è·Ÿä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ¥è¡¨ç¤ºä½¿ç”¨è¯¥è¡¨è¾¾å¼çš„ç»“æœã€‚

```bat
:%s/^/\=line('.') . ' '/    # åœ¨å½“å‰ç¼–è¾‘æ–‡ä»¶çš„æ¯ä¸€è¡Œå‰é¢æ’å…¥è¡Œå·å’Œç©ºæ ¼; line æ˜¯ Vim çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œline('.') è¡¨ç¤ºâ€œå½“å‰â€è¡Œçš„è¡Œå·
```





#### æ§åˆ¶ç»“æ„

Vim æ”¯æŒæ ‡å‡†çš„ `if`ã€`while` å’Œ `for` è¯­å¥ã€‚

Vim çš„å†™æ³•æœ‰ç‚¹è€æ´¾ï¼Œæ¯ç§ç»“æ„éƒ½è¦ç”¨ä¸€ä¸ªå¯¹åº”çš„ endifã€endwhile å’Œ endfor æ¥ç»“æŸï¼Œå¦‚ä¸‹é¢æ‰€ç¤ºï¼š

```bat
" ç®€å•æ¡ä»¶è¯­å¥
if è¡¨è¾¾å¼
  è¯­å¥
endif

" æœ‰ else åˆ†æ”¯çš„æ¡ä»¶è¯­å¥
if è¡¨è¾¾å¼
  è¯­å¥
else
  è¯­å¥
endif

" æ›´å¤æ‚çš„æ¡ä»¶è¯­å¥
if è¡¨è¾¾å¼
  è¯­å¥
elseif è¡¨è¾¾å¼
  è¯­å¥
else
  è¯­å¥
endif

" å¾ªç¯è¯­å¥
while è¡¨è¾¾å¼
  è¯­å¥
endwhile
```

åœ¨ while å’Œ for å¾ªç¯è¯­å¥é‡Œï¼Œä½ å¯ä»¥ä½¿ç”¨ break æ¥é€€å‡ºå¾ªç¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ continue æ¥è·³è¿‡å¾ªç¯ä½“å†…çš„å…¶ä»–è¯­å¥ã€‚



Vim è„šæœ¬çš„ for è¯­å¥è·Ÿ Python éå¸¸ç›¸ä¼¼ï¼Œå½¢å¼æ˜¯ï¼š

```bat
for var in object  // è¡¨ç¤ºéå† objectï¼ˆé€šå¸¸æ˜¯ä¸ªåˆ—è¡¨ï¼‰å¯¹è±¡é‡Œé¢çš„æ‰€æœ‰å…ƒç´ ã€‚
  è¿™å„¿å¯ä»¥ä½¿ç”¨ var
endfor
```



#### å‡½æ•°å’ŒåŒ¿åå‡½æ•°

Vim è„šæœ¬é‡Œå®šä¹‰å‡½æ•°ä½¿ç”¨ä¸‹é¢çš„è¯­æ³•ï¼š

```bat
function å‡½æ•°å(å‚æ•°1, å‚æ•°2, ...)
  å‡½æ•°å†…å®¹
endfunction
```

Vim é‡Œç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°å¿…é¡»é¦–å­—æ¯å¤§å†™ï¼ˆå’Œå†…ç½®å‡½æ•°ç›¸åŒºåˆ«ï¼‰æˆ–è€…ä½¿ç”¨ `s:` è¡¨ç¤ºè¯¥å‡½æ•°åªåœ¨å½“å‰è„šæœ¬æ–‡ä»¶æœ‰æ•ˆã€‚`...` å¯ä»¥å‡ºç°åœ¨å‚æ•°åˆ—è¡¨çš„ç»“å°¾ï¼Œè¡¨ç¤ºå¯ä»¥ä¼ é€’é¢å¤–çš„æ— åå‚æ•°ã€‚ä½¿ç”¨æœ‰åå­—çš„å‚æ•°æ—¶ï¼Œä½ éœ€è¦åŠ ä¸Š `a:` å‰ç¼€ã€‚è¦è®¿é—®é¢å¤–å‚æ•°ï¼Œåˆ™éœ€è¦ä½¿ç”¨ `a:1`ã€`a:2` è¿™æ ·çš„å½¢å¼ã€‚ç‰¹æ®Šåå­— `a:0` è¡¨ç¤ºé¢å¤–å‚æ•°çš„æ•°é‡ï¼Œ`a:000` è¡¨ç¤ºæŠŠé¢å¤–å‚æ•°å½“æˆåˆ—è¡¨æ¥ä½¿ç”¨ï¼Œå› è€Œ `a:000[0]` å°±ç›¸å½“äº `a:1`ã€‚



åœ¨å‡½æ•°é‡Œé¢ï¼Œè·Ÿå¤§éƒ¨åˆ†è¯­è¨€ä¸€æ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨ return å‘½ä»¤è¿”å›ä¸€ä¸ªç»“æœï¼Œæˆ–æå‰ç»“æŸå‡½æ•°çš„æ‰§è¡Œã€‚



##### åŒ¿åå‡½æ•°

im è„šæœ¬é‡Œå…è®¸åŒ¿åå‡½æ•°ï¼Œå½¢å¼æ˜¯ {é€—å·åˆ†éš”å¼€çš„å‚æ•° -> è¡¨è¾¾å¼}ã€‚

```bat
echo map(range(1, 5), {idx, val -> val * val})

# rang(1,5) = [1,2,3,4,5]
# idxä¸ºåˆ—è¡¨çš„ç´¢å¼•ï¼Œvalæ˜¯åˆ—è¡¨çš„å€¼
```



#### vimç‰¹æ€§

##### å˜é‡çš„å‰ç¼€

- `a:` è¡¨ç¤ºè¿™ä¸ªå˜é‡æ˜¯å‡½æ•°å‚æ•°ï¼Œåªèƒ½åœ¨å‡½æ•°å†…ä½¿ç”¨ã€‚
- `g:` è¡¨ç¤ºè¿™ä¸ªå˜é‡æ˜¯å…¨å±€å˜é‡ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è®¿é—®ã€‚
- `l:` è¡¨ç¤ºè¿™ä¸ªå˜é‡æ˜¯æœ¬åœ°å˜é‡ï¼Œä½†ä¸€èˆ¬è¿™ä¸ªå‰ç¼€ä¸éœ€è¦ä½¿ç”¨ï¼Œé™¤éä½ è·Ÿç³»ç»Ÿçš„æŸä¸ªåå­—å‘ç”Ÿäº†å†²çªã€‚
- `s:`è¡¨ç¤ºè¿™ä¸ªå˜é‡ï¼ˆæˆ–å‡½æ•°ï¼Œå®ƒä¹Ÿèƒ½ç”¨åœ¨å‡½æ•°ä¸Šï¼‰åªèƒ½ç”¨äºå½“å‰è„šæœ¬ï¼Œæœ‰ç‚¹åƒ C é‡Œé¢çš„ static å˜é‡å’Œå‡½æ•°ï¼Œåªåœ¨å½“å‰è„šæœ¬æ–‡ä»¶æœ‰æ•ˆï¼Œå› è€Œä¸ä¼šå½±å“å…¶ä»–è„šæœ¬æ–‡ä»¶é‡Œå®šä¹‰çš„æœ‰å†²çªçš„åå­—ã€‚





##### é‡è¦å‘½ä»¤







## æ­£åˆ™è¡¨è¾¾å¼



### æ­£åˆ™è¡¨è¾¾å¼çš„ä¸‰ä¸ªæµæ´¾

#### POSIX æµæ´¾çš„æ­£åˆ™è¡¨è¾¾å¼

- **BREæ ‡å‡†**

  > ä¸‹åˆ—å­—ç¬¦ç”¨åˆ°ä¸»è¦è½¬ç§»ï¼š()ï¼Œ+ï¼Œ*ï¼Œï¼Ÿï¼Œ{}



- **EREæ ‡å‡†**



#### POSIX å­—ç¬¦ç»„

![img](https://static001.geekbang.org/resource/image/c3/ya/c32024952cb6af3f78d9c08d9b5b3yya.png?wh=1162*1022)

#### Perlå…¼å®¹æ­£åˆ™è¡¨è¾¾å¼

åœ¨ 1987 å¹´ 12 æœˆï¼ŒLarry Wall å‘å¸ƒäº† Perl è¯­è¨€ç¬¬ä¸€ç‰ˆï¼Œå› å…¶åŠŸèƒ½å¼ºå¤§ä¸€ç¥¨èµ°çº¢ï¼Œæ‰€å¼•å…¥çš„æ­£åˆ™è¡¨è¾¾å¼åŠŸèƒ½å¤§æ”¾å¼‚å½©ã€‚ä¹‹å Perl è¯­è¨€ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ä¸æ–­æ”¹è¿›ï¼Œå½±å“è¶Šæ¥è¶Šå¤§ã€‚äºæ˜¯åœ¨æ­¤åŸºç¡€ä¸Šï¼Œ1997 å¹´åˆè¯ç”Ÿäº†PCREâ€”â€”Perl å…¼å®¹æ­£åˆ™è¡¨è¾¾å¼ï¼ˆPerl Compatible Regular Expressionsï¼‰ã€‚

PCRE æ˜¯ä¸€ä¸ªå…¼å®¹ Perl è¯­è¨€æ­£åˆ™è¡¨è¾¾å¼çš„è§£æå¼•æ“ï¼Œæ˜¯ç”± Philip Hazel å¼€å‘çš„ï¼Œä¸ºå¾ˆå¤šç°ä»£è¯­è¨€å’Œå·¥å…·æ‰€æ™®éä½¿ç”¨ã€‚é™¤äº† Unix ä¸Šçš„å·¥å…·éµå¾ª POSIX æ ‡å‡†ï¼Œ**PCRE ç°å·²æˆä¸ºå…¶ä»–å¤§éƒ¨åˆ†è¯­è¨€å’Œå·¥å…·éšç„¶éµå¾ªçš„æ ‡å‡†ã€‚**









### å•å­—ç¬¦

.ï¼šä»»æ„å­—ç¬¦ï¼ˆ\né™¤å¤–ï¼‰

```bash
echo -e "abc\ndef" | grep -E "a.*f"
```

**ä¸ä¼šåŒ¹é…æˆåŠŸ**ï¼Œå› ä¸º `.` æ— æ³•è·¨è¶Šæ¢è¡Œç¬¦ `\n`ã€‚



\d ï¼šæ•°å­—

\w ï¼š æ•°å­—ï¼Œå­—æ¯ï¼Œä¸‹åˆ’çº¿

\sï¼šç©ºç™½å­—ç¬¦



åº•çº¿ï¼šç”¨å¤šé€‰ä¸€è¡¨è¾¾\dï¼Œ\w

[ ]ï¼šå¤šé€‰ä¸€

[^ ]ï¼šå–åï¼Œåªæœ‰åœ¨ä¸­æ‹¬å·é‡Œæ˜¯å–åçš„æ„æ€ï¼Œæ³¨æ„ä¸è¦å’Œæ–­è¨€æ··æ·†



### é‡è¯

`*` ï¼š0åˆ°å¤šä¸ª

`+` : 1åˆ°å¤šä¸ª

`?`ï¼š0åˆ°1ä¸ª

{N}ï¼šNä¸ª

{M,N}ï¼šMåˆ°Nä¸ª



### æ–­è¨€

^ï¼šå¼€å¤´æ–­è¨€

$ï¼šç»“å°¾æ–­è¨€

\bï¼šå•è¯æ–­è¨€



ç¯è§†



### åˆ†ç»„å¼•ç”¨

æŠ€å·§ï¼šæ ¹æ®å·¦æ‹¬å·åˆ¤æ–­\numä¸­çš„æ•°å­—

```bash
[root@magedu ~]# echo forwardfor|grep -P "((for)(ward))\2"
forwardfor
[root@magedu ~]# echo forwardward|grep -P "((for)(ward))\3"
forwardward
[root@magedu ~]# echo forwardforward|grep -P "((for)(ward))\1"
forwardforward
```



[root@magedu ~]# echo "abc def" | sed -E 's/(abc) (def)/\1-&/'ï¼ˆ& == \0ï¼‰
abc-abc def





### æ¨¡å¼

g global å…¨å‘˜



i å¸¦å¤§å°å†™ä¸æ•æ„Ÿ









## ä¸‰å‰‘å®¢



grep, sed, awkéƒ½æ˜¯è¡Œå¤„ç†å·¥å…·



### grep

è¿‡æ»¤



-oï¼šåªè¾“å‡ºåŒ¹é…åˆ°çš„

-Eï¼šERE

-Pï¼šperlå…¼å®¹æ­£åˆ™è¡¨è¾¾å¼

-vï¼šå–å

-iï¼šå¤§å°å†™ä¸æ•æ„Ÿ

-nï¼šæ˜¾ç¤ºè¡Œå·

-rï¼šé€’å½’



--------------------------------------------------

-Anum   åŒ¹é…åˆ°çš„è¡ŒåŠä¹‹åå‡ è¡Œ



-Bnum   åŒ¹é…åˆ°çš„è¡ŒåŠä¹‹å‰å‡ è¡Œ



-Cnum   åŒ¹é…åˆ°çš„è¡ŒåŠä¹‹å‰åå‡ è¡Œ







### sed

è¯­æ³•ï¼š**sed   [é€‰é¡¹]   'å¤„ç†åŠ¨ä½œ'   file**

â€‹            å¤„ç†åŠ¨ä½œ = èŒƒå›´ + åŠ¨ä½œ ï¼ˆå¯¹å“ªäº›èŒƒå›´ï¼Œåšå“ªäº›åŠ¨ä½œï¼‰

â€‹            **sed [é€‰é¡¹] 'èŒƒå›´ + åŠ¨ä½œ'  file**  ï¼Œè¿™é‡Œçš„åŠ¨ä½œæŒ‡çš„æ˜¯å¯¹æ¨¡å¼ç©ºé—´çš„åŠ¨ä½œ









åŸºç¡€ç»“æ„

```bash
sed '' passwd    #é»˜è®¤è¾“å‡ºæ¯ä¸€è¡Œ

sed -n '' passwd    # é™åˆ¶è¾“å‡ºï¼Œå³ä½¿ç”¨äº† -nï¼Œæ¯ä¸€è¡Œè¿˜æ˜¯ä¼šè¢«è¯»å–è¿›æ¨¡å¼ç©ºé—´ï¼Œåªæ˜¯ä¸è¾“å‡ºè€Œå·²ã€‚

sed -n 'p' passwd   # å°†æ¨¡å¼ç©ºé—´ä¸­åŒ¹é…çš„è¾“å‡ºå‡ºæ¥ï¼Œä¸å†™èŒƒå›´ï¼Œé»˜è®¤å…¨æ–‡åŒ¹é…

# è¾“å‡ºç¬¬2è¡Œ
[root@magedu ~]# sed -n '2p' /etc/passwd
bin:x:1:1:bin:/bin:/sbin/nologin

```





é€‰é¡¹

-n

-E/-r

-iï¼šæ”¹å˜æºæ–‡ä»¶

-i.bakï¼šå¤‡ä»½



èŒƒå›´çš„æ ¼å¼ï¼š

- Nï¼šä»£è¡¨ç¬¬å‡ è¡Œ
- N,Mï¼šnåˆ°mè¡Œ

- /pattern/ï¼šè¾“å‡ºåŒ¹é…çš„è¡Œ

- /pattern1/,/pattern2/



åŠ¨ä½œï¼š

pï¼šæ‰“å°

s@@@ï¼šæ›¿æ¢             æ¨¡å¼ï¼šg,i

a\ -------------- å‘ä¸‹ä¸€è¡Œè¿½åŠ 

i\ ---------- å‘å‰ä¸€è¡Œè¿½åŠ 

c\ --------- æ›¿æ¢æ•´è¡Œ

d ------ åˆ é™¤





### awk

è¯­æ³•ï¼šawk  [é€‰é¡¹]  'å¤„ç†åŠ¨ä½œ' file

â€‹            åŠ¨ä½œï¼šåˆ¤æ–­ + åŠ¨ä½œ

åŸºæœ¬æ ¼å¼

```bash
# ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œåˆ™æ²¡æ¡ä»¶ï¼Œä¹Ÿæ²¡åŠ¨ä½œ
[root@magedu ~]# seq 5 |awk ''

# åªç»™ä¸€ä¸ªåŠ¨ä½œï¼Œé»˜è®¤ä¸ºçœŸ
[root@magedu ~]# seq 5 |awk '{print}'
1
2
3
4
5

# awkæ‰§è¡Œé»˜è®¤åŠ¨ä½œ {print $0}
[root@magedu ~]# seq 5 | awk '1'
1
2
3
4
5


```



é€‰é¡¹ï¼š

-v ï¼šå˜é‡

-Fï¼šåˆ†éš”ç¬¦ï¼Œç­‰ä»·äº-v FS=''

> -v FS=":" = -F:



å˜é‡ï¼š

O: output

F: field å­—æ®µï¼ˆåˆ—ï¼‰

R: record è®°å½•ï¼ˆè¡Œï¼‰

Sï¼š Separator    åˆ†éš”

Nï¼šnumber æ•°å­—ï¼Œå·



FSï¼šField Separator   å­—æ®µåˆ†éš”ç¬¦



NFï¼šå­—æ®µå·

NRï¼šè¡Œå·

RSï¼šè¡Œåˆ†éš”

OFSï¼šoutput Field Separaotr ï¼šè¾“å‡ºå­—æ®µåˆ†éš”ç¬¦





åˆ¤æ–­+åŠ¨ä½œï¼š

print

```bash
# awkä¸­å˜é‡æœªå®šä¹‰ï¼Œé»˜è®¤æ˜¯0
seq 10|awk 'i=!i'   # æ³¨æ„è¿™é‡Œ=æ˜¯èµ‹å€¼ï¼Œä¸æ˜¯æ¯”è¾ƒ
```



å¤„ç†é¡ºåº

seq 10|awk 'BEGIN{}{}END{}'





# ç¬¬Nå¤©ï¼ˆShellï¼‰

```bash
>|        #  å¼ºåˆ¶è¦†ç›–ï¼ˆå…è®¸åœ¨set -Cçš„æƒ…å†µä¸‹ï¼Œå¼ºåˆ¶è¦†ç›–ï¼‰
```

```bash
set -C ç¦æ­¢å°†å†…å®¹è¦†ç›–å·²æœ‰æ–‡ä»¶ï¼Œä½†å¯è¿½åŠ 
set +C å…è®¸è¦†ç›–ï¼Œé»˜è®¤

# è¯¥çŸ¥è¯†ç‚¹ä»…ä½œäº†è§£
```









# wireshark åŸºæœ¬ç”¨æ³•





## å¦‚ä½•æ•è·æŠ¥æ–‡

- **ç‚¹å‡»æ•è· -> é€‰é¡¹ï¼Œæ‰“å¼€æ•è·çª—å£**
  - ç½‘å¡è®¾å¤‡/æµé‡/æ•è·è¿‡æ»¤å™¨ï¼Œç‚¹å‡»â€œå¼€å§‹â€æŒ‰é’®å¼€å§‹æŠ“åŒ…
- **ç‚¹å‡»æ•è· -> åœæ­¢ï¼Œåœæ­¢æŠ“åŒ…**

![image-20250619174044113](D:\git_repository\cyber_security_learning\markdown_img\image-20250619174044113.png)





### è¾“å‡º

æ•è·åˆ°çš„æ•°æ®ï¼Œè¦ä¹ˆä¿å­˜åˆ°ä¸´æ—¶æ–‡ä»¶ï¼Œè¦ä¹ˆä¿å­˜åˆ°æ°¸ä¹…æ–‡ä»¶ä¸­

- å¦‚æœè¦ä¿å­˜åˆ°**æ°¸ä¹…æ–‡ä»¶**ä¸­ï¼Œå¯ä»¥æŒ‡å®šå¥½è¦ä¿å­˜çš„è·¯å¾„åŠæ–‡ä»¶å

- å¦‚æœæ˜¯**ä¸´æ—¶æ–‡ä»¶**ï¼Œå¯ä»¥ç‚¹å‡»è‡ªåŠ¨åˆ›å»ºæ–°æ–‡ä»¶ï¼Œç»è¿‡å¤šå°‘ç§’æˆ–è€…å¤šå°‘å­—èŠ‚ï¼Œè‡ªåŠ¨æ¢ä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå¹¶ä¸æ–­æ–°å¢

  > æŠ“åŒ…æ•°æ®è¢«å…ˆå†™å…¥ä¸€ä¸ªä¸´æ—¶åŒºåŸŸï¼ˆé€šå¸¸æ˜¯å†…å­˜æˆ–ç£ç›˜ä¸­çš„ä¸´æ—¶æ–‡ä»¶ï¼‰ï¼Œå½“ä½ â€œåœæ­¢æ•è·â€æ—¶ï¼Œå·¥å…·æ‰ä¼šæç¤ºä½ æ˜¯å¦ä¿å­˜è¿™ä¸ªä¸´æ—¶å†…å®¹ä¸ºæ­£å¼æ–‡ä»¶ã€‚

- ç¯å½¢ç¼“å†²åŒºï¼ˆring bufferï¼‰æœºåˆ¶æœ¬èº«åªæ˜¯é™åˆ¶æ–‡ä»¶ä¸ªæ•°ï¼Œå¹¶ä¸ä¼šä¸»åŠ¨è§¦å‘æ–‡ä»¶è½®è½¬ï¼›ä½ éœ€è¦é…åˆâ€œè‡ªåŠ¨åˆ›å»ºæ–°æ–‡ä»¶â€è®¾ç½®ï¼ˆåŸºäºæ—¶é—´æˆ–å¤§å°ï¼‰æ¥å®ç°ç¯å½¢å†™å…¥æ•ˆæœã€‚

![image-20250619174915407](D:\git_repository\cyber_security_learning\markdown_img\image-20250619174915407.png)



### é€‰é¡¹

é€‰é¡¹ä¸»è¦ä½œç”¨æ˜¯å†³å®šå¤šé•¿æ—¶é—´æˆ–è€…å¤šå°‘æ–‡ä»¶æˆ–è€…å¤šå°‘æ•°æ®åï¼Œè‡ªåŠ¨åœæ­¢æ•è·ã€‚ä»¥åŠæ˜¯å¦è§£æåç§°

![image-20250619175521009](D:\git_repository\cyber_security_learning\markdown_img\image-20250619175521009.png)

å„ä¸ªåç§°è§£æé€‰é¡¹å«ä¹‰ä¸ç¤ºä¾‹ï¼š

**`Resolve MAC addresses`ï¼ˆå·²å¯ç”¨ï¼‰**

- **ä½œç”¨**ï¼šå°† MAC åœ°å€è½¬æ¢ä¸ºå¯¹åº”å‚å•†çš„åç§°ï¼ˆæ ¹æ® OUI æ•°æ®åº“ï¼‰

  | åŸå§‹å­—æ®µ            | è§£æå            |
  | ------------------- | ----------------- |
  | `00:1C:42:00:00:08` | `Parallels, Inc.` |
  | `00:0C:29:5B:A4:21` | `VMware, Inc.`    |



**`Resolve network names`**

- **ä½œç”¨**ï¼šå°† IP åœ°å€è§£ææˆä¸»æœºåï¼ˆDNS æˆ–æœ¬åœ°è§£æï¼‰

  | åŸå§‹ IP       | è§£æå                             |
  | ------------- | ---------------------------------- |
  | `8.8.8.8`     | `dns.google`                       |
  | `192.168.1.1` | `router.local`ï¼ˆå¦‚æœä¸»æœºåå¯è§£æï¼‰ |

âš ï¸ æ³¨æ„ï¼š**å¯ç”¨åå¯èƒ½é€ æˆæŠ“åŒ…æ—¶å¡é¡¿**ï¼Œå› ä¸ºå®ƒå¯èƒ½è§¦å‘å®é™…çš„ DNS æŸ¥è¯¢ï¼



 **`Resolve transport names`**

- **ä½œç”¨**ï¼šå°†ç«¯å£å·è§£ææˆå¸¸è§åè®®åï¼ˆåŸºäº `/etc/services` æˆ–å†…ç½®æ˜ å°„ï¼‰

  | åŸå§‹ç«¯å£ | åè®®å  |
  | -------- | ------- |
  | `443`    | `HTTPS` |
  | `53`     | `DNS`   |
  | `22`     | `SSH`   |







## wireshark é¢æ¿

![image-20250619180200930](D:\git_repository\cyber_security_learning\markdown_img\image-20250619180200930.png)







### å¿«æ·æ–¹å¼å·¥å…·æ 

![image-20250619180505886](D:\git_repository\cyber_security_learning\markdown_img\image-20250619180505886.png)



### æ•°æ®åŒ…çš„é¢œè‰²ï¼ˆè§†å›¾->ç€è‰²è§„åˆ™ï¼‰

![image-20250619181042041](D:\git_repository\cyber_security_learning\markdown_img\image-20250619181042041.png)







### è®¾å®šæ—¶é—´æ˜¾ç¤ºæ ¼å¼

**ç»å¯¹æ—¶é—´**

![image-20250619181321755](D:\git_repository\cyber_security_learning\markdown_img\image-20250619181321755.png)

**ç›¸å¯¹æ—¶é—´**

![image-20250619181358844](D:\git_repository\cyber_security_learning\markdown_img\image-20250619181358844.png)



**åŸºäºæŸä¸ªæ•°æ®åŒ…çš„ç›¸å¯¹æ—¶é—´**

![image-20250619181459082](D:\git_repository\cyber_security_learning\markdown_img\image-20250619181459082.png)







### æ•°æ®åŒ…åˆ—è¡¨é¢æ¿çš„æ ‡è®°ç¬¦å·

![image-20250619181645488](D:\git_repository\cyber_security_learning\markdown_img\image-20250619181645488.png)





## æ•è·è¿‡æ»¤å™¨













## æ˜¾ç¤ºè¿‡æ»¤å™¨





























































