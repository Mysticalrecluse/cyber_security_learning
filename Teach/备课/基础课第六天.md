## æ·±å…¥ç†è§£ç›®å½•ä¸æ–‡ä»¶

### Inodeè¯¦è§£

#### è®¤è¯†Inode

```C
struct inode {
    umode_t i_mode;                 // æ–‡ä»¶çš„ç±»å‹å’Œæƒé™ï¼ˆå¦‚æ–‡ä»¶ã€ç›®å½•ã€ç¬¦å·é“¾æ¥ç­‰ï¼‰
    unsigned short i_opflags;
    kuid_t i_uid;                   // æ–‡ä»¶çš„ç”¨æˆ· IDï¼ˆæ‰€æœ‰è€…ï¼‰
    kgid_t i_gid;                   // æ–‡ä»¶çš„ç»„ IDï¼ˆæ‰€å±ç»„ï¼‰
    unsigned int i_flags;
    struct timespec64 i_atime;      // æœ€åè®¿é—®æ—¶é—´
    struct timespec64 i_mtime;      // æœ€åä¿®æ”¹æ—¶é—´
    struct timespec64 i_ctime;      // å…ƒæ•°æ®æœ€åä¿®æ”¹æ—¶é—´
    unsigned int i_nlink;           // ç¡¬é“¾æ¥æ•°
    blkcnt_t i_blocks;              // åˆ†é…ç»™è¯¥æ–‡ä»¶çš„å—æ•°
    loff_t i_size;                  // æ–‡ä»¶çš„å¤§å°ï¼ˆå­—èŠ‚ï¼‰
    
    struct super_block *i_sb;       // æŒ‡å‘è¶…çº§å—çš„æŒ‡é’ˆ
    struct address_space *i_mapping;// å…³è”æ–‡ä»¶æ•°æ®çš„åœ°å€ç©ºé—´
    // ... å…¶ä»–æˆå‘˜
};
```

- inode æ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œå®ƒåŒ…å«äº†å¤šç§ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„å…ƒæ•°æ®å’ŒæŒ‡å‘æ•°æ®å—çš„æŒ‡é’ˆã€‚å› æ­¤ï¼Œinode çš„ä¸»è¦ä½œç”¨æ˜¯ç®¡ç†æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯æŒ‡å‘æ–‡ä»¶çš„ç‰©ç†ä½ç½®ã€‚
- node ä¸­åŒ…å«å¤šä¸ªæŒ‡é’ˆï¼šinode ä¸­åŒ…å«äº†å¤šä¸ªæŒ‡å‘ç£ç›˜ä¸Šæ•°æ®å—çš„æŒ‡é’ˆï¼Œç”¨æ¥å®šä½æ–‡ä»¶çš„å®é™…å†…å®¹ã€‚æ–‡ä»¶çš„å¤§å°å†³å®šäº†éœ€è¦å¤šå°‘ä¸ªæ•°æ®å—æ¥å­˜å‚¨æ–‡ä»¶å†…å®¹ï¼Œè€Œ inode ç»“æ„ä¸­çš„æŒ‡é’ˆå¸®åŠ©æ–‡ä»¶ç³»ç»Ÿæ‰¾åˆ°è¿™äº›æ•°æ®å—

![image-20250604130652102](D:\git_repository\cyber_security_learning\markdown_img\image-20250604130652102-1752042405570-1.png)





#### è®¤è¯†Inodeè¡¨

å½“åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿä¼šåœ¨ inode è¡¨ ä¸­åˆ†é…ä¸€ä¸ª inodeï¼Œå¹¶ä¸ºè¯¥æ–‡ä»¶ç”Ÿæˆä¸€ä¸ª inode ç»“æ„ä½“ï¼Œå­˜å‚¨è¯¥æ–‡ä»¶çš„å…ƒæ•°æ®ã€‚è¿™äº› inode æ˜¯åœ¨ æ–‡ä»¶ç³»ç»Ÿåˆå§‹åŒ–æ—¶ï¼ˆé€šå¸¸æ˜¯æ ¼å¼åŒ–æ—¶ï¼‰é¢„ç•™çš„ï¼Œä¿å­˜åœ¨ç£ç›˜ä¸Šçš„ inode è¡¨ä¸­ã€‚
è¯¦ç»†è¿‡ç¨‹

- æ–‡ä»¶ç³»ç»Ÿåˆå§‹åŒ–ï¼ˆæ ¼å¼åŒ–ï¼‰ï¼š
  - å½“æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚ ext4ï¼‰è¢«åˆå§‹åŒ–æˆ–æ ¼å¼åŒ–æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿä¼šåœ¨ç£ç›˜ä¸Šåˆ’åˆ†å‡ºä¸€å®šçš„ç©ºé—´ï¼Œç”¨æ¥å­˜å‚¨ inode è¡¨ã€‚
  - inode è¡¨ä¸­çš„ inode æ•°é‡æ˜¯æœ‰é™çš„ï¼Œæ˜¯åœ¨æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºæ—¶ç¡®å®šçš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿå¹¶æŒ‡å®š 10,000 ä¸ª inodeï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿæœ€å¤šåªèƒ½æ”¯æŒ 10,000 ä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼ˆå³ä½¿ç£ç›˜ç©ºé—´æ²¡æœ‰ç”¨å®Œï¼‰ã€‚
  - inode è¡¨ä¼šè¢«åˆ†é…å›ºå®šå¤§å°çš„ç©ºé—´ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª inode å¤§çº¦å ç”¨ 128 æˆ– 256 å­—èŠ‚ï¼Œè¿™å–å†³äºæ–‡ä»¶ç³»ç»Ÿçš„é…ç½®ã€‚æ ¼å¼åŒ–æ—¶ä¼šè®¡ç®— inode è¡¨æ‰€éœ€çš„ç©ºé—´ï¼Œå¹¶åœ¨ç£ç›˜ä¸Šé¢„ç•™è¿™äº›ç©ºé—´ã€‚

- åˆ›å»ºæ–‡ä»¶æ—¶çš„ inode åˆ†é…ï¼š
  - æ¯å½“ä½ åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿä¼šä» inode è¡¨ä¸­åˆ†é…ä¸€ä¸ªç©ºé—²çš„ inodeï¼Œç”¨äºå­˜å‚¨è¯¥æ–‡ä»¶çš„å…ƒæ•°æ®ã€‚
  - inode åˆ†é…åï¼Œæ–‡ä»¶ç³»ç»Ÿä¼šå°†æ–‡ä»¶çš„ç›¸å…³å…ƒæ•°æ®ï¼ˆå¦‚æƒé™ã€æ‰€æœ‰è€…ã€æ—¶é—´æˆ³ã€æ•°æ®å—æŒ‡é’ˆç­‰ï¼‰å¡«å…¥è¯¥ inodeï¼Œå¹¶æ›´æ–°æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•é¡¹ï¼Œå°†æ–‡ä»¶åä¸è¯¥ inode å…³è”ã€‚
  - éšç€æ–‡ä»¶çš„å¢åŠ ï¼Œinode è¡¨ä¸­çš„ç©ºé—² inode é€æ¸å‡å°‘ï¼›ä¸€æ—¦ inode è€—å°½ï¼Œæ–‡ä»¶ç³»ç»Ÿå°†æ— æ³•åˆ›å»ºæ–°æ–‡ä»¶æˆ–ç›®å½•ï¼Œå°½ç®¡ç£ç›˜ä¸Šå¯èƒ½è¿˜æœ‰å‰©ä½™ç©ºé—´ã€‚

- inode è¡¨çš„æœ‰é™æ€§ï¼š
  - inode è¡¨åœ¨æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºæ—¶ç¡®å®šå¤§å°ï¼Œä¹‹åé€šå¸¸ä¸å¯åŠ¨æ€è°ƒæ•´ã€‚è¿™æ„å‘³ç€æ–‡ä»¶ç³»ç»Ÿå¯ä»¥å­˜å‚¨çš„æ–‡ä»¶æ•°é‡å—é™äº inode æ•°é‡ï¼Œè€Œä¸ä»…ä»…æ˜¯ç£ç›˜å®¹é‡ã€‚
    å¯¹äºå­˜å‚¨å¤§é‡å°æ–‡ä»¶çš„åœºæ™¯ï¼Œinode æ•°é‡å¯èƒ½æ¯”ç£ç›˜å®¹é‡æ›´æ—©è€—å°½ã€‚å› æ­¤åœ¨æ ¼å¼åŒ–æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´ inode æ•°é‡æ¥ä¼˜åŒ–æ–‡ä»¶ç³»ç»Ÿçš„ä½¿ç”¨ã€‚



#### è®¤è¯†inodeä½å›¾

 inode ä½å›¾ç”¨äºç®¡ç† inode è¡¨çš„ä½¿ç”¨çŠ¶æ€ï¼ŒæŒ‡ç¤ºå“ªäº› inode æ˜¯ç©ºé—²çš„ã€å“ªäº›è¢«å ç”¨ã€‚





### ç›®å½•æœ¬è´¨è¯¦è§£

ç›®å½•å°±æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå…¶å†…å®¹æ˜¯ä¸€ä¸ªä¸ªâ€œç›®å½•é¡¹è®°å½•â€ï¼ˆdirectory entriesï¼‰ç»„æˆçš„ç»“æ„æ•°ç»„ï¼Œç”¨äºè¡¨ç¤ºâ€œæ–‡ä»¶å â†’ inodeå·â€çš„æ˜ å°„å…³ç³»ã€‚

#### ç›®å½•é¡¹ï¼ˆdirectory entryï¼‰çš„åŸºæœ¬ç»„æˆ

ä»¥ **ext2/ext3/ext4 æ–‡ä»¶ç³»ç»Ÿ**ä¸ºä¾‹ï¼Œæ¯ä¸ªç›®å½•é¡¹ï¼ˆ`struct ext4_dir_entry`ï¼‰ä¸€èˆ¬åŒ…å«ä»¥ä¸‹å­—æ®µï¼š

| å­—æ®µå      | è¯´æ˜                               |
| ----------- | ---------------------------------- |
| `inode`     | å¯¹åº”æ–‡ä»¶çš„ inode ç¼–å·ï¼ˆ`inum`ï¼‰    |
| `rec_len`   | å½“å‰ç›®å½•é¡¹å ç”¨çš„æ€»å­—èŠ‚æ•°ï¼ˆå«å¡«å……ï¼‰ |
| `name_len`  | æ–‡ä»¶åçš„é•¿åº¦                       |
| `file_type` | æ–‡ä»¶ç±»å‹ï¼ˆå¦‚æ™®é€šæ–‡ä»¶/ç›®å½•/é“¾æ¥ï¼‰   |
| `name`      | æ–‡ä»¶åå­—ç¬¦ä¸²ï¼ˆä¸å«ç»“æŸç¬¦ `\\0`ï¼‰   |



#### ç¤ºä¾‹ç»“æ„ä½“ï¼ˆext4ï¼‰

```C
struct ext4_dir_entry {
    __le32 inode;        // 4 bytes
    __le16 rec_len;      // 2 bytesï¼šå½“å‰ç›®å½•é¡¹æ€»é•¿åº¦
    __u8   name_len;     // 1 byteï¼šæ–‡ä»¶åé•¿åº¦
    __u8   file_type;    // 1 byteï¼šæ–‡ä»¶ç±»å‹ï¼ˆext4 ä¸“æœ‰ï¼‰
    char   name[];       // ä¸å®šé•¿ï¼šæ–‡ä»¶åï¼ˆä¸å« '\\0' ç»“å°¾ï¼‰
};
```

 **å­—æ®µè§£æè¯´æ˜ï¼š**

1. **`inode`ï¼ˆinumï¼‰**

- è¡¨ç¤ºè¯¥æ–‡ä»¶/ç›®å½•å¯¹åº”çš„ inode ç¼–å·
- æ“ä½œç³»ç»Ÿå¯ç”¨å®ƒè®¿é—®è¯¥æ–‡ä»¶çš„å…·ä½“å…ƒä¿¡æ¯

2. **`rec_len`ï¼ˆrecord lengthï¼‰**

- å½“å‰ç›®å½•é¡¹åœ¨ç›®å½•æ–‡ä»¶ä¸­å®é™…å æ®çš„æ€»å­—èŠ‚æ•°
- ç”±äºæ–‡ä»¶åé•¿åº¦å¯å˜ï¼Œä¸ºäº†ä¿æŒå¯¹é½ï¼Œrec_len é€šå¸¸ä¼š > å®é™…æ‰€éœ€ç©ºé—´ï¼ˆå†…å«å¡«å……ï¼‰

3. **`name_len`**

- å®é™…æ–‡ä»¶åçš„é•¿åº¦ï¼Œå•ä½æ˜¯å­—èŠ‚
- ä¸åŒ…æ‹¬ `\\0` ç»“å°¾å­—ç¬¦

4. **`file_type`ï¼ˆext4 ä¸“æœ‰ï¼Œext2/3 ä¸ä¸€å®šæœ‰ï¼‰**

- è¡¨ç¤ºè¯¥ç›®å½•é¡¹æ˜¯æ™®é€šæ–‡ä»¶ã€ç›®å½•ã€ç¬¦å·é“¾æ¥ç­‰
- ç±»å‹ä»£ç ä¾‹å¦‚ï¼š
  - `1`ï¼šæ™®é€šæ–‡ä»¶
  - `2`ï¼šç›®å½•
  - `7`ï¼šsocketï¼ˆUnix åŸŸï¼‰

5. **`name[]`**

- å­—ç¬¦ä¸²å½¢å¼çš„æ–‡ä»¶å
- ç´§è·Ÿåœ¨ç»“æ„ä½“åé¢ï¼Œ**å˜é•¿å­—æ®µ**





#### ç¤ºä¾‹ï¼šç›®å½•ç»“æ„ä¸­çš„è®°å½•å†…å®¹ï¼ˆå‡è®¾æ˜¯ ext4ï¼‰

ä¸€ä¸ªç›®å½•æ–‡ä»¶å†…å®¹ç¤ºä¾‹ï¼ˆåå…­è¿›åˆ¶ï¼‰å¯è§£æå‡ºå¦‚ä¸‹å†…å®¹ï¼š

| inode | rec_len | name_len | file_type | name  |
| ----- | ------- | -------- | --------- | ----- |
| 12    | 12      | 1        | 2         | .     |
| 2     | 12      | 2        | 2         | ..    |
| 1002  | 24      | 5        | 1         | readm |

è¯´æ˜ï¼š

- `.` è¡¨ç¤ºå½“å‰ç›®å½•
- `..` è¡¨ç¤ºä¸Šçº§ç›®å½•
- `readm` æ˜¯æ™®é€šæ–‡ä»¶ï¼ˆå®é™…æ˜¯ `readme`ï¼Œå› å¯¹é½å¯èƒ½è¢«æˆªæ–­æ˜¾ç¤ºï¼‰



 **ext4 ä¸­ `file_type` å­—æ®µçš„æ‰€æœ‰å–å€¼è¯´æ˜ï¼š**

| æ•°å€¼ï¼ˆåè¿›åˆ¶ï¼‰ | å®åï¼ˆå¸¸é‡ï¼‰       | æ–‡ä»¶ç±»å‹      | å¯¹åº”çš„ `stat` ç±»å‹ |
| -------------- | ------------------ | ------------- | ------------------ |
| `0`            | `EXT4_FT_UNKNOWN`  | æœªçŸ¥ç±»å‹      | ä¸å¯è¯†åˆ«           |
| `1`            | `EXT4_FT_REG_FILE` | æ™®é€šæ–‡ä»¶      | `S_IFREG`          |
| `2`            | `EXT4_FT_DIR`      | ç›®å½•          | `S_IFDIR`          |
| `3`            | `EXT4_FT_CHRDEV`   | å­—ç¬¦è®¾å¤‡æ–‡ä»¶  | `S_IFCHR`          |
| `4`            | `EXT4_FT_BLKDEV`   | å—è®¾å¤‡æ–‡ä»¶    | `S_IFBLK`          |
| `5`            | `EXT4_FT_FIFO`     | FIFO/ç®¡é“æ–‡ä»¶ | `S_IFIFO`          |
| `6`            | `EXT4_FT_SOCK`     | å¥—æ¥å­—æ–‡ä»¶    | `S_IFSOCK`         |
| `7`            | `EXT4_FT_SYMLINK`  | ç¬¦å·é“¾æ¥      | `S_IFLNK`          |





#### åˆ›å»ºåˆå§‹ç›®å½•çš„æ—¶å€™ï¼Œç¡¬é“¾æ¥æ•°åˆå§‹ä¸º2çš„åŸå› 

åœ¨UNIXå’ŒLinuxæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œç›®å½•çš„ç¡¬é“¾æ¥æ•°ä»2å¼€å§‹æ˜¯æœ‰ç‰¹å®šçš„åŸå› çš„ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªç›®å½•ï¼ˆä¾‹å¦‚dir1ï¼‰ï¼Œåˆå§‹çš„ä¸¤ä¸ªç¡¬é“¾æ¥ä»£è¡¨ï¼š

- å¼•ç”¨è¯¥ç›®å½•çš„åå­—ï¼šè¿™å°±æ˜¯ä½ æ‰€åˆ›å»ºçš„ç›®å½•åï¼Œå¦‚dir1ã€‚è‡ªèº«æ˜¯ä¸€ä¸ªç¡¬é“¾æ¥
- .ï¼ˆç‚¹ï¼‰ï¼šæ¯ä¸ªç›®å½•éƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šçš„åå­—.ï¼Œå®ƒå¼•ç”¨è‡ªèº«ã€‚å½“ä½ è¿›å…¥dir1å¹¶åˆ—å‡ºå†…å®¹æ—¶ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ª.ç›®å½•ï¼Œå®ƒå®é™…ä¸ŠæŒ‡å‘dir1è‡ªèº«ã€‚
- å½“ä½ åœ¨dir1å†…åˆ›å»ºå­ç›®å½•æ—¶ï¼Œdir1çš„ç¡¬é“¾æ¥æ•°ä¼šå¢åŠ ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸ªå­ç›®å½•éƒ½æœ‰ä¸€ä¸ªåä¸º..ï¼ˆåŒç‚¹ï¼‰çš„ç‰¹æ®Šç›®å½•åï¼Œå®ƒæŒ‡å‘å…¶çˆ¶ç›®å½•ã€‚å› æ­¤ï¼Œæ¯å½“ä½ åœ¨dir1å†…åˆ›å»ºä¸€ä¸ªå­ç›®å½•ï¼Œdir1çš„ç¡¬é“¾æ¥æ•°å°±ä¼šå¢åŠ 1ã€‚





### é“¾æ¥æ–‡ä»¶è¯¦è§£

#### ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥

**ç¡¬é“¾æ¥**ï¼š

- æ¦‚è¿°ï¼šæœ¬è´¨ä¸Šæ˜¯å¤šä¸ªæ–‡ä»¶åå…±ç”¨ä¸€ä¸ªinode
- å‘½ä»¤ï¼š`ln a.txt aa.txt`
- æ³¨æ„ï¼š
  - å› ä¸ºæœ¬è´¨æ˜¯å…±ç”¨ä¸€ä¸ªinodeï¼Œæ‰€ä»¥ä¸èƒ½è·¨åˆ†åŒºåˆ›å»ºç¡¬é“¾æ¥ï¼Œå› ä¸ºä¸åŒåˆ†åŒºæœ‰ç‹¬ç«‹çš„inodeè¡¨
  - åŒç†ï¼Œä¸ºäº†é˜²æ­¢inodeå¾ªç¯åˆ©ç”¨ï¼Œæ‰€ä»¥ç›®å½•ä¹Ÿä¸èƒ½åˆ›å»ºç¡¬é“¾æ¥ï¼Œä½†æ˜¯åœ¨åˆ›å»ºç›®å½•åŠå…¶å­ç›®å½•çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»º.å’Œ..è¿™ç§ç›®å½•çš„ç¡¬é“¾æ¥
  - ç¡¬é“¾æ¥æ•°æœ¬è´¨ä¸Šæ˜¯inodeè®¡æ•°å™¨çš„å€¼

**è½¯é“¾æ¥**ï¼š

- æ¦‚è¿°ï¼šä¹Ÿå«ç¬¦å·é“¾æ¥ï¼Œè½¯é“¾æ¥çš„æœ¬è´¨æ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„å†…å®¹æ˜¯æºæ–‡ä»¶çš„è·¯å¾„ï¼Œæ‰€ä»¥è®¿é—®è½¯è¿æ¥æ–‡ä»¶ï¼Œå®è´¨ä¸Šç³»ç»Ÿè®¿é—®æŒ‡å‘äº†æºæ–‡ä»¶
- å‘½ä»¤ï¼š`ln -s ç›®æ ‡æ–‡ä»¶ è½¯é“¾æ¥æ–‡ä»¶`
  - æ³¨æ„ï¼šæ ¹æ®è½¯é“¾æ¥çš„æœ¬è´¨ï¼Œè½¯è¿æ¥æ–‡ä»¶ä¸­çš„å†…å®¹å®é™…ä¸Šæ˜¯æŒ‡å‘ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ï¼Œå› æ­¤ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„å¦‚æœæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œé‚£ä¹ˆä¸€å®šæ˜¯ç›¸å¯¹è½¯é“¾æ¥çš„è·¯å¾„ 
  - æ³¨æ„2ï¼šåˆ é™¤è½¯é“¾æ¥çš„æ—¶å€™ï¼Œä¸è¦åŠ tabé”®è¡¥å…¨ï¼Œå¦‚æœè½¯è¿æ¥æ–‡ä»¶åè·Ÿ/,åˆ é™¤çš„æ—¶å€™ï¼Œæ¯”å¦‚rm -rf /Storage/test/test/ å®é™…ä¸Šæ˜¯æŠŠåŸå§‹ç›®å½•ä¸­çš„å†…å®¹ä¸€èµ·åˆ é™¤



**å…³äºè½¯è¿æ¥å†…å®¹è§£æ**

```bash
[root@ubuntu2204 ~]#mkdir -p a/b/c
[root@ubuntu2204 ~]#tree a/
a/
â””â”€â”€ b
    â””â”€â”€ c

2 directories, 0 files
[root@ubuntu2204 ~]#cd a/b/c/
[root@ubuntu2204 c]#ln -s ../../../hello.txt hello.txt
[root@ubuntu2204 c]#ll
æ€»è®¡ 8
drwxr-xr-x 2 root root 4096  6æœˆ  4 13:18 ./
drwxr-xr-x 3 root root 4096  6æœˆ  4 13:17 ../
lrwxrwxrwx 1 root root   18  6æœˆ  4 13:18 hello.txt -> ../../../hello.txt

# è½¯é“¾æ¥çš„å†…å®¹å³æ˜¯ï¼šä»é“¾æ¥æ–‡ä»¶åˆ°æºæ–‡ä»¶çš„æŒ‡å‘è·¯å¾„
[root@ubuntu2204 c]#echo "../../../hello.txt"|grep -o "[^\d]"|wc -l
18

```



<span style="color:red">**æ³¨æ„ï¼šé«˜å±æ“ä½œ**</span>

```bash
[root@ubuntu2204 ~]#tree a
a
â””â”€â”€ b
    â””â”€â”€ c
    
# è¿›å…¥a/b/c
[root@ubuntu2204 ~]# cd a/b/c/
[root@ubuntu2204 c]# ln -s ../../../test test
[root@ubuntu2204 ~]#tree a
a
â””â”€â”€ b
    â””â”€â”€ c
        â””â”€â”€ test -> ../../../test

3 directories, 0 files

[root@ubuntu2204 c]#ls test
10.txt  1.txt  2.txt  3.txt  4.txt  5.txt  6.txt  7.txt  8.txt  9.txt

# å½“åˆ é™¤è½¯è¿æ¥ç›®å½•çš„æ—¶å€™ï¼Œåé¢æºå¸¦/
[root@ubuntu2204 c]#rm -rf test/

# æŸ¥çœ‹åŸç›®å½•å†…å®¹ï¼Œå‘ç°ä¹Ÿè¢«åˆ é™¤o(â•¥ï¹â•¥)oï¼ï¼ï¼
[root@ubuntu2204 c]#ls -a /root/test/
.  ..
```







### è®¿é—®æ–‡ä»¶æ—¶çš„å®Œæ•´æµç¨‹

**1ï¸âƒ£ è·¯å¾„è§£æ â†’ æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶çš„ inode**

- ä»æ ¹ç›®å½• `/` å¼€å§‹ï¼Œé€å±‚æŸ¥æ‰¾æ¯ä¸€çº§ç›®å½•é¡¹çš„ inodeã€‚
- ç³»ç»Ÿä¼šæ ¹æ®è·¯å¾„ä¸­æ¯ä¸ªåå­—ï¼ˆå¦‚ `/home/zhangyifeng/secret.txt`ï¼‰ï¼ŒæŸ¥æ‰¾å¯¹åº”ç›®å½•ä¸­çš„ **ç›®å½•é¡¹ï¼ˆdentryï¼‰**ï¼Œæå–ç›®æ ‡æ–‡ä»¶çš„ inode ç¼–å·ã€‚



**2ï¸âƒ£ åŠ è½½ç›®æ ‡ inode â†’ å¾—åˆ°é€»è¾‘å—å·**

- inode ä¸­åŒ…å«ï¼š
  - æ–‡ä»¶å¤§å°ã€æƒé™ã€æ—¶é—´æˆ³ç­‰å…ƒæ•°æ®
  - æŒ‡å‘æ•°æ®å—çš„â€œé€»è¾‘å—å·â€ï¼ˆextents æˆ–ç´¢å¼•ç»“æ„ï¼‰



**3ï¸âƒ£ é€»è¾‘å—å· â†’ è®¡ç®—é€»è¾‘æ‰‡åŒºå·**

- æ–‡ä»¶ç³»ç»Ÿå±‚å°†é€»è¾‘å—å·ä¹˜ä»¥å—å¤§å°ï¼ˆå¦‚ 4096 å­—èŠ‚ï¼‰â†’ å¾—åˆ°æ–‡ä»¶æ•°æ®åœ¨ç£ç›˜ä¸­çš„åç§»ï¼ˆé€»è¾‘æ‰‡åŒºå·ï¼‰ã€‚



4ï¸âƒ£ ç³»ç»Ÿè¯»å–æ•°æ®å— â†’ æŠŠæ•°æ®äº¤ç»™ç¨‹åº

- å†…æ ¸é€šè¿‡å—è®¾å¤‡é©±åŠ¨ï¼Œå‘ç£ç›˜å‘èµ·è¯»å–è¯·æ±‚ï¼Œè¯»å–ç›®æ ‡æ‰‡åŒºã€‚
- æ•°æ®å…ˆè¿›å…¥**å†…å­˜ä¸­çš„é¡µç¼“å­˜**ï¼›
- ç„¶åé€šè¿‡ `read()` ç³»ç»Ÿè°ƒç”¨ï¼Œå°†æ•°æ®ä»å†…æ ¸ç¼“å†²å¤åˆ¶åˆ°ç”¨æˆ·ç¨‹åºä¸­ã€‚



**5ï¸âƒ£ ç¨‹åºæ‹¿åˆ°æ•°æ®ï¼Œå¤„ç†æˆ–æ˜¾ç¤º**



```ABAP
"æ–‡ä»¶è·¯å¾„" â†’ æ‰¾ inode â†’ å¾—åˆ°æ•°æ®ä½ç½® â†’ ç£ç›˜è¯»æ•°æ® â†’ ç¨‹åºæ”¶åˆ°æ•°æ®
```







### å®éªŒ1ï¼šæ‰‹åŠ¨ç”¨ `hexdump` åˆ†æ ext4 çš„ç›®å½•ç»“æ„

**æ•´ä½“æµç¨‹æ¦‚è§ˆ**

1. æ‰¾åˆ°ç›®æ ‡ç›®å½•å¯¹åº”çš„ inodeï¼ˆä½¿ç”¨ `debugfs`ï¼‰
2. è·å–è¯¥ inode æŒ‡å‘çš„æ•°æ®å—åœ°å€
3. ä»è®¾å¤‡ä¸­æå–å¯¹åº”æ•°æ®å—å†…å®¹
4. ç”¨ `hexdump` æŸ¥çœ‹ï¼Œå¹¶æ‰‹åŠ¨è§£æç›®å½•é¡¹ç»“æ„



##### å®éªŒæ­¥éª¤è¯¦è§£

> å‡è®¾æˆ‘ä»¬çš„æŒ‚è½½è®¾å¤‡æ˜¯ `/dev/vda1`ï¼ŒæŒ‚è½½ç‚¹ä¸º `/`ï¼Œè¦åˆ†æçš„ç›®å½•ä¸º `/home`

**ç¬¬ 1 æ­¥ï¼šè¿›å…¥ debugfs æŸ¥çœ‹ç›®æ ‡ç›®å½• inode ä¿¡æ¯**

```bash
debugfs /dev/vda1
```

è¿›å…¥äº¤äº’åï¼š

```bash
debugfs: stat /home
```

```bash
Inode: 1518   Type: directory    Mode:  0755   Flags: 0x80000
Generation: 2375206807    Version: 0x00000000:00000002
User:     0   Group:     0   Project:     0   Size: 4096
File ACL: 0
Links: 3   Blockcount: 8
Fragment:  Address: 0    Number: 0    Size: 0
 ctime: 0x64be8b93:0a7d8c00 -- Mon Jul 24 14:32:51 2023
 atime: 0x683ca913:e6065518 -- Sun Jun  1 19:25:07 2025
 mtime: 0x64be8b93:0a7d8c00 -- Mon Jul 24 14:32:51 2023
crtime: 0x64ae0bd7:e5c38f74 -- Wed Jul 12 02:11:35 2023
Size of extra inode fields: 32
Inode checksum: 0xeeec52cf
EXTENTS:
(0):16735
```

**è¯¦ç»†è§£é‡Šï¼š**

ğŸ“Œ `EXTENTS:` æ˜¯ ext4 æ–‡ä»¶ç³»ç»Ÿçš„å—å¯»å€æ–¹å¼ä¹‹ä¸€

- ext2/ext3 ä½¿ç”¨ã€Œç›´æ¥å— + é—´æ¥å—ã€æ–¹å¼ï¼ˆæœ€å¤š 15 ä¸ªæŒ‡é’ˆï¼‰
- ext4 é»˜è®¤ä½¿ç”¨ **Extent treeï¼ˆæ‰©å±•æ ‘ï¼‰**ï¼Œæ›´é€‚åˆå¤§æ–‡ä»¶ã€é«˜è¿ç»­æ€§

ğŸ“Œ `(0):16735` çš„å«ä¹‰æ˜¯ï¼š

- `0` è¡¨ç¤ºè¿™æ˜¯ç¬¬ 0 ä¸ª extentï¼ˆèµ·å§‹åç§»å—å·ä¸º 0ï¼‰
- `16735` æ˜¯è¯¥ extent åœ¨ç‰©ç†è®¾å¤‡ä¸­çš„ç¬¬ä¸€ä¸ªå®é™… **ç‰©ç†å—å·**



**ç¬¬ 2 æ­¥ï¼šæ ¹æ®ä¸Šæ–‡çš„è¾“å‡ºï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯**

```ABAP
è¿™æ˜¯ä¸€ä¸ª ext4 æ–‡ä»¶ç³»ç»Ÿ
è¯¥ inode ä½¿ç”¨ Extentï¼ˆæ‰©å±•å—æ˜ å°„ï¼‰æ ¼å¼
ç¬¬ä¸€ä¸ªæ•°æ®å—å·æ˜¯ 16735

å­—èŠ‚åç§» = 16735 Ã— 4096 = 68575232 å­—èŠ‚
```



**ç¬¬ 3 æ­¥ï¼šä»è®¾å¤‡ä¸­æå–è¿™ä¸ªæ•°æ®å—**

```bash
dd if=/dev/vda1 bs=4096 skip=16735 count=1 of=dirblock.bin
```



**ç¬¬ 4 æ­¥ï¼šä½¿ç”¨ hexdump åˆ†æç›®å½•å—å†…å®¹**

```bash
hexdump -C dirblock.bin | less
```

```bash
00000000  ee 05 00 00 0c 00 01 02  2e 00 00 00 02 00 00 00  |................|
00000010  0c 00 02 02 2e 2e 00 00  01 f0 03 00 dc 0f 06 02  |................|
00000020  75 62 75 6e 74 75 00 00  00 00 00 00 00 00 00 00  |ubuntu..........|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
00000ff0  00 00 00 00 00 00 00 00  0c 00 00 de 14 63 1c 37  |.............c.7|
00001000
```



##### æ‰‹åŠ¨è§£æè§„åˆ™ï¼ˆåŸºäº `ext4_dir_entry`ï¼‰

æ¯ä¸ªç›®å½•é¡¹æ ¼å¼å¦‚ä¸‹ï¼š

| å­—èŠ‚åç§» | å­—æ®µå    | é•¿åº¦   | å«ä¹‰                             |
| -------- | --------- | ------ | -------------------------------- |
| 0        | inode     | 4B     | æ–‡ä»¶/ç›®å½•çš„ inode ç¼–å·           |
| 4        | rec_len   | 2B     | å½“å‰ç›®å½•é¡¹å ç”¨çš„æ€»é•¿åº¦           |
| 6        | name_len  | 1B     | æ–‡ä»¶åé•¿åº¦ï¼ˆä¸å«ç»“å°¾ï¼‰           |
| 7        | file_type | 1B     | æ–‡ä»¶ç±»å‹ï¼ˆ1: æ™®é€šæ–‡ä»¶, 2: ç›®å½•ï¼‰ |
| 8        | name      | N å­—èŠ‚ | æ–‡ä»¶åï¼ˆå˜é•¿ï¼‰                   |



**ç¤ºä¾‹è§£æ**

```bash
 01 f0 03 00 dc 0f 06 02  # 
 75 62 75 6e 74 75        # Ubuntu(æ–‡ä»¶å)
```

é€é¡¹è§£é‡Šï¼š

- `01 f0 03 00` â†’ `inode = 0x0003f001 = 258,049`
- `dc 0f` â†’ `rec_len = 0x0fdc = 4060`
- `06` â†’ name_len = 6ï¼ˆUbuntuï¼Œ6ä¸ªå­—ç¬¦ï¼‰
- `02` â†’ file_type = 2 ï¼ˆç›®å½•ï¼‰
- `2e` â†’ æ–‡ä»¶å = "."ï¼ˆASCIIï¼‰

```bash
[root@devops-custom ~]# ll -i /home
æ€»è®¡ 12
  1518 drwxr-xr-x  3 root   root   4096  7æœˆ 24  2023 ./
     2 drwxr-xr-x 19 root   root   4096  5æœˆ 26 08:53 ../
258049 drwxr-x--- 17 ubuntu ubuntu 4096  5æœˆ  4 12:53 ubuntu/
```





### å®éªŒ2ï¼šLinux æ–‡ä»¶ç³»ç»Ÿå–è¯å®æ“â€”é€šè¿‡ inode æ‰‹åŠ¨æ¢å¤å·²åˆ é™¤æ–‡ä»¶

```bash
# åˆ›å»ºä¸€ä¸ªæ–‡ä»¶
[root@ubuntu2204 ~]#echo hello > hello.txt

# æŸ¥çœ‹hello.txtæ‰€åœ¨çš„ç‰©ç†å—å·
[root@ubuntu2204 ~]#debugfs /dev/ubuntu-vg/ubuntu-lv 
debugfs 1.46.5 (30-Dec-2021)
debugfs:  stat /root/hello.txt
Inode: 1572881   Type: regular    Mode:  0644   Flags: 0x80000
Generation: 3004533257    Version: 0x00000000:00000001
User:     0   Group:     0   Project:     0   Size: 6
File ACL: 0
Links: 1   Blockcount: 8
Fragment:  Address: 0    Number: 0    Size: 0
 ctime: 0x683fdcad:1cff6aa4 -- Wed Jun  4 13:42:05 2025
 atime: 0x683fdcad:1cff6aa4 -- Wed Jun  4 13:42:05 2025
 mtime: 0x683fdcad:1cff6aa4 -- Wed Jun  4 13:42:05 2025
crtime: 0x683fdcad:1cff6aa4 -- Wed Jun  4 13:42:05 2025
Size of extra inode fields: 32
Inode checksum: 0x70d6ba27
EXTENTS:
(0):6389761

# åˆ é™¤æ–‡ä»¶
[root@ubuntu2204 ~]#rm hello.txt

# ç›´æ¥è®¿é—®ç£ç›˜æ¢å¤æ•°æ®
[root@ubuntu2204 ~]#dd if=/dev/ubuntu-vg/ubuntu-lv of=recovered.txt bs=4096 skip=6389761 count=1
è®°å½•äº†1+0 çš„è¯»å…¥
è®°å½•äº†1+0 çš„å†™å‡º
4096å­—èŠ‚ï¼ˆ4.1 kBï¼Œ4.0 KiBï¼‰å·²å¤åˆ¶ï¼Œ0.000407764 sï¼Œ10.0 MB/s
[root@ubuntu2204 ~]#cat recovered.txt 
hello
```









## é‡å®šå‘ä¸ç®¡é“

### æ ‡å‡†è¾“å…¥å’Œè¾“å‡º

Linux ç³»ç»Ÿä¸­æœ‰ä¸‰ä¸ªæœ€åŸºæœ¬çš„IOè®¾å¤‡

1. **æ ‡å‡†è¾“å…¥è®¾å¤‡(stdin)**ï¼šå¯¹åº”ç»ˆç«¯é”®ç›˜ 
2. **æ ‡å‡†è¾“å‡ºè®¾å¤‡(stdout)**ï¼šå¯¹åº”ç»ˆç«¯çš„æ˜¾ç¤ºå™¨ 
3. **æ ‡å‡†é”™è¯¯è¾“å‡ºè®¾å¤‡(stderr)**ï¼šå¯¹åº”ç»ˆç«¯çš„æ˜¾ç¤ºå™¨



åœ¨Linuxç³»ç»Ÿä¸­ï¼Œä¸€åˆ‡çš†æ–‡ä»¶ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸‰ä¸ªè®¾å¤‡ä¹Ÿæ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼å­˜åœ¨äºç³»ç»Ÿä¸­ï¼› 

ç¨‹åºä»æ ‡å‡†è¾“å…¥è®¾å¤‡ä¸­è·å–æ•°æ®ï¼Œå†å°†è¿è¡Œç»“æœå’Œé”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡å’Œæ ‡å‡†é”™è¯¯è¾“å‡ºè®¾å¤‡ï¼›



åœ¨è™šæ‹Ÿç»ˆç«¯ä¸­ï¼Œæ ‡å‡†è¾“å…¥è¾“å‡ºè®¾å¤‡éƒ½æ˜¯å½“å‰çš„ç»ˆç«¯çª—å£

```bash
[root@ubuntu2204 ~]#ll /dev/std*
lrwxrwxrwx 1 root root 15  6æœˆ  4 10:17 /dev/stderr -> /proc/self/fd/2
lrwxrwxrwx 1 root root 15  6æœˆ  4 10:17 /dev/stdin -> /proc/self/fd/0
lrwxrwxrwx 1 root root 15  6æœˆ  4 10:17 /dev/stdout -> /proc/self/fd/1

[root@ubuntu2204 ~]#ll /proc/self/fd/
æ€»è®¡ 0
dr-x------ 2 root root  0  6æœˆ  4 14:26 ./
dr-xr-xr-x 9 root root  0  6æœˆ  4 14:26 ../
lrwx------ 1 root root 64  6æœˆ  4 14:26 0 -> /dev/pts/3
lrwx------ 1 root root 64  6æœˆ  4 14:26 1 -> /dev/pts/3
lrwx------ 1 root root 64  6æœˆ  4 14:26 2 -> /dev/pts/3
lr-x------ 1 root root 64  6æœˆ  4 14:26 3 -> /proc/199933/fd/

[root@ubuntu2204 ~]#tty
/dev/pts/3
```





<img src="D:\git_repository\cyber_security_learning\markdown_img\image-20250604142816384-1752042405570-2.png" alt="image-20250604142816384" style="zoom:150%;" />





#### è®¤è¯†æ–‡ä»¶æè¿°ç¬¦

 

å¦‚æœæˆ‘ä»¬å°†æ–‡ä»¶æ¯”ä½œä¸€ä¸ªæ°´é¾™å¤´ï¼Œé‚£ä¹ˆâ€œæ–‡ä»¶æè¿°ç¬¦â€å°±æ˜¯æ°´é¾™å¤´çš„å·ç ç‰Œï¼ˆç¼–å·ï¼‰ï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥ä½¿ç”¨æ°´é¾™å¤´ï¼Œä½†æ˜¯ç¨‹åºå¿…é¡»é€šè¿‡å·ç ç‰Œçš„ç¼–å·æ¥æ“ä½œæŒ‡å®šçš„æ°´é¾™å¤´



![image-20250604144038046](D:\git_repository\cyber_security_learning\markdown_img\image-20250604144038046-1752042405570-3.png)





- åœ¨ Linux ä¸­ï¼Œä¸€æ—¦ç¨‹åºæ‰“å¼€æ–‡ä»¶ï¼Œå®ƒå°±å¾—åˆ°äº†ä¸€ä¸ªæ°´é¾™å¤´çš„â€œç¼–å·â€â€”â€”è¿™ä¸ªç¼–å·å°±æ˜¯**æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰**ã€‚

- ç¨‹åºå†ä¹Ÿä¸ä¼šä½¿ç”¨â€œè·¯å¾„â€æ¥æ“ä½œæ–‡ä»¶ï¼Œè€Œæ˜¯ç”¨è¿™ä¸ªç¼–å·æ¥â€œæ‹§å¼€æ°´é¾™å¤´â€ã€‚

- ç¼–å· 0ã€1ã€2 é»˜è®¤åˆ†åˆ«å¯¹åº” **æ ‡å‡†è¾“å…¥**ã€**æ ‡å‡†è¾“å‡º** å’Œ **æ ‡å‡†é”™è¯¯**ã€‚





##### ç”¨æˆ·è§†è§’ VS ç¨‹åºè§†è§’ä¸­çš„æ–‡ä»¶æè¿°ç¬¦

| è§’è‰² | å¦‚ä½•è®¿é—®æ–‡ä»¶       | ä¸¾ä¾‹                    |
| ---- | ------------------ | ----------------------- |
| ç”¨æˆ· | `cat file.txt`     | é€šè¿‡â€œè·¯å¾„ + æ–‡ä»¶åâ€è®¿é—® |
| ç¨‹åº | `open("file.txt")` | è¿”å›ä¸€ä¸ª **æ–‡ä»¶æè¿°ç¬¦** |

> ç¨‹åº**ä¸èƒ½ç”¨è·¯å¾„ç›´æ¥è®¿é—®æ–‡ä»¶å†…å®¹**ï¼Œå¿…é¡»å…ˆè°ƒç”¨ `open()` å¾—åˆ°**æ–‡ä»¶æè¿°ç¬¦ï¼ˆæ•´æ•°ï¼‰**ï¼Œåç»­è¯»å†™æ“ä½œå…¨é è¿™ä¸ªâ€œç¼–å·â€æ¥è¿›è¡Œã€‚





##### æ–‡ä»¶æè¿°ç¬¦çš„æ¥æº

```C
int fd = open("file.txt", O_RDONLY);
```

> `open()` ç³»ç»Ÿè°ƒç”¨çš„è¿”å›å€¼ `fd` å°±æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œæ˜¯ä¸€ä¸ªæ•´æ•°ï¼ˆå¦‚ `3`ï¼‰ã€‚

| æ–‡ä»¶æè¿°ç¬¦ç¼–å· | ä½œç”¨                           |
| -------------- | ------------------------------ |
| 0              | æ ‡å‡†è¾“å…¥ stdin                 |
| 1              | æ ‡å‡†è¾“å‡º stdout                |
| 2              | æ ‡å‡†é”™è¯¯ stderr                |
| 3 åŠä»¥ä¸Š       | æ™®é€šæ–‡ä»¶ã€socketã€ç®¡é“ã€è®¾å¤‡ç­‰ |



##### æ–‡ä»¶æè¿°ç¬¦å¦‚ä½•ä½¿ç”¨

```C
read(fd, buf, 100);   // ä» fd å¯¹åº”çš„æ–‡ä»¶ä¸­è¯»æ•°æ®
write(fd, buf, 100);  // å‘ fd å¯¹åº”çš„æ–‡ä»¶ä¸­å†™æ•°æ®
close(fd);            // å…³é—­ fd
```

> ç¨‹åºä¸å…³å¿ƒâ€œæ–‡ä»¶åâ€æˆ–â€œè·¯å¾„â€ï¼Œå®ƒåªæ“ä½œæ–‡ä»¶æè¿°ç¬¦ï¼



```basic
æ–‡ä»¶æè¿°ç¬¦æœ¬èº«ä¸å ç”¨Inodeï¼Œä½†æ˜¯å®ƒé—´æ¥æŒæœ‰Inode
```







### I/Oé‡å®šå‘ redirect

I/Oé‡å®šå‘ï¼šå°†é»˜è®¤çš„è¾“å…¥ï¼Œè¾“å‡ºæˆ–é”™è¯¯å¯¹åº”çš„è®¾å¤‡æ”¹å˜ï¼ŒæŒ‡å‘æ–°çš„ç›®æ ‡



#### æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯é‡å®šå‘

STDOUTå’ŒSTDERRé»˜è®¤æ˜¯ä½¿ç”¨å½“å‰ç»ˆç«¯ï¼Œä½†ä¹Ÿå¯ä»¥é‡å®šå‘åˆ°æŒ‡å®šç»ˆç«¯æˆ–æŒ‡å®šæ–‡ä»¶



æ ¼å¼ï¼š

```bash
COMMAND OPERATOR FILE|DEVICE

# è¦†ç›–æ“ä½œç¬¦ï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œä¼šè¢«è¦†ç›–
>                # æŠŠSTDOUTé‡å®šå‘åˆ°æ–‡ä»¶
1>               # åŒä¸Š
2>               # æŠŠSTDERRé‡å®šå‘åˆ°æ–‡ä»¶
&>               # æŠŠæ ‡å‡†è¾“å‡ºå’Œé”™è¯¯éƒ½é‡å®šå‘
>&               # å’Œä¸Šé¢åŠŸèƒ½ä¸€æ ·ï¼Œå»ºè®®ä½¿ç”¨ä¸Šé¢æ–¹å¼ 


# è¿½åŠ æ“ä½œç¬¦ï¼Œåœ¨åŸæœ‰æ–‡ä»¶çš„åŸºç¡€ä¸Šè¿½åŠ å†…å®¹
>>               # è¿½åŠ æ ‡å‡†è¾“å‡ºé‡å®šå‘è‡³æ–‡ä»¶
1>>              # åŒä¸Š
2>>              # è¿½åŠ æ ‡å‡†é”™è¯¯é‡å®šå‘è‡³æ–‡ä»¶
```



èŒƒä¾‹ï¼šæ ‡å‡†è¾“å‡ºåˆ°å…¶ä»–ç»ˆç«¯

```bash
# åœ¨ç»ˆç«¯çª—å£1æŸ¥çœ‹
[root@ubuntu2204 ~]# tty
/dev/pts/1

# åœ¨ç»ˆç«¯çª—å£3æŸ¥çœ‹ 
[root@ubuntu2204 ~]# tty
/dev/pts/3

# åœ¨ç»ˆç«¯å¼€çª—å£1æ‰§è¡Œ
[root@ubuntu2204 ~]#echo "hello" > /dev/pts/3

# åœ¨ç»ˆç«¯çª—å£3æ˜¾ç¤º
[root@ubuntu2204 ~]# hello    # è¿™é‡Œæ˜¾ç¤ºçš„helloï¼Œæ˜¯ä»çª—å£1å‘é€è¿‡æ¥çš„
```



èŒƒä¾‹ï¼šæ ‡å‡†é”™è¯¯è¾“å‡ºè‡³å…¶ä»–ç»ˆç«¯

```bash
# åœ¨ç»ˆç«¯çª—å£1æŸ¥çœ‹
[root@ubuntu2204 ~]# tty
/dev/pts/1

# åœ¨ç»ˆç«¯çª—å£3æŸ¥çœ‹ 
[root@ubuntu2204 ~]# tty
/dev/pts/3

# åœ¨ç»ˆç«¯çª—å£1æ‰§è¡Œ
[root@ubuntu2204 ~]#lss > /dev/pts/3
æ‰¾ä¸åˆ°å‘½ä»¤ â€œlssâ€ï¼Œæ‚¨çš„æ„æ€æ˜¯ï¼š
  â€œgssâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… libgss-dev (1.0.3-7)
  â€œlscâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… livescript (1.6.1+dfsg-2)
  â€œlswâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… suckless-tools (46-1)
  â€œlrsâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… lrslib (0.71a-1)
  â€œlsâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… coreutils (8.32-4.1ubuntu1.2)
  â€œlvsâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… lvm2 (2.03.11-2.1ubuntu5)
  â€œlsmâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… lsm (1.0.4-2)
  â€œassâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… irpas (0.10-9)
  â€œssâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… iproute2 (5.15.0-1ubuntu2)
  â€œlessâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… less (590-1ubuntu0.22.04.3)
  â€œissâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… insilicoseq (1.5.4-2)
  â€œlesâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… atm-tools (1:2.5.1-4build2)
  â€œlsnsâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… util-linux (2.37.2-4ubuntu3.4)
  â€œlssuâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… nilfs-tools (2.2.8-1)
  â€œlshâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… lsh-client (2.1-13)
å°è¯• apt install <deb name>

# ç»ˆç«¯çª—å£3æ— ä»»ä½•æ˜¾ç¤º

# åœ¨ç»ˆç«¯çª—å£1æ‰§è¡Œ
[root@ubuntu2204 ~]# lss 2> /dev/pts/3

# ç»ˆç«¯çª—å£3æ˜¾ç¤º
[root@ubuntu2204 ~]#æ‰¾ä¸åˆ°å‘½ä»¤ â€œlssâ€ï¼Œæ‚¨çš„æ„æ€æ˜¯ï¼š
  â€œassâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… irpas (0.10-9)
  â€œissâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… insilicoseq (1.5.4-2)
  â€œlssuâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… nilfs-tools (2.2.8-1)
  â€œlsnsâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… util-linux (2.37.2-4ubuntu3.4)
  â€œssâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… iproute2 (5.15.0-1ubuntu2)
  â€œlvsâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… lvm2 (2.03.11-2.1ubuntu5)
  â€œlscâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… livescript (1.6.1+dfsg-2)
  â€œlsâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… coreutils (8.32-4.1ubuntu1.2)
  â€œlsmâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… lsm (1.0.4-2)
  â€œlesâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… atm-tools (1:2.5.1-4build2)
  â€œlshâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… lsh-client (2.1-13)
  â€œlswâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… suckless-tools (46-1)
  â€œlessâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… less (590-1ubuntu0.22.04.3)
  â€œgssâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… libgss-dev (1.0.3-7)
  â€œlrsâ€ å‘½ä»¤æ¥è‡ª Debian è½¯ä»¶åŒ… lrslib (0.71a-1)
å°è¯• apt install <deb name>
```



èŒƒä¾‹ï¼šé‡å®šå‘è‡³æ–‡ä»¶

```bash
# æ ‡å‡†è¾“å‡ºé‡å®šå‘è‡³æ–‡ä»¶ï¼Œè¦†ç›–
[root@ubuntu2204 ~]# cat fstab > out.log

# æ ‡å‡†è¾“å‡ºé‡å®šå‘è‡³æ–‡ä»¶ï¼Œè¿½åŠ 
[root@ubuntu2204 ~]# cat fstab >> out.log

#æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘è‡³æ–‡ä»¶ï¼Œè¦†ç›–
[root@ubuntu2204 ~]# cat null 2> err.log

#æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘è‡³æ–‡ä»¶ï¼Œè¿½åŠ 
[root@ubuntu2204 ~]# cat null 2>> err.log
```



**æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºå„è‡ªå®šå‘è‡³ä¸åŒä½ç½®**

æ ¼å¼ï¼š

```bash
COMMAND > sucess.out 2> /path/to/error.out
```



èŒƒä¾‹ï¼šåŒæ—¶æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡º

```bash
[root@ubuntu2204 ~]# ls hello.sh he > success.log 2> error.log

[root@ubuntu2204 ~]# cat success.log 
hello.sh

[root@ubuntu2204 ~]# cat error.log 
ls: æ— æ³•è®¿é—® 'he': æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
```





**åˆå¹¶æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºä¸ºåŒä¸€ä¸ªæ•°æ®æµè¿›è¡Œé‡å®šå‘**

æ ¼å¼ï¼š

```bash
&>                   # è¦†ç›–é‡å®šå‘
&>>                  # è¿½åŠ é‡å®šå‘

COMMAND > /path/to/file.out 2>&1 
COMMAND >> /path/to/file.out 2>&1
```



èŒƒä¾‹ï¼šæ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘è‡³åŒä¸€ä¸ªæ–‡ä»¶

```bash
# æ­£å¸¸æ‰§è¡Œ
[root@ubuntu2204 ~]#ls fstab null
ls: æ— æ³•è®¿é—® 'null': æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
fstab

#æ ‡å‡†è¾“å‡ºé‡å®šå‘è‡³ out.log,æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘è‡³æ ‡å‡†è¾“å‡º
[root@ubuntu2204 ~]# ls fstab null > out.log 2>&1

# æŸ¥çœ‹
[root@ubuntu2204 ~]#cat out.log 
ls: æ— æ³•è®¿é—® 'null': æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
fstab

# ä¸2>&1ç­‰ä»·
[root@ubuntu2204 ~]#ls fstab null &> out.log
```

è¡¥å……ï¼š`&`ç¬¦å·çš„ä½œç”¨

- è¡¨ç¤ºè¦æ“ä½œçš„æ˜¯æ–‡ä»¶æè¿°ç¬¦è€Œéæ–‡ä»¶æˆ–å‘½ä»¤ã€‚
- ä¾‹å¦‚`&1`è¿™é‡ŒæŒ‡çš„æ˜¯æ–‡ä»¶æè¿°ç¬¦1



èŒƒä¾‹ï¼šæ¸…é™¤å¤§æ–‡ä»¶

```bash
# é€šç”¨
[root@ubuntu2204 ~]# cat /dev/null > /data/file.log

# ä¾èµ–äºshellç±»å‹,ä¸é€šç”¨
[root@ubuntu2204 ~]# > /data/file.log
```



#### å•è¡Œé‡å®šå‘ä¸å¤šè¡Œé‡å®šå‘è¾“å‡º

```bash
å•è¡Œé‡å®šå‘ï¼š
cat > cat.log

å¤šè¡Œé‡å®šå‘ï¼š
cat > cat2.log <<EOF  # EOFæ˜¯ç»“æŸç¬¦

# å•è¡Œé‡å®šå‘åœ¨å›è½¦å¯ç”¨å‘½ä»¤æ˜¯ï¼Œå°±å·²ç»åˆ›å»ºäº†æ–‡ä»¶ï¼Œç„¶åæ¯è¾“å…¥ä¸€è¡Œï¼Œå›è½¦åï¼Œå†…å®¹å°±æµå…¥æŒ‡å®šæ–‡ä»¶
# å¤šè¡Œé‡å®šå‘æ˜¯åœ¨æ‰€æœ‰å‘½ä»¤éƒ½è¾“å…¥å®Œä¹‹åï¼Œé‡åˆ°EOFç»“æŸæ—¶ï¼Œæ‰ä¸€èµ·æ‰§è¡Œæ‰€æœ‰å‘½ä»¤
```



èŒƒä¾‹ï¼šå¤šè¡Œé‡å®šå‘

```bash
[root@ubuntu2204 ~]#cat > cat.log <<EOF
> 11111
> 22222
> 33333
> EOF

[root@ubuntu2204 ~]#cat cat.log 
11111
22222
33333
```





#### æ ‡å‡†è¾“å…¥é‡å®šå‘

```ABAP
ä½¿ç”¨æ ‡å‡†è¾“å…¥çš„å‰æï¼šå‘½ä»¤æ”¯æŒæ ‡å‡†è¾“å…¥
```



##### tr å‘½ä»¤

ç”¨äºè½¬æ¢å­—ç¬¦ã€åˆ é™¤å­—ç¬¦å’Œå‹ç¼©é‡å¤çš„å­—ç¬¦ã€‚å®ƒä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®å¹¶å°†ç»“æœè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º

```bash
tr [OPTION]... SET1 [SET2]

#å¸¸ç”¨é€‰é¡¹
-c|-C|--complement            # å–å­—ç¬¦é›†çš„è¡¥é›† 
-d|--delete                   # åˆ é™¤æ‰€æœ‰å±äºç¬¬ä¸€å­—ç¬¦é›†çš„å­—ç¬¦        
-s|--squeeze-repeats          # æŠŠè¿ç»­é‡å¤çš„å­—ç¬¦ä»¥å•ç‹¬ä¸€ä¸ªå­—ç¬¦è¡¨ç¤ºï¼Œå³å»é‡
-t|--truncate-set1            # å°†ç¬¬ä¸€ä¸ªå­—ç¬¦é›†å¯¹åº”å­—ç¬¦è½¬æ¢ä¸ºç¬¬äºŒä¸ªå­—ç¬¦é›†å¯¹åº”çš„å­—ç¬¦ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦é›†çš„å­—ç¬¦æ•°é‡å¤šäºç¬¬äºŒå­—ç¬¦é›†                                 æ•°é‡ï¼Œè¶…å‡ºéƒ¨åˆ†å¿½ç•¥    

#å¸¸ç”¨é€šé…ç¬¦
[:alnum:]ï¼šå­—æ¯å’Œæ•°å­—
[:alpha:]ï¼šå­—æ¯
[:digit:]ï¼šæ•°å­—
[:lower:]ï¼šå°å†™å­—æ¯
[:upper:]ï¼šå¤§å†™å­—æ¯
[:space:]ï¼šç©ºç™½å­—ç¬¦
[:print:]ï¼šå¯æ‰“å°å­—ç¬¦
[:punct:]ï¼šæ ‡ç‚¹ç¬¦å·
[:graph:]ï¼šå›¾å½¢å­—ç¬¦
[:cntrl:]ï¼šæ§åˆ¶(éæ‰“å°)å­—ç¬¦
[:xdigit:]ï¼šåå…­è¿›åˆ¶å­—ç¬¦
```



ç¤ºä¾‹

```bash
# æ–‡ä»¶é‡å®šå‘
# æ›¿æ¢å¤§å°å†™
[root@ubuntu2204 ~]#tr 'a-z' 'A-Z' < /etc/issue
UBUNTU 22.04.1 LTS \N \L

[root@ubuntu2204 ~]#tr [:lower:] [:upper:] < /etc/issue
UBUNTU 22.04.1 LTS \N \L

# ä¿ç•™æ‰€éœ€å­—ç¬¦
[root@ubuntu2204 ~]#tr -dc 'a-z0-9A-Z' < /dev/random |head -c 10
72waODnf7x

# å‘½ä»¤é‡å®šå‘
# å‹ç¼©ç©ºæ ¼
[root@ubuntu2204 ~]#tr -s ' ' < <(df)    # <(df) ä¼šä¸´æ—¶ç”Ÿæˆä¸€ä¸ªä¼ªæ–‡ä»¶
æ–‡ä»¶ç³»ç»Ÿ 1Kçš„å— å·²ç”¨ å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹
tmpfs 198824 1320 197504 1% /run
/dev/mapper/ubuntu--vg-ubuntu--lv 101590008 6660852 89722528 7% /
tmpfs 994120 0 994120 0% /dev/shm
tmpfs 5120 0 5120 0% /run/lock
/dev/sda2 1992552 248988 1622324 14% /boot
tmpfs 198824 0 198824 0% /run/user/0
/dev/sdb 20466256 28 19401268 1% /mnt

# åŒä¸Š
[root@ubuntu2204 ~]# tr -s ' ' <<< `df`
```



##### bc å‘½ä»¤

`bc` æ˜¯ Linux ä¸­éå¸¸å¸¸ç”¨çš„**ä»»æ„ç²¾åº¦è®¡ç®—å™¨è¯­è¨€ï¼ˆBasic Calculatorï¼‰**ï¼Œæ”¯æŒæ•´æ•°ã€æµ®ç‚¹æ•°ã€å˜é‡ã€è‡ªå®šä¹‰å‡½æ•°ç­‰ï¼Œéå¸¸é€‚åˆç”¨äºå‘½ä»¤è¡Œä¸­çš„æ•°å­¦è®¡ç®—ï¼Œå°¤å…¶æ˜¯ **shell è„šæœ¬ä¸­çš„æµ®ç‚¹æ•°è®¡ç®—**ã€‚



**è¿›å…¥äº¤äº’æ¨¡å¼**

```bash
[root@ubuntu2204 ~]#bc
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
This is free software with ABSOLUTELY NO WARRANTY.
For details type `warranty'. 
1+2
3
quit  # é€€å‡º
```



**ä½¿ç”¨æµ®ç‚¹æ•°è®¡ç®—ï¼ˆé»˜è®¤ä¸å¼€å¯å°æ•°ï¼‰**

```bash
[root@ubuntu2204 ~]# bc < <(echo "1/2")
0
```

 æ­£ç¡®æ–¹å¼ï¼šå¯ç”¨å°æ•°è®¡ç®—ç²¾åº¦

```bash
[root@ubuntu2204 ~]# bc < <(echo "scale=4; 1 / 2")
.5000
```



**å˜é‡ä¸è¡¨è¾¾å¼**

```bash
[root@ubuntu2204 ~]# bc < <(echo "a = 5; b = 2; scale=2; a / b")
2.50
```





#### é«˜çº§é‡å®šå‘å†™æ³•

##### 1.3.2.4.1 cmd <<< "string"

å«ä¹‰æ˜¯ here-string ï¼Œè¡¨ç¤ºä¼ ç»™ç»™cmdçš„stdinçš„å†…å®¹ä»è¿™é‡Œå¼€å§‹æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚



èŒƒä¾‹ï¼šç›´æ¥å­—ç¬¦ä¸²

```bash
[root@ubuntu2204 ~]# cat <<< "abc"
abc

[root@ubuntu2204 ~]# bc <<< "1+2+3"
6
```



èŒƒä¾‹ï¼šï¼šæ‰§è¡Œå‘½ä»¤ä½œé‡å®šå‘è¾“å…¥

```bash
[root@ubuntu2204 ~]# bc <<< `echo 1+2+3`
6

[root@ubuntu2204 ~]# tr 'a-z' 'A-Z' <<< `hostname`
ROCKY86
```



##### cmd1 < <(cmd2)

åç§°ä¸º Process substitution ,æ˜¯ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆ

<(cmd2) è¡¨ç¤ºæŠŠcmd2çš„è¾“å‡ºå†™å…¥ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶, æ³¨æ„ï¼š< ç¬¦å· ä¸ï¼ˆ ç¬¦å·ä¹‹é—´æ²¡æœ‰ç©ºæ ¼



èŒƒä¾‹

```bash
[root@ubuntu2204 ~]# bc < <(echo 1+2+3)
6

[root@ubuntu2204 ~]# bc < <(seq -s + 3)
6

[root@ubuntu2204 ~]# tr 'a-z' 'A-Z' < <(hostname)
ROCKY86
```





èŒƒä¾‹ï¼šæŸ¥çœ‹ä¸­é—´æ–‡ä»¶

```bash
[root@ubuntu2204 ~]#ll <(hostname)
lr-x------ 1 root root 64  6æœˆ  4 17:10 /dev/fd/63 -> 'pipe:[1264724]'

# è¯´æ˜æè¿°ç¬¦ 63 æ˜¯ä¸€ä¸ª FIFOï¼ˆç®¡é“ï¼‰æ–‡ä»¶ï¼Œè€Œ 1264724 æ˜¯å®ƒçš„â€œinode IDâ€ã€‚
```







### ç®¡é“

åœ¨shell ä¸­ï¼Œå¯ä»¥å°†ä¸¤ä¸ªæˆ–å¤šä¸ªå‘½ä»¤(ç¨‹åº|è¿›ç¨‹)è¿æ¥èµ·æ¥ï¼Œå°†å‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºåä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ï¼Œ å°±åƒæ‹¿æ°´ç®¡å°†ä¸¤ä¸ªå‘½ä»¤è¿èµ·æ¥

ä½¿ç”¨ç®¡é“ï¼Œè¦æ±‚å‰ä¸€ä¸ªå‘½ä»¤å¿…é¡»æ”¯æŒæ ‡å‡†è¾“å‡ºï¼Œ**åä¸€ä¸ªå‘½ä»¤å¿…é¡»æ”¯æŒæ ‡å‡†è¾“å…¥**ï¼›



æ ¼å¼

```bash
COMMAND1|COMMAND2|COMMAND3|...
```



åŠŸèƒ½è¯´æ˜ï¼š

-  å°†å‘½ä»¤1çš„STDOUTå‘é€ç»™å‘½ä»¤2çš„STDINï¼Œå‘½ä»¤2çš„STDOUTå‘é€åˆ°å‘½ä»¤3çš„STDIN  
-  æ‰€æœ‰å‘½ä»¤ä¼šåœ¨å½“å‰shellè¿›ç¨‹çš„å­shellè¿›ç¨‹ä¸­æ‰§è¡Œ  
-  ç»„åˆå¤šç§å·¥å…·çš„åŠŸèƒ½



æ³¨æ„ï¼šSTDERRé»˜è®¤ä¸èƒ½é€šè¿‡ç®¡é“è½¬å‘ï¼Œå¯åˆ©ç”¨2>&1 æˆ– |& å®ç°ï¼Œæ ¼å¼å¦‚ä¸‹

```bash
COMMAND1 2>&1 | COMMAND2 
COMMAND1 |& COMMAND2
```



èŒƒä¾‹

```bash
[root@ubuntu2204 ~]# echo 1+2+3|bc
 6
 
[root@ubuntu2204 ~]# cat /var/log/syslog | more
 
[root@ubuntu2204 ~]#echo $PATH | tr ':' '\n'
/usr/local/sbin
/usr/local/bin
/usr/sbin
/usr/bin
/sbin
/bin
/usr/games
/usr/local/games
/snap/bin
```



èŒƒä¾‹ï¼šå¤šé‡ç®¡é“

```bash
[root@ubuntu2204 ~]# cat /dev/random |tr -dc [a-zA-Z0-9.]|head -c 20
zzHOaiy[pDIAicMejgYe
```





èŒƒä¾‹ï¼šæ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºåŒæ—¶ä½¿ç”¨ç®¡é“

```bash
[root@ubuntu2204 ~]# ls fstab null 2>&1 | tr 'a-z' 'A-Z'
LS: CANNOT ACCESS 'NULL': NO SUCH FILE OR DIRECTORY
FSTAB
```



èŒƒä¾‹ï¼šå®ç°é‚®ä»¶æœåŠ¡

```bash
[root@ubuntu2204 ~]#cat > /etc/mail.rc <<EOF
> set from=15104600741@163.com
> set smtp=smtp.163.com
> set smtp-auth-user=15104600741@163.com
> set smtp-auth-password=OZUREAAOLBQQGUTQ
> set smtp-auth=login
> set ssl-verify=ingore
> EOF

# ä¸‹è½½mail
[root@ubuntu2204 ~]# apt install mailutils

[root@ubuntu2204 ~]#echo "test email" |mail -s "test" 3140394153@qq.com
```



èŒƒä¾‹ï¼šç”¨æˆ·å¯†ç ä¿®æ”¹

```bash
[root@rocky9 etc]# useradd tom
[root@rocky9 etc]# passwd --stdin tom
Changing password for user tom.
123456
passwd: all authentication tokens updated successfully.

[root@centos8 ~]#cat pass.txt
 centos
 
[root@rocky86 ~]# passwd --stdin jose < pass.txt
Changing password for user jose.
passwd: all authentication tokens updated successfully

[root@rocky86 ~]# cat pass.txt | passwd --stdin jose
Changing password for user jose.
passwd: all authentication tokens updated successfully.
```

```bash
#ubuntu ä¸­ passwd å‡½æ•°æ²¡æœ‰ --stdin é€‰é¡¹
[root@ubuntu2204 ~]#echo -e "123456\n123456" | passwd mystical
New password: Retype new password: passwd: password updated successfully
```



#### teeç®¡é“

å°†æ ‡å‡†è¾“å…¥å¤åˆ¶åˆ°æ¯ä¸ªæŒ‡å®šæ–‡ä»¶ï¼Œå¹¶æ˜¾ç¤ºåˆ°æ ‡å‡†è¾“å‡º

```ABAP
æ—¢è¦åˆè¦
```



æ ¼å¼

```bash
tee [OPTION]... [FILE]...

# å¸¸ç”¨é€‰é¡¹
-a|--append                  # å†…å®¹è¿½åŠ åˆ°ç»™å®šçš„æ–‡ä»¶è€Œéè¦†ç›–
-i|--ignore-interrupts       # å¿½ç•¥ä¸­æ–­ä¿¡å·
-p                           # å¯¹å†™å…¥éç®¡é“çš„è¡Œä¸ºæ’æŸ¥é”™è¯¯ï¼Œå…¶ä½¿ç”¨çš„æ˜¯ warn-nopipe
--output-error[=æ¨¡å¼]         # #è®¾ç½®å†™å…¥å‡ºé”™æ—¶çš„è¡Œä¸º (warn|warn-nopipe|exit|exit-nopipe)

cmd1 | tee [-a ] filename | cmd2 
```



èŒƒä¾‹

```bash
#æ¥å—æ ‡å‡†è¾“å…¥ï¼Œåœ¨æ ‡å‡†è¾“å‡ºä¸Šæ‰“å°ï¼Œå¹¶å†™æ–‡ä»¶
[root@ubuntu2204 ~]# tee tee.log

#ç®¡é“é‡å®šå‘
[root@ubuntu2204 ~]# echo hello | tee tee.log
hello

#tee.log é‡Œé¢æ˜¯hello,ç»ˆç«¯è¾“å‡ºæ˜¯HELLO
[root@ubuntu2204 ~]# echo hello | tee tee.log | tr 'a-z' 'A-Z'
HELLO

# tee.log å’Œç»ˆç«¯è¾“å‡ºéƒ½æ˜¯å¤§å†™
[root@ubuntu2204 ~]# echo hello | tr 'a-z' 'A-Z' | tee tee.log
HELLO

# è¿½åŠ 
[root@ubuntu2204 ~]# echo hello | tr 'a-z' 'A-Z' | tee -a tee.log
HELLO
```















