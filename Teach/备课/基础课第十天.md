## 1.4 http基础知识

### 1.4.1 Web浏览器发起HTTP请求得典型场景

![image-20250617214154980](D:\git_repository\cyber_security_learning\markdown_img\image-20250617214154980-1752047439883-1.png)

**详解过程**

- 首先服务器监听打开了443或者80端口
- 浏览器从url中解析出域名
- 根据域名查询DNS，获取域名对应得IP地址
- 浏览器根据ip地址，和服务器三次握手建立TCP链接，https会额外完成TLS/SSL的握手
- 构造HTTP请求，在构造请求的过程中，填充相应的HTTP头部，包括上下文所需要的信息，至头部中
- 通过链接发起HTTP请求
- 服务器接收到HTTP请求后，完成资源的表述，把客户端请求的文件如html页面作为包体返回给浏览器
- 浏览器在渲染引擎中解析响应，根据这个响应中一些其他的超链接资源去构造其他HTTP请求



### 1.4.2  Hypertext Transfer Protocol(HTTP)协议

![image-20250617214406486](D:\git_repository\cyber_security_learning\markdown_img\image-20250617214406486-1752047439884-2.png)

- **Stateless**：无状态的，也就是说连续的两个请求中，后一个请求不能依赖前一个请求中相应的字段。或者head头部等。

- **request/reponse**：这里说明一定是基于一个连接，首先由客户端发起请求，然后服务器才能在这个连接上发起response响应，它必须以这样的方式工作。

- **extensible semantics**：语义可扩展，协议的设计允许不同版本之间兼容，并且新版本中增加的新功能不会影响老版本的正常工作。

  > **HTTP 的语义可扩展表现在哪？**
  >
  > 例子：
  >
  > - HTTP/1.1 引入了 `Host` 头、持久连接（Keep-Alive）、管道化等新特性；
  > - HTTP/1.0 的服务器并不了解这些新特性；
  > - 但 **浏览器仍然可以向 HTTP/1.0 的服务器发送兼容的请求**，并且 **服务器可以正常响应**。
  >
  > 原因：
  >
  > - HTTP 的请求/响应结构是基于「**文本协议** + **键值对头部**」的形式；
  > - **不认识的 header**，服务器/客户端是允许 **忽略** 的 —— 这是协议设计上的要求；
  > - 所以 HTTP/1.1 客户端即使发送了一些 HTTP/1.1 才定义的头部，HTTP/1.0 的服务器看到不认识的头部时会 **跳过它们**，只处理它认识的那部分。

  

- **self-decriptive**：我们所传送的消息，是要一个子描述的消息，我们从一个请求中就能知道这个消息是视频还是文本还是音频，而不需要依赖于其他的请求

- **hypertext information**：这个是一个超文本系统，我们传输的不只有文档，还有视频，音频等大颗粒度的内容







### 1.4.4 OSI（Open System Interconnection Reference Model）概念模型

![image-20250617164913865](D:\git_repository\cyber_security_learning\markdown_img\image-20250617164913865-1752047439884-5.png)

SI是一个概念模型，也就是说它从来没有被实现过，但是我们在实现网络协议的时候，必须要参考这样一个概念模型，才能非常好的理解网络中的协议分层



**应用层：** HTTP，FTP，DNS，都在应用层，应用层解决的是业务问题

**表示层：** 表示层负责把网络中的消息转换成应用层可以读取的消息

> 比如：ssl，ssl加密的数据，用户是无法直接读取的，需要表示层做一次转换。所以TLS/SSL 工作在表示层

**会话层：** 是一个完全概念化的一层，Session。他负责建立会话，握手，维持连接，关闭，但实际上传输层（TCP）和表示层，都有部分延伸到会话层，因此会话层只是一个概念。用来帮助理解会话这个概念。

**传输层：** 包括TCP，UDP协议，主要解决进程与进程之间的通讯。除此之外，TCP还解决了数据传输的可靠性。

**网络层：**IP协议，确保了在广域网中，可以把报文从一个主机发送到另一个主机上。

**数据链路层：**负责局域网中的主机间数据交换。



OSI仅仅是一个概念模型，而互联网上实际使用的是TCP/IP模型

<img src="D:\git_repository\cyber_security_learning\markdown_img\image-20250617164938809-1752047439884-7.png" alt="image-20250617164938809" style="zoom:150%;" />

#### 1.4.4.1 抓包演示数据包层层封装

**应用层：**

![image-20250617184328846](D:\git_repository\cyber_security_learning\markdown_img\image-20250617184328846-1752047439884-8.png)

**传输层头部数据**

![image-20250617184405245](D:\git_repository\cyber_security_learning\markdown_img\image-20250617184405245-1752047439884-9.png)

**网络层头部数据**

![image-20250617184430070](D:\git_repository\cyber_security_learning\markdown_img\image-20250617184430070-1752047439884-10.png)

**数据链路层头部数据**

![image-20250617184522885](D:\git_repository\cyber_security_learning\markdown_img\image-20250617184522885-1752047439884-11.png)



### 1.4.5 Cookie 与 Session

#### 1.4.5.1 Cookie的格式与约束

Cookie是前端编程中经常使用的概念。 我们可以使用cookie利用浏览器帮助我们存放用户的相关状态信息，保存用户已经做了哪些事情。

- Cookie的工作原理是什么？

- Cookie的限制又是什么？

- Session是服务器端所维护的会话状态，Session又怎样与Cookie关联起来？ 





##### 1.4.5.1.1 Cookie是什么？

![image-20250618091730167](D:\git_repository\cyber_security_learning\markdown_img\image-20250618091730167.png)



**RFC6265，HTTP State Management Mechanism**



Cookie保持在客户端，由浏览器维护（但是是由服务端生成的），表示应用状态的HTTP头部

- 存放在内存或者磁盘中
- 服务器端生成Cookie在响应中通过Set-Cookie头部告知客户端（允许多个Set-Cookie头部传递多个值）
- 客户端得到Cookie后，后续请求都会自动将Cookie头部携带至请求中





##### 1.4.5.1.2 Cookie 与 Set-Cookie头部的定义

Cookie 头部中可以存放多个 **name/value** 名值对

```haskell
cookie-header = "Cookie:" OWS cookie-string OWS
  cookie-string = cookie-pai r*( ";" SP cookie-pair )
  cookie-pair = cookie-name "=" cookie-value
```



Set-Cookie头部一次只能传递1个 **name/value** 名值对，响应中可以含多个头部

```haskell
set-cookie-header = "Set-Cookie:" SP set-cookie-string
  set-cookie-string = cookie-pair *( ";" SP cookie-av )
  cookie-pair = cookie-name "=" cookie-value
  cookie-av: 描述 cookie-pair 的可选属性
```



浏览器查看Set-Cookie

![image-20250618093022285](D:\git_repository\cyber_security_learning\markdown_img\image-20250618093022285.png)



##### 1.4.5.1.3 Set-Cookie 中描述cookie-pair的属性

![image-20250618093427872](D:\git_repository\cyber_security_learning\markdown_img\image-20250618093427872.png)



##### 1.4.5.1.4 Cookie 使用的限制

RFC规范对浏览器使用Cookie的要求

- 每条Cookie的长度（包括 name, value 以及描述的属性等总长度）至少要支持达到 4KB
- 每个域名下至少支持50 个 Cookie
- 至少要支持 3000 个 Cookie



代理服务器传递Cookie时会有限制（Nginx默认32k）



##### 1.4.5.1.5 Cookie 在协议设计上的问题

- Cookie会被附加在每个HTTP请求中，所以无形中增加了流量
- 由于在HTTP请求中的 Cookie 是明文传递的，所以安全性成问题（除非用HTTPS）
- Cookie的大小不应超过4KB，因为对于复杂的存储需求来说是不够用的。





#### 1.4.5.2 Session 及第三方Cookie的工作原理

##### 1.4.5.2.1 登录场景下 Cookie与Session的常见用法

![image-20250618094437692](D:\git_repository\cyber_security_learning\markdown_img\image-20250618094437692.png)

- 首先登录请求发起一个POST表单的login操作。
- 服务器收到请求后，从表单中读取用户名和密码，和持久化数据中的数据进行比对，比对通过后，把登录状态生成session（这个session是有时效的）。
- 将有时效的session数据写入内存数据库
- 将session中的session_ID在响应中返回给浏览器，SESSIOIN返回的方式是Set-Cookie
- 浏览器在它的Storage中保存收到的Cookie
- 浏览器发起的后续请求会携带这个Cookie信息
- 服务器收到携带Cookie的信息后，会在后端解析Cookie携带的Session_ID，判断该用户是否是登录的，如果判断成功，则执行该用户的相关业务，并将结果返回给用户。

| 步骤                                    | 建议或补充                                                   |
| --------------------------------------- | ------------------------------------------------------------ |
| 1. 用户发送 POST /login 请求            | 可以带表单或 JSON 格式登录信息                               |
| 2. 服务端读取用户名密码，与持久化库比对 | 实际上可使用数据库或认证中心（如 LDAP）                      |
| 3. 验证通过，生成 session（含有效期）   | 通常 `session = { user_id, expires_at, ... }`                |
| 4. 将 session 存入“内存数据库”          | 通常是 Redis，或者内存 hashmap（如 Java `HttpSession`）      |
| 5. 返回 Set-Cookie，设置 `session_id`   | 示例：`Set-Cookie: session=abc123; Path=/; HttpOnly; Secure` |
| 6. 浏览器接收并保存 Cookie              | 浏览器自动保存，并根据 Path/Domain 控制何时发送              |
| 7. 后续请求自动带上 Cookie              | 浏览器自动加上 `Cookie: session=abc123`                      |
| 8. 服务端读取 Cookie 并验证 session     | 查 Redis 判断 session 是否存在、是否过期                     |
| 9. 执行业务并返回结果                   | 此时说明用户已认证，按权限执行对应业务                       |









## 1.5 web站点部署



### 1.5.1 主流 Web 服务介绍

Web服务是提供Web信息服务的软件，它通过HTTP或HTTPS协议与客户端通信，接受客户端请求， 处理请求，然后返回响应数据，Web 服务器的主要工作是通过存储、处理和交付网页给用户来显示网站 内容，一个成熟的WEB服务器软件不仅仅只是处理客户端请求，还要有良好的安全性和稳定性，以满足用户不断变化和增长的需求



以下是一些主流的Web服务器以及它们的特点，这些Web服务器都有各自特点和优势，在使用的时候， 要取决于项目需求，性能要求及开发人员偏好等



**Apache**

Apache 是目前市场占有率最高的WEB服务器，它免费开源，功能强大，支持多种操作系统，可在多平 台上运行，包括Unix、Linux、Windows等，同时具有强大的模块化体系结构，提供了丰富的模块，也 支持许多第三方模块，允许用户自定义服务器功能，另外也支持虚拟主机配置



**Nginx**

Nginx是一个高性能的Web服务器，广泛应用于高并发、大流量的互联网应用场景中，Nginx还可以作为反向代理服务器、负载均衡服务器，其优异的静态处理能力，使其在处理静态文件时具有很高的效率， 由于选择了高效的网络IO模型，使其在高并发大流量的工作场景下，对于资源（CPU，内存等）的要求非常低，且运行非常稳定



**Tomcat**

Tomcat是一个开放源代码、运行 servlet 和 JSP Web 应用软件，它不仅仅是一个WEB服务器，也是一个 Servle t和 JSP 容器，但其对静态文件和高并发的处理能力较弱







#### 1.5.1.1 WEB 服务器市场占有率排名

W3Techs，全名 **Web Technology Surveys**，是一个专门统计全球网站使用的技术情况的网站，包括：

- Web 服务器（如 Nginx、Apache）
- 编程语言（如 PHP、Node.js）
- CMS（如 WordPress、Drupal）
- JS 框架、CDN、SSL 使用情况等

```http
https://w3techs.com/technologies/overview/web_server
```

This diagram shows the percentages of websites using various web servers. See [technologies overview](https://w3techs.com/technologies) for explanations on the methodologies used in the surveys. Our reports are updated daily.（号称每日更新）

Nginx is used by 33.7% of all the websites whose web server we know.

| [Nginx](https://w3techs.com/technologies/details/ws-nginx)   | 33.7%                     |
| :----------------------------------------------------------- | ------------------------- |
| [Apache](https://w3techs.com/technologies/details/ws-apache) | 26.0%                     |
| [Cloudflare Server](https://w3techs.com/technologies/details/ws-cloudflare) | 24.0%                     |
| [LiteSpeed](https://w3techs.com/technologies/details/ws-litespeed) | 14.7%                     |
| [Node.js](https://w3techs.com/technologies/details/ws-nodejs) | 4.6%                      |
| [Microsoft-IIS](https://w3techs.com/technologies/details/ws-microsoftiis) | 3.9%                      |
| [Envoy](https://w3techs.com/technologies/details/ws-envoyproxy) | 1.4%                      |
| [Google Servers](https://w3techs.com/technologies/details/ws-google) | 0.8%                      |
| [Caddy](https://w3techs.com/technologies/details/ws-caddy)   | 0.3%                      |
| [IdeaWebServer](https://w3techs.com/technologies/details/ws-ideawebserver) | 0.1%                      |
| [Tengine](https://w3techs.com/technologies/details/ws-tengine) | 0.1%                      |
| [Kestrel](https://w3techs.com/technologies/details/ws-kestrel) | 0.1%                      |
| [Cowboy](https://w3techs.com/technologies/details/ws-cowboy) | 0.1%                      |
| [ArvanNginx](https://w3techs.com/technologies/details/ws-arvannginx) | 0.1%                      |
| Percentages of websites using various web servers Note: a website may use more than one web server | W3Techs.com, 15 June 2025 |









### 1.5.2  Nginx服务

#### 1.5.2.1 Ubuntu环境部署Nginx

简介

```bat
	Nginx 一般可以使用 apt/yum 来安装二进制包，如果需要使用特定的功能模块，也可以使用源码安装，使用 yum/apt 安装的时候，只能安装操作系统发行版厂商己经提交到仓库中的版本，如果需要安装更新的版本或历史版本，可自行配置官方仓库，然后进行安装。
```

Ubuntu系统软件安装

```bash
root@ubuntu24:~# apt install nginx -y
```

```bat
查看服务状态
[root@magedu ~]# systemctl is-active nginx
active

[root@magedu ~]# ss -ntlp
State       Recv-Q      Send-Q           Local Address:Port             Peer Address:Port      Process                           
LISTEN      0           4096                127.0.0.54:53                    0.0.0.0:*          users:(("systemd-resolve",pid=738,fd=17))                                            
LISTEN      0           511                    0.0.0.0:80                    0.0.0.0:*          users:(("nginx",pid=1759,fd=5),("nginx",pid=1758,fd=5),("nginx",pid=1757,fd=5))      
LISTEN      0           4096             127.0.0.53%lo:53                    0.0.0.0:*          users:(("systemd-resolve",pid=738,fd=15))                                            
LISTEN      0           128                  127.0.0.1:6010                  0.0.0.0:*          users:(("sshd",pid=1367,fd=7))   
LISTEN      0           128                      [::1]:6010                     [::]:*          users:(("sshd",pid=1367,fd=5))   
LISTEN      0           511                       [::]:80                       [::]:*          users:(("nginx",pid=1759,fd=6),("nginx",pid=1758,fd=6),("nginx",pid=1757,fd=6))      
LISTEN      0           4096                         *:22                          *:*          users:(("sshd",pid=1365,fd=3),("systemd",pid=1,fd=119))
```

浏览器访问效果

![image-20250618101807681](D:\git_repository\cyber_security_learning\markdown_img\image-20250618101807681-1752047439884-12.png)

#### 1.5.2.2 Nginx 软件环境解读

配置文件目录

```bat
# Ubuntu系统
[root@magedu ~]# ls /etc/nginx
conf.d        fastcgi_params  koi-win     modules-available  nginx.conf    scgi_params      sites-enabled  uwsgi_params
fastcgi.conf  koi-utf         mime.types  modules-enabled    proxy_params  sites-available  snippets       win-utf
```

默认首页

```bat
[root@magedu ~]# ls /var/www/html
index.nginx-debian.html

# 在 /var/www/html 目录下添加index.html
[root@magedu ~]# echo hello > /var/www/html/index.html
[root@magedu ~]# curl 10.0.0.231
hello
```



#### 1.5.2.3 常用 nginx 命令

常用命令

```bat
# 检查配置文件语法
[root@magedu ~]# nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful

# 重新加载配置文件
[root@magedu ~]# nginx -s reload
2025/06/18 10:27:24 [notice] 1861#1861: signal process started
```



#### 1.5.2.4 Nginx配置解读

##### 1.5.2.4.1 nginx配置目录结构

```bat
[root@magedu ~]# ll /etc/nginx
total 76
drwxr-xr-x   8 root root 4096 Jun 18 10:14 ./
drwxr-xr-x 114 root root 4096 Jun 18 10:14 ../
drwxr-xr-x   2 root root 4096 Apr  1 02:38 conf.d/                 # 子配置文件目录，在主配置文件中被包含，默认为空
-rw-r--r--   1 root root 1125 Dec  1  2023 fastcgi.conf            # FastCGI配置文件，定义相关配置项，被引用
-rw-r--r--   1 root root 1055 Dec  1  2023 fastcgi_params          # FastCGI配置文件，定义相关配置项，被引用
-rw-r--r--   1 root root 2837 Dec  1  2023 koi-utf                 # 用于转换KOI8-R编码的字符集到UTF-8
-rw-r--r--   1 root root 2223 Dec  1  2023 koi-win                 # 用于转换KOI8-U编码的字符集到UTF-8
-rw-r--r--   1 root root 5465 Dec  1  2023 mime.types              # 包含文件扩展名和相应MIME类型的映射
drwxr-xr-x   2 root root 4096 Apr  1 02:38 modules-available/      # 模块配置文件目录
drwxr-xr-x   2 root root 4096 Apr  1 02:38 modules-enabled/        # 当前生效的模块配置文件目录，用软链接指向真正的文件
-rw-r--r--   1 root root 1446 Dec  1  2023 nginx.conf              * 主配置文件
-rw-r--r--   1 root root  180 Dec  1  2023 proxy_params            # 反向代理配置文件
-rw-r--r--   1 root root  636 Dec  1  2023 scgi_params             # SCGI配置文件，SCGI和FastCGI类似，都是一种协议
drwxr-xr-x   2 root root 4096 Jun 18 10:14 sites-available/        # 所有域名配置文件
drwxr-xr-x   2 root root 4096 Jun 18 10:14 sites-enabled/          * 生效的域名配置文件，用软连接指向site-available中的文件
drwxr-xr-x   2 root root 4096 Jun 18 10:14 snippets/               # 通用的配置片段目录，需要时被引用
-rw-r--r--   1 root root  664 Dec  1  2023 uwsgi_params            # 配置 Nginx uWSGI 模块的默认参数的文件
-rw-r--r--   1 root root 3071 Dec  1  2023 win-utf                 # 编码转换映射转化文件

```

Nginx 配置文件格式说明

- 配置文件由指令与指令块构成
- 每条指令以 ` ; ` 分号结尾，指令与值之间以空格符号分隔
- 可以将多条指令放在同一行，用分号分隔即可，但可读性差，不推荐
- 指令块以{ }大括号将多条指令组织在一起，且可以嵌套指令块
- include 语句允许组合多个配置文件以提升可维护性
- 使用 # 号添加注释，提高可读性
- 使用 $ 符号使用变量
- 变量分为 Nginx 内置变量和自定义变量，自定义变量用 set 指令定义
- 部分指令的参数支持正则表达式





##### 1.5.2.4.2 核心配置文件

nginx配置的完整结构

```bat
# --- 全局配置段 ---
user ...;
worker_processes ...;
...
# --- 事件驱动相关的配置 --
events {
     ...;
}

# --- http/https 协议相关配置段 --
http {
    ...;
    server {
        ...;
        location {
            ...;
        }
    }
}

# --- mail 协议相关配置段，默认被注释 --
mail {
    server {
        ...
    }
}
 
# --- stream 协议相关配置 --
stream {
    ...;
}
```

查看默认主配置文件内容

```bat
[root@magedu ~]# cat /etc/nginx/nginx.conf | grep -Ev "#|^$"
 # --- 全局配置段 ---
user www-data;
worker_processes auto;
pid /run/nginx.pid;
error_log /var/log/nginx/error.log;
include /etc/nginx/modules-enabled/*.conf;

# --- 事件驱动相关的配置 ---
events {
	worker_connections 768;
}

# --- http/https 协议相关配置段 ---
http {
	sendfile on;
	tcp_nopush on;
	types_hash_max_size 2048;
	include /etc/nginx/mime.types;
	default_type application/octet-stream;
	ssl_prefer_server_ciphers on;
	access_log /var/log/nginx/access.log;
	gzip on;
	include /etc/nginx/conf.d/*.conf;
	include /etc/nginx/sites-enabled/*;
}
```



##### 1.5.2.4.3 Server配置段

server 主要用来配置虚拟主机，可以在一台 web 服务器上支持多个域名，一个 server 配置段中可 以有多个 location 配置。location块是Server配置段中的关键部分，用于进一步细分对虚拟主机的请求 处理规则。location块可以基于请求的URL进行匹配，并根据匹配结果执行相应的处理指令。



**常用 server 属性**

当前虚以主机监听的ip,port，是否是default_server，是否支持ssl 等 默认值 *:80|*:8000; 可以写多条，完全说明请参考官方文档

```nginx
listen address[:port] [default_server] [ssl];       
listen port [default_server] [ssl];
listen unix:path [default_server] [ssl];    
```

```nginx
root path;              # 当前虚拟主机网页文件目录，写在location中，文件路径是root+location
index file ...;         # 当前虚拟主机的默认页面，可以写多个，按顺序生效，默认 index.html
server_name name ...;   # 虚拟主机域名，可以写多个值，客户端请求头中的 Host 字段会与此处匹配
```



##### 1.5.2.4.4 Location配置段

**配置样式**

```nginx
location [ = | ~ | ~* | ^~ ] uri { ... }
location @name { ... }
```

```bat
配置段匹配规则
	=              # 用于标准uri前，需要请求字串与uri精确匹配，区分大小写   
	^~             # 用于标准uri前，表示包含正则表达式，匹配以特定字符串开始，区分大小写 
	~              # 用于标准uri前，表示包含正则表达式，区分大小写
	~*             # 用于标准uri前，表示包含正则表达式，不区分大写       
	/str           # 不带符号 匹配以 str 开头的 uri，/ 也是一个字符
	\              # 用于标准uri前，表示包含正则表达式并且转义字符，可以将 . * ?等转义为普通符号    
	@name          # 定义
```

```bat
常用配置项   
root path;             # 定义网站在文件系统上的家目录，server_root/location_root   
index file ...;        # 当前配置段的默认页面，可以写多个，依次生效，默认 index.html
proxy_pass URL;        # 设置反向代理，将符合规则的请求转发到后端服务器进行处理
```



#### 1.5.2.5 Nginx web实践

##### 1.5.2.5.1 server实践准备

查看默认配置文件

```nginx
[root@magedu ~]# grep -Ev '^$|#' /etc/nginx/sites-enabled/default
server {
	listen 80 default_server;
	listen [::]:80 default_server;
	root /var/www/html;
	index index.html index.htm index.nginx-debian.html;
	server_name _;
	location / {
		try_files $uri $uri/ =404;
	}
}
```

准备工作

```bash
# 删除默认配置
root@magedu ~]# rm -f /etc/nginx/sites-enabled/default
```

```bat
# 定制应用页面
mkdir /data/server/nginx/web{1..3} -p
echo "nginx web1" > /data/server/nginx/web1/index.html
echo "nginx web2" > /data/server/nginx/web2/index.html
echo "nginx web3" > /data/server/nginx/web3/index.html
```



#####  1.5.2.5.2 基于端口的站点实践

基于端口号实现多server

```nginx
[root@magedu ~]# vim /etc/nginx/conf.d/vhost.conf
server {
    listen 80;
    root /data/server/nginx/web1;
}

server {
    listen 81;
    root /data/server/nginx/web2;
}

server {
    listen 82;
    root /data/server/nginx/web3;
}

# 检查配置文件
[root@magedu ~]# nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful

# 重新加载配置
[root@magedu ~]# nginx -s reload
2025/06/18 10:58:56 [notice] 2084#2084: signal process started
```

检测效果

```bat
[root@magedu ~]# curl 10.0.0.231
nginx web1
[root@magedu ~]# curl 10.0.0.231:81
nginx web2
[root@magedu ~]# curl 10.0.0.231:82
nginx web3
```



##### 1.5.2.5.3 基于域名的站点实践

基于域名实现多server

```nginx
# 定制配置文件
[root@magedu ~]# vim /etc/nginx/conf.d/vhost.conf 
server {
    listen 80 default_server;
    server_name www.web1.com;
    root /data/server/nginx/web1;
}
    server {
    listen 80;
    server_name www.web2.com;
    root /data/server/nginx/web2;
}
server {
    listen 80;
    server_name www.web3.com;
    root /data/server/nginx/web3;
}

# 检查配置文件
[root@magedu ~]# nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful

# 重启服务
[root@magedu ~]# nginx -s reload
2025/06/18 11:04:12 [notice] 2127#2127: signal process started
```

在 `/etc/hosts` 中加入域名解析

```bash
[root@magedu ~]# echo "10.0.0.231 www.web1.com www.web2.com www.web3.com" >> /etc/hosts
[root@magedu ~]# cat /etc/hosts
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6

10.0.0.231 www.web1.com www.web2.com www.web3.com
```

访问站点信息，查看效果

```bash
[root@magedu ~]# curl www.web1.com
nginx web1
[root@magedu ~]# curl www.web2.com
nginx web2
[root@magedu ~]# curl www.web3.com
nginx web3
```







### 1.5.3 Nodejs项目

#### 1.5.3.1 Nodejs基础

##### 1.5.3.1.1 Nodejs简介

Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境，让 JavaScript 可以在服务器端运行.

```bat
	传统意义上 JavaScript 主要运行在浏览器中，用于实现网页的交互效果。而 Node.js 突破了这一限制，它将 Chrome V8 引擎移植到服务器端，使得开发者能够使用 JavaScript 编写服务器端代码，创建高性能、可扩展的网络应用程序。
```

发展历程

```bat
	2009 年，由 Ryan Dahl 开发的 Node.js 项目诞生。它的初衷是为了实现高性能的网络服务器，解决服务器端在处理高并发请求时的性能瓶颈问题。
	2010 年，npm（Node Package Manager）发布，这是 Node.js 的包管理工具，极大地促进了 Node.js 生态系统的发展。开发者可以方便地共享和使用各种开源模块，加速项目的开发。
	随着时间的推移，Node.js 不断发展和完善，其应用范围也越来越广泛，逐渐成为服务器端开发的主流技术之一
```

应用场景

```bat
Web 服务器开发：
	Node.js 可以用于构建高性能的 Web 服务器，处理大量的并发请求。许多知名的网站和应用都使用 Node.js 作为服务器端技术，如 Netflix、PayPal 等。
实时应用开发：
	由于 Node.js 的非阻塞 I/O 和事件驱动特性，非常适合开发实时应用，如在线聊天应用、实时游戏、实时数据监控系统等。
命令行工具开发：
	开发者可以使用 Node.js 编写命令行工具，利用其丰富的模块和跨平台特性，方便地实现各种功能，如文件处理、代码编译、自动化部署等。
微服务架构：
	Node.js 可以用于构建微服务架构中的各个服务，通过 npm 模块和 HTTP 协议进行服务之间的通信和协作，实现系统的高可扩展性和灵活性。
```

官方网站： https://nodejs.cn/

![image-20250615232331934](D:\git_repository\cyber_security_learning\markdown_img\image-20250615232331934-1752047439884-15.png)







##### 1.5.3.1.2 环境部署

安装软件

```bash
# Ubuntu环境
# 使用一键换源工具，更换国内源
[root@magedu ~]# wget https://www.mysticalrecluse.com/script/Shell/switchsource
[root@magedu ~]# bash switchsource -t

# 安装nodejs，npm包管理
[root@magedu ~]# apt install -y nodejs npm
```

查看

````bash
[root@magedu ~]# node -v
v18.19.1
````



##### 1.5.3.1.2 简单实践

创建一个新的项目目录

```bash
[root@magedu ~]# mkdir -p /data/codes/my-node-server -p
[root@magedu ~]# cd /data/codes/my-node-server/
```

创建文件 server.js

```bash
[root@magedu my-node-server]# vim server.js
const http = require('http');

// 创建一个 HTTP 服务器
const server = http.createServer((req, res) => {
    // 设置响应头
    res.writeHead(200, { 'Content-Type': 'text/plain' });
    // 发送响应内容
    res.end('Hello, World!\n');
});

// 监听 3000 端口
server.listen(3000, '0.0.0.0', () => {
    console.log('Server running at http://0.0.0.0:3000/')
});
```

运行代码

```bash
[root@magedu my-node-server]# node server.js
Server running at http://0.0.0.0:3000/
```

浏览器访问http://10.0.0.231:3000

![image-20250616100400696](D:\git_repository\cyber_security_learning\markdown_img\image-20250616100400696-1752047439884-13.png)

Ctrl + C 关闭服务

```bash
[root@magedu my-node-server]# node server.js
Server running at http://0.0.0.0:3000/
^C
```







#### 1.5.3.2 npm基础

##### 1.5.3.2.1 npm是什么

```bat
	npm（Node Package Manager）是 Node.js 的默认包管理器，类似于手机应用市场。其主要功能是管理 Node.js 项目中的各种依赖包。npm 拥有巨大的软件仓库，汇聚了海量 Node.js 包，功能覆盖网络编程、数据库交互、前端框架搭建等众多领域, 比如网络编程、文件操作、数据库管理、前端框架等，开发者可以在其中找到满足自己项目需求的各种包。
```

功能

```bat
	npm能让开发者方便地共享和重用代码，同时管理项目中的依赖项。当你安装 Node.js 时，npm 会随之自动安装。
```



##### 1.5.3.2.2 nodejs 和 npm

npm（Node Package Manager）和 Node.js 之间存在着紧密的关联

```bat
	当你安装 Node.js 时，npm 会被默认捆绑安装。也就是说，安装 Node.js 的过程中，npm 也会一同被安装到系统中，你无需额外进行操作去安装 npm。这样的设计让开发者在开始使用 Node.js 时，就能立即使用 npm 来管理项目的依赖。
```

功能互补

```bat
npm 推动 Node.js 生态发展
	npm 拥有庞大的软件仓库，其中包含了大量的开源 Node.js 包，这些包涵盖了各种功能和应用场景。开发者可以轻松地从 npm 上获取所需的包，无需重复造轮子，大大提高了开发效率。丰富的包资源吸引了更多的开发者使用 Node.js 进行开发，从而推动了 Node.js 生态系统的不断壮大。
	
Node.js 为 npm 提供应用场景
	Node.js 的广泛应用为 npm 提供了大量的使用场景。随着 Node.js 在服务器端开发、前端构建工具、自动化脚本等领域的应用越来越广泛，对各种功能包的需求也日益增加，这促使更多的开发者将自己开发的包发布到 npm 上，进一步丰富了 npm 的生态
```



##### 1.5.3.2.3 项目初始化

初始化项目

```bash
[root@magedu my-node-server]# mkdir /data/codes/npm-project
[root@magedu my-node-server]# cd /data/codes/npm-project/

# 运行npm init后，会引导你创建一个 package.json 文件，该文件记录了项目的元数据和依赖项信息。
[root@magedu npm-project]# npm init
This utility will walk you through creating a package.json file.
It only covers the most common items, and tries to guess sensible defaults.

See `npm help init` for definitive documentation on these fields
and exactly what they do.

Use `npm install <pkg>` afterwards to install a package and
save it as a dependency in the package.json file.

Press ^C at any time to quit.
package name: (npm-project)                                   # 直接Enter
version: (1.0.0)                                              # 直接Enter
description: simple demo                                      # 简单描述
entry point: (index.js)                                       # 直接Enter
test command:                                                 # 直接Enter
git repository:                                               # 直接Enter
keywords:                                                     # 直接Enter
author: mystical                                              # 直接Enter
license: (ISC)                                                # 直接Enter
About to write to /data/codes/npm-project/package.json:

{
  "name": "npm-project",
  "version": "1.0.0",
  "description": "simple demo",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "mystical",
  "license": "ISC"
}


Is this OK? (yes)                                             # 直接Enter
```

项目目录下生成一个 package.json 文件，该文件记录了项目的元数据和依赖信息。

```bash
[root@magedu npm-project]# cat package.json 
{
  "name": "npm-project",
  "version": "1.0.0",
  "description": "simple demo",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "mystical",
  "license": "ISC"
}
```



##### 1.5.3.2.4 项目依赖

为了避免获取互联网的软件包过于缓慢，定制专属的镜像源

```bash
[root@magedu npm-project]# npm config set registry https://registry.npmmirror.com
```

```bash
# 在当前目录下生产一个隐藏的配置文件
# 查看
[root@magedu npm-project]# cat .npmrc 
registry=https://registry.npmmirror.com/
```

安装 express 框架作为项目依赖， express 是一个流行的 Node.js Web 应用框架。

```bash
[root@magedu npm-project]# npm install express

added 67 packages in 2s

14 packages are looking for funding
  run `npm fund` for details
```

```bash
# 临时指定下载仓库的方式
npm install express --registry=https://registry.npmmirror.com
```



express 安装到项目的  node_modules 目录下，并在  package.json 文件中添加相应的依赖项。

```bash
[root@magedu npm-project]# ls
node_modules  package.json  package-lock.json
[root@magedu npm-project]# tree -L 1 node_modules/
node_modules/
├── accepts
├── body-parser
├── bytes
├── call-bind-apply-helpers
├── call-bound
├── content-disposition
├── content-type
├── cookie
├── cookie-signature
......
```

```bash
# 查看依赖项
[root@magedu npm-project]# head package-lock.json 
{
  "name": "npm-project",
  "version": "1.0.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "npm-project",
      "version": "1.0.0",
      "license": "ISC",
```



##### 1.5.3.2.5 项目创建

创建入口文件 index.js

```bash
[root@magedu npm-project]# vim index.js
const express = require('express');
const app = express();
const port = 3000;

// 定义简单的路由
app.get('/', (req, res) => {
    res.send('站点首页!!!\n');
});
app.get('/login', (req, res) => {
    res.send('站点登录页面!!!\n');
});
app.get('/register', (req, res) => {
    res.send('站点注册页面!!!\n');
});

// 启动服务器
app.listen(port, () => {
    console.log(`Server is running on port ${port}`);
});
```



##### 1.5.3.2.6 项目启动

为了方便启动项目，你可以在 package.json 文件中添加一个启动脚本

```bash
[root@magedu npm-project]# vim package.json
{
  "name": "npm-project",
  "version": "1.0.0",
  "description": "simple demo",
  "main": "index.js",
  "scripts": {
    "start": "node index.js"
  },
  "author": "mystical",
  "license": "ISC",
  "dependencies": {
    "express": "^5.1.0"
  }
}
```

运行项目

```bash
[root@magedu npm-project]# npm start

> npm-project@1.0.0 start
> node index.js

Server is running on port 3000
......
```

访问查看（另起一个终端）

```bash
[root@magedu ~]# curl 10.0.0.231:3000
站点首页!!!
[root@magedu ~]# curl 10.0.0.231:3000/login
站点登录页面!!!
[root@magedu ~]# curl 10.0.0.231:3000/register
站点注册页面!!!
```





#### 1.5.3.3 博客系统

##### 1.5.3.3.1 基础环境

环境准备

```bash
[root@magedu npm-project]# mkdir /data/codes/hexo_project
[root@magedu npm-project]# cd /data/codes/hexo_project/
[root@magedu hexo_project]# npm config set registry https://registry.npmmirror.com
```

安装软件

```bash
[root@magedu hexo_project]# npm install -g hexo-cli

added 53 packages in 4s

14 packages are looking for funding
  run `npm fund` for details
```



##### 1.5.3.3.2 定制项目

新建一个 myblogs 文件夹,该过程会持续20s左右，因为要下载文件

```bash
[root@magedu hexo_project]# hexo init myblogs
INFO  Cloning hexo-starter https://github.com/hexojs/hexo-starter.git
fatal: unable to access 'https://github.com/hexojs/hexo-starter.git/': Recv failure: Connection reset by peer
WARN  git clone failed. Copying data instead
INFO  Install dependencies
INFO  Start blogging with Hexo!
```

安装hexo项目所依赖的文件

```bash
# 设定本地下载源信息
[root@magedu hexo_project]# cd myblogs/
[root@magedu myblogs]# npm config set registry https://registry.npmmirror.com
[root@magedu myblogs]# ls -a
.                      _config.yml   .npmrc             scaffolds
..                     .github       package.json       source
_config.landscape.yml  node_modules  package-lock.json  themes
```

```bash
# 安装 Hexo 项目所需的依赖项
[root@magedu myblogs]# npm install

added 2 packages in 1s

29 packages are looking for funding
  run `npm fund` for details
```

运行项目，这里虽然提示 localhost，但是依然可以通过IP地址进行访问

```bash
[root@magedu myblogs]# hexo server
INFO  Validating config
INFO  Start processing
INFO  Hexo is running at http://localhost:4000/ . Press Ctrl+C to stop.
......
```

浏览器访问 10.0.0.13:4000

![image-20250616103141514](D:\git_repository\cyber_security_learning\markdown_img\image-20250616103141514-1752047439884-14.png)



##### 1.5.3.3.3 更改新的主题

```bash
# 安装icarus主题
[root@magedu myblogs]# npm install -S hexo-theme-icarus hexo-renderer-inferno

added 169 packages in 7s

38 packages are looking for funding
  run `npm fund` for details
```

```bash
# 切换主题
[root@magedu myblogs]# hexo config theme icarus
INFO  Validating config
Inferno is in development mode.
```

```bash
# 生成主题并部署
[root@magedu myblogs]# hexo generate
[root@magedu myblogs]# hexo deploy
```



```bash
# 启用 hexo 查看主题效果
[root@magedu myblogs]# hexo server
INFO  Validating config
Inferno is in development mode.
......
```

![image-20250616104053391](D:\git_repository\cyber_security_learning\markdown_img\image-20250616104053391-1752047439884-16.png)





###### 1.5.3.3.3.1 添加新的文章

```bash
[root@magedu myblogs]# hexo new "Day01 Learning Linux"
INFO  Validating config
Inferno is in development mode.
INFO  =======================================
 ██╗ ██████╗ █████╗ ██████╗ ██╗   ██╗███████╗
 ██║██╔════╝██╔══██╗██╔══██╗██║   ██║██╔════╝
 ██║██║     ███████║██████╔╝██║   ██║███████╗
 ██║██║     ██╔══██║██╔══██╗██║   ██║╚════██║
 ██║╚██████╗██║  ██║██║  ██║╚██████╔╝███████║
 ╚═╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝ ╚══════╝
=============================================
INFO  === Checking package dependencies ===
INFO  === Checking theme configurations ===
INFO  === Registering Hexo extensions ===
INFO  Created: /data/codes/hexo_project/myblogs/source/_posts/Day01-Learning-Linux.md

[root@magedu myblogs]# cd source/_posts/
[root@magedu _posts]# ls
Day01-Learning-Linux.md  hello-world.md
[root@magedu _posts]# vim Day01-Learning-Linux.md 
---
title: Day01 Learning Linux
date: 2025-06-16 11:45:03
tags: linux
categories: Linux教程
cover: ../image/computer1.png                                        # 卡片图片
---

本篇文章将介绍Linux历史，计算机基础硬件知识，操作系统基础知识以及Linux常见系统>的安装。  # 描述信息

<!-- more -->                                                               # 起到折叠卡片的效果

# Linux Base
```



###### 1.5.3.3.3.2 修改个人信息

```bash
# 在source目录下创建image目录，用来存放图片
[root@magedu myblogs]# cd source/
[root@magedu source]# mkdir image
[root@magedu source]# ls
image  _posts

# 将自己喜欢的头像放入image目录下
[root@magedu source]# cd image/
[root@magedu image]# rz
[root@magedu image]# ls
touxiang.jpg

# 修改配置文件,填写个人信息
[root@magedu myblogs]# vim _config.icarus.yml
widgets:
    # Profile widget configurations
    -
        # Where should the widget be placed, left sidebar or right sidebar
        position: left
        type: profile
        # Author name
        author: Mystical Recluse                            # 修改用户名
        # Author title
        author_title: My Blog                               # 修改title
        # Author's current location
        location: china, beijing                            # 修改地址
        # URL or path to the avatar image
        avatar: image/touxiang.jpg                          # 修改头像
        # Whether show the rounded avatar image
        avatar_rounded: false
......
```

修改后查看效果

![image-20250616120155658](D:\git_repository\cyber_security_learning\markdown_img\image-20250616120155658-1752047439884-17.png)



###### 1.5.3.3.3.3 修改布局

```bash
# 将常用的侧边栏放到右边
[root@magedu myblogs]# vim _config.icarus.yml 
   # Categories widget configurations
    -
        # Where should the widget be placed, left sidebar or right sidebar
        position: right                            # 改到右边
        type: categories
    # Recent posts widget configurations
    -
        # Where should the widget be placed, left sidebar or right sidebar
        position: right                            # 改到右边
        type: recent_posts
    # Archives widget configurations
    -
        # Where should the widget be placed, left sidebar or right sidebar
        position: left
        type: archives
    # Tags widget configurations
    -
        # Where should the widget be placed, left sidebar or right sidebar
        position: right                            # 改到右边
        type: tags

# 保存后，启用服务，查看效果
[root@magedu myblogs]# hexo server
```



![image-20250616120554736](D:\git_repository\cyber_security_learning\markdown_img\image-20250616120554736-1752047439884-18.png)



###### 1.5.3.3.3.4 修改RECENTS风格

**主题配置中启用组件**

在你的主题配置文件 `_config.icarus.yml` 中启用侧边栏组件：

```yaml
widgets:
  - type: recent_posts
    position: right
    limit: 5     # 显示多少篇文章
```

这段配置表示：

- 使用 `recent_posts` 小部件（Icarus 自带）
- 显示在右侧 `position: right`
- 限制只展示最近 5 篇文章



**文章启用封面图 thumbnail（实现缩略图）**

为了让每篇文章在 `RECENTS` 中显示小图，必须在每篇文章的 `Front Matter` 中添加 `thumbnail` 字段：

```yaml
---
title: Day01 Learning Linux
date: 2025-06-16 11:45:03
tags: linux
categories: 
cover: image/computer1.png
thumbnail: image/computer1.png   # 填写图片路径，以source为根目
---
......
```

![image-20250616140301835](D:\git_repository\cyber_security_learning\markdown_img\image-20250616140301835-1752047439884-20.png)



###### 1.5.3.3.3.5 目录设置与优化

设置目录

```bash
[root@magedu myblogs]# vim _config.icarus.yml
......
    # Table of contents widget configurations
    -
        # Where should the widget be placed, left sidebar or right sidebar
        position: left                                                # 把目录放在左边栏（你也可以改为 right）
        type: toc                                                     # 表示这是“目录组件”，不是分类或标签组件
        # Whether to show the index of each heading
        index: true                                                   # 显示标题前的序号（1、2、3…）
        # Whether to collapse sub-headings when they are out-of-view
        collapsed: true                                               # 子标题默认折叠（点击展开），可改为 false
        # Maximum level of headings to show (1-6)
        depth: 4                                                      # 显示目录的最大标题层级（支持 ## 到 ####）
```

文章中显示加载目录

```bat
---
title: 计算机基础和Linux安装
date: 2025-06-14
toc: true              # 添加toc: true
tags: [Linux, OS]
categories:
cover: markdown_img/computer1.png
thumbnail: markdown_img/computer1.png
---
```

添加懒加载，优化网站加载速度

```bash
# 安装 Hexo 插件自动懒加载
npm install hexo-lazyload-image --save

# _config.yml 添加配置
lazyload:
  enable: true
  onlypost: true
  loadingImg: /images/loading.gif # 可选
```

使用js，优化目录折叠效果加载速度

```bash
[root@magedu source]# mkdir -p js/custom/
```

```bash
[root@magedu source]# cd /js/custom/
[root@magedu custom]# vim custom.js
document.addEventListener('DOMContentLoaded', () => {
  const tocEl = document.querySelector('#toc');

  if (tocEl) {
    // 如果目录已经渲染好了，直接绑定
    bindTocToggle();
  } else {
    // 否则监听 DOM 变化
    const observer = new MutationObserver(() => {
      const tocNow = document.querySelector('#toc');
      if (tocNow) {
        observer.disconnect();
        bindTocToggle();
      }
    });

    observer.observe(document.body, { childList: true, subtree: true });
  }
});

function bindTocToggle() {
  console.log('✅ 正在绑定 TOC 折叠功能');

  const tocItems = document.querySelectorAll('.catalogue .is-collapsible');

  tocItems.forEach(li => {
    const btn = li.querySelector('.catalogue-toggle');
    const subList = li.querySelector('ul');

    if (btn && subList) {
      btn.addEventListener('click', () => {
        subList.classList.toggle('is-hidden');
        btn.classList.toggle('is-expanded');
      });
    }
  });

  console.log('✅ TOC 折叠绑定完成');
}

# 在配置文件中，加载自定义js
[root@magedu myblogs]# vim _config.icarus.yml
......
injects:
  bottom:
    - <script src="/js/custom/custom.js"></script>    # ✅ 加入这一行
```

重启服务

```bash
[root@magedu myblogs]# nohup hexo server &
```

查看效果

![image-20250616165427512](D:\git_repository\cyber_security_learning\markdown_img\image-20250616165427512-1752047439884-19.png)



###### 15.3.3.3.6 多级分类实现

使用嵌套数组形式的 `categories` front-matter

示例

```bash
---
title: 使用 Valine 评论系统
date: 2025-06-16
categories:
  - Plugins
  - Comment
tags: [Valine, Comment]
---
```

注意：配置文件中，启用分类组件（通常默认启用）

```bash
widgets:
  -
    type: categories
    position: leftv
```

效果展示

![image-20250616171625487](D:\git_repository\cyber_security_learning\markdown_img\image-20250616171625487-1752047439884-21.png)



###### 1.5.3.3.3.7 更改主题风格

通过此设置为Icarus更换”皮肤“。 此设置目前支持”`default`“和”`cyberpunk`“两种值。 你可以在[此处](https://ppoffice.github.io/hexo-theme-icarus/uncategorized/cyberpunk-theme-variant/)查看Cyberpunk变体的效果。

```bash
[root@magedu myblogs]# vim _config.icarus.yml
# Icarus theme variant, can be "default" or "cyberpunk"
#variant: default
variant: cyberpunk      # 改为 cyberpunk 风格
```

```bash
# 重启服务
[root@magedu myblogs]# nohup hexo server &
```

查看效果

![image-20250616172044576](D:\git_repository\cyber_security_learning\markdown_img\image-20250616172044576-1752047439884-22.png)





###### 1.5.3.3.3.8 添加ShareThis

进入sharethis网站

```http
https://sharethis.com/
```

1. 访问[ShareThis](https://sharethis.com/)并点击页面上的“从分享按钮开始”(Start with Share Buttons)按钮。

![image-20250616140610056](D:\git_repository\cyber_security_learning\markdown_img\image-20250616140610056-1752047439884-23.png)

在“选择分享按钮类型”(Choose type of sharing button)页面选择你需要的按钮类型。 不要启用”GDPR规范工具“，否则可能会导致一些问题。 你也可以点击“自定义你的分享按钮”(Customize your share buttons)链接来进行按钮的进一步配置。 完成后点击“下一步”(Next)。

![image-20250616140705324](D:\git_repository\cyber_security_learning\markdown_img\image-20250616140705324-1752047439884-24.png)

在“注册并获取代码”(Register and get the code!)页面输入邮箱和密码完成ShareThis的注册。(我直接使用Google账户登录了)

![image-20250616140900394](D:\git_repository\cyber_security_learning\markdown_img\image-20250616140900394-1752047439884-25.png)

从HTML代码段中复制`src`中的URL地址到分享按钮配置中

![image-20250616140952216](D:\git_repository\cyber_security_learning\markdown_img\image-20250616140952216-1752047439884-26.png)

例如：下面的ShareThis代码

```bash
<script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=xxxxxxxxxxxxx&product=inline-share-buttons" async="async"></script>
```

对应下面的主题配置：

```yaml
share:
    type: sharethis
    install_url: https://platform-api.sharethis.com/js/sharethis.js#property=xxxxxxxxxxxxx&product=inline-share-buttons

```

```bash
# 修改配置后，重启hexo
```

<img src="D:\git_repository\cyber_security_learning\markdown_img\image-20250616141224309-1752047439884-27.png" alt="image-20250616141224309" style="zoom:150%;" />

测试分享

![image-20250616141416659](D:\git_repository\cyber_security_learning\markdown_img\image-20250616141416659-1752047439884-28.png)

使用二维码分享

<img src="D:\git_repository\cyber_security_learning\markdown_img\image-20250616141437916-1752047439884-29.png" alt="image-20250616141437916" style="zoom:150%;" />





###### 1.5.3.3.3.9 创建comment评论

**Disqus**

首先，登录[Disqus](https://disqus.com/)。 点击首页的“开始”(GET STARTED)按钮来创建新的站点评论服务。

```http
https://disqus.com/
```

![image-20250616104950202](D:\git_repository\cyber_security_learning\markdown_img\image-20250616104950202-1752047439884-30.png)



![image-20250616105146651](D:\git_repository\cyber_security_learning\markdown_img\image-20250616105146651-1752047439884-31.png)

先下拉，选择免费版本使用

![image-20250616105231521](D:\git_repository\cyber_security_learning\markdown_img\image-20250616105231521-1752047439884-32.png)

![image-20250616105358824](D:\git_repository\cyber_security_learning\markdown_img\image-20250616105358824-1752047439884-33.png)

![image-20250616105459698](D:\git_repository\cyber_security_learning\markdown_img\image-20250616105459698-1752047439884-34.png)

选择Disqus的安装平台。 此处选择页面底部的“上面没有列出我使用的平台，使用通用代码安装” (I don’t see my platform listed, install manually with Universal Code)。

![image-20250616105628346](D:\git_repository\cyber_security_learning\markdown_img\image-20250616105628346-1752047439884-36.png)

1. 点击页面底部的“配置”(Configure)按钮跳过“通用代码安装指南”(Universal Code install instructions)。

![image-20250616105830988](D:\git_repository\cyber_security_learning\markdown_img\image-20250616105830988-1752047439884-35.png)

![image-20250616111301909](D:\git_repository\cyber_security_learning\markdown_img\image-20250616111301909-1752047439884-37.png)

Comment Policy URL 编写示例

```bash
# vim source/comment-policy.md

# comment-policy.md 内容如下：
---
title: Comment Policy
date: 2025-06-15 10:00:00
layout: page
---

# Comment Policy

We welcome and encourage comments on this site. To maintain a respectful and valuable community, please follow these simple rules:

## ✅ What’s encouraged:

- Sharing your experiences and ideas
- Asking thoughtful questions
- Engaging in respectful, constructive conversation

## 🚫 What’s not allowed:

- **Off-topic** comments unrelated to the post content
- **Spam or self-promotion**, including unrelated links
- **Hate speech or discrimination** of any kind
- **Personal attacks, harassment, or abusive language**
- **Flooding** the comments with repeated messages

## 🔧 Moderation Policy

Comments are subject to manual or automatic moderation. We reserve the right to:

- Edit or delete any comment at any time
- Block repeat offenders from commenting
- Use spam filters to detect low-quality or harmful content

## 💬 You agree:

By posting a comment, you agree to follow this policy and contribute positively to the discussion.

Thank you for helping make this a respectful and engaging space for all readers!
```

```bash
# 部署生效
root@mystical:/data/codes/hexo_project/myblogs/source# hexo clean && hexo g && hexo d
```

``` bat
# 访问查看
http://blog.mysticalrecluse.com/comment-policy.html
```

![image-20250616111559460](D:\git_repository\cyber_security_learning\markdown_img\image-20250616111559460-1752047439884-38.png)

创建好后，点击Next

![image-20250616111658813](D:\git_repository\cyber_security_learning\markdown_img\image-20250616111658813-1752047439884-39.png)

![image-20250616111735668](D:\git_repository\cyber_security_learning\markdown_img\image-20250616111735668-1752047439884-40.png)

部署成功！在“配置Disqus”(Configure Disqus)页面中按需填写Disqus个性化配置。 然后，点击“完成安装”(Complete Setup)和“关闭配置”(Dismiss Setup)按钮来结束配置。

![image-20250616111811770](D:\git_repository\cyber_security_learning\markdown_img\image-20250616111811770-1752047439884-41.png)

下一步，在评论服务首页的右上角点击“编辑配置”(Edit Settings)按钮

![image-20250616111958316](D:\git_repository\cyber_security_learning\markdown_img\image-20250616111958316-1752047439884-42.png)

在“为你的站点配置Disqus”(Configure Disqus for Your Site)页面上找到“Shortname”的值， 复制到主题配置的评论配置项中。 例如，下面截图中的“Shortname”为`mystical-blog`：

![image-20250616112103020](D:\git_repository\cyber_security_learning\markdown_img\image-20250616112103020-1752047439884-43.png)

对应的主题配置为：

```bash
root@mystical:/data/codes/hexo_project/myblogs# vim _config.icarus.yml
comment:
......
    type: disqus
    # Disqus shortname
    shortname: mystical-blog
    ...... 
```

重启hexo后查看评论效果

```bash
root@mystical:/data/codes/hexo_project/myblogs# updatehexo
root@mystical:/data/codes/hexo_project/myblogs# alias updatehexo
alias updatehexo='killall hexo && nohup hexo server &'
```

![image-20250616112729076](D:\git_repository\cyber_security_learning\markdown_img\image-20250616112729076-1752047439884-44.png)

（可选）你可以在文章的front-matter中加入`disqusId`来为文章添加Disqus唯一标识。 这样，你可以在未来更改文章的位置而不会丢失所有评论。

```bash
title: 我的第一篇文章
date: 2015-01-01 00:00:01
disqusId: post-0001-hello-world
---
# Hello world
```

你也可以使用一些规则化方式来生成它：

- 用文件名做 ID：`disqusId: 2024-hello-world`
- 用文章 slug：`disqusId: first-post`
- 用数据库 ID（如果你从 CMS 导入文章）：`disqusId: post-123`



##### 1.5.3.3.4 配置Nginx代理

部署Nginx

```bash
[root@magedu myblogs]# apt install -y nginx
```

定制nginx配置

```nginx
[root@magedu sites-enabled]# vim blog.magedu.org.conf  
server {
    server_name blog.magedu.org;

    location / {
         proxy_pass http://localhost:4000;
    }
}
```

重启配置

```bat
[root@magedu sites-enabled]# nginx -s reload
2025/06/18 11:36:28 [notice] 2663#2663: signal process started
```

更改宿主机hosts文件

```bat
# Windows操作系统hosts文件路径
C:\Windows\System32\drivers\etc\hosts
```

找到 hosts 文件

![image-20250618112124346](D:\git_repository\cyber_security_learning\markdown_img\image-20250618112124346-1752047439884-45.png)

更改 hosts 文件权限

![image-20250618112353643](D:\git_repository\cyber_security_learning\markdown_img\image-20250618112353643-1752047439884-46.png)



![image-20250618112716217](D:\git_repository\cyber_security_learning\markdown_img\image-20250618112716217-1752047439884-47.png)

在桌面添加快捷方式

![image-20250618113107048](D:\git_repository\cyber_security_learning\markdown_img\image-20250618113107048.png)

在 `hosts` 文件中添加：

```bat
10.0.0.231 blog.magedu.org
```

![image-20250618113509587](D:\git_repository\cyber_security_learning\markdown_img\image-20250618113509587-1752047439884-48.png)

在浏览器查看`blog.magedu.org`

![image-20250618114046385](D:\git_repository\cyber_security_learning\markdown_img\image-20250618114046385-1752047439884-49.png)



































































































 