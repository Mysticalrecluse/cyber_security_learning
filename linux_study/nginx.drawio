<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/24.2.5 Chrome/120.0.6099.109 Electron/28.1.0 Safari/537.36" modified="2025-09-20T14:54:51.490Z" etag="EJbYhIHttrH_MsI47R2a" version="24.2.5" type="device">
  <diagram id="wrCdoQ_2FLhnvDLX_88F" name="第 1 页">
    <mxGraphModel dx="3248" dy="2316" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" background="none" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="_FFqBCeF78_xi2tW4rS6-34" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="_FFqBCeF78_xi2tW4rS6-26" target="_FFqBCeF78_xi2tW4rS6-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-37" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="_FFqBCeF78_xi2tW4rS6-26" target="_FFqBCeF78_xi2tW4rS6-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-42" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="_FFqBCeF78_xi2tW4rS6-26" target="tlIEBAkVMEHic_1Gy2fF-41" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-26" value="事件（&lt;b&gt;&lt;font color=&quot;#ff8000&quot;&gt;网络事件&lt;/font&gt;&lt;/b&gt;）驱动框架" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=12;align=center;strokeColor=#6c8ebf;fillColor=#dae8fc;" parent="1" vertex="1">
          <mxGeometry x="-184" y="-168" width="177" height="56" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-29" value="读事件（EPOLLIN）" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="-248" y="-64" width="96" height="46" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-30" value="写事件（EPOLLOUT）" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="-43" y="-64" width="96" height="46" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-52" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="86" y="-217" width="459" height="269" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-38" value="&lt;span style=&quot;font-size: 10px&quot;&gt;各种读事件（比如nginx接收请求）&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="_FFqBCeF78_xi2tW4rS6-52" vertex="1">
          <mxGeometry x="4.59" y="53.06802721088435" width="168.912" height="31.108843537414966" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-39" value="&lt;font style=&quot;font-size: 10px&quot;&gt;各种写事件（比如写回响应数据）&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="_FFqBCeF78_xi2tW4rS6-52" vertex="1">
          <mxGeometry y="166.52380952380952" width="173.502" height="31.108843537414966" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-40" value="事&lt;br&gt;件&lt;br&gt;收&lt;br&gt;集&lt;br&gt;分&lt;br&gt;发&lt;br&gt;器" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=12;fontColor=#000000;align=center;strokeColor=#6c8ebf;fillColor=#dae8fc;" parent="_FFqBCeF78_xi2tW4rS6-52" vertex="1">
          <mxGeometry x="223.074" width="27.540000000000003" height="269" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-47" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="_FFqBCeF78_xi2tW4rS6-52" source="_FFqBCeF78_xi2tW4rS6-38" target="_FFqBCeF78_xi2tW4rS6-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-48" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="_FFqBCeF78_xi2tW4rS6-52" source="_FFqBCeF78_xi2tW4rS6-39" target="_FFqBCeF78_xi2tW4rS6-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-49" value="&lt;span style=&quot;font-size: 10px&quot;&gt;每种事件都有对应的消费者进行处理&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="_FFqBCeF78_xi2tW4rS6-52" vertex="1">
          <mxGeometry x="290.088" y="113.91326530612245" width="168.912" height="41.173469387755105" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-51" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="_FFqBCeF78_xi2tW4rS6-52" source="_FFqBCeF78_xi2tW4rS6-40" target="_FFqBCeF78_xi2tW4rS6-49" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-53" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="1571" y="-580" width="750" height="313" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-1" value="&lt;b&gt;&lt;font style=&quot;font-size: 15px&quot;&gt;Nginx&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="_FFqBCeF78_xi2tW4rS6-53" vertex="1">
          <mxGeometry x="312.5" width="125.00000000000001" height="57.96296296296296" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-3" value="&lt;font style=&quot;font-size: 11px&quot;&gt;HTTP状态机&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="_FFqBCeF78_xi2tW4rS6-53" vertex="1">
          <mxGeometry x="318.1818181818182" y="127.51851851851852" width="113.63636363636364" height="46.37037037037037" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="_FFqBCeF78_xi2tW4rS6-53" source="_FFqBCeF78_xi2tW4rS6-1" target="_FFqBCeF78_xi2tW4rS6-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-5" value="&lt;font style=&quot;font-size: 11px&quot;&gt;TCP状态机&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="_FFqBCeF78_xi2tW4rS6-53" vertex="1">
          <mxGeometry x="142.04545454545456" y="127.51851851851852" width="113.63636363636364" height="46.37037037037037" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-11" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="_FFqBCeF78_xi2tW4rS6-53" source="_FFqBCeF78_xi2tW4rS6-1" target="_FFqBCeF78_xi2tW4rS6-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-6" value="&lt;font style=&quot;font-size: 11px&quot;&gt;MAIL状态机&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="_FFqBCeF78_xi2tW4rS6-53" vertex="1">
          <mxGeometry x="494.31818181818187" y="127.51851851851852" width="113.63636363636364" height="46.37037037037037" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-12" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="_FFqBCeF78_xi2tW4rS6-53" source="_FFqBCeF78_xi2tW4rS6-1" target="_FFqBCeF78_xi2tW4rS6-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-13" value="HTTP状态机详解" style="rounded=1;whiteSpace=wrap;html=1;container=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="_FFqBCeF78_xi2tW4rS6-53" vertex="1">
          <mxGeometry y="220.25925925925924" width="750.0000000000001" height="92.74074074074073" as="geometry">
            <mxRectangle x="387.5" y="260" width="115" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-15" value="&lt;font style=&quot;font-weight: normal ; font-size: 10px&quot;&gt;接受HTTP请求&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1" parent="_FFqBCeF78_xi2tW4rS6-13" vertex="1">
          <mxGeometry x="17.045454545454547" y="21.73611111111111" width="102.27272727272728" height="49.26851851851852" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-16" value="&lt;font style=&quot;font-weight: normal ; font-size: 10px&quot;&gt;解析请求行和请求头&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1" parent="_FFqBCeF78_xi2tW4rS6-13" vertex="1">
          <mxGeometry x="153.40909090909093" y="21.73611111111111" width="125.00000000000001" height="49.26851851851852" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-18" value="&lt;font style=&quot;font-weight: normal ; font-size: 10px&quot;&gt;检查请求体是否完整&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1" parent="_FFqBCeF78_xi2tW4rS6-13" vertex="1">
          <mxGeometry x="301.1363636363637" y="21.73611111111111" width="125.00000000000001" height="49.26851851851852" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-20" value="&lt;font style=&quot;font-weight: normal ; font-size: 10px&quot;&gt;生成并发送响应&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1" parent="_FFqBCeF78_xi2tW4rS6-13" vertex="1">
          <mxGeometry x="448.86363636363643" y="21.73611111111111" width="113.63636363636364" height="49.26851851851852" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-22" value="&lt;font style=&quot;font-weight: normal ; font-size: 10px&quot;&gt;完成请求处理，关闭连接&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1" parent="_FFqBCeF78_xi2tW4rS6-13" vertex="1">
          <mxGeometry x="585.2272727272727" y="21.73611111111111" width="147.72727272727275" height="49.26851851851852" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-17" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="_FFqBCeF78_xi2tW4rS6-13" source="_FFqBCeF78_xi2tW4rS6-15" target="_FFqBCeF78_xi2tW4rS6-16" edge="1">
          <mxGeometry x="22.72727272727273" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-19" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="_FFqBCeF78_xi2tW4rS6-13" source="_FFqBCeF78_xi2tW4rS6-16" target="_FFqBCeF78_xi2tW4rS6-18" edge="1">
          <mxGeometry x="22.72727272727273" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-21" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="_FFqBCeF78_xi2tW4rS6-13" source="_FFqBCeF78_xi2tW4rS6-18" target="_FFqBCeF78_xi2tW4rS6-20" edge="1">
          <mxGeometry x="22.72727272727273" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-23" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="_FFqBCeF78_xi2tW4rS6-13" source="_FFqBCeF78_xi2tW4rS6-20" target="_FFqBCeF78_xi2tW4rS6-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-24" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=none;curved=1;" parent="_FFqBCeF78_xi2tW4rS6-53" source="_FFqBCeF78_xi2tW4rS6-3" target="_FFqBCeF78_xi2tW4rS6-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_FFqBCeF78_xi2tW4rS6-25" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="_FFqBCeF78_xi2tW4rS6-53" source="_FFqBCeF78_xi2tW4rS6-3" target="_FFqBCeF78_xi2tW4rS6-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--51" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--43" target="oCp0Jb_trErku0qVtbz--45" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--53" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--43" target="oCp0Jb_trErku0qVtbz--46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--54" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--43" target="oCp0Jb_trErku0qVtbz--44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--55" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--43" target="oCp0Jb_trErku0qVtbz--47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--43" value="&lt;b&gt;&lt;font style=&quot;font-size: 15px&quot;&gt;Nginx模块&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="2787" y="151" width="110" height="50" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--66" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--44" target="oCp0Jb_trErku0qVtbz--64" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--67" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--44" target="oCp0Jb_trErku0qVtbz--65" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--44" value="&lt;b&gt;&lt;font style=&quot;font-size: 15px&quot;&gt;前提：编译进Nginx&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2226" y="273" width="155" height="50" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--61" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--45" target="oCp0Jb_trErku0qVtbz--57" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--62" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--45" target="oCp0Jb_trErku0qVtbz--60" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--45" value="&lt;b&gt;&lt;font style=&quot;font-size: 15px&quot;&gt;提供哪些配置项&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="2652" y="273" width="155" height="50" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--46" value="&lt;b&gt;&lt;font style=&quot;font-size: 15px&quot;&gt;模块何时被使用&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="3272" y="273" width="155" height="50" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--47" value="&lt;b&gt;&lt;font style=&quot;font-size: 15px&quot;&gt;提供哪些变量&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="3596" y="273" width="155" height="50" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--57" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;查看官网&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="2589.25" y="370" width="109" height="45" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--81" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--60" target="oCp0Jb_trErku0qVtbz--80" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--60" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;根据源码查看指定模块体提供哪些配置项&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="2797" y="370" width="238" height="45" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--73" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--64" target="oCp0Jb_trErku0qVtbz--70" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--74" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--64" target="oCp0Jb_trErku0qVtbz--69" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--75" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--64" target="oCp0Jb_trErku0qVtbz--71" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--64" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;编译模块&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2105" y="370" width="109" height="45" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--77" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--65" target="oCp0Jb_trErku0qVtbz--76" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--65" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;查看是否编译成功&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2410.75" y="370" width="109" height="45" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--69" value="--with-XXX" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2014" y="470" width="89" height="42" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--70" value="--without-XXX" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2115" y="470" width="89" height="42" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--71" value="--add-module=XXX" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2216" y="470" width="118" height="42" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--79" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--76" target="oCp0Jb_trErku0qVtbz--78" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--76" value="./configure XXX之后，查看&lt;b&gt;obj/ngx_modules.c&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2341.25" y="470" width="248" height="44" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--78" value="&lt;b&gt;obj / nginx_modules.c&lt;/b&gt;中，有个数组&lt;br&gt;ngx_module_t *ngx_modules[ ] = {&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;font style=&quot;color: rgb(255, 0, 0);&quot;&gt;&amp;amp;ngx_core_module,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;color: rgb(255, 0, 0);&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;amp;ngx_errlog_module,&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;amp;ngx_conf_module,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ......&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;}&amp;nbsp; // 这里是所有编译进Nginx中的模块&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;align=left;spacingLeft=10;" parent="1" vertex="1">
          <mxGeometry x="2357.88" y="544" width="214.75" height="127" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="oCp0Jb_trErku0qVtbz--80" target="oCp0Jb_trErku0qVtbz--82" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--80" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;以gzip模块为例：&lt;b&gt;&lt;font style=&quot;color: rgb(255, 0, 0);&quot;&gt;src/http/modules/ngx_http_gzip_filter_module.c&lt;/font&gt;&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="2771.5" y="467" width="289" height="45" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--82" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;搜索结构体：&lt;br&gt;static&lt;b&gt;&lt;font style=&quot;color: rgb(255, 0, 0);&quot;&gt; ngx_command_t&lt;/font&gt;&lt;/b&gt; ngx_http_gzip_filter_commands[ ] = { ... }；&lt;br&gt;// 上述结构体是一个数组，数组里的每个成员就是该模块支持的指令名&amp;nbsp;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=13;" parent="1" vertex="1">
          <mxGeometry x="2693.75" y="557" width="444.5" height="111" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-46" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tlIEBAkVMEHic_1Gy2fF-41" target="tlIEBAkVMEHic_1Gy2fF-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-48" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tlIEBAkVMEHic_1Gy2fF-41" target="tlIEBAkVMEHic_1Gy2fF-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-50" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tlIEBAkVMEHic_1Gy2fF-41" target="tlIEBAkVMEHic_1Gy2fF-49" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-41" value="事件的本质" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=#ffffff;fontStyle=1;fillColor=#d80073;strokeColor=#A50040;" parent="1" vertex="1">
          <mxGeometry x="-320" y="-163.5" width="91" height="47" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-44" value="&lt;span style=&quot;font-weight: normal;&quot;&gt;epoll 事件（network event）本质上是：内核检测到某个 fd（socket）的状态变化后，向用户空间通知“这个 fd 现在可以进行某种 I/O 操作（读/写）”&lt;br&gt;&lt;/span&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;br&gt;事件只是一个&lt;strong data-end=&quot;275&quot; data-start=&quot;265&quot;&gt;信号/元信息&lt;/strong&gt;，告诉你**“fd 已准备好”**，而不是携带具体数据。&lt;br&gt;&lt;/font&gt;&lt;span style=&quot;font-weight: normal;&quot;&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontStyle=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="-776" y="-363" width="393" height="91.25" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-47" value="&lt;ul&gt;&lt;li data-end=&quot;164&quot; data-start=&quot;46&quot;&gt;&lt;p data-end=&quot;164&quot; data-start=&quot;48&quot;&gt;&lt;strong data-end=&quot;57&quot; data-start=&quot;48&quot;&gt;事件的本质&lt;/strong&gt;&lt;br data-end=&quot;60&quot; data-start=&quot;57&quot;&gt;&lt;br&gt;👉 &lt;strong data-end=&quot;119&quot; data-start=&quot;65&quot;&gt;是内核 epoll 的 &lt;code data-end=&quot;91&quot; data-start=&quot;79&quot;&gt;ready_list&lt;/code&gt; 链表中的节点（&lt;code data-end=&quot;116&quot; data-start=&quot;99&quot;&gt;epitem-&amp;gt;rdllink&lt;/code&gt;）&lt;/strong&gt;，&lt;br data-end=&quot;123&quot; data-start=&quot;120&quot;&gt;&lt;br&gt;这个节点表示&lt;strong data-end=&quot;149&quot; data-start=&quot;131&quot;&gt;某个 fd 当前处于就绪状态&lt;/strong&gt;（可读 / 可写 / 错误）。&lt;/p&gt;&lt;br&gt;&lt;/li&gt;&lt;li data-end=&quot;297&quot; data-start=&quot;166&quot;&gt;&lt;p data-end=&quot;297&quot; data-start=&quot;168&quot;&gt;&lt;strong data-end=&quot;186&quot; data-start=&quot;168&quot;&gt;&lt;code data-end=&quot;180&quot; data-start=&quot;170&quot;&gt;events[]&lt;/code&gt; 的作用&lt;/strong&gt;&lt;br data-end=&quot;189&quot; data-start=&quot;186&quot;&gt;&lt;br&gt;👉 只是 &lt;code data-end=&quot;211&quot; data-start=&quot;197&quot;&gt;epoll_wait()&lt;/code&gt; &lt;strong data-end=&quot;236&quot; data-start=&quot;212&quot;&gt;将 ready_list 里的事件元信息&lt;/strong&gt;（fd + event mask）&lt;br data-end=&quot;256&quot; data-start=&quot;253&quot;&gt;&lt;br&gt;&lt;strong data-end=&quot;269&quot; data-start=&quot;258&quot;&gt;复制到用户空间&lt;/strong&gt; 的一个 &lt;strong data-end=&quot;282&quot; data-start=&quot;274&quot;&gt;数组形式&lt;/strong&gt;，方便用户（Nginx）读取。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontStyle=1;fillColor=#f8cecc;strokeColor=#b85450;align=left;" parent="1" vertex="1">
          <mxGeometry x="-827" y="-248.5" width="444" height="217" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-49" value="&lt;ul&gt;&lt;li data-end=&quot;164&quot; data-start=&quot;46&quot;&gt;&lt;h2 data-end=&quot;61&quot; data-start=&quot;35&quot;&gt;&lt;strong data-end=&quot;61&quot; data-start=&quot;40&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;事件类型由 socket 状态决定&lt;/font&gt;&lt;/strong&gt;&lt;/h2&gt;&lt;p data-end=&quot;142&quot; data-start=&quot;63&quot;&gt;在 epoll 中，&lt;strong data-end=&quot;119&quot; data-start=&quot;73&quot;&gt;事件类型（EPOLLIN / EPOLLOUT）完全取决于 socket 的当前状态&lt;/strong&gt;，而不是用户空间 Nginx 主动设置的标志。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontStyle=1;fillColor=#f8cecc;strokeColor=#b85450;align=left;" parent="1" vertex="1">
          <mxGeometry x="-827" y="-18" width="444" height="112.5" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-63" value="&lt;div&gt;http/ngx_http_core_module.c&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;ngx_module_t&amp;nbsp; ngx_http_core_module = {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NGX_MODULE_V1,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;amp;ngx_http_core_module_ctx,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* module context */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_http_core_commands,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* module directives */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;NGX_HTTP_MODULE,&amp;nbsp;&lt;/font&gt;&lt;/b&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;font color=&quot;#ff3333&quot;&gt;/* module type */&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* init master */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* init module */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* init process */&lt;br&gt;......&lt;br&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=17;" parent="1" vertex="1">
          <mxGeometry x="2703" y="1413.5" width="319" height="173.5" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--86" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;Nginx模块分类&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=#ffffff;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;" parent="1" vertex="1">
          <mxGeometry x="2621.5" y="763" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--88" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;NGX_CORE_MODULE&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d80073;strokeColor=#A50040;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="2607.5" y="862" width="148" height="53" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-25" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--86" target="oCp0Jb_trErku0qVtbz--88" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--89" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;NGX_EVENT_MODULE&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="3350" y="979.5" width="150" height="50" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-24" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--88" target="oCp0Jb_trErku0qVtbz--89" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--90" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;NGX_HTTP_MODULE&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2967" y="979.5" width="150" height="50" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-22" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--88" target="oCp0Jb_trErku0qVtbz--90" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--92" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;NGX_MAIL_MODULE&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="2606.5" y="975" width="150" height="50" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-20" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--88" target="oCp0Jb_trErku0qVtbz--92" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--93" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;NGX_STREAM_MODULE&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="2240.5" y="975" width="150" height="50" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-21" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--88" target="oCp0Jb_trErku0qVtbz--93" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-10" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;NGX_CONF_MODULE&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1860.5" y="975" width="150" height="50" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-23" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--88" target="tbstedJyYURACH70QP3b-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-26" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;core/ngx_conf_file.c-&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;ngx_module_t&amp;nbsp; ngx_conf_module = {&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;&amp;nbsp; &amp;nbsp; NGX_MODULE_V1,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* module context */&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;&amp;nbsp; &amp;nbsp; ngx_conf_commands,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* module directives */&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;NGX_CONF_MODULE&lt;/font&gt;&lt;/b&gt;,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;font color=&quot;#ff3333&quot;&gt;/* module type */&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* init master */&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;&amp;nbsp; &amp;nbsp; ......&lt;br&gt;}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;align=left;spacingLeft=17;" parent="1" vertex="1">
          <mxGeometry x="1769" y="1071" width="333" height="168" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-27" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-10" target="tbstedJyYURACH70QP3b-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-28" value="&lt;div&gt;&lt;div&gt;stream/ngx_stream.c:&lt;br&gt;&lt;/div&gt;&lt;div&gt;ngx_module_t&amp;nbsp; ngx_stream_module = {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NGX_MODULE_V1,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;amp;ngx_stream_module_ctx,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* module context */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_stream_commands,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* module directives */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;NGX_CORE_MODULE,&lt;/font&gt;&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;font color=&quot;#ff3333&quot;&gt;&amp;nbsp;/* module type */&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* init master */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* init module */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* init process */、&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ......&lt;br&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=17;" parent="1" vertex="1">
          <mxGeometry x="2152" y="1071" width="327" height="168" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-30" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--93" target="tbstedJyYURACH70QP3b-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-31" value="&lt;div&gt;mail/ngx_mail.c:&lt;br&gt;&lt;/div&gt;&lt;div&gt;ngx_module_t&amp;nbsp; ngx_mail_module = {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NGX_MODULE_V1,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;amp;ngx_mail_module_ctx,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* module context */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_mail_commands,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* module directives */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;&lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt; NGX_CORE_MODULE,&amp;nbsp;&lt;/font&gt;&lt;/b&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;font color=&quot;#ff3333&quot;&gt;/* module type */&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* init master */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* init module */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* init process */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ......&lt;br&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;spacingLeft=17;" parent="1" vertex="1">
          <mxGeometry x="2531.5" y="1068.5" width="300" height="168" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-33" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--92" target="tbstedJyYURACH70QP3b-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-67" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-34" target="tbstedJyYURACH70QP3b-66" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-71" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-34" target="tbstedJyYURACH70QP3b-69" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-34" value="&lt;div&gt;http/ngx_http.c:&lt;br&gt;&lt;/div&gt;&lt;div&gt;ngx_module_t&amp;nbsp; ngx_http_module = {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NGX_MODULE_V1,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;amp;ngx_http_module_ctx,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* module context */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_http_commands,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* module directives */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;NGX_CORE_MODULE,&lt;/font&gt;&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;font color=&quot;#ff3333&quot;&gt;/* module type */&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* init master */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* init module */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* init process */&lt;br&gt;&amp;nbsp; &amp;nbsp; ......&lt;br&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=17;" parent="1" vertex="1">
          <mxGeometry x="2890" y="1070.5" width="304" height="173.5" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-35" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--90" target="tbstedJyYURACH70QP3b-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-36" value="&lt;div&gt;&lt;div&gt;ngx_module_t&amp;nbsp; ngx_events_module = {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NGX_MODULE_V1,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;amp;ngx_events_module_ctx,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* module context */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_events_commands,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* module directives */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;NGX_CORE_MODULE,&lt;/font&gt;&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;font color=&quot;#ff3333&quot;&gt;/* module type */&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* init master */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ......&lt;/div&gt;&lt;div&gt;};&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;align=left;spacingLeft=17;" parent="1" vertex="1">
          <mxGeometry x="3254" y="1071.5" width="342" height="172.5" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-37" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="oCp0Jb_trErku0qVtbz--89" target="tbstedJyYURACH70QP3b-36" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-68" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-66" target="tbstedJyYURACH70QP3b-63" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-74" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-66" target="tbstedJyYURACH70QP3b-73" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-66" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;NGX_HTTP_ CORE_MUDULE&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2766" y="1321" width="193" height="51" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-72" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-69" target="tbstedJyYURACH70QP3b-70" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-69" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;NGX_HTTP_ UPSTREAM_MUDULE&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="3121" y="1321" width="221" height="51" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-70" value="&lt;div&gt;ngx_module_t&amp;nbsp; ngx_http_upstream_module = {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NGX_MODULE_V1,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;amp;ngx_http_upstream_module_ctx,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;/* module context */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_http_upstream_commands,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* module directives */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;NGX_HTTP_MODULE,&lt;/font&gt;&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;font color=&quot;#ff3333&quot;&gt;/* module type */&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* init master */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; NULL,&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* init module */&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ......&lt;br&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=17;" parent="1" vertex="1">
          <mxGeometry x="3059" y="1412.5" width="345" height="174.5" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-73" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;每个模块中会有一些通用的，共性的部分，通常是XX_core_mudole，会把通用的，共同具有的功能写在里面，index为1，也就是一定是第一位的&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;" parent="1" vertex="1">
          <mxGeometry x="2440" y="1321" width="280" height="51" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-93" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-75" target="tbstedJyYURACH70QP3b-76" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-127" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-75" target="tbstedJyYURACH70QP3b-78" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-148" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-75" target="DRZZ042X9pF3NeJ8se2F-147" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-75" value="Nginx 连接池" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=#ffffff;fillColor=#1ba1e2;strokeColor=#006EAF;" parent="1" vertex="1">
          <mxGeometry x="-319" y="2189" width="97" height="33" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-160" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-76" target="DRZZ042X9pF3NeJ8se2F-158" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-161" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-76" target="DRZZ042X9pF3NeJ8se2F-159" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-76" value="&lt;b style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;ngx_connection_t&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-1551" y="2289" width="125" height="29" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-80" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-79" target="tbstedJyYURACH70QP3b-75" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-88" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-79" target="tbstedJyYURACH70QP3b-86" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-92" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-79" target="tbstedJyYURACH70QP3b-91" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-79" value="&lt;b&gt;NGX_CYCLE_T&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=#ffffff;fillColor=#6a00ff;strokeColor=#3700CC;" parent="1" vertex="1">
          <mxGeometry x="-142" y="1984" width="113" height="33" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-86" value="&lt;div&gt;&lt;b style=&quot;border-color: var(--border-color); text-align: center;&quot;&gt;core/ngx_core.h:typedef struct ngx_cycle_s&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;ngx_cycle_t;&lt;/b&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;typedef struct ngx_cycle_s {&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; ngx_connection_t&amp;nbsp; &amp;nbsp;*connections;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// 连接池数组&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; ngx_event_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; *read_events;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 读事件数组&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; ngx_event_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; *write_events;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// 写事件数组&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; ngx_connection_t&amp;nbsp; &amp;nbsp;*free_connections;&amp;nbsp; // 空闲连接链表头&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; ngx_uint_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; connection_n;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// 连接池大小 (worker_connections)&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;ngx_pool_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// 内存池&lt;/b&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; ...&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;} ngx_cycle_t;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;spacingLeft=10;" parent="1" vertex="1">
          <mxGeometry x="-611" y="1916.5" width="420" height="168" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-131" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-91" target="tbstedJyYURACH70QP3b-129" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-133" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-91" target="tbstedJyYURACH70QP3b-130" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-91" value="&lt;b&gt;Nginx 内存池&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=#ffffff;fillColor=#008a00;strokeColor=#005700;" parent="1" vertex="1">
          <mxGeometry x="1468" y="2189" width="97" height="33" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-124" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="-812" y="2291" width="1966.25" height="795" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-78" value="&lt;b&gt;事件触发与连接池分配的过程&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry x="624.75" width="161" height="29" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-94" value="客户端 → 服务器 TCP 三次握手" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry x="26.25" y="72" width="191" height="29" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-100" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=none;endFill=0;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-78" target="tbstedJyYURACH70QP3b-94" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-95" value="epoll 事件触发" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry x="396.75" y="72" width="117" height="29" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-102" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-94" target="tbstedJyYURACH70QP3b-95" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-96" value="Nginx 处理 &lt;code data-end=&quot;323&quot; data-start=&quot;312&quot;&gt;listen_fd&lt;/code&gt; 事件" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry x="776.25" y="72" width="150" height="29" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-103" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-95" target="tbstedJyYURACH70QP3b-96" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-97" value="连接池分配 &lt;code data-end=&quot;455&quot; data-start=&quot;437&quot;&gt;ngx_connection_t&lt;/code&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry x="1192.25" y="72" width="200" height="29" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-101" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=none;endFill=0;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-78" target="tbstedJyYURACH70QP3b-97" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-104" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-96" target="tbstedJyYURACH70QP3b-97" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-105" value="内核 TCP 栈完成握手 → &lt;code data-end=&quot;152&quot; data-start=&quot;141&quot;&gt;listen_fd&lt;/code&gt; 变为 &lt;strong data-end=&quot;171&quot; data-start=&quot;156&quot;&gt;可读（EPOLLIN）&lt;/strong&gt;。" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry y="142" width="243.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-108" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-94" target="tbstedJyYURACH70QP3b-105" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-109" value="&lt;ul style=&quot;line-height: 150%;&quot;&gt;&lt;li&gt;内核 TCP 栈完成握手 → &lt;code data-end=&quot;152&quot; data-start=&quot;141&quot;&gt;listen_fd&lt;/code&gt; 变为 &lt;strong data-end=&quot;171&quot; data-start=&quot;156&quot;&gt;可读（EPOLLIN）&lt;/strong&gt;。&lt;/li&gt;&lt;li&gt;&lt;code data-end=&quot;264&quot; data-start=&quot;250&quot;&gt;epoll_wait()&lt;/code&gt; 被唤醒 → &lt;strong data-end=&quot;295&quot; data-start=&quot;271&quot;&gt;拷贝事件到用户空间 &lt;code data-end=&quot;293&quot; data-start=&quot;283&quot;&gt;events[]&lt;/code&gt;&lt;/strong&gt;。&lt;/li&gt;&lt;/ul&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=0;" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry x="272.25" y="142" width="366" height="60" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-111" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-95" target="tbstedJyYURACH70QP3b-109" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-112" value="&lt;ul style=&quot;line-height: 150%;&quot;&gt;&lt;li&gt;扫描 &lt;code data-end=&quot;349&quot; data-start=&quot;339&quot;&gt;events[]&lt;/code&gt; 发现 &lt;code data-end=&quot;364&quot; data-start=&quot;353&quot;&gt;listen_fd&lt;/code&gt; 触发可读 → 调用 &lt;code data-end=&quot;385&quot; data-start=&quot;375&quot;&gt;accept()&lt;/code&gt;；&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;code data-end=&quot;404&quot; data-start=&quot;394&quot;&gt;accept()&lt;/code&gt; 返回一个新的 &lt;code data-end=&quot;423&quot; data-start=&quot;412&quot;&gt;client_fd&lt;/code&gt;。&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=0;" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry x="668.25" y="142" width="366" height="60" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-113" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-96" target="tbstedJyYURACH70QP3b-112" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-114" value="&lt;ul style=&quot;line-height: 150%;&quot;&gt;&lt;li&gt;Nginx 从 &lt;code data-end=&quot;488&quot; data-start=&quot;473&quot;&gt;connections[]&lt;/code&gt;（连接池）空闲链表中取一个 &lt;code data-end=&quot;520&quot; data-start=&quot;502&quot;&gt;ngx_connection_t&lt;/code&gt;；&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;font color=&quot;#ff3333&quot;&gt;将 &lt;code data-end=&quot;542&quot; data-start=&quot;531&quot;&gt;client_fd&lt;/code&gt; 绑定到这个 &lt;code data-end=&quot;567&quot; data-start=&quot;549&quot;&gt;ngx_connection_t&lt;/code&gt;；&lt;/font&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;初始化其 &lt;code data-end=&quot;587&quot; data-start=&quot;581&quot;&gt;read&lt;/code&gt; / &lt;code data-end=&quot;597&quot; data-start=&quot;590&quot;&gt;write&lt;/code&gt; 指针，关联到 &lt;code data-end=&quot;620&quot; data-start=&quot;605&quot;&gt;read_events[]&lt;/code&gt; / &lt;code data-end=&quot;639&quot; data-start=&quot;623&quot;&gt;write_events[]&lt;/code&gt; 对应位置；&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;font color=&quot;#ff3333&quot;&gt;设置 &lt;code data-end=&quot;662&quot; data-start=&quot;656&quot;&gt;data&lt;/code&gt; 指向上层 HTTP 请求对象&lt;/font&gt;。&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=0;" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry x="1054.25" y="142" width="476" height="91" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-115" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-97" target="tbstedJyYURACH70QP3b-114" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-116" value="&lt;p style=&quot;line-height: 130%;&quot; data-end=&quot;242&quot; data-start=&quot;201&quot;&gt;当 &lt;code data-end=&quot;213&quot; data-start=&quot;203&quot;&gt;accept()&lt;/code&gt; 返回一个 &lt;code data-end=&quot;230&quot; data-start=&quot;219&quot;&gt;client_fd&lt;/code&gt; 时，Nginx 需要：&lt;/p&gt;&lt;ol style=&quot;line-height: 130%;&quot; data-end=&quot;565&quot; data-start=&quot;243&quot;&gt;&lt;li data-end=&quot;296&quot; data-start=&quot;243&quot;&gt;&lt;p style=&quot;line-height: 130%;&quot; data-end=&quot;296&quot; data-start=&quot;246&quot;&gt;&lt;strong data-end=&quot;295&quot; data-start=&quot;246&quot;&gt;从连接池 &lt;code data-end=&quot;268&quot; data-start=&quot;253&quot;&gt;connections[]&lt;/code&gt; 取一个空闲 &lt;code data-end=&quot;293&quot; data-start=&quot;275&quot;&gt;ngx_connection_t&lt;/code&gt;&lt;/strong&gt;；&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;349&quot; data-start=&quot;297&quot;&gt;&lt;p style=&quot;line-height: 130%;&quot; data-end=&quot;349&quot; data-start=&quot;300&quot;&gt;&lt;strong data-end=&quot;348&quot; data-start=&quot;300&quot;&gt;把 &lt;code data-end=&quot;315&quot; data-start=&quot;304&quot;&gt;client_fd&lt;/code&gt; 存到这个 &lt;code data-end=&quot;343&quot; data-start=&quot;321&quot;&gt;ngx_connection_t-&amp;gt;fd&lt;/code&gt; 字段&lt;/strong&gt;；&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;453&quot; data-start=&quot;350&quot;&gt;&lt;p style=&quot;line-height: 130%;&quot; data-end=&quot;453&quot; data-start=&quot;353&quot;&gt;&lt;strong data-end=&quot;367&quot; data-start=&quot;353&quot;&gt;初始化其读写事件指针&lt;/strong&gt;，让 &lt;code data-end=&quot;394&quot; data-start=&quot;370&quot;&gt;ngx_connection_t-&amp;gt;read&lt;/code&gt; / &lt;code data-end=&quot;404&quot; data-start=&quot;397&quot;&gt;write&lt;/code&gt; 分别指向 &lt;code data-end=&quot;429&quot; data-start=&quot;410&quot;&gt;read_events[slot]&lt;/code&gt; / &lt;code data-end=&quot;452&quot; data-start=&quot;432&quot;&gt;write_events[slot]&lt;/code&gt;；&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;506&quot; data-start=&quot;454&quot;&gt;&lt;p style=&quot;line-height: 130%;&quot; data-end=&quot;506&quot; data-start=&quot;457&quot;&gt;&lt;strong data-end=&quot;487&quot; data-start=&quot;457&quot;&gt;将读事件的 &lt;code data-end=&quot;471&quot; data-start=&quot;465&quot;&gt;data&lt;/code&gt; 字段设置为指向这个连接对象&lt;/strong&gt;（&lt;code data-end=&quot;504&quot; data-start=&quot;488&quot;&gt;read-&amp;gt;data = c&lt;/code&gt;）；&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;565&quot; data-start=&quot;507&quot;&gt;&lt;p style=&quot;line-height: 130%;&quot; data-end=&quot;565&quot; data-start=&quot;510&quot;&gt;通过 &lt;code data-end=&quot;540&quot; data-start=&quot;513&quot;&gt;epoll_ctl(ADD, client_fd)&lt;/code&gt; 把这个 fd 注册到 epoll，绑定事件回调。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=14;" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry x="737.25" y="312" width="444" height="168" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-117" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-114" target="tbstedJyYURACH70QP3b-116" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-118" value="&lt;p style=&quot;line-height: 80%;&quot; data-end=&quot;242&quot; data-start=&quot;201&quot;&gt;// 假设当前有 &lt;code data-end=&quot;614&quot; data-start=&quot;596&quot;&gt;connections[100]&lt;/code&gt; 这个空闲的 &lt;code data-end=&quot;639&quot; data-start=&quot;621&quot;&gt;ngx_connection_t&lt;/code&gt;，&lt;code data-end=&quot;653&quot; data-start=&quot;643&quot;&gt;accept()&lt;/code&gt; 新建了 &lt;code data-end=&quot;674&quot; data-start=&quot;658&quot;&gt;client_fd = 56&lt;/code&gt;，Nginx 会：&lt;br&gt;&lt;br&gt;ngx_connection_t *c = &amp;amp;cycle-&amp;gt;connections[100];&amp;nbsp; // 取一个空闲连接&lt;/p&gt;&lt;p style=&quot;line-height: 80%;&quot; data-end=&quot;242&quot; data-start=&quot;201&quot;&gt;c-&amp;gt;fd = 56;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// 绑定 client_fd&lt;/p&gt;&lt;p style=&quot;line-height: 80%;&quot; data-end=&quot;242&quot; data-start=&quot;201&quot;&gt;c-&amp;gt;read = &amp;amp;cycle-&amp;gt;read_events[100];&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// 绑定读事件对象&lt;/p&gt;&lt;p style=&quot;line-height: 80%;&quot; data-end=&quot;242&quot; data-start=&quot;201&quot;&gt;c-&amp;gt;write = &amp;amp;cycle-&amp;gt;write_events[100];&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 绑定写事件对象&lt;/p&gt;&lt;p style=&quot;line-height: 80%;&quot; data-end=&quot;242&quot; data-start=&quot;201&quot;&gt;c-&amp;gt;read-&amp;gt;data = c;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 事件回调能找到连接&lt;/p&gt;&lt;p style=&quot;line-height: 80%;&quot; data-end=&quot;242&quot; data-start=&quot;201&quot;&gt;c-&amp;gt;write-&amp;gt;data = c;&lt;/p&gt;&lt;div style=&quot;line-height: 80%;&quot;&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=14;" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry x="664.75" y="518" width="589" height="196" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-119" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-116" target="tbstedJyYURACH70QP3b-118" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-120" value="&lt;p style=&quot;line-height: 130%;&quot; data-end=&quot;242&quot; data-start=&quot;201&quot;&gt;当 Nginx 建立一个连接后，&lt;code data-end=&quot;51&quot; data-start=&quot;33&quot;&gt;ngx_connection_t&lt;/code&gt; 只是底层 socket 的抽象，&lt;strong data-end=&quot;92&quot; data-start=&quot;68&quot;&gt;它本身并不存储 HTTP 请求的全部信息&lt;/strong&gt;。&lt;br data-end=&quot;96&quot; data-start=&quot;93&quot;&gt;&lt;br&gt;当真正收到 HTTP 请求时，Nginx 会为这个连接创建一个 &lt;code data-end=&quot;148&quot; data-start=&quot;128&quot;&gt;ngx_http_request_t&lt;/code&gt;（HTTP 请求对象），并把 &lt;code data-end=&quot;187&quot; data-start=&quot;163&quot;&gt;&lt;b&gt;ngx_connection_t-&amp;gt;data&lt;/b&gt;&lt;/code&gt; 指针指向这个请求对象，以便后续所有事件处理时都能找到 HTTP 层上下文&lt;br&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=14;" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry x="1344.25" y="316" width="586" height="102" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-121" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-114" target="tbstedJyYURACH70QP3b-120" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-122" value="&lt;ol data-end=&quot;711&quot; data-start=&quot;253&quot;&gt;&lt;li data-end=&quot;353&quot; data-start=&quot;253&quot;&gt;&lt;p data-end=&quot;278&quot; data-start=&quot;256&quot;&gt;&lt;strong data-end=&quot;275&quot; data-start=&quot;256&quot;&gt;刚 accept() 新连接时&lt;/strong&gt;：&lt;/p&gt;&lt;ul data-end=&quot;353&quot; data-start=&quot;282&quot;&gt;&lt;li data-end=&quot;353&quot; data-start=&quot;282&quot;&gt;&lt;p data-end=&quot;353&quot; data-start=&quot;284&quot;&gt;&lt;code data-end=&quot;293&quot; data-start=&quot;284&quot;&gt;c-&amp;gt;data&lt;/code&gt; 可能先指向一个简单的回调处理函数的上下文，例如 &lt;code data-end=&quot;347&quot; data-start=&quot;318&quot;&gt;ngx_http_init_connection(c)&lt;/code&gt; 处理阶段&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li data-end=&quot;537&quot; data-start=&quot;355&quot;&gt;&lt;p data-end=&quot;380&quot; data-start=&quot;358&quot;&gt;&lt;strong data-end=&quot;377&quot; data-start=&quot;358&quot;&gt;当开始接收 HTTP 请求头时&lt;/strong&gt;&lt;/p&gt;&lt;ul data-end=&quot;537&quot; data-start=&quot;384&quot;&gt;&lt;li data-end=&quot;451&quot; data-start=&quot;384&quot;&gt;&lt;p data-end=&quot;451&quot; data-start=&quot;386&quot;&gt;Nginx 调用 &lt;code data-end=&quot;423&quot; data-start=&quot;395&quot;&gt;ngx_http_create_request(c)&lt;/code&gt; 创建 &lt;code data-end=&quot;450&quot; data-start=&quot;427&quot;&gt;ngx_http_request_t *r&lt;/code&gt;；&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;489&quot; data-start=&quot;455&quot;&gt;&lt;p data-end=&quot;489&quot; data-start=&quot;457&quot;&gt;这个 &lt;code data-end=&quot;463&quot; data-start=&quot;460&quot;&gt;r&lt;/code&gt; 保存 HTTP 请求的状态、解析缓冲、响应链表等；&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;537&quot; data-start=&quot;493&quot;&gt;&lt;p data-end=&quot;537&quot; data-start=&quot;495&quot;&gt;&lt;strong data-end=&quot;517&quot; data-start=&quot;495&quot;&gt;然后执行 &lt;code data-end=&quot;515&quot; data-start=&quot;502&quot;&gt;c-&amp;gt;data = r&lt;/code&gt;&lt;/strong&gt;，把连接对象和 HTTP 请求对象绑定。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li data-end=&quot;711&quot; data-start=&quot;539&quot;&gt;&lt;p data-end=&quot;572&quot; data-start=&quot;542&quot;&gt;&lt;strong data-end=&quot;571&quot; data-start=&quot;542&quot;&gt;以后所有的事件（EPOLLIN/EPOLLOUT）&lt;/strong&gt;：&lt;/p&gt;&lt;ul data-end=&quot;711&quot; data-start=&quot;576&quot;&gt;&lt;li data-end=&quot;640&quot; data-start=&quot;576&quot;&gt;&lt;p data-end=&quot;640&quot; data-start=&quot;578&quot;&gt;当 epoll 返回事件时，通过 &lt;code data-end=&quot;613&quot; data-start=&quot;595&quot;&gt;c-&amp;gt;read-&amp;gt;handler&lt;/code&gt; 或 &lt;code data-end=&quot;635&quot; data-start=&quot;616&quot;&gt;c-&amp;gt;write-&amp;gt;handler&lt;/code&gt; 被调用；&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;711&quot; data-start=&quot;644&quot;&gt;&lt;p data-end=&quot;711&quot; data-start=&quot;646&quot;&gt;事件处理函数内部会通过 &lt;code data-end=&quot;692&quot; data-start=&quot;658&quot;&gt;ngx_http_request_t *r = c-&amp;gt;data;&lt;/code&gt; 找到 HTTP 请求对象来处理业务。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ol&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;align=left;spacingLeft=7;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="tbstedJyYURACH70QP3b-124" vertex="1">
          <mxGeometry x="1308.25" y="514" width="658" height="281" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-123" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tbstedJyYURACH70QP3b-124" source="tbstedJyYURACH70QP3b-120" target="tbstedJyYURACH70QP3b-122" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-49" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-129" target="SBsURusUmZdSX8FJDAMt-42" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-50" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-129" target="SBsURusUmZdSX8FJDAMt-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-129" value="&lt;b&gt;请求内存池&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1753" y="2295" width="97" height="33" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-51" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-130" target="SBsURusUmZdSX8FJDAMt-41" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-52" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="tbstedJyYURACH70QP3b-130" target="SBsURusUmZdSX8FJDAMt-43" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tbstedJyYURACH70QP3b-130" value="&lt;b&gt;连接内存池&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1315" y="2295" width="97" height="33" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-30" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="474" y="-1435" width="1287" height="607" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;strokeWidth=2;startArrow=classic;startFill=1;" parent="2pCcyZzb-pndT4Qp4Zei-30" source="2pCcyZzb-pndT4Qp4Zei-1" target="2pCcyZzb-pndT4Qp4Zei-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-1" value="&lt;b&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;Nginx&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="2pCcyZzb-pndT4Qp4Zei-30" vertex="1">
          <mxGeometry x="541" y="335" width="188" height="88" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-2" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 26px;&quot;&gt;Nginx 相关的生产问题解决思路&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="2pCcyZzb-pndT4Qp4Zei-30" vertex="1">
          <mxGeometry x="417" width="464" height="89" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;startArrow=classic;startFill=1;" parent="2pCcyZzb-pndT4Qp4Zei-30" source="2pCcyZzb-pndT4Qp4Zei-3" target="2pCcyZzb-pndT4Qp4Zei-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-12" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;" parent="2pCcyZzb-pndT4Qp4Zei-30" source="2pCcyZzb-pndT4Qp4Zei-3" target="2pCcyZzb-pndT4Qp4Zei-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-13" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;" parent="2pCcyZzb-pndT4Qp4Zei-30" source="2pCcyZzb-pndT4Qp4Zei-3" target="2pCcyZzb-pndT4Qp4Zei-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-14" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;" parent="2pCcyZzb-pndT4Qp4Zei-30" source="2pCcyZzb-pndT4Qp4Zei-3" target="2pCcyZzb-pndT4Qp4Zei-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-3" value="&lt;b&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;网络&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;" parent="2pCcyZzb-pndT4Qp4Zei-30" vertex="1">
          <mxGeometry x="242" y="334" width="188" height="88" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-23" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;" parent="2pCcyZzb-pndT4Qp4Zei-30" source="2pCcyZzb-pndT4Qp4Zei-4" target="2pCcyZzb-pndT4Qp4Zei-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-24" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;" parent="2pCcyZzb-pndT4Qp4Zei-30" source="2pCcyZzb-pndT4Qp4Zei-4" target="2pCcyZzb-pndT4Qp4Zei-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-25" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;" parent="2pCcyZzb-pndT4Qp4Zei-30" source="2pCcyZzb-pndT4Qp4Zei-4" target="2pCcyZzb-pndT4Qp4Zei-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-26" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;" parent="2pCcyZzb-pndT4Qp4Zei-30" source="2pCcyZzb-pndT4Qp4Zei-4" target="2pCcyZzb-pndT4Qp4Zei-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-4" value="&lt;b&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;资源&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#a20025;strokeColor=#6F0000;fontColor=#ffffff;" parent="2pCcyZzb-pndT4Qp4Zei-30" vertex="1">
          <mxGeometry x="840" y="336" width="188" height="88" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-8" value="&lt;b&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;TCP&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="2pCcyZzb-pndT4Qp4Zei-30" vertex="1">
          <mxGeometry y="189" width="158" height="77" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-9" value="&lt;b&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;HTTP&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="2pCcyZzb-pndT4Qp4Zei-30" vertex="1">
          <mxGeometry y="339.5" width="158" height="77" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-10" value="&lt;b&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;SSL/TLS&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="2pCcyZzb-pndT4Qp4Zei-30" vertex="1">
          <mxGeometry y="479" width="158" height="77" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-15" value="&lt;b&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;计算&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="2pCcyZzb-pndT4Qp4Zei-30" vertex="1">
          <mxGeometry x="1136.5" y="136" width="150.5" height="68" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-16" value="&lt;span style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;内存&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="2pCcyZzb-pndT4Qp4Zei-30" vertex="1">
          <mxGeometry x="1129.75" y="273" width="157.25" height="70" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-17" value="&lt;span style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;网络&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="2pCcyZzb-pndT4Qp4Zei-30" vertex="1">
          <mxGeometry x="1130.25" y="403" width="154" height="72" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-22" value="&lt;span style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;磁盘IO&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="2pCcyZzb-pndT4Qp4Zei-30" vertex="1">
          <mxGeometry x="1129.75" y="535" width="154" height="72" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-31" value="Nginx事件驱动框架与HTTP等状态机的关系&lt;div&gt;&lt;strong data-end=&quot;2188&quot; data-start=&quot;2178&quot;&gt;事件驱动框架&lt;/strong&gt;：提供“什么时候可以继续干活”的调度与唤醒（I/O 就绪和定时器）。&lt;/div&gt;&lt;div&gt;&lt;strong data-end=&quot;2239&quot; data-start=&quot;2227&quot;&gt;HTTP 状态机&lt;/strong&gt;：定义“每次被唤醒要干哪一小步活”，并决定下一步要监听什么事件/超时。&lt;br&gt;&amp;nbsp;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="1908" y="-713" width="711" height="146" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-47" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="617" y="-678" width="831" height="525" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-41" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;dashed=1;dashPattern=8 8;" parent="2pCcyZzb-pndT4Qp4Zei-47" source="2pCcyZzb-pndT4Qp4Zei-32" target="2pCcyZzb-pndT4Qp4Zei-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-32" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;Nginx&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=#ffffff;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;" parent="2pCcyZzb-pndT4Qp4Zei-47" vertex="1">
          <mxGeometry x="412" y="55" width="299" height="60" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-40" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;entryX=0.25;entryY=1;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;dashed=1;dashPattern=8 8;" parent="2pCcyZzb-pndT4Qp4Zei-47" source="2pCcyZzb-pndT4Qp4Zei-33" target="2pCcyZzb-pndT4Qp4Zei-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-33" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;网络 TCP/IP 协议栈&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=#ffffff;labelBackgroundColor=none;fillColor=#0050ef;strokeColor=#001DBC;" parent="2pCcyZzb-pndT4Qp4Zei-47" vertex="1">
          <mxGeometry x="412" y="393" width="299" height="60" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-43" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-47" source="2pCcyZzb-pndT4Qp4Zei-34" target="2pCcyZzb-pndT4Qp4Zei-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-44" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;通知就绪&lt;/b&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="2pCcyZzb-pndT4Qp4Zei-43" vertex="1" connectable="0">
          <mxGeometry x="-0.385" y="-29" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-45" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-47" source="2pCcyZzb-pndT4Qp4Zei-34" target="2pCcyZzb-pndT4Qp4Zei-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-46" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 17px;&quot;&gt;监听&lt;/b&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="2pCcyZzb-pndT4Qp4Zei-45" vertex="1" connectable="0">
          <mxGeometry x="0.2213" y="18" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-34" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;EPOLL( ) 系统调用&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=#ffffff;labelBackgroundColor=none;fillColor=#a20025;strokeColor=#6F0000;" parent="2pCcyZzb-pndT4Qp4Zei-47" vertex="1">
          <mxGeometry x="88" y="243" width="299" height="60" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-37" value="&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 14px;&quot;&gt;负责 &lt;strong data-start=&quot;464&quot; data-end=&quot;480&quot;&gt;TCP 连接建立与状态机&lt;/strong&gt;（SYN/ACK、重传、拥塞控制、FIN/RST 等）&lt;/font&gt;&lt;div&gt;&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 14px;&quot;&gt;以及把数据放到套接字接收缓冲区。维护socket状态&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=none;" parent="2pCcyZzb-pndT4Qp4Zei-47" vertex="1">
          <mxGeometry x="349" y="467" width="482" height="58" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-38" value="&lt;font style=&quot;font-size: 14px;&quot; color=&quot;#cc0000&quot;&gt;（事件驱动框架）只是&lt;strong data-start=&quot;364&quot; data-end=&quot;372&quot; style=&quot;&quot;&gt;通知就绪&lt;/strong&gt;的机制，不做协议解析、不收发数据&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font color=&quot;#cc0000&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;你可以理解为“唤醒器”：告诉 Nginx 哪些 fd 现在可以读/写了。&lt;/font&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font color=&quot;#cc0000&quot;&gt;&lt;strong data-end=&quot;1121&quot; data-start=&quot;1040&quot;&gt;&amp;nbsp;epoll 维护 fd 的就绪集合 → &lt;code data-end=&quot;1097&quot; data-start=&quot;1083&quot;&gt;epoll_wait()&lt;/code&gt; 通知 Nginx 哪些 fd 可读/可写”&lt;/strong&gt;。&lt;/font&gt;&lt;font style=&quot;font-size: 14px;&quot; color=&quot;#cc0000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="2pCcyZzb-pndT4Qp4Zei-47" vertex="1">
          <mxGeometry y="171" width="482" height="58" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-39" value="&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font color=&quot;#cc0000&quot;&gt;接收数据后，进入对应&lt;b&gt;状态机&lt;/b&gt;，对其进行&lt;b&gt;处理&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=none;" parent="2pCcyZzb-pndT4Qp4Zei-47" vertex="1">
          <mxGeometry x="324" width="482" height="58" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-48" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="-915" y="152" width="1966" height="457.44000000000005" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--1" value="&lt;b&gt;Nginx&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#008a00;fontColor=#ffffff;strokeColor=#005700;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="738" width="109" height="45" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--3" value="操作体统" style="rounded=1;whiteSpace=wrap;html=1;container=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="550" y="82" width="527" height="44" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--2" value="epoll机制" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="oCp0Jb_trErku0qVtbz--3" vertex="1">
          <mxGeometry x="30.688755020080325" y="3.5" width="142.86144578313255" height="37" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--22" value="完整事件处理流程" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="oCp0Jb_trErku0qVtbz--3" vertex="1">
          <mxGeometry x="418" y="3.5" width="100.95" height="37" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--1" target="oCp0Jb_trErku0qVtbz--2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-38" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--6" target="tlIEBAkVMEHic_1Gy2fF-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--6" value="epoll_create()&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;创建epoll实例&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="482" y="167" width="94" height="37" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-37" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--7" target="tlIEBAkVMEHic_1Gy2fF-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--7" value="epoll_ctl()&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;注册监听socket fd&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="607.37" y="168" width="89.5" height="36" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--15" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--8" target="oCp0Jb_trErku0qVtbz--14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--8" value="epoll_wait()&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;让内核阻塞等待事件&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="714" y="168" width="118" height="36" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--2" target="oCp0Jb_trErku0qVtbz--7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--10" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--2" target="oCp0Jb_trErku0qVtbz--6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--11" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--2" target="oCp0Jb_trErku0qVtbz--8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--14" value="1. nginx 调用 epoll_wait() 监听一批 fd&lt;div&gt;2.&amp;nbsp;&lt;span style=&quot;text-align: center; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;某客户端通过连接 conn_fd 发送数据&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;3.&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;text-align: center; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;数据到达服务端后被放入内核的接收缓存区中&lt;br&gt;4. 内核将这个 conn_fd 标记为可读&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;5. Nginx 调用 read() 处理数据&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=11;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="475" y="254" width="265" height="82" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--28" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--23" target="oCp0Jb_trErku0qVtbz--24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--30" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--23" target="oCp0Jb_trErku0qVtbz--26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--23" value="监听和等待阶段&lt;br&gt;（内核空间）" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="865" y="167" width="148" height="36" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--29" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--24" target="oCp0Jb_trErku0qVtbz--25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--32" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--24" target="oCp0Jb_trErku0qVtbz--31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--24" value="事件触发阶段&lt;br&gt;（内核空间 -&amp;gt; 用户空间）" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="1330" y="168" width="167" height="36" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--35" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--25" target="oCp0Jb_trErku0qVtbz--33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--25" value="Nginx分发处理阶段&lt;br&gt;（用户态操作）" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="1708.5" y="168" width="151" height="36" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--26" value="1. &lt;b&gt;nginx 初始化时&lt;/b&gt;：&lt;br&gt;&amp;nbsp; &amp;nbsp; a. 调用 epoll_create() 创建 epoll 实例&lt;br&gt;&amp;nbsp; &amp;nbsp; b. 调用 epoll_ctl() 注册监听 socket fd (监听连接) 或已连接fd（监听读写）&lt;div&gt;&lt;br&gt;&lt;div&gt;2. &lt;b&gt;进入事件循环：&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp;&lt;/b&gt; a. 调用 epoll_wait(epfd, events[], MAX_EVENTS, timeout) 让内核阻塞等待事件&lt;br&gt;&amp;nbsp; &amp;nbsp; b. 此时，Nginx处于【等待事件状态】（比如连接到达，数据可读）&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=11;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="756" y="249" width="426" height="121" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--27" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--22" target="oCp0Jb_trErku0qVtbz--23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--31" value="1. 当某个fd有事件（如可读）时：&lt;div&gt;&amp;nbsp; &amp;nbsp; a. 内核将事件信息（例如：fd = 5, EPOLLIN）加入内核的ready list&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; b. epoll_wait()被唤醒，将事件元数据复制到用户空间的events[ ]数组&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;注意：这里只是复制了“事件描述信息”，而不是 socket 中的实际数据&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=11;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="1205" y="249" width="364" height="121" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--33" value="1.&lt;b&gt; Nginx 遍历 events[ ] 数组：&lt;/b&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; a. 对每个就绪事件，找到其对应的 handler 函数&lt;br&gt;&amp;nbsp; &amp;nbsp; b. handler 函数会决定是否继续下一步，如调用read() 读取数据&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2. &lt;b&gt;调用 read(fd, buf, size) / recv()：&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp;&lt;/b&gt; &amp;nbsp; a. 这个时候才发生 【数据复制】：&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; (1) 从内核的socket接收缓冲区（TCP recv buffer）&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; (2) 复制数据到用户空间缓冲区 （如：char buf[1024]）&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;3. &lt;b&gt;数据读取成功后&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &lt;/b&gt;a. Nginx handler 开始执行业务逻辑 （比如解析HTTP请求）&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=11;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="1602" y="249" width="364" height="177" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--39" value="&lt;span&gt;红黑树&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="349" y="35" width="93" height="38" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--40" value="链表" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry x="349" y="140" width="93" height="38" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--41" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--2" target="oCp0Jb_trErku0qVtbz--39" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oCp0Jb_trErku0qVtbz--42" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="oCp0Jb_trErku0qVtbz--2" target="oCp0Jb_trErku0qVtbz--40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-4" value="" style="group" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1" connectable="0">
          <mxGeometry x="46" y="267" width="384" height="190.44" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-3" value="" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="14.309999999999999" y="1.44" width="334.46" height="189" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-27" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-3" target="9Dw6ee0XKq7G6TXhmcGK-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-28" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-3" target="9Dw6ee0XKq7G6TXhmcGK-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="88" y="51" />
              <mxPoint x="114" y="51" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-3" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e51400;fontColor=#ffffff;strokeColor=#B20000;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="77.78251599147121" y="15.092172154356442" width="20.121673003802282" height="20.121673003802282" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-10" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-4" target="9Dw6ee0XKq7G6TXhmcGK-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-14" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-4" target="9Dw6ee0XKq7G6TXhmcGK-6" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="61" y="98" />
              <mxPoint x="88" y="98" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-4" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;fontColor=#ffffff;strokeColor=#000000;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="50.76332622601279" y="65.39742496561767" width="20.121673003802282" height="20.121673003802282" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-15" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-5" target="9Dw6ee0XKq7G6TXhmcGK-6" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="114" y="100" />
              <mxPoint x="88" y="100" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-17" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-5" target="9Dw6ee0XKq7G6TXhmcGK-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-30" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-5" target="9Dw6ee0XKq7G6TXhmcGK-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-5" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="103.98294243070362" y="65.39742496561767" width="20.121673003802282" height="20.121673003802282" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-6" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e51400;fontColor=#ffffff;strokeColor=#B20000;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="77.78251599147121" y="114.26465091821049" width="20.121673003802282" height="20.121673003802282" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-7" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e51400;fontColor=#ffffff;strokeColor=#B20000;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="22.925373134328357" y="114.26342771620419" width="20.121673003802282" height="20.121673003802282" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-8" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="108.07675906183368" y="163.12652536202572" width="20.121673003802282" height="20.121673003802282" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-24" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-9" target="9Dw6ee0XKq7G6TXhmcGK-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-29" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-9" target="9Dw6ee0XKq7G6TXhmcGK-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-9" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#e51400;fontColor=#ffffff;strokeColor=#B20000;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="131.00213219616205" y="116.42054445433216" width="20.121673003802282" height="20.121673003802282" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-11" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="171.12153518123668" y="15.092783755359598" width="20.840304182509506" height="20.840304182509506" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-12" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="216.15351812366737" y="15.092783755359598" width="20.840304182509506" height="20.840304182509506" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-11" target="9Dw6ee0XKq7G6TXhmcGK-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-13" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="269.3731343283582" y="15.092783755359598" width="20.840304182509506" height="20.840304182509506" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-12" target="9Dw6ee0XKq7G6TXhmcGK-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-14" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="315.2238805970149" y="15.092783755359598" width="20.840304182509506" height="20.840304182509506" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-13" target="9Dw6ee0XKq7G6TXhmcGK-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-31" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-10" target="9Dw6ee0XKq7G6TXhmcGK-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9Dw6ee0XKq7G6TXhmcGK-10" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="tlIEBAkVMEHic_1Gy2fF-4" vertex="1">
          <mxGeometry x="153.9275053304904" y="163.12927756653994" width="20.121673003802282" height="20.121673003802282" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-18" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="tlIEBAkVMEHic_1Gy2fF-4" source="9Dw6ee0XKq7G6TXhmcGK-9" target="9Dw6ee0XKq7G6TXhmcGK-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-35" value="红黑树上有两种fd:&lt;br&gt;listen_fd和client_fd&lt;br&gt;可以通过查看/proc/nginx_pid/fd进行查看" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#f8cecc;strokeColor=#b85450;" parent="2pCcyZzb-pndT4Qp4Zei-48" vertex="1">
          <mxGeometry y="163" width="215" height="60" as="geometry" />
        </mxCell>
        <mxCell id="tlIEBAkVMEHic_1Gy2fF-36" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-48" source="9Dw6ee0XKq7G6TXhmcGK-3" target="tlIEBAkVMEHic_1Gy2fF-35" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-49" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="-651" y="790" width="1233" height="453" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-1" value="&lt;b&gt;traditional server&lt;br&gt;同一时间只处理一个请求&lt;br&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="239.44144144144144" width="215.99099099099098" height="68.54605263157895" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-2" value="&lt;b&gt;Nginx&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="657.8468468468469" width="187.6036036036036" height="68.54605263157895" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-3" value="&lt;b&gt;VS&lt;/b&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d80073;fontColor=#ffffff;strokeColor=#A50040;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="535.6576576576578" y="5.9605263157894735" width="45.873873873873876" height="45.873873873873876" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-4" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="241.90990990990989" y="140.07236842105263" width="34.55855855855855" height="312.92763157894734" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-5" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="336.94594594594594" y="140.07236842105263" width="34.55855855855855" height="312.92763157894734" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-6" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="424.5765765765766" y="134.11184210526315" width="34.55855855855855" height="312.92763157894734" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-7" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="729.4324324324324" y="96.85855263157895" width="34.55855855855855" height="96.85855263157895" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-56" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-49" source="7tuyBMnh53eZHOQNJwQC-8" target="7tuyBMnh53eZHOQNJwQC-54" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-8" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="729.4324324324324" y="177.32565789473682" width="34.55855855855855" height="113.25" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-9" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="729.4324324324324" y="266.73355263157896" width="34.55855855855855" height="120.70065789473684" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-11" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="729.4324324324324" y="344.2203947368421" width="34.55855855855855" height="98.34868421052632" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-12" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;process1&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="224.6306306306306" y="95.36842105263158" width="69.1171171171171" height="38.743421052631575" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-13" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;process2&lt;br&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="319.6666666666666" y="95.36842105263158" width="69.1171171171171" height="38.743421052631575" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-14" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;process3&lt;br&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="412.2342342342342" y="95.36842105263158" width="69.1171171171171" height="34.27302631578947" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-15" value="&lt;p style=&quot;line-height: 30%;&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;request1&lt;/font&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#a20025;strokeColor=#6F0000;fontColor=#ffffff;align=left;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="241.90990990990989" y="140.07236842105263" width="34.55855855855855" height="89.4078947368421" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-16" value="&lt;font style=&quot;font-size: 6px;&quot;&gt;request1&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="336.94594594594594" y="223.51973684210526" width="34.55855855855855" height="61.0953947368421" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;fillColor=#008a00;strokeColor=#005700;" parent="2pCcyZzb-pndT4Qp4Zei-49" source="7tuyBMnh53eZHOQNJwQC-17" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="424.01873910705586" y="317.1707181088312" as="targetPoint" />
            <Array as="points">
              <mxPoint x="350.5225225225225" y="315.9078947368421" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-17" value="&lt;font style=&quot;font-size: 6px;&quot;&gt;request2&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#a20025;strokeColor=#6F0000;fontColor=#ffffff;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="241.90990990990989" y="296.5361842105263" width="34.55855855855855" height="20.861842105263158" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-18" value="&lt;font style=&quot;font-size: 6px;&quot;&gt;request2&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="336.94594594594594" y="338.2598684210526" width="34.55855855855855" height="46.19407894736842" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fillColor=#008a00;strokeColor=#005700;" parent="2pCcyZzb-pndT4Qp4Zei-49" source="7tuyBMnh53eZHOQNJwQC-19" target="7tuyBMnh53eZHOQNJwQC-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-19" value="&lt;font style=&quot;font-size: 6px;&quot;&gt;request1&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6a00ff;strokeColor=#3700CC;fontColor=#ffffff;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="424.5765765765766" y="280.14473684210526" width="34.55855855855855" height="20.861842105263158" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-20" value="&lt;font style=&quot;font-size: 6px;&quot;&gt;request2&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6a00ff;strokeColor=#3700CC;fontColor=#ffffff;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="424.5765765765766" y="317.3980263157895" width="34.55855855855855" height="20.861842105263158" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0.015;entryY=0.217;entryDx=0;entryDy=0;entryPerimeter=0;fillColor=#008a00;strokeColor=#005700;" parent="2pCcyZzb-pndT4Qp4Zei-49" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="276.4684684684684" y="223.51973684210526" as="sourcePoint" />
            <mxPoint x="337.4643243243243" y="224.3691118421055" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0.008;entryY=0.416;entryDx=0;entryDy=0;entryPerimeter=0;fillColor=#008a00;strokeColor=#005700;" parent="2pCcyZzb-pndT4Qp4Zei-49" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="371.50450450450444" y="280.14473684210526" as="sourcePoint" />
            <mxPoint x="424.8530450450448" y="281.053717105263" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=1.011;entryY=0.633;entryDx=0;entryDy=0;entryPerimeter=0;fillColor=#008a00;strokeColor=#005700;" parent="2pCcyZzb-pndT4Qp4Zei-49" source="7tuyBMnh53eZHOQNJwQC-20" target="7tuyBMnh53eZHOQNJwQC-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="411" y="338.2598684210526" />
              <mxPoint x="411" y="338.2598684210526" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.955;entryY=0.781;entryDx=0;entryDy=0;entryPerimeter=0;fillColor=#008a00;strokeColor=#005700;" parent="2pCcyZzb-pndT4Qp4Zei-49" source="7tuyBMnh53eZHOQNJwQC-18" target="7tuyBMnh53eZHOQNJwQC-4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="330.7747747747748" y="384.45394736842104" />
              <mxPoint x="330.7747747747748" y="384.45394736842104" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-35" value="&lt;font style=&quot;font-size: 6px;&quot;&gt;request3&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#a20025;strokeColor=#6F0000;fontColor=#ffffff;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="241.90990990990989" y="384.45394736842104" width="34.55855855855855" height="20.861842105263158" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-39" value="&lt;font style=&quot;font-size: 6px;&quot;&gt;request3&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="336.94594594594594" y="405.3157894736842" width="34.55855855855855" height="13.411184210526315" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-40" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.847;entryDx=0;entryDy=0;entryPerimeter=0;fillColor=#008a00;strokeColor=#005700;" parent="2pCcyZzb-pndT4Qp4Zei-49" source="7tuyBMnh53eZHOQNJwQC-35" target="7tuyBMnh53eZHOQNJwQC-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="306.09009009009003" y="405.3157894736842" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-41" value="&lt;font style=&quot;font-size: 6px;&quot;&gt;request3&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6a00ff;strokeColor=#3700CC;fontColor=#ffffff;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="424.5765765765766" y="418.7269736842105" width="34.55855855855855" height="28.3125" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-42" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=-0.012;entryY=0.909;entryDx=0;entryDy=0;entryPerimeter=0;" parent="2pCcyZzb-pndT4Qp4Zei-49" source="7tuyBMnh53eZHOQNJwQC-39" target="7tuyBMnh53eZHOQNJwQC-6" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="397.4234234234234" y="418.7269736842105" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-44" value="&lt;font style=&quot;font-size: 7px;&quot;&gt;假设每个process(连接)分为3个请求&lt;br&gt;&lt;b&gt;读请求&lt;/b&gt;：读取header首部，从而知晓上游服务器地址&lt;br&gt;&lt;b&gt;读请求&lt;/b&gt;：读取contest_lenth，了解包体长度&lt;br&gt;&lt;b&gt;写请求&lt;/b&gt;：生成响应返回给客户端&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;align=left;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry y="195.20723684210526" width="171.55855855855856" height="138.58223684210526" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-46" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.991;entryY=0.673;entryDx=0;entryDy=0;entryPerimeter=0;curved=1;" parent="2pCcyZzb-pndT4Qp4Zei-49" source="7tuyBMnh53eZHOQNJwQC-17" target="7tuyBMnh53eZHOQNJwQC-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-47" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1.004;entryY=0.87;entryDx=0;entryDy=0;entryPerimeter=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-49" source="7tuyBMnh53eZHOQNJwQC-35" target="7tuyBMnh53eZHOQNJwQC-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-51" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1.001;entryY=0.364;entryDx=0;entryDy=0;entryPerimeter=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="2pCcyZzb-pndT4Qp4Zei-49" source="7tuyBMnh53eZHOQNJwQC-15" target="7tuyBMnh53eZHOQNJwQC-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-53" value="&lt;font style=&quot;font-size: 6px;&quot;&gt;当request1不满足时，进行切换&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="280.1711711711711" y="178.8157894736842" width="51.83783783783784" height="25.332236842105264" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-54" value="&lt;h2 style=&quot;font-size: 6px;&quot; data-end=&quot;93&quot; data-start=&quot;80&quot;&gt;&lt;ol style=&quot;&quot; data-end=&quot;611&quot; data-start=&quot;95&quot;&gt;&lt;li style=&quot;&quot; data-end=&quot;202&quot; data-start=&quot;95&quot;&gt;&lt;p data-end=&quot;130&quot; data-start=&quot;98&quot;&gt;&lt;strong data-end=&quot;128&quot; data-start=&quot;98&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;当前 epoll_wait 返回的 events[]&lt;/font&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ul data-end=&quot;202&quot; data-start=&quot;134&quot;&gt;&lt;li data-end=&quot;172&quot; data-start=&quot;134&quot;&gt;&lt;p data-end=&quot;172&quot; data-start=&quot;136&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;这是内核 &lt;strong data-end=&quot;162&quot; data-start=&quot;141&quot;&gt;ready_list → 用户空间&lt;/strong&gt; 的一次性拷贝。&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;202&quot; data-start=&quot;176&quot;&gt;&lt;p data-end=&quot;202&quot; data-start=&quot;178&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;Nginx 在这次循环中扫描并尝试处理每个事件。&lt;/font&gt;&lt;/p&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li style=&quot;&quot; data-end=&quot;351&quot; data-start=&quot;204&quot;&gt;&lt;p data-end=&quot;226&quot; data-start=&quot;207&quot;&gt;&lt;strong data-end=&quot;224&quot; data-start=&quot;207&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;资源不足时（无法完成处理）&lt;/font&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ul data-end=&quot;351&quot; data-start=&quot;230&quot;&gt;&lt;li data-end=&quot;277&quot; data-start=&quot;230&quot;&gt;&lt;p data-end=&quot;277&quot; data-start=&quot;232&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;Nginx &lt;strong data-end=&quot;260&quot; data-start=&quot;238&quot;&gt;不会保留这个事件在 events[]&lt;/strong&gt;，因为这个数组是一次性缓冲区；&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;351&quot; data-start=&quot;281&quot;&gt;&lt;p data-end=&quot;351&quot; data-start=&quot;283&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;处理失败的 fd 并不会被 &lt;code data-end=&quot;313&quot; data-start=&quot;297&quot;&gt;epoll_ctl(DEL)&lt;/code&gt; 删除，而是 &lt;strong data-end=&quot;339&quot; data-start=&quot;320&quot;&gt;仍然保留在 epoll 红黑树&lt;/strong&gt; 里，等待后续状态变化。&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;li style=&quot;&quot; data-end=&quot;476&quot; data-start=&quot;353&quot;&gt;&lt;p data-end=&quot;375&quot; data-start=&quot;356&quot;&gt;&lt;strong data-end=&quot;373&quot; data-start=&quot;356&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;fd 的状态在内核保持监控&lt;/font&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ul data-end=&quot;476&quot; data-start=&quot;379&quot;&gt;&lt;li data-end=&quot;419&quot; data-start=&quot;379&quot;&gt;&lt;p data-end=&quot;419&quot; data-start=&quot;381&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;由于 fd 仍然注册在 epoll 中，内核继续关注它的 I/O 状态；&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;476&quot; data-start=&quot;423&quot;&gt;&lt;p data-end=&quot;476&quot; data-start=&quot;425&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;当资源恢复、socket 再次可读/可写时，&lt;strong data-end=&quot;475&quot; data-start=&quot;447&quot;&gt;内核重新把这个 fd 挂到 ready_list&lt;/strong&gt;。&lt;/font&gt;&lt;/p&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li style=&quot;&quot; data-end=&quot;611&quot; data-start=&quot;478&quot;&gt;&lt;p style=&quot;&quot; data-end=&quot;501&quot; data-start=&quot;481&quot;&gt;&lt;strong data-end=&quot;499&quot; data-start=&quot;481&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;下一轮 epoll_wait&lt;/font&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ul style=&quot;&quot; data-end=&quot;611&quot; data-start=&quot;505&quot;&gt;&lt;li style=&quot;&quot; data-end=&quot;535&quot; data-start=&quot;505&quot;&gt;&lt;p data-end=&quot;535&quot; data-start=&quot;507&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;Nginx 再次调用 &lt;code data-end=&quot;532&quot; data-start=&quot;518&quot;&gt;epoll_wait()&lt;/code&gt;；&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li style=&quot;&quot; data-end=&quot;592&quot; data-start=&quot;539&quot;&gt;&lt;p data-end=&quot;592&quot; data-start=&quot;541&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;内核检测 ready_list 里又有这个 fd，就会重新把它拷贝到用户态 &lt;code data-end=&quot;589&quot; data-start=&quot;579&quot;&gt;events[]&lt;/code&gt;；&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li style=&quot;&quot; data-end=&quot;611&quot; data-start=&quot;596&quot;&gt;&lt;p style=&quot;&quot; data-end=&quot;611&quot; data-start=&quot;598&quot;&gt;&lt;font style=&quot;font-size: 6px;&quot;&gt;Nginx 重新尝试处理。&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/h2&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;align=left;spacingLeft=0;fillColor=#f8cecc;strokeColor=#b85450;spacingRight=0;spacing=-22;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="816.337925445705" y="123" width="365.74337115072933" height="303.18" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-57" value="&lt;font style=&quot;font-size: 6px;&quot;&gt;一次切换时5微秒，但是当并发连接数变多，切换时间的会指数级提升，进程间消耗会非常可观&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="471.4774774774775" y="195.20723684210526" width="41.96396396396396" height="177.32565789473682" as="geometry" />
        </mxCell>
        <mxCell id="7tuyBMnh53eZHOQNJwQC-58" value="&lt;font style=&quot;font-size: 6px;&quot;&gt;Nginx只有在worker进程时间片到了的情况下会发生，而时间片长度与CPU优先级有关，因此通常nginx优化，会将优先级调高&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="2pCcyZzb-pndT4Qp4Zei-49" vertex="1">
          <mxGeometry x="676.3603603603603" y="158.69901315789474" width="41.96396396396396" height="250.3421052631579" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-50" value="&lt;b&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;阻塞 / 非阻塞&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=#ffffff;labelBackgroundColor=none;fillColor=#0050ef;strokeColor=#001DBC;" parent="1" vertex="1">
          <mxGeometry x="2908" y="1853" width="135" height="60" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-53" value="&lt;b&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;同步 / 异步&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=#ffffff;labelBackgroundColor=none;fillColor=#a20025;strokeColor=#6F0000;" parent="1" vertex="1">
          <mxGeometry x="3336" y="1853" width="135" height="60" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-55" value="&lt;strong data-end=&quot;640&quot; data-start=&quot;613&quot;&gt;阻塞/非阻塞关注“调用时会不会让当前线程睡眠”&lt;br&gt;&lt;/strong&gt;（从而通常触发 CPU 切换）。" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2841" y="1964" width="263" height="75" as="geometry" />
        </mxCell>
        <mxCell id="2pCcyZzb-pndT4Qp4Zei-56" value="&lt;strong data-end=&quot;692&quot; data-start=&quot;661&quot;&gt;同步/异步关注“结果是自己去等&lt;/strong&gt;&lt;div&gt;&lt;strong data-end=&quot;692&quot; data-start=&quot;661&quot;&gt;还是别人完成后通知你”&lt;/strong&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="3299" y="1967" width="204" height="72" as="geometry" />
        </mxCell>
        <mxCell id="ZQGSLkE3Rj219-_GT_hG-1" value="操作系统或者底层的C库提供的方法或者系统调用，调用在这个方法的时候，这个方法可能会导致进程进入Sleep状态，而进入Sleep状态的原因是当前条件不满足的情况下，操作系统主动把当前进程切换成另外一个进程在使用当前CPU。" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="2781" y="2062" width="337" height="82" as="geometry" />
        </mxCell>
        <mxCell id="ZQGSLkE3Rj219-_GT_hG-2" value="非阻塞方法：我们调用该方法永远也不会因为时间片未用完的情况下，把我们的进程主动切换掉。" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="2781" y="2167" width="337" height="82" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-35" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="2688" y="-1006" width="1203.5" height="824" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-17" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-1" target="aTIp0SBcrr1D4VGqHeDJ-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-1" value="&lt;b&gt;&lt;font style=&quot;font-size: 15px&quot;&gt;Nginx&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="aTIp0SBcrr1D4VGqHeDJ-35" vertex="1">
          <mxGeometry x="593.2499999999995" width="140.5" height="53" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-21" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-2" target="aTIp0SBcrr1D4VGqHeDJ-15" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="210.75" y="348" />
              <mxPoint x="663.75" y="348" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-2" value="&lt;p style=&quot;line-height: 130%;&quot;&gt;&lt;b&gt;进入 &lt;code data-end=&quot;310&quot; data-start=&quot;301&quot;&gt;http { }&lt;/code&gt; / &lt;code data-end=&quot;324&quot; data-start=&quot;313&quot;&gt;stream { }&lt;/code&gt; 等上下文时，各模块解析到 &lt;code data-end=&quot;346&quot; data-start=&quot;338&quot;&gt;listen&lt;/code&gt; 指令&lt;/b&gt;&lt;br&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="aTIp0SBcrr1D4VGqHeDJ-35" vertex="1">
          <mxGeometry y="247" width="420.75" height="69" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-22" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-6" target="aTIp0SBcrr1D4VGqHeDJ-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-6" value="&lt;p style=&quot;line-height: 130%;&quot;&gt;为每个监听端口创建一个&lt;b&gt; &lt;code data-end=&quot;387&quot; data-start=&quot;370&quot;&gt;ngx_listening_t&lt;/code&gt;&lt;/b&gt;：&lt;br&gt;填 IP:PORT、协议（TCP/UDP）、参数（&lt;code data-end=&quot;422&quot; data-start=&quot;413&quot;&gt;backlog&lt;/code&gt;、&lt;code data-end=&quot;434&quot; data-start=&quot;423&quot;&gt;reuseport&lt;/code&gt;…）&lt;br&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="aTIp0SBcrr1D4VGqHeDJ-35" vertex="1">
          <mxGeometry x="453.12999999999965" y="247" width="420.75" height="69" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-23" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-7" target="aTIp0SBcrr1D4VGqHeDJ-15" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1057.75" y="349" />
              <mxPoint x="663.75" y="349" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-7" value="&lt;p style=&quot;line-height: 130%;&quot;&gt;&lt;strong data-end=&quot;468&quot; data-start=&quot;437&quot;&gt;把 &lt;code data-end=&quot;455&quot; data-start=&quot;442&quot;&gt;ls-&amp;gt;handler&lt;/code&gt; 设成本模块的入口函数&lt;/strong&gt;。&lt;br&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="aTIp0SBcrr1D4VGqHeDJ-35" vertex="1">
          <mxGeometry x="912.75" y="247" width="290.75" height="69" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-28" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-13" target="aTIp0SBcrr1D4VGqHeDJ-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-13" value="&lt;p style=&quot;line-height: 130%;&quot;&gt;Nginx 打开并 &lt;code data-end=&quot;531&quot; data-start=&quot;514&quot;&gt;bind()/listen()&lt;/code&gt; 这些套接字，&lt;br&gt;把它们纳入事件驱动（epoll/kqueue）&lt;br&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="aTIp0SBcrr1D4VGqHeDJ-35" vertex="1">
          <mxGeometry x="290" y="517.5" width="323" height="69" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-30" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-14" target="aTIp0SBcrr1D4VGqHeDJ-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-14" value="&lt;p style=&quot;line-height: 130%;&quot;&gt;建立“监听 fd → 对应的 &lt;code data-end=&quot;589&quot; data-start=&quot;585&quot;&gt;ls&lt;/code&gt;”的映射&lt;br&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="aTIp0SBcrr1D4VGqHeDJ-35" vertex="1">
          <mxGeometry x="723.75" y="517.5" width="323" height="69" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-24" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-15" target="aTIp0SBcrr1D4VGqHeDJ-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-25" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-15" target="aTIp0SBcrr1D4VGqHeDJ-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-15" value="&lt;p style=&quot;line-height: 130%;&quot;&gt;阶段2：初始化运行阶段（reload/启动）&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;" parent="aTIp0SBcrr1D4VGqHeDJ-35" vertex="1">
          <mxGeometry x="541.5" y="397" width="244" height="45" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-18" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-16" target="aTIp0SBcrr1D4VGqHeDJ-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-19" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-16" target="aTIp0SBcrr1D4VGqHeDJ-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-20" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-16" target="aTIp0SBcrr1D4VGqHeDJ-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-16" value="&lt;p style=&quot;line-height: 130%;&quot;&gt;&lt;b&gt;阶段1：解析配置阶段&lt;/b&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;" parent="aTIp0SBcrr1D4VGqHeDJ-35" vertex="1">
          <mxGeometry x="594.5" y="114" width="138" height="45" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-33" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-26" target="aTIp0SBcrr1D4VGqHeDJ-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-34" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="aTIp0SBcrr1D4VGqHeDJ-35" source="aTIp0SBcrr1D4VGqHeDJ-26" target="aTIp0SBcrr1D4VGqHeDJ-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-26" value="&lt;p style=&quot;line-height: 130%;&quot;&gt;阶段3：事件循环阶段（收新连接）&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;" parent="aTIp0SBcrr1D4VGqHeDJ-35" vertex="1">
          <mxGeometry x="550" y="653" width="244" height="45" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-31" value="&lt;p style=&quot;line-height: 130%;&quot;&gt;某个监听 fd 就绪 → &lt;code data-end=&quot;646&quot; data-start=&quot;636&quot;&gt;accept()&lt;/code&gt; 新 fd → 创建 &lt;b&gt;&lt;code data-end=&quot;678&quot; data-start=&quot;657&quot;&gt;ngx_connection_t *c&lt;/code&gt;，&lt;code data-end=&quot;698&quot; data-start=&quot;679&quot;&gt;c-&amp;gt;listening = ls&lt;/code&gt;&lt;/b&gt;&lt;br&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="aTIp0SBcrr1D4VGqHeDJ-35" vertex="1">
          <mxGeometry x="304" y="755" width="323" height="69" as="geometry" />
        </mxCell>
        <mxCell id="aTIp0SBcrr1D4VGqHeDJ-32" value="&lt;p style=&quot;line-height: 130%;&quot;&gt;&lt;strong data-end=&quot;715&quot; data-start=&quot;707&quot;&gt;直接调用&lt;/strong&gt; &lt;code data-end=&quot;732&quot; data-start=&quot;716&quot;&gt;ls-&amp;gt;handler(c)&lt;/code&gt; 把连接交给对应模块（HTTP/stream…）继续推进状态机。&lt;br&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="aTIp0SBcrr1D4VGqHeDJ-35" vertex="1">
          <mxGeometry x="714" y="755" width="323" height="69" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="hu0hCMJhubJs4NQiXsDg-1" target="hu0hCMJhubJs4NQiXsDg-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-1" value="源码解读" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6a00ff;fontColor=#ffffff;strokeColor=#3700CC;" parent="1" vertex="1">
          <mxGeometry x="5362.5" y="-1006" width="120" height="55" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-6" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=0;" parent="1" source="hu0hCMJhubJs4NQiXsDg-2" target="hu0hCMJhubJs4NQiXsDg-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-7" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="hu0hCMJhubJs4NQiXsDg-2" target="hu0hCMJhubJs4NQiXsDg-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-16" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="hu0hCMJhubJs4NQiXsDg-2" target="hu0hCMJhubJs4NQiXsDg-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-17" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="hu0hCMJhubJs4NQiXsDg-2" target="hu0hCMJhubJs4NQiXsDg-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-4" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="hu0hCMJhubJs4NQiXsDg-2" target="DRZZ042X9pF3NeJ8se2F-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-10" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="hu0hCMJhubJs4NQiXsDg-2" target="DRZZ042X9pF3NeJ8se2F-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-2" value="nginx启动会生成一些对象和数组" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="5238" y="-891" width="369" height="55" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-9" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="hu0hCMJhubJs4NQiXsDg-4" target="hu0hCMJhubJs4NQiXsDg-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-4" value="ngx_event_s" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="4125" y="-772" width="187" height="55" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-11" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="hu0hCMJhubJs4NQiXsDg-5" target="hu0hCMJhubJs4NQiXsDg-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-5" value="ngx_connection_s" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="4587" y="-772" width="187" height="55" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-8" value="&lt;div&gt;typedef struct ngx_event_s ngx_event_t;&lt;br&gt;&lt;br&gt;struct ngx_event_s {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; unsigned&amp;nbsp; active:1;&amp;nbsp; &amp;nbsp;// 已注册在epoll中&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; unsigned&amp;nbsp; ready:1;&amp;nbsp; &amp;nbsp; // 本轮事件已就绪&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; unsigned&amp;nbsp; write:1;&amp;nbsp; &amp;nbsp; // 这是写事件(否则默认读事件)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; unsigned&amp;nbsp; error:1;&amp;nbsp; &amp;nbsp; // 出错/对端关闭&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; void&amp;nbsp; &amp;nbsp; (*handler)(ngx_event_t *ev); // 事件处理入口（状态机）&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; void&amp;nbsp; &amp;nbsp; &amp;nbsp;*data;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// 指回宿主连接 ngx_connection_t*&lt;/div&gt;&lt;div&gt;};&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=15;" parent="1" vertex="1">
          <mxGeometry x="4031.5" y="-678" width="374" height="235" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-10" value="&lt;div&gt;typedef struct ngx_connection_s ngx_connection_t;&lt;br&gt;&lt;br&gt;struct ngx_connection_s {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; int&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;fd;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 套接字&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_event_t&amp;nbsp; *read;&amp;nbsp; &amp;nbsp; &amp;nbsp; // 指向读事件对象（在read_events[]里）&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_event_t&amp;nbsp; *write;&amp;nbsp; &amp;nbsp; &amp;nbsp;// 指向写事件对象（在write_events[]里）&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; // 业务缓存、请求上下文等...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; char&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; rbuf[8192];&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; int&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;rbuf_used;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; char&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; wbuf[8192];&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; int&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;wbuf_used;&lt;/div&gt;&lt;div&gt;};&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=15;" parent="1" vertex="1">
          <mxGeometry x="4491" y="-675.5" width="379" height="230" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-14" value="// 连接池（长期存在）&lt;br&gt;static ngx_connection_t connections[WORKER_CONNECTIONS];&lt;br&gt;// 空闲连接&lt;br&gt;static int free_idx_stack[WORKER_CONNECTIONS];" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=15;" parent="1" vertex="1">
          <mxGeometry x="4965" y="-771" width="395" height="115" as="geometry" />
        </mxCell>
        <mxCell id="hu0hCMJhubJs4NQiXsDg-15" value="&lt;div style=&quot;line-height: 140%;&quot;&gt;// 读事件数组（长期存在）&lt;br&gt;static ngx_event_t&amp;nbsp; &amp;nbsp; &amp;nbsp; read_events[WORKER_CONNECTIONS];&lt;br&gt;// 写事件数组（长期存在）&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;line-height: 140%;&quot;&gt;static ngx_event_t&amp;nbsp; &amp;nbsp; &amp;nbsp; write_events[WORKER_CONNECTIONS];&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=15;spacing=5;" parent="1" vertex="1">
          <mxGeometry x="5461" y="-769" width="396" height="111" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-6" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="DRZZ042X9pF3NeJ8se2F-1" target="DRZZ042X9pF3NeJ8se2F-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-1" value="&lt;div style=&quot;line-height: 140%;&quot;&gt;// 将listen_fd和ngx_event_t关联&lt;br&gt;static ngx_listening_t ls;&lt;br&gt;// 写事件数组（长期存在）&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;line-height: 140%;&quot;&gt;static ngx_event_t ls_read_ev&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=15;spacing=5;" parent="1" vertex="1">
          <mxGeometry x="5926" y="-769" width="244" height="111" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-5" value="&lt;div&gt;int start_listen_and_register(short port) {&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;int fd = socket(AF_INET, SOCK_STREAM, 0);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre; white-space: normal;&quot;&gt;&#x9;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;int on = 1;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;setsockopt(fd, SOL_SOCKET, SO_REUSEADDR, &amp;amp;on, sizeof(on));&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre; white-space: normal;&quot;&gt;&#x9;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;struct sockaddr_in sa; memset(&amp;amp;sa, 0, sizeof(sa));&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; sa.sin_family = AF_INET; sa.sin_port = htons(port); sa.sin_addr.s_addr = htonl(INADDR_ANY);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; bind(fd, (struct sockaddr*)&amp;amp;sa, sizeof(sa));&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; listen(fd, 1024);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; set_nonblock(fd);&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre; white-space: normal;&quot;&gt;&#x9;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;static ngx_event_t ls_read_ev;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;static ngx_listening_t ls;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre; white-space: normal;&quot;&gt;&#x9;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;ls.fd = fd;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre; white-space: normal;&quot;&gt;&#x9;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;ls.read = &amp;amp;ls_read_ev;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre; white-space: normal;&quot;&gt;&#x9;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;ls_read_ev.write = 0;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;ls_read_ev.active = 0;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;ls_read_ev.handler = /*ngx_event_accept*/&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;ls_read_ev.data = &amp;amp;ls&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre; white-space: normal;&quot;&gt;&#x9;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;if (ngx_epoll_add_listen_event(ls.read,ls.fd) != 0) return -1;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre; white-space: normal;&quot;&gt;&#x9;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: normal;&quot;&gt;&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;return fd;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=15;" parent="1" vertex="1">
          <mxGeometry x="5772" y="-614.75" width="552" height="343" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-9" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="DRZZ042X9pF3NeJ8se2F-7" target="DRZZ042X9pF3NeJ8se2F-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-7" value="&lt;div style=&quot;line-height: 140%;&quot;&gt;// epoll_wait()将ready_list[]数组中的就绪事件填到event_list[]&lt;br&gt;struct epoll_event event_list[NEVENT_PRE_LOOP];&lt;br&gt;//&amp;nbsp;&lt;span style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;int n = epoll_wait(epfd, event_list, NEVENTS_PER_LOOP, &lt;/span&gt;&lt;span style=&quot;font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; background-color: rgb(23, 178, 224);&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;*timeout ms*/&lt;/span&gt;&lt;span style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; background-color: rgb(23, 178, 224);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;000&lt;/span&gt;&lt;span style=&quot;font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; background-color: rgb(191, 9, 29);&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;background-color: rgba(0, 0, 0, 0); color: rgb(235, 235, 235); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=15;spacing=5;" parent="1" vertex="1">
          <mxGeometry x="6354" y="-769" width="549" height="98" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-8" value="&lt;div&gt;for (int i = 0; i &amp;lt; n; ++i) { /* E: &#39;n&#39; undeclared (first use in this function)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;ngx_event_t *ev = (ngx_event_t*) event_list[i].data.ptr; &lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // ★ 拿回注册时塞进去的事件对象指针&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;uint32_t&amp;nbsp; &amp;nbsp; &amp;nbsp;ee = event_list[i].events;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// 标记错误/挂断&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;if (ee &amp;amp; (EPOLLERR | EPOLLHUP)) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;ev-&amp;gt;error = 1;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;}&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;ev-&amp;gt;ready = 1; // 本轮就绪&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;ev-&amp;gt;handler(ev); // ★ 进入该事件的状态机入口（读或写）&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;ev-&amp;gt;ready = 0;&amp;nbsp; &amp;nbsp;// 处理完清标志（实际Nginx里会更细致）&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;}&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=15;" parent="1" vertex="1">
          <mxGeometry x="6401.5" y="-614.75" width="454" height="302" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-49" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="3852" y="107" width="2945.68" height="865" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-13" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-11" target="DRZZ042X9pF3NeJ8se2F-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-11" value="&lt;b&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Nginx完整流程&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=#ffffff;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="1493.101291005291" width="210.40571428571428" height="99.74774774774775" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-43" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-12" target="DRZZ042X9pF3NeJ8se2F-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-44" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-12" target="DRZZ042X9pF3NeJ8se2F-36" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-45" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-12" target="DRZZ042X9pF3NeJ8se2F-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-46" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-12" target="DRZZ042X9pF3NeJ8se2F-23" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1597.5248677248676" y="370.93693693693695" />
              <mxPoint x="478.47817989417985" y="370.93693693693695" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-47" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-12" target="DRZZ042X9pF3NeJ8se2F-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-48" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-12" target="DRZZ042X9pF3NeJ8se2F-38" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-12" value="&lt;b&gt;&lt;font style=&quot;font-size: 19px;&quot;&gt;Nginx启动初始化&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=#ffffff;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="1493.101291005291" y="201.05405405405406" width="210.40571428571428" height="99.74774774774775" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-17" value="Nginx的连接池&lt;br&gt;ngx_connection_t connections[ ]" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry y="606.2792792792793" width="321.06353439153435" height="90.3963963963964" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-19" value="读事件数组&lt;br&gt;ngx_event_t read[]" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="375.613164021164" y="606.2792792792793" width="207.28859259259258" height="90.3963963963964" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-20" value="写事件数组&lt;br&gt;ngx_event_t write[]" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="632.7757037037037" y="606.2792792792793" width="207.28859259259258" height="90.3963963963964" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-24" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-23" target="DRZZ042X9pF3NeJ8se2F-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-25" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-23" target="DRZZ042X9pF3NeJ8se2F-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-26" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-23" target="DRZZ042X9pF3NeJ8se2F-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-23" value="&lt;b&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;初始化阶段进行关联&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="375.613164021164" y="451.981981981982" width="207.28859259259258" height="85.72072072072072" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-29" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-27" target="DRZZ042X9pF3NeJ8se2F-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-27" value="&lt;b&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;创建epoll实例&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="940.5914708994709" y="442.63063063063066" width="207.28859259259258" height="85.72072072072072" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-28" value="epfd = epoll_create1(0);" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="919.5508994708994" y="606.2792792792793" width="249.36973544973543" height="90.3963963963964" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-32" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-30" target="DRZZ042X9pF3NeJ8se2F-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-30" value="&lt;b&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;创建listen_fd&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="1312.3082328042328" y="442.63063063063066" width="207.28859259259258" height="85.72072072072072" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-34" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-31" target="DRZZ042X9pF3NeJ8se2F-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-35" value="" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-31" target="DRZZ042X9pF3NeJ8se2F-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-31" value="通过ngx_listening_t;&lt;br&gt;将listen_fd和ngx_event_t关联" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="1260.0964444444444" y="606.2792792792793" width="311.7121693121693" height="90.3963963963964" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-33" value="ngx_event_t内注册了ngx_event_accept，&lt;br&gt;用于根据tcp连接对象生成client_fd,&lt;br&gt;并将其加入红黑树节点" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="1235.1594708994708" y="763.6936936936937" width="361.5861164021164" height="90.3963963963964" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-36" value="&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;b&gt;epoll_ctl()&amp;nbsp;&lt;br&gt;&lt;/b&gt;将活跃事件指向ready_list链表&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="1675.45291005291" y="442.63063063063066" width="243.13549206349205" height="85.72072072072072" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-37" value="&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;b&gt;epoll_wait()&amp;nbsp;&lt;br&gt;&lt;/b&gt;将ready_list链表中的对象填到event_list[]中&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="2010.543492063492" y="442.63063063063066" width="380.28884656084654" height="85.72072072072072" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-41" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-38" target="DRZZ042X9pF3NeJ8se2F-39" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-38" value="&lt;b style=&quot;font-size: 13px;&quot;&gt;nginx遍历event_list[]中的对象，&lt;br&gt;并进入相应状态机入口，后续进行处理&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="2451.6162116402115" y="442.63063063063066" width="380.28884656084654" height="85.72072072072072" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-42" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="DRZZ042X9pF3NeJ8se2F-49" source="DRZZ042X9pF3NeJ8se2F-39" target="DRZZ042X9pF3NeJ8se2F-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-39" value="listen_fd的事件&lt;br&gt;是ngx_event_accept&lt;br&gt;用于调用accept生成client_fd" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="2499.152317460317" y="610.9549549549549" width="285.21663492063493" height="85.72072072072072" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-40" value="client_fd&lt;br&gt;根据配置文件，它对应的handler可能是http状态机入口，或其他状态机入口" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-49" vertex="1">
          <mxGeometry x="2337.84126984127" y="779.2792792792793" width="607.8387301587301" height="85.72072072072072" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-140" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="3822" y="1706" width="3141" height="879" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-92" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-85" target="DRZZ042X9pF3NeJ8se2F-87" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-85" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;状态机&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d80073;strokeColor=#A50040;fontColor=#ffffff;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="319.5" width="177" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-93" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-86" target="DRZZ042X9pF3NeJ8se2F-87" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-86" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;当前处于某种&lt;font color=&quot;#cc0000&quot;&gt;状态1&lt;/font&gt;&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry y="127" width="177" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-94" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-87" target="DRZZ042X9pF3NeJ8se2F-88" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-87" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;某个&lt;font color=&quot;#cc0000&quot;&gt;事件&lt;/font&gt;导致状态改变的触发条件&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="268" y="127" width="280" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-95" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-88" target="DRZZ042X9pF3NeJ8se2F-89" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-88" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;条件触发后，进行&lt;font color=&quot;#cc0000&quot;&gt;动作&lt;/font&gt;使其进入新的状态2&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="609" y="127" width="322" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-96" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-89" target="DRZZ042X9pF3NeJ8se2F-90" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-89" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;当前处于某种&lt;font color=&quot;#cc0000&quot;&gt;状态2&lt;/font&gt;&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="7" y="242" width="177" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-97" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-90" target="DRZZ042X9pF3NeJ8se2F-91" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-90" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;某个&lt;font color=&quot;#cc0000&quot;&gt;事件&lt;/font&gt;导致状态改变的触发条件&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="268" y="242" width="280" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-91" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;条件触发后，进行&lt;font color=&quot;#cc0000&quot;&gt;动作&lt;/font&gt;使其进入新的 状态3&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="609" y="242" width="322" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-103" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-99" target="DRZZ042X9pF3NeJ8se2F-101" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-99" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;状态机代码演示&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d80073;strokeColor=#A50040;fontColor=#ffffff;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="1352" y="9" width="177" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-101" value="&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;class HTTPStateMachine:&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; def __init__(self):&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.state = &quot;WAIT_REQUEST&quot;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; def handle_event(self, event):&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if self.state == &quot;WAIT_REQUEST&quot;:&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if event == &quot;RequestReceived&quot;:&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print(&quot;Request received, transitioning to PARSE_HEADERS&quot;)&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.state = &quot;PARSE_HEADERS&quot;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; elif self.state == &quot;PARSE_HEADERS&quot;:&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if event == &quot;HeadersParsed&quot;:&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print(&quot;Headers parsed, transitioning to PROCESS_BODY&quot;)&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.state = &quot;PROCESS_BODY&quot;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; elif self.state == &quot;PROCESS_BODY&quot;:&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if event == &quot;BodyProcessed&quot;:&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print(&quot;Body processed, transitioning to SEND_RESPONSE&quot;)&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.state = &quot;SEND_RESPONSE&quot;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; elif self.state == &quot;SEND_RESPONSE&quot;:&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if event == &quot;ResponseSent&quot;:&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print(&quot;Response sent, transitioning to DONE&quot;)&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.state = &quot;DONE&quot;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; elif self.state == &quot;DONE&quot;:&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print(&quot;Request handling completed.&quot;)&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; else:&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print(f&quot;Unknown state: {self.state}&quot;)&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;# 示例流程&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;fsm = HTTPStateMachine()&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;# 模拟事件触发&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;fsm.handle_event(&quot;RequestReceived&quot;)&amp;nbsp; # WAIT_REQUEST -&amp;gt; PARSE_HEADERS&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;fsm.handle_event(&quot;HeadersParsed&quot;)&amp;nbsp; &amp;nbsp; # PARSE_HEADERS -&amp;gt; PROCESS_BODY&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;fsm.handle_event(&quot;BodyProcessed&quot;)&amp;nbsp; &amp;nbsp; # PROCESS_BODY -&amp;gt; SEND_RESPONSE&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;fsm.handle_event(&quot;ResponseSent&quot;)&amp;nbsp; &amp;nbsp; &amp;nbsp;# SEND_RESPONSE -&amp;gt; DONE&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=30;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="1102" y="132" width="677" height="747" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-139" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-104" target="DRZZ042X9pF3NeJ8se2F-107" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-104" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;http状态机&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d80073;strokeColor=#A50040;fontColor=#ffffff;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2511.5" width="177" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-109" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#d6b656;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#fff2cc;strokeWidth=2;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-105" target="DRZZ042X9pF3NeJ8se2F-107" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-105" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;初始状态：WAIT_REQUEST&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2064" y="160" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-110" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#d6b656;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#fff2cc;strokeWidth=2;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-107" target="DRZZ042X9pF3NeJ8se2F-108" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-107" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;动作：&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;white-space-collapse: preserve; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; text-align: left;&quot;&gt;接收请求行并保存&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2471" y="160" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-118" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d6b656;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#fff2cc;strokeWidth=2;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-108" target="DRZZ042X9pF3NeJ8se2F-111" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-108" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;事件：&lt;/b&gt;&lt;/span&gt;&lt;strong style=&quot;box-sizing: border-box; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left; white-space-collapse: preserve;&quot;&gt;RequestReceived&lt;/strong&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&lt;br&gt;(&amp;nbsp;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left; white-space-collapse: preserve;&quot;&gt;接收到 HTTP 请求行&lt;/span&gt;&lt;span style=&quot;white-space-collapse: preserve; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2870" y="160" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-113" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#ffe6cc;strokeWidth=2;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-111" target="DRZZ042X9pF3NeJ8se2F-112" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-111" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;状态：&lt;/b&gt;&lt;/span&gt;&lt;strong style=&quot;box-sizing: border-box; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left; white-space-collapse: preserve;&quot;&gt;PARSE_HEADERS&lt;/strong&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2064" y="286" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-117" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#ffe6cc;strokeWidth=2;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-112" target="DRZZ042X9pF3NeJ8se2F-115" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-112" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;动作：&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;white-space-collapse: preserve; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; text-align: left;&quot;&gt;验证并解析请求头&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2471" y="286" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-124" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#ffe6cc;strokeWidth=2;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-115" target="DRZZ042X9pF3NeJ8se2F-119" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-115" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;事件：&lt;/b&gt;&lt;/span&gt;&lt;strong style=&quot;box-sizing: border-box; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left; white-space-collapse: preserve;&quot;&gt;HeadersParsed&lt;/strong&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&lt;br&gt;(&amp;nbsp;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left; white-space-collapse: preserve;&quot;&gt;解析请求头完成&lt;/span&gt;&lt;span style=&quot;white-space-collapse: preserve; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left;&quot;&gt;行&lt;/span&gt;&lt;span style=&quot;white-space-collapse: preserve; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2878" y="286" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-122" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#b85450;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#f8cecc;strokeWidth=2;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-119" target="DRZZ042X9pF3NeJ8se2F-120" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-119" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;状态：&lt;/b&gt;&lt;/span&gt;&lt;strong style=&quot;box-sizing: border-box; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left; white-space-collapse: preserve;&quot;&gt;PROCESS_BODY&lt;/strong&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2069" y="417" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-123" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#b85450;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#f8cecc;strokeWidth=2;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-120" target="DRZZ042X9pF3NeJ8se2F-121" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-120" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;动作：&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; text-align: left; white-space-collapse: preserve;&quot;&gt;处理请求体并准备响应&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2471" y="417" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-132" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#b85450;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#f8cecc;strokeWidth=2;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-121" target="DRZZ042X9pF3NeJ8se2F-125" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-121" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;事件：&lt;/b&gt;&lt;/span&gt;&lt;strong style=&quot;box-sizing: border-box; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left; white-space-collapse: preserve;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;md-plain&quot;&gt;BodyProcessed&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&lt;br&gt;(&amp;nbsp;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left; white-space-collapse: preserve;&quot;&gt;请求体处理完成&lt;/span&gt;&lt;span style=&quot;white-space-collapse: preserve; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2878" y="417" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-133" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#9673a6;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;strokeWidth=2;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-125" target="DRZZ042X9pF3NeJ8se2F-129" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-125" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;状态：&lt;/b&gt;&lt;/span&gt;&lt;strong style=&quot;box-sizing: border-box; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left; white-space-collapse: preserve;&quot;&gt;SEND_RESPONSE&lt;/strong&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2064" y="564" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-134" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#9673a6;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;strokeWidth=2;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-129" target="DRZZ042X9pF3NeJ8se2F-131" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-129" value="&lt;div style=&quot;text-align: left;&quot;&gt;&lt;b style=&quot;font-size: 16px; background-color: initial;&quot;&gt;动作：&lt;/b&gt;&lt;span style=&quot;font-size: 16px; background-color: initial;&quot;&gt;发送响应&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2471" y="564" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-136" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;strokeWidth=2;" parent="DRZZ042X9pF3NeJ8se2F-140" source="DRZZ042X9pF3NeJ8se2F-131" target="DRZZ042X9pF3NeJ8se2F-135" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-131" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;事件：&lt;/b&gt;&lt;/span&gt;&lt;strong style=&quot;box-sizing: border-box; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left; white-space-collapse: preserve;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;md-plain&quot;&gt;BodyProcessed&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;&lt;br&gt;(&amp;nbsp;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left; white-space-collapse: preserve;&quot;&gt;响应发送完成&lt;/span&gt;&lt;span style=&quot;white-space-collapse: preserve; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2883" y="564" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-135" value="&lt;span style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;状态：&lt;/b&gt;&lt;/span&gt;&lt;strong style=&quot;box-sizing: border-box; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 16px; orphans: 1; text-align: left; white-space-collapse: preserve;&quot;&gt;DONE&lt;br/&gt;( 完成请求处理)&lt;/strong&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="DRZZ042X9pF3NeJ8se2F-140" vertex="1">
          <mxGeometry x="2064" y="703" width="258" height="69" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-152" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="DRZZ042X9pF3NeJ8se2F-147" target="DRZZ042X9pF3NeJ8se2F-149" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-157" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="DRZZ042X9pF3NeJ8se2F-147" target="DRZZ042X9pF3NeJ8se2F-156" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-147" value="&lt;b style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;ngx_event_t&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-1109" y="2289" width="125" height="29" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-149" value="&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;struct ngx_event_s {&lt;/span&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; void&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; *data;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; unsigned&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;instance:l;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; unsigned&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;timedout:l;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; unsigned&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;timer_set:l;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; unsigned&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;available:l;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_event_handler_pt&amp;nbsp; &amp;nbsp; handler;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_uint_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;index;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_log_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; *log;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_rbtree_node_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;timer;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_queue_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; queue;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ......&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;};&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="-1288" y="2366" width="246" height="222" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-156" value="&lt;b&gt;96字节大小&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="-1000" y="2371" width="118" height="52" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-158" value="&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;struct ngx_connection_s {&lt;/span&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; void&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; *data;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_event_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;*read;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_event_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;*write;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_socket_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;fd;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_recv_pt&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;recv;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_send_pt&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; send;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; off_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; send; // byte_sent变量&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_log_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;*log;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_pool_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;*pool;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; int&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;type;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; strcut sockaddr&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; *sockaddr;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; socklen_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;socklen;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_str_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; addr_text;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_str_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; proxy_protocol_addr&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_port_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; proxy_protocol_port;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_buf_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;*buffer;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ngx_queue_t&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; queue;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;};&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="-1754" y="2366" width="288" height="306" as="geometry" />
        </mxCell>
        <mxCell id="DRZZ042X9pF3NeJ8se2F-159" value="&lt;b&gt;232字节大小&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="-1436" y="2366" width="118" height="52" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-8" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;HTTP模块处理用户请求&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="5478" y="2899" width="260" height="71" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="b0SIwih08a3Fdy_9vTAJ-9" target="b0SIwih08a3Fdy_9vTAJ-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="b0SIwih08a3Fdy_9vTAJ-9" target="b0SIwih08a3Fdy_9vTAJ-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-9" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;Nginx框架对客户端建立好连接&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="5014.5" y="2899" width="304" height="71" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="b0SIwih08a3Fdy_9vTAJ-11" target="b0SIwih08a3Fdy_9vTAJ-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-11" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;先接收HTTP发来的Line(方法，URL等)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="4982" y="3040.5" width="370" height="71" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="b0SIwih08a3Fdy_9vTAJ-13" target="b0SIwih08a3Fdy_9vTAJ-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-13" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;接收所有Header&lt;br&gt;根据Header信息决定选择哪些配重块&lt;br&gt;决定让Http模块怎样处理请求&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="5423" y="3031" width="370" height="90" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" source="SBsURusUmZdSX8FJDAMt-2" target="SBsURusUmZdSX8FJDAMt-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-2" value="&lt;font style=&quot;font-size: 15px;&quot;&gt;建立三次握手&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="3711" y="3479" width="153" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="SBsURusUmZdSX8FJDAMt-3" target="SBsURusUmZdSX8FJDAMt-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-34" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" source="SBsURusUmZdSX8FJDAMt-3" target="SBsURusUmZdSX8FJDAMt-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-3" value="&lt;font style=&quot;font-size: 15px;&quot;&gt;连接对象进入accept队列&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="3927" y="3479" width="217" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" source="SBsURusUmZdSX8FJDAMt-5" target="SBsURusUmZdSX8FJDAMt-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-5" value="&lt;p style=&quot;line-height: 150%;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;listen_fd在数据到来后，触发&lt;b&gt;ep_poll_callback&lt;/b&gt;&lt;br&gt;将epoll_item入队到ready_list，并唤醒&lt;b&gt;epoll_wait()&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="4207" y="3479" width="418" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" source="SBsURusUmZdSX8FJDAMt-7" target="SBsURusUmZdSX8FJDAMt-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-7" value="&lt;p style=&quot;line-height: 150%;&quot;&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;epoll_wait()将ready_list的事件（&lt;b&gt;epoll_event&lt;/b&gt;）填入&lt;b&gt;event_list[ ]&lt;/b&gt;(用户态)&lt;/span&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="4688" y="3479" width="508" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" source="SBsURusUmZdSX8FJDAMt-9" target="SBsURusUmZdSX8FJDAMt-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-9" value="&lt;p style=&quot;line-height: 150%;&quot;&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;nginx遍历event_list[]，accept处理器生成&lt;b&gt;client_fd&lt;/b&gt;，并为其绑定ngx_connection_t，&lt;br&gt;并进行协议初始化，在协议初始化过程中（ngx_http_init_conneciton）分配连接内存池（&lt;b&gt;connection_pool_size 512&lt;/b&gt;）&lt;/span&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="5252" y="3479" width="802" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-14" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;curved=0;" parent="1" source="SBsURusUmZdSX8FJDAMt-11" target="SBsURusUmZdSX8FJDAMt-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-11" value="&lt;p style=&quot;line-height: 150%;&quot;&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;调用epoll_ctl()将client_fd绑定的事件加入rbtree，&lt;br&gt;并添加超时定时器（&lt;b&gt;client_header_timeout 60s&lt;/b&gt;）&lt;/span&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="6110" y="3479" width="468" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" source="SBsURusUmZdSX8FJDAMt-13" target="SBsURusUmZdSX8FJDAMt-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-13" value="&lt;font style=&quot;font-size: 15px;&quot;&gt;http请求数据收到后，&lt;br&gt;&lt;b&gt;client_fd就绪&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="3682.5" y="3646" width="210" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" source="SBsURusUmZdSX8FJDAMt-15" target="SBsURusUmZdSX8FJDAMt-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-15" value="&lt;span style=&quot;font-size: 15px;&quot;&gt;触发&lt;/span&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;ep_poll_callback&lt;/b&gt;&lt;br style=&quot;font-size: 15px;&quot;&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;将epoll_item入队到ready_list，并唤醒&lt;/span&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;epoll_wait()&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="3967" y="3646" width="396" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" source="SBsURusUmZdSX8FJDAMt-17" target="SBsURusUmZdSX8FJDAMt-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-17" value="&lt;span style=&quot;font-size: 15px;&quot;&gt;epoll_wait()将ready_list的事件（&lt;/span&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;epoll_event&lt;/b&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;）填入&lt;/span&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;event_list[ ]&lt;/b&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;(用户态)&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="4437" y="3646" width="597" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" source="SBsURusUmZdSX8FJDAMt-19" target="SBsURusUmZdSX8FJDAMt-21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-19" value="&lt;span style=&quot;font-size: 15px;&quot;&gt;epoll_wait()将ready_list的事件（&lt;/span&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;epoll_event&lt;/b&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;）填入&lt;/span&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;event_list[ ]&lt;/b&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;(用户态)&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="5104" y="3646" width="597" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" source="SBsURusUmZdSX8FJDAMt-21" target="SBsURusUmZdSX8FJDAMt-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-21" value="&lt;span style=&quot;font-size: 15px;&quot;&gt;epoll_wait()将ready_list的事件（&lt;/span&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;epoll_event&lt;/b&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;）填入&lt;/span&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;event_list[ ]&lt;/b&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;(用户态)&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="5792" y="3646" width="597" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-26" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;curved=0;" parent="1" source="SBsURusUmZdSX8FJDAMt-23" target="SBsURusUmZdSX8FJDAMt-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-23" value="&lt;span style=&quot;font-size: 15px;&quot;&gt;遍历event_list[]处理里面的事件，进入ngx_http_wait_request_handler()&lt;br&gt;创建&lt;b&gt; r -&amp;gt; pool（默认4K，request_pool_size 4k;）&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="6480" y="3646" width="597" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" source="SBsURusUmZdSX8FJDAMt-25" target="SBsURusUmZdSX8FJDAMt-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-25" value="&lt;span style=&quot;font-size: 15px;&quot;&gt;在创建好r-&amp;gt;pool之后，http数据头部会先读到c-&amp;gt;buff，不够用的时候，才会从r-&amp;gt;pool申请更大的内存，并将c-&amp;gt;pool中的数据复制过去&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="3648" y="3807" width="456" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-27" value="&lt;span style=&quot;font-size: 15px;&quot;&gt;读取到http头部的line信息和header信息后，&lt;b&gt;开始11个阶段的http请求处理&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="4210" y="3807" width="529" height="67" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-37" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fillColor=#0050ef;strokeColor=#001DBC;strokeWidth=2;curved=0;" parent="1" source="SBsURusUmZdSX8FJDAMt-35" target="SBsURusUmZdSX8FJDAMt-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-35" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 18px;&quot;&gt;nginx处理连接请求全过程&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="4912" y="3312" width="270" height="84" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-40" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=0;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;" parent="1" source="SBsURusUmZdSX8FJDAMt-39" target="SBsURusUmZdSX8FJDAMt-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-39" value="Nginx维护一个定时器红黑树，独立于epoll的rbtree，&lt;br&gt;而是通过ngx_event_t 间接关联起来" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="6399" y="3323" width="320" height="90" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-57" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="SBsURusUmZdSX8FJDAMt-41" target="SBsURusUmZdSX8FJDAMt-53" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-41" value="&lt;b&gt;connection_pool_size 512&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1158" y="2371" width="166" height="33" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-59" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="SBsURusUmZdSX8FJDAMt-42" target="SBsURusUmZdSX8FJDAMt-56" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-42" value="&lt;b&gt;request_pool_size 4k&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1631" y="2371" width="166" height="33" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-58" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="SBsURusUmZdSX8FJDAMt-43" target="SBsURusUmZdSX8FJDAMt-54" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-43" value="&lt;b&gt;client_header_buffer_size 1-4K&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1395" y="2371" width="180" height="33" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-48" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="SBsURusUmZdSX8FJDAMt-44" target="SBsURusUmZdSX8FJDAMt-45" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-44" value="&lt;b&gt;large_client_header_buffers 4 8k&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1981.5" y="2371" width="216" height="33" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-45" value="当请求头&lt;strong data-end=&quot;140&quot; data-start=&quot;133&quot;&gt;装不下&lt;/strong&gt;连接级小缓冲（&lt;code data-end=&quot;174&quot; data-start=&quot;147&quot;&gt;client_header_buffer_size&lt;/code&gt;）时，&lt;br&gt;从 &lt;strong data-end=&quot;192&quot; data-start=&quot;179&quot;&gt;&lt;code data-end=&quot;190&quot; data-start=&quot;181&quot;&gt;r-&amp;gt;pool&lt;/code&gt;&lt;/strong&gt; 里再申请 &lt;strong data-end=&quot;213&quot; data-start=&quot;198&quot;&gt;N 个、每个 S 大小&lt;/strong&gt;的&lt;strong data-end=&quot;223&quot; data-start=&quot;214&quot;&gt;大头部缓冲&lt;/strong&gt;用于继续接收/解析请求头。" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1860.5" y="2445" width="458" height="73" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-53" value="&lt;b&gt;初始的分配的连接内存池大小&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1152.5" y="2449" width="177" height="39" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-54" value="&lt;b&gt;连接内存池最多存放多大数据&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1396.5" y="2449" width="177" height="39" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-56" value="&lt;b&gt;初始分配的请求内存池大小&lt;br&gt;(连接内存池放不下，会复制到请求内存池)&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1589.75" y="2449" width="248.5" height="39" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-61" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="SBsURusUmZdSX8FJDAMt-60" target="SBsURusUmZdSX8FJDAMt-35" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-60" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 18px;&quot;&gt;Nginx核心框架进行处理&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="5311" y="3312" width="270" height="84" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-3" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#f8cecc;strokeColor=#b85450;curved=0;" parent="1" source="b0SIwih08a3Fdy_9vTAJ-1" target="b0SIwih08a3Fdy_9vTAJ-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-1" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 18px;&quot;&gt;HTTP模块详解&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d80073;strokeColor=#A50040;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="10747" y="-1334.25" width="375" height="84" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" source="b0SIwih08a3Fdy_9vTAJ-2" target="b0SIwih08a3Fdy_9vTAJ-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-63" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#b85450;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#f8cecc;" parent="1" source="b0SIwih08a3Fdy_9vTAJ-2" target="SBsURusUmZdSX8FJDAMt-62" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-2" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;Listen&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="8212.5" y="-1094.25" width="178" height="71" as="geometry" />
        </mxCell>
        <mxCell id="b0SIwih08a3Fdy_9vTAJ-5" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;b style=&quot;&quot;&gt;Syntax&lt;/b&gt;:&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;listen address[:port] [default_server] [ssl] [http2 | quic] [proxy_protocol] [setfib=number] [fastopen=number] [backlog=number] [rcvbuf=size] [sndbuf=size] [accept_filter=filter] [deferred] [bind] [ipv6only=on|off] [reuseport] [so_keepalive=on|off|[keepidle]:[keepintvl]:[keepcnt]];&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;listen port [default_server] [ssl] [http2 | quic] [proxy_protocol] [setfib=number] [fastopen=number] [backlog=number] [rcvbuf=size] [sndbuf=size] [accept_filter=filter] [deferred] [bind] [ipv6only=on|off] [reuseport] [so_keepalive=on|off|[keepidle]:[keepintvl]:[keepcnt]];&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;listen unix:path [default_server] [ssl] [http2 | quic] [proxy_protocol] [backlog=number] [rcvbuf=size] [sndbuf=size] [accept_filter=filter] [deferred] [bind] [so_keepalive=on|off|[keepidle]:[keepintvl]:[keepcnt]];&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Default&lt;/b&gt;:&lt;span style=&quot;white-space:pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;listen *:80 | *:8000;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;b style=&quot;&quot;&gt;Context&lt;/b&gt;:&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;server&amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="8024" y="-966.25" width="555" height="370" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-67" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#b85450;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#f8cecc;strokeWidth=2;" parent="1" source="SBsURusUmZdSX8FJDAMt-62" target="SBsURusUmZdSX8FJDAMt-64" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-117" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#b85450;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#f8cecc;" parent="1" source="SBsURusUmZdSX8FJDAMt-62" target="SBsURusUmZdSX8FJDAMt-116" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-62" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;Server&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="10104.5" y="-1092.25" width="178" height="71" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-66" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-64" target="SBsURusUmZdSX8FJDAMt-65" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-70" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#b85450;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#f8cecc;" parent="1" source="SBsURusUmZdSX8FJDAMt-64" target="SBsURusUmZdSX8FJDAMt-68" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-64" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;server_name 指令&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="10086.5" y="-964.25" width="214" height="71" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-65" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;决定哪个server块指令被使用&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="10413.66" y="-964.25" width="312" height="71" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-73" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-68" target="SBsURusUmZdSX8FJDAMt-72" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-80" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-68" target="SBsURusUmZdSX8FJDAMt-79" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-89" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-68" target="SBsURusUmZdSX8FJDAMt-87" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-97" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-68" target="SBsURusUmZdSX8FJDAMt-88" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-68" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;// 指令后可以跟多个域名，第1个是主域名&lt;br&gt;Syntax&amp;nbsp; &amp;nbsp; server_name_in_redirect on | off;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Default&amp;nbsp; &amp;nbsp; server_nmae_in_redirect off;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Context&amp;nbsp; &amp;nbsp;http, server, location&lt;br&gt;&lt;br&gt;// *泛域名：仅支持在最前或者最后&lt;br&gt;eg: server_name *.taohui.tech&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;// 正则表达式：加 ~ 前缀&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;eg: server_name www.taohui.tech ~^www\d+\.taohui\.tech$;&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="9879" y="-847.25" width="629" height="234" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-77" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-72" target="SBsURusUmZdSX8FJDAMt-75" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-78" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#ffe6cc;strokeWidth=2;" parent="1" source="SBsURusUmZdSX8FJDAMt-72" target="SBsURusUmZdSX8FJDAMt-76" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-72" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;演示：server_name_in_redirect on 用法&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="8280.5" y="-476.25" width="477" height="71" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-75" value="&lt;pre&gt;&lt;div style=&quot;font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 conf.d]#&lt;/span&gt;cat server_name_test.conf                                                                                                                                                                                                                            &lt;/div&gt;&lt;div&gt;server {                                                                                                                                                                                                                                                                      &lt;/div&gt;&lt;div&gt;    server_name primary.mystical.org second.mystical.org;                                                                                                                                                                                                                     &lt;/div&gt;&lt;div&gt;    server_name_in_redirect on;                                                                                                                                                                                                                                               &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    return 302 /redirect;                                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div&gt;}   &lt;br&gt;                                                                                                                                                                                                                                                                          &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 conf.d]#&lt;/span&gt;curl second.mystical.org -I                                                                                                                                                                                                                          &lt;/div&gt;&lt;div&gt;HTTP/1.1 302 Moved Temporarily                                                                                                                                                                                                                                                &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Server&lt;/span&gt;: nginx/1.26.2                                                             &lt;font style=&quot;&quot; color=&quot;#cc0000&quot;&gt;                                   &lt;/font&gt;                                                                                                                                                          &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Date&lt;/span&gt;: Wed, 03 Sep 2025 08:48:05 GMT                                                                                                                                                                                                                                           &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Content-Type&lt;/span&gt;: text/html                                                                                                                                                                                                                                                       &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Content-Length&lt;/span&gt;: 145                                                                                                                                                                                                                                                           &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Location&lt;/span&gt;: &lt;font color=&quot;#cc0000&quot;&gt;&lt;b&gt;http://primary.mystical.org/redirect&lt;/b&gt;&lt;/font&gt;                                                                                                                                                                                                                                &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Connection&lt;/span&gt;: keep-alive &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=30;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="7859" y="-303.25" width="617" height="485" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-76" value="&lt;pre&gt;&lt;div style=&quot;font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 conf.d]#&lt;/span&gt;vim server_name_test.conf  &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                          &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 conf.d]#&lt;/span&gt;nginx -s reload&lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                      &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 conf.d]#&lt;/span&gt;curl second.mystical.org -I                                                                                                                                                                                                                          &lt;/div&gt;&lt;div&gt;HTTP/1.1 302 Moved Temporarily                                                                                                                                                                                                                                                &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Server&lt;/span&gt;: nginx/1.26.2                                                                                                                                                                                                                                                          &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Date&lt;/span&gt;: Wed, 03 Sep 2025 08:54:56 GMT                                                                                                                                                                                                                                           &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Content-Type&lt;/span&gt;: text/html                                                                                                                                                                                                                                                       &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Content-Length&lt;/span&gt;: 145                                                                                                                                                                                                                                                           &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Location&lt;/span&gt;: &lt;b&gt;&lt;font color=&quot;#cc0000&quot;&gt;http://second.mystical.org/redirect&lt;/font&gt;&lt;/b&gt;                                                                                                                                                                                                                                 &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Connection&lt;/span&gt;: keep-alive   &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=30;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="8563" y="-303.25" width="617" height="401" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-82" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-79" target="SBsURusUmZdSX8FJDAMt-81" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-83" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;&lt;b&gt;位置变量&lt;/b&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="SBsURusUmZdSX8FJDAMt-82" vertex="1" connectable="0">
          <mxGeometry x="0.1544" y="3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-85" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-79" target="SBsURusUmZdSX8FJDAMt-84" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-86" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;&lt;b&gt;命名变量&lt;/b&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="SBsURusUmZdSX8FJDAMt-85" vertex="1" connectable="0">
          <mxGeometry x="-0.1121" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-79" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;演示：用正则表达式创建变量&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="9954" y="-476.25" width="477" height="71" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-81" value="&lt;pre&gt;&lt;div style=&quot;font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 games.mystical.org]#&lt;/span&gt;cat /apps/nginx/conf.d/server_name_test2.conf                                                                                                                                                                                            &lt;/div&gt;&lt;div&gt;server {                                                                                                                                                                                                                                                                      &lt;/div&gt;&lt;div&gt;    server_name ~^(www\.)?(.+)$;                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    location / {                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;         root /sites/$2;                                                                                                                                                                                                                                                      &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;}                                                                                                                                                                                                                                                                             &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                    &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 sites]#&lt;/span&gt;tree /sites/                                                                                                                                                                                                                                          &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;/sites/&lt;/span&gt;                                                                                                                                                                                                                                                                       &lt;/div&gt;&lt;div&gt;├── &lt;span style=&quot;font-weight: bold;&quot;&gt;blog.mystical.org&lt;/span&gt;                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;│&amp;nbsp;&amp;nbsp; └── index.html                                                                                                                                                                                                                                                            &lt;/div&gt;&lt;div&gt;└── &lt;span style=&quot;font-weight: bold;&quot;&gt;games.mystical.org&lt;/span&gt;                                                                                                                                                                                                                                                        &lt;/div&gt;&lt;div&gt;    └── index.html                                                                                                                                                                                                                                                            &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;2 directories, 2 files        &lt;br/&gt;                                                                                                                                                                                                                                                &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 sites]#&lt;/span&gt;curl blog.mystical.org                                                                                                                                                                                                                                &lt;/div&gt;&lt;div&gt;this is blog                                                                                                                                                                                                                                                                  &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 sites]#&lt;/span&gt;curl games.mystical.org                                                                                                                                                                                                                               &lt;/div&gt;&lt;div&gt;There are some game in here!&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=30;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="9226" y="-303.25" width="898" height="565" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-84" value="&lt;pre&gt;&lt;div style=&quot;font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 sites]#&lt;/span&gt;cat /apps/nginx/conf.d/server_name_test2.conf                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;server {                                                                                                                                                                                                                                                                      &lt;/div&gt;&lt;div&gt;    server_name ~^(www\.)?(?&amp;lt;domain&amp;gt;.+)$;                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div&gt;    location / {                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;         root /sites/$domain;                                                                                                                                                                                                                                                 &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;}                                                                                                                                                                                                                                                                             &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 sites]#&lt;/span&gt;curl blog.mystical.org                                                                                                                                                                                                                                &lt;/div&gt;&lt;div&gt;this is blog                                                                                                                                                                                                                                                                  &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 sites]#&lt;/span&gt;curl games.mystical.org                                                                                                                                                                                                                               &lt;/div&gt;&lt;div&gt;There are some game in here!                                                                                                                                                                                                                                                  &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@ubuntu2204 sites]#&lt;/span&gt; &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=30;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="10188" y="-303.25" width="898" height="565" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-94" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#ffe6cc;strokeWidth=2;" parent="1" source="SBsURusUmZdSX8FJDAMt-87" target="SBsURusUmZdSX8FJDAMt-90" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-95" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#ffe6cc;strokeWidth=2;" parent="1" source="SBsURusUmZdSX8FJDAMt-87" target="SBsURusUmZdSX8FJDAMt-92" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-96" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#ffe6cc;strokeWidth=2;" parent="1" source="SBsURusUmZdSX8FJDAMt-87" target="SBsURusUmZdSX8FJDAMt-93" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-87" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;其他用法&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="11475" y="-473.25" width="477" height="71" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-103" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-88" target="SBsURusUmZdSX8FJDAMt-98" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-88" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;Server 匹配顺序&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="12355" y="-473.25" width="477" height="71" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-90" value="&lt;pre&gt;&lt;div style=&quot;font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;b&gt;.magedu.org 可以匹配 magedu.org *.magedu.org&lt;/b&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=30;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="11108" y="-296.25" width="498" height="109" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-92" value="&lt;pre&gt;&lt;div style=&quot;font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;b&gt;_ 匹配所有&lt;/b&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=30;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="11634.5" y="-300.25" width="158" height="109" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-93" value="&lt;pre&gt;&lt;div style=&quot;font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;b&gt;&quot;&quot; 匹配没有传递Host头部&lt;/b&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=30;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="11846" y="-300.25" width="281" height="109" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-104" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-98" target="SBsURusUmZdSX8FJDAMt-99" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-113" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="SBsURusUmZdSX8FJDAMt-98" target="SBsURusUmZdSX8FJDAMt-112" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-98" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;01 精确匹配&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="12413.5" y="-347.25" width="360" height="71" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-105" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-99" target="SBsURusUmZdSX8FJDAMt-100" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-99" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;02 * 在前的泛域名&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="12413.5" y="-233.25" width="360" height="71" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-106" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-100" target="SBsURusUmZdSX8FJDAMt-101" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-114" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="SBsURusUmZdSX8FJDAMt-100" target="SBsURusUmZdSX8FJDAMt-112" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-100" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;03 * 在后的泛域名&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="12413.5" y="-110.25" width="360" height="71" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-107" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="SBsURusUmZdSX8FJDAMt-101" target="SBsURusUmZdSX8FJDAMt-102" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-108" value="" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-101" target="SBsURusUmZdSX8FJDAMt-102" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-101" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;04 按文件中的顺序匹配正则表达式域名&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="12403" y="7.75" width="381" height="71" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-102" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;05 default server&lt;br&gt;-&amp;nbsp; 第一个&lt;/b&gt;&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;- listen 指定 default&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=40;" parent="1" vertex="1">
          <mxGeometry x="12464" y="138.75" width="259" height="93" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-112" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;&lt;b&gt;和文件顺序无关&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="12848" y="-217.25" width="124" height="30" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-120" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-116" target="SBsURusUmZdSX8FJDAMt-119" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-129" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-116" target="SBsURusUmZdSX8FJDAMt-123" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-130" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-116" target="SBsURusUmZdSX8FJDAMt-124" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-131" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-116" target="SBsURusUmZdSX8FJDAMt-128" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-133" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-116" target="SBsURusUmZdSX8FJDAMt-132" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-135" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-116" target="SBsURusUmZdSX8FJDAMt-134" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-141" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-116" target="SBsURusUmZdSX8FJDAMt-137" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-142" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-116" target="SBsURusUmZdSX8FJDAMt-138" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-143" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-116" target="SBsURusUmZdSX8FJDAMt-139" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-144" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-116" target="SBsURusUmZdSX8FJDAMt-140" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-146" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-116" target="SBsURusUmZdSX8FJDAMt-136" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-116" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;HTTP请求的11个阶段&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;（每个阶段必须是依次进行）&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="14857" y="-1090.25" width="282" height="71" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-147" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-119" target="SBsURusUmZdSX8FJDAMt-123" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-119" value="&lt;font size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;POST_READ&lt;br&gt;（接收到请求头部之后）&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;刚读完HTTP头部，没有做任何再加工之前，想获取一些原始的值&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="12753" y="-964.25" width="603" height="126" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-148" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-123" target="SBsURusUmZdSX8FJDAMt-124" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-123" value="&lt;b style=&quot;font-size: 19px;&quot;&gt;SERVER_REWRITE&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="13426" y="-964.25" width="286" height="126" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-149" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-124" target="SBsURusUmZdSX8FJDAMt-128" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-124" value="&lt;b style=&quot;font-size: 19px;&quot;&gt;FIND_CONFIG&lt;/b&gt;&lt;div&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;通常没有模块在这个阶段&lt;br&gt;主要做location的匹配&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="13782" y="-964.25" width="286" height="126" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-150" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-128" target="SBsURusUmZdSX8FJDAMt-132" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-128" value="&lt;b style=&quot;font-size: 19px;&quot;&gt;REWRITE&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="14141" y="-964.25" width="286" height="126" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-151" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-132" target="SBsURusUmZdSX8FJDAMt-134" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-132" value="&lt;b style=&quot;font-size: 19px;&quot;&gt;POST_REWRITE&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="14500" y="-964.25" width="286" height="126" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-152" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-134" target="SBsURusUmZdSX8FJDAMt-136" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-134" value="&lt;b style=&quot;font-size: 19px;&quot;&gt;PREACCESS&lt;br&gt;对访问资源进行限制（限流限速）&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="14837" y="-964.25" width="322" height="126" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-153" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-136" target="SBsURusUmZdSX8FJDAMt-137" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-136" value="&lt;b style=&quot;font-size: 19px;&quot;&gt;ACCESS&lt;br&gt;确认访问权限（能不能访问）&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="15211" y="-964.25" width="286" height="126" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-154" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-137" target="SBsURusUmZdSX8FJDAMt-138" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-137" value="&lt;b style=&quot;font-size: 19px;&quot;&gt;POST_ACCESS&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="15565" y="-964.25" width="286" height="126" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-155" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-138" target="SBsURusUmZdSX8FJDAMt-139" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-138" value="&lt;b style=&quot;font-size: 19px;&quot;&gt;PRECONTENT&lt;/b&gt;&lt;div&gt;&lt;b style=&quot;font-size: 19px;&quot;&gt;处理响应之前&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="15920" y="-964.25" width="286" height="126" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-156" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-139" target="SBsURusUmZdSX8FJDAMt-140" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-139" value="&lt;b style=&quot;font-size: 19px;&quot;&gt;CONTENT&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="16288" y="-964.25" width="286" height="126" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-140" value="&lt;b style=&quot;font-size: 19px;&quot;&gt;LOG&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="16656" y="-964.25" width="286" height="126" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-158" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;11个阶段中模块的处理顺序&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="14459" y="-671" width="298" height="96" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-165" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#82b366;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#d5e8d4;" parent="1" source="SBsURusUmZdSX8FJDAMt-159" target="SBsURusUmZdSX8FJDAMt-162" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="15046" y="-464" />
              <mxPoint x="15046" y="-313" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-159" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;realip&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="14511" y="-500" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-160" value="&lt;font color=&quot;#cc0000&quot; size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 22px;&quot;&gt;postread 阶段&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="15254" y="-509.5" width="158" height="91" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-166" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="SBsURusUmZdSX8FJDAMt-162" target="SBsURusUmZdSX8FJDAMt-163" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-162" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;server_rewrite&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="14789" y="-349" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-167" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="SBsURusUmZdSX8FJDAMt-163" target="SBsURusUmZdSX8FJDAMt-164" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-163" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;find_config&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="14519" y="-349" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-171" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#d6b656;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#fff2cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-164" target="SBsURusUmZdSX8FJDAMt-169" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="14183" y="-313" />
              <mxPoint x="14183" y="-147" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-164" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;rewrite&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="14225" y="-349" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-168" value="&lt;font color=&quot;#cc0000&quot; size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 22px;&quot;&gt;Nginx HTTP 框架执行的&lt;br&gt;（其他第三方模块没有机会在这里执行）&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="15137" y="-368" width="399" height="91" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-172" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#d6b656;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#fff2cc;strokeWidth=2;" parent="1" source="SBsURusUmZdSX8FJDAMt-169" target="SBsURusUmZdSX8FJDAMt-170" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-169" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;limit_req&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="14299" y="-183" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-177" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#ffe6cc;strokeWidth=2;" parent="1" source="SBsURusUmZdSX8FJDAMt-170" target="SBsURusUmZdSX8FJDAMt-175" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="14926" y="-147" />
              <mxPoint x="14926" y="-74" />
              <mxPoint x="14195" y="-74" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-170" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;limit_conn&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="14639" y="-183" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-173" value="&lt;font color=&quot;#cc0000&quot; size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 22px;&quot;&gt;preaccess 阶段&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="15248" y="-202" width="199" height="91" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=0;strokeWidth=2;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" source="SBsURusUmZdSX8FJDAMt-174" target="SBsURusUmZdSX8FJDAMt-182" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-174" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;auth_quest&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="14813" y="-38" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-178" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-175" target="SBsURusUmZdSX8FJDAMt-176" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-175" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;access&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="14098" y="-38" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-179" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#d79b00;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#ffe6cc;" parent="1" source="SBsURusUmZdSX8FJDAMt-176" target="SBsURusUmZdSX8FJDAMt-174" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-176" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;auth_basic&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="14463" y="-38" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-180" value="&lt;font color=&quot;#cc0000&quot; size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 22px;&quot;&gt;access 阶段&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="15248" y="-58" width="199" height="91" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-4" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#e1d5e7;" parent="1" source="SBsURusUmZdSX8FJDAMt-181" target="SBsURusUmZdSX8FJDAMt-186" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-181" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;mirrors&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="14657" y="118" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-3" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#b85450;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#f8cecc;" parent="1" source="SBsURusUmZdSX8FJDAMt-182" target="SBsURusUmZdSX8FJDAMt-181" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-182" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;try_files&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="14292" y="118" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-185" value="&lt;font color=&quot;#cc0000&quot; size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 22px;&quot;&gt;precontent 阶段&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="15248" y="94" width="199" height="91" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-5" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#9673a6;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#e1d5e7;" parent="1" source="SBsURusUmZdSX8FJDAMt-186" target="SBsURusUmZdSX8FJDAMt-187" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-186" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;concat&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="14044" y="266" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-6" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#9673a6;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#e1d5e7;" parent="1" source="SBsURusUmZdSX8FJDAMt-187" target="SBsURusUmZdSX8FJDAMt-188" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-15" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="SBsURusUmZdSX8FJDAMt-187" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="14542.334147135418" y="321.58333333333394" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-187" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;random_index&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="14321" y="266" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-7" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#9673a6;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#e1d5e7;" parent="1" source="SBsURusUmZdSX8FJDAMt-188" target="SBsURusUmZdSX8FJDAMt-189" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-188" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;index&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="14598" y="266" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-8" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#9673a6;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#e1d5e7;" parent="1" source="SBsURusUmZdSX8FJDAMt-189" target="SBsURusUmZdSX8FJDAMt-190" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-189" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;auto_index&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="14875" y="266" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-10" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;strokeWidth=2;fillColor=#dae8fc;" parent="1" source="SBsURusUmZdSX8FJDAMt-190" target="7jRE_PZrU57L1XS55z77-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SBsURusUmZdSX8FJDAMt-190" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;static&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="15152" y="266" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-9" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;log&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="14292" y="414" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-11" value="&lt;font color=&quot;#cc0000&quot; size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 22px;&quot;&gt;content 阶段&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="15403" y="256.5" width="199" height="91" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-12" value="&lt;font color=&quot;#cc0000&quot; size=&quot;1&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 22px;&quot;&gt;log 阶段&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="15403" y="404.5" width="199" height="91" as="geometry" />
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-13" value="&lt;pre style=&quot;font-size: 20px;&quot;&gt;&lt;div style=&quot;font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 20px;&quot;&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;// configure预处理后，会在obj目录生成ngx_module.c&lt;br/&gt;// 里面的数组ngx_module_names记录了所有加入的模块&lt;br/&gt;// 顺序越往后，越先执行&lt;br/&gt;&lt;br&gt;char&lt;/span&gt; *ngx_module_names[] = {                                                                                                                                                                                                                                                  &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_core_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                        &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_errlog_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                      &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_conf_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                        &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_openssl_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_regex_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                       &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_events_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                      &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_event_core_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                  &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_epoll_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                       &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                        &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_core_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                   &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_log_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                    &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_upstream_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                               &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_v2_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_static_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                 &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_gzip_static_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                            &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_autoindex_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_index_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                  &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_mirror_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                                 &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_try_files_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_auth_basic_module&quot;&lt;/span&gt;,                                                                                                                                                                                                                                             &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    &lt;span style=&quot;font-size: 20px;&quot;&gt;&quot;ngx_http_access_module&quot;&lt;/span&gt;, &lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;    ......&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;}        &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=20;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=default;align=left;spacingLeft=30;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="15672" y="-388" width="742" height="848" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=0;strokeWidth=2;fillColor=#008a00;strokeColor=#005700;" parent="1" source="7jRE_PZrU57L1XS55z77-16" target="c-Om4ZVsiT-AUXczZZ-C-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-22" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=0;strokeWidth=2;fillColor=#008a00;strokeColor=#005700;" parent="1" source="7jRE_PZrU57L1XS55z77-16" target="c-Om4ZVsiT-AUXczZZ-C-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-30" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#005700;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#008a00;" parent="1" source="7jRE_PZrU57L1XS55z77-16" target="c-Om4ZVsiT-AUXczZZ-C-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-14" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#005700;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#008a00;" parent="1" source="7jRE_PZrU57L1XS55z77-16" target="P8bKrxKqJgt3pFntmFku-13" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="10889.5" y="1250" />
              <mxPoint x="13412.5" y="1250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-61" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#005700;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#008a00;" parent="1" source="7jRE_PZrU57L1XS55z77-16" target="P8bKrxKqJgt3pFntmFku-52" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="10889" y="1249" />
              <mxPoint x="16527" y="1249" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="7jRE_PZrU57L1XS55z77-16" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;如何拿到真实的用户 IP 地址&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="10752.5" y="1144" width="273" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;endSize=7;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-1" target="c-Om4ZVsiT-AUXczZZ-C-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-1" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;真实场景&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#a20025;strokeColor=#6F0000;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="7834.5" y="1286" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;endSize=7;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-3" target="c-Om4ZVsiT-AUXczZZ-C-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-3" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;用户&lt;/b&gt;&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;（内网IP: 192.168.0.x）&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="7784" y="1423" width="295" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;endSize=7;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-5" target="c-Om4ZVsiT-AUXczZZ-C-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-5" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;ADSL&lt;/b&gt;&lt;/span&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;（运营商公网IP: 115.204.33.1）&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="7784" y="1560" width="295" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;endSize=7;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-6" target="c-Om4ZVsiT-AUXczZZ-C-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-6" value="&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;CDN&lt;br&gt;（IP地址: 1.1.1.1）&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="7784" y="1697.5" width="295" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;endSize=7;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-8" target="c-Om4ZVsiT-AUXczZZ-C-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-8" value="&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;某反向代理（ali:SLB）&lt;br&gt;（IP地址: 2.2.2.2）&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="7784" y="1849" width="295" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-9" value="&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;Nginx&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="7784" y="1996" width="295" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#008a00;strokeColor=#005700;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-15" target="7jRE_PZrU57L1XS55z77-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-15" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;realip 模块&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="10792" y="1000" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-20" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fillColor=#dae8fc;strokeColor=#6c8ebf;curved=0;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-17" target="c-Om4ZVsiT-AUXczZZ-C-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-21" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;curved=0;strokeWidth=2;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-17" target="c-Om4ZVsiT-AUXczZZ-C-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-17" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;相关变量&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="8376.5" y="1286" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-18" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;X-Forwarded-For&lt;br&gt;(用于传递IP)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="8150.5" y="1423" width="295" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-19" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;X-Real-IP&lt;br&gt;(用于传递用户IP)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="8488" y="1423" width="295" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-25" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#b85450;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#f8cecc;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-23" target="c-Om4ZVsiT-AUXczZZ-C-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-33" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-23" target="c-Om4ZVsiT-AUXczZZ-C-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-42" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-23" target="c-Om4ZVsiT-AUXczZZ-C-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-23" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;如何使用&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d80073;strokeColor=#A50040;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="9576" y="1286" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-28" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#b85450;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#f8cecc;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-24" target="c-Om4ZVsiT-AUXczZZ-C-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-29" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#b85450;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#f8cecc;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-24" target="c-Om4ZVsiT-AUXczZZ-C-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-24" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;基于变量使用&lt;br&gt;相关变量会被 X-Forwarded-For 和 X-Real-IP 覆盖&lt;br&gt;这样做limit_conn模块才有意义&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="8834.5" y="1423" width="468" height="109" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-26" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;binary_remote_addr&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="8720.5" y="1605" width="295" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-27" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;remote_addr&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="9135.5" y="1605" width="257" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-35" value="" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-32" target="c-Om4ZVsiT-AUXczZZ-C-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-32" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;默认不会编译进Nginx&lt;/b&gt;&lt;br&gt;通过 --with-http_realip_module启用功能&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="9439" y="1423" width="468" height="90" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-38" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-34" target="c-Om4ZVsiT-AUXczZZ-C-36" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-39" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-34" target="c-Om4ZVsiT-AUXczZZ-C-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-34" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;因为realip模块更改了remote_addr&lt;br&gt;因此如果想获取修改前的值，通过如下变量&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="9456.5" y="1605" width="433" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-36" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;realip_remote_addr&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="9395.5" y="1764" width="257" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-37" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;realip_remote_port&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="9693.5" y="1764" width="257" height="72" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-54" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-40" target="c-Om4ZVsiT-AUXczZZ-C-48" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-55" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-40" target="c-Om4ZVsiT-AUXczZZ-C-43" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-56" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-40" target="c-Om4ZVsiT-AUXczZZ-C-51" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-40" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;相关指令&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="10649.5" y="1427" width="292" height="90" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-45" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-43" target="c-Om4ZVsiT-AUXczZZ-C-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-47" value="&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;解释声明&lt;/b&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="c-Om4ZVsiT-AUXczZZ-C-45" vertex="1" connectable="0">
          <mxGeometry x="-0.0723" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-43" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Syntax&amp;nbsp; &amp;nbsp; set_real_ip_from &lt;/b&gt;address | CIDR | unix;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Default&amp;nbsp; &amp;nbsp; —&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Context&amp;nbsp; &amp;nbsp;&lt;/b&gt;http, server, location&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="10024.5" y="1605" width="436" height="99" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-3" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-44" target="P8bKrxKqJgt3pFntmFku-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-4" value="&lt;font size=&quot;1&quot; color=&quot;#cc0000&quot; style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 16px;&quot;&gt;注意事项&lt;/b&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="P8bKrxKqJgt3pFntmFku-3" vertex="1" connectable="0">
          <mxGeometry x="-0.038" y="-3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-6" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-44" target="P8bKrxKqJgt3pFntmFku-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-9" value="&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; text-align: start;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%22%26lt%3Bfont%20size%3D%26quot%3B1%26quot%3B%20color%3D%26quot%3B%23cc0000%26quot%3B%20style%3D%26quot%3B%26quot%3B%26gt%3B%26lt%3Bb%20style%3D%26quot%3Bfont-size%3A%2016px%3B%26quot%3B%26gt%3B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%26lt%3B%2Fb%26gt%3B%26lt%3B%2Ffont%26gt%3B%22%20style%3D%22edgeLabel%3Bhtml%3D1%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3Bresizable%3D0%3Bpoints%3D%5B%5D%3BfontFamily%3DHelvetica%3BfontSize%3D11%3BfontColor%3Ddefault%3BlabelBackgroundColor%3Ddefault%3B%22%20vertex%3D%221%22%20connectable%3D%220%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%2215386.000059923255%22%20y%3D%221594.5714285714294%22%20as%3D%22geometry%22%2F%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="P8bKrxKqJgt3pFntmFku-6" vertex="1" connectable="0">
          <mxGeometry x="-0.0625" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-12" value="&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;原理&lt;/b&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="P8bKrxKqJgt3pFntmFku-6" vertex="1" connectable="0">
          <mxGeometry x="0.0162" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-44" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;strong data-end=&quot;41&quot; data-start=&quot;21&quot;&gt;声明“可信的上游地址（或网段）”&lt;/strong&gt;。&lt;br&gt;当请求&lt;strong data-end=&quot;57&quot; data-start=&quot;45&quot;&gt;来自这些可信地址&lt;/strong&gt;时，NGINX 才会相信上游在请求头或 PROXY protocol 里携带的“客户端真实 IP”，并据此&lt;strong data-end=&quot;140&quot; data-start=&quot;110&quot;&gt;重写 &lt;code data-end=&quot;129&quot; data-start=&quot;115&quot;&gt;$remote_addr&lt;/code&gt;（以及可选的端口）&lt;/strong&gt;。&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="10021.5" y="1794" width="439" height="117" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-50" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-48" target="c-Om4ZVsiT-AUXczZZ-C-49" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-48" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Syntax&amp;nbsp; &amp;nbsp; real_ip_header &lt;/b&gt;field | X-Real-IP | X-Forwarded-For | proxy_protocol;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Default&amp;nbsp; &amp;nbsp; &lt;/b&gt;real_ip_header X-Real-IP;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Context&amp;nbsp; &amp;nbsp;&lt;/b&gt;http, server, location&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="10505.5" y="1605" width="580" height="99" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-49" value="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;指定从哪个头取真实 IP；或使用 PROXY protocol&lt;/b&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="10595" y="1794" width="401" height="117" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-53" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="c-Om4ZVsiT-AUXczZZ-C-51" target="c-Om4ZVsiT-AUXczZZ-C-52" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-51" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Syntax&amp;nbsp; &amp;nbsp; real_ip_recursive &lt;/b&gt;on | off;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Default&amp;nbsp; &amp;nbsp; &lt;/b&gt;real_ip_recursive off;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Context&amp;nbsp; &amp;nbsp;&lt;/b&gt;http, server, location&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="11126.5" y="1605" width="313" height="99" as="geometry" />
        </mxCell>
        <mxCell id="c-Om4ZVsiT-AUXczZZ-C-52" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;开了 &lt;code data-end=&quot;1259&quot; data-start=&quot;1237&quot;&gt;real_ip_recursive on&lt;/code&gt; 才会“穿透多级代理”，&lt;br&gt;拿到&lt;span data-end=&quot;1287&quot; data-start=&quot;1273&quot;&gt;最左边的非可信 IP&lt;/span&gt;（通常就是原始客户端）&lt;/b&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="11082.5" y="1787" width="401" height="117" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-1" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;strong data-end=&quot;46&quot; data-start=&quot;3&quot;&gt;&lt;code data-end=&quot;13&quot; data-start=&quot;5&quot;&gt;realip&lt;/code&gt; 模块只在“直连到你这台 NGINX 的对端 IP 是可信的”&lt;/strong&gt; 前提下，才会去读取/解析 &lt;code data-end=&quot;77&quot; data-start=&quot;60&quot;&gt;X-Forwarded-For&lt;/code&gt;。&lt;br&gt;&lt;b&gt;所以直连的反代必须信任，（不能隔着直连，信任上端）&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="9718.5" y="1996" width="439" height="117" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-5" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp;NGINX 在 &lt;code data-end=&quot;68&quot; data-start=&quot;46&quot;&gt;real_ip_recursive on&lt;/code&gt; 的规则下，会从 &lt;strong data-end=&quot;96&quot; data-start=&quot;77&quot;&gt;X-Forwarded-For&lt;/strong&gt; 右往左找&lt;strong data-end=&quot;120&quot; data-start=&quot;101&quot;&gt;第一个“不在信任列表里”的地址&lt;/strong&gt;当作客户端 IP&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="10263.5" y="1996" width="439" height="117" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-45" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-13" target="P8bKrxKqJgt3pFntmFku-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-46" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-13" target="P8bKrxKqJgt3pFntmFku-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-47" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-13" target="P8bKrxKqJgt3pFntmFku-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-48" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-13" target="P8bKrxKqJgt3pFntmFku-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-49" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-13" target="P8bKrxKqJgt3pFntmFku-38" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-13" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;实验演示&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#6a00ff;strokeColor=#3700CC;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="13315.5" y="1309" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-24" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-16" target="P8bKrxKqJgt3pFntmFku-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-16" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;实验架构图&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="11627.5" y="1432.5" width="292" height="90" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-32" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-17" target="P8bKrxKqJgt3pFntmFku-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-17" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;NAT服务器配置&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="12331.5" y="1432.5" width="292" height="90" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-40" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-18" target="P8bKrxKqJgt3pFntmFku-39" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-18" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;反向代理服务器1配置&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="13266.5" y="1432.5" width="292" height="90" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-25" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-19" target="P8bKrxKqJgt3pFntmFku-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-19" value="&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;客户端&lt;br&gt;（10.0.0.202 ）&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="11664.25" y="1579" width="218.5" height="75" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-26" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-20" target="P8bKrxKqJgt3pFntmFku-21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-20" value="&lt;font style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;NAT服务器&lt;/b&gt;&lt;br&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;（&lt;/b&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;10.0.0.203,192.168.10.100&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;）&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="11655.869999999999" y="1707" width="235.25" height="75" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-27" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-21" target="P8bKrxKqJgt3pFntmFku-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-21" value="&lt;font style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;反向代理服务器&lt;/b&gt;&lt;br&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;（&lt;/b&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;192.168.10.110&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;）&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="11665.75" y="1833" width="217" height="75" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-28" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-22" target="P8bKrxKqJgt3pFntmFku-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-22" value="&lt;font style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;反向代理服务器&lt;/b&gt;&lt;br&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;（&lt;/b&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;192.168.10.115&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;）&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="11665.75" y="1958" width="217" height="75" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-23" value="&lt;font style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;Web服务器&lt;/b&gt;&lt;br&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;（&lt;/b&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;192.168.10.120&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 15px;&quot;&gt;）&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="11665.75" y="2083" width="217" height="75" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-34" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-31" target="P8bKrxKqJgt3pFntmFku-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-31" value="&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;添加NAT规则&lt;br&gt;iptables -t nat -A POSTROUTING -s 10.0.0.202 ! -d 10.0.0.202 -j SNAT --to-source 192.168.10.100&lt;br&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontColor=default;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="11952.5" y="1579" width="1050" height="93.5" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-33" value="&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;开启内核转发&lt;/div&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: rgba(0, 0, 0, 0); white-space: normal;&quot;&gt;echo 1 &amp;gt; /proc/sys/net/ipv4/ip_forward&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontColor=default;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="12143" y="1735" width="669" height="93.5" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-44" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-37" target="P8bKrxKqJgt3pFntmFku-41" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-37" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;反向代理服务器2配置&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="14050.5" y="1432.5" width="292" height="90" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-43" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-38" target="P8bKrxKqJgt3pFntmFku-42" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-38" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;Web服务器配置&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="15158" y="1432.5" width="292" height="90" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-39" value="&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;server&lt;/span&gt; {                                                                                                                                                                                                                                                                      &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;server_name&lt;/span&gt; _;                                                                                                                                                                                                                                                            &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;location&lt;/span&gt; / {                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;proxy_pass&lt;/span&gt; http://&lt;span style=&quot;&quot;&gt;192.168.10.115&lt;/span&gt;;                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;proxy_set_header&lt;/span&gt; Host &lt;span style=&quot;&quot;&gt;$http_host&lt;/span&gt;;                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;proxy_set_header&lt;/span&gt; X-Forwarded-For &lt;span style=&quot;&quot;&gt;$proxy_add_x_forwarded_for&lt;/span&gt;;                                                                                                                                                                                                          &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;} &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontColor=default;fontStyle=1;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="13047.5" y="1579" width="730" height="268" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-41" value="&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;server&lt;/span&gt; {                                                                                                                                                                                                                                                                      &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;server_name&lt;/span&gt; _;                                                                                                                                                                                                                                                            &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;location&lt;/span&gt; / {                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;proxy_pass&lt;/span&gt; http://&lt;span style=&quot;&quot;&gt;192.168.10.120&lt;/span&gt;;                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;proxy_set_header&lt;/span&gt; Host &lt;span style=&quot;&quot;&gt;$http_host&lt;/span&gt;;                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;proxy_set_header&lt;/span&gt; X-Forwarded-For &lt;span style=&quot;&quot;&gt;$proxy_add_x_forwarded_for&lt;/span&gt;;                                                                                                                                                                                                          &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;} &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontColor=default;fontStyle=1;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="13831.5" y="1579" width="730" height="268" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-42" value="&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;server&lt;/span&gt; {                                                                                                                                                                                                                                                                      &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;server_name&lt;/span&gt; realip.mystical.tech;                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;set_real_ip_from&lt;/span&gt; &lt;span style=&quot;&quot;&gt;192.168.10.115&lt;/span&gt;;                                                                                                                                                                                                                                          &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;set_real_ip_from&lt;/span&gt; &lt;span style=&quot;&quot;&gt;192.168.10.110&lt;/span&gt;;                                                                                                                                                                                                                                          &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;real_ip_header&lt;/span&gt; X-Forwarded-For;                                                                                                                                                                                                                                           &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;real_ip_recursive&lt;/span&gt; &lt;span style=&quot;&quot;&gt;on&lt;/span&gt;;                                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;location&lt;/span&gt; / {                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;&quot;&gt;200&lt;/span&gt; &lt;span style=&quot;&quot;&gt;&quot;Remote_addr: &lt;/span&gt;&lt;span style=&quot;&quot;&gt;${remote_addr}&lt;/span&gt;&lt;span style=&quot;&quot;&gt;\nrealip_remote_addr: &lt;/span&gt;&lt;span style=&quot;&quot;&gt;${realip_remote_addr}&lt;/span&gt;&lt;span style=&quot;&quot;&gt;\nX-Forwarede-For: &lt;/span&gt;&lt;span style=&quot;&quot;&gt;${http_x_forwarded_for}&lt;/span&gt;&lt;span style=&quot;&quot;&gt;\n&quot;&lt;/span&gt;;                                                                                                                                      &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontColor=default;fontStyle=1;align=left;spacingLeft=30;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="14605.5" y="1579" width="1397" height="290" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-55" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#ffe6cc;" parent="1" source="P8bKrxKqJgt3pFntmFku-52" target="P8bKrxKqJgt3pFntmFku-53" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-52" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;配置realip的意义&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#a20025;strokeColor=#6F0000;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="16381" y="1309" width="292" height="90" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-59" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#ffe6cc;" parent="1" source="P8bKrxKqJgt3pFntmFku-53" target="P8bKrxKqJgt3pFntmFku-56" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-53" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;如果不使用realip&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="16381" y="1467.5" width="292" height="90" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-58" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d79b00;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#ffe6cc;" parent="1" source="P8bKrxKqJgt3pFntmFku-56" target="P8bKrxKqJgt3pFntmFku-57" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-56" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;用户可以在Header自行构造XFF&lt;br&gt;导致后端拿不到真实IP&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="16294.5" y="1626.5" width="465" height="138" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-57" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;示例：&lt;/b&gt;&lt;/span&gt;&lt;div&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;[root@NAT ~]#&lt;/span&gt;curl -H &#39;X-Forwarded-For: 11.11.11.11,22.2.2.2&#39; realip.mystical.tech                                                                                                                                                                                             &lt;/div&gt;&lt;div&gt;Remote_addr: 192.168.10.100                                                                                                                                                                                                                                                   &lt;/div&gt;&lt;div&gt;realip_remote_addr: 192.168.10.115                                                                                                                                                                                                                                            &lt;/div&gt;&lt;div&gt;X-Forwarede-For: 11.11.11.11,22.2.2.2, 192.168.10.100, 192.168.10.110  &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;spacingLeft=30;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="16093" y="1843.5" width="868" height="171" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-158" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#005700;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#008a00;" parent="1" source="P8bKrxKqJgt3pFntmFku-71" target="P8bKrxKqJgt3pFntmFku-72" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-189" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#005700;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#008a00;" parent="1" source="P8bKrxKqJgt3pFntmFku-71" target="P8bKrxKqJgt3pFntmFku-121" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-71" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;Rewrite 模块&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="10929" y="2548" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-157" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-72" target="P8bKrxKqJgt3pFntmFku-73" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-72" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;如何使用&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d80073;strokeColor=#A50040;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="9940" y="2717" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-75" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-73" target="P8bKrxKqJgt3pFntmFku-74" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-115" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-73" target="P8bKrxKqJgt3pFntmFku-110" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-155" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-73" target="P8bKrxKqJgt3pFntmFku-123" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-167" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-73" target="P8bKrxKqJgt3pFntmFku-166" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-73" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;相关指令&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="9891" y="2861" width="292" height="90" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-78" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-74" target="P8bKrxKqJgt3pFntmFku-77" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-74" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Syntax&amp;nbsp; &amp;nbsp; return &lt;/b&gt;code [text];&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return &lt;/b&gt;code URL;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return &lt;/b&gt;URL;（默认302）&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Default&amp;nbsp; &amp;nbsp; —&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Context&amp;nbsp; &amp;nbsp;&lt;/b&gt;server, location, if&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="8342.5" y="3046" width="279" height="120.5" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-103" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-77" target="P8bKrxKqJgt3pFntmFku-82" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-104" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-77" target="P8bKrxKqJgt3pFntmFku-81" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-106" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-77" target="P8bKrxKqJgt3pFntmFku-83" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-77" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;返回状态码解析&lt;br&gt;&amp;nbsp; &amp;nbsp; code&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="8389.75" y="3226" width="184.5" height="69" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-81" value="Nginx 自定义" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="7736" y="3373" width="110" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-87" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-82" target="P8bKrxKqJgt3pFntmFku-85" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-88" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-82" target="P8bKrxKqJgt3pFntmFku-86" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-82" value="HTTP 1.0 标准" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="8178" y="3373" width="110" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-93" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-83" target="P8bKrxKqJgt3pFntmFku-91" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-94" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-83" target="P8bKrxKqJgt3pFntmFku-90" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-95" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-83" target="P8bKrxKqJgt3pFntmFku-92" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-83" value="HTTP 1.1 标准" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="8844.5" y="3373" width="110" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-84" value="404&lt;br&gt;关闭连接" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="7736" y="3468.5" width="110" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-99" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-85" target="P8bKrxKqJgt3pFntmFku-98" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-85" value="301&lt;div&gt;http1.0 永久重定向&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="8055" y="3467" width="110" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-97" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-86" target="P8bKrxKqJgt3pFntmFku-96" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-86" value="302&lt;div&gt;临时重定向，禁止被缓存&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="8306" y="3467" width="144" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-101" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-90" target="P8bKrxKqJgt3pFntmFku-100" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-102" value="&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;解析：改变方法&lt;/b&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="P8bKrxKqJgt3pFntmFku-101" vertex="1" connectable="0">
          <mxGeometry x="-0.3313" relative="1" as="geometry">
            <mxPoint x="-2" y="14" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-90" value="303&lt;div&gt;临时重定向，允许改变方法，禁止被缓存&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="8521.5" y="3467" width="228" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-91" value="307&lt;div&gt;临时重定向，不允许改变方法，禁止被缓存&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="8785.5" y="3467" width="228" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-92" value="308&lt;div&gt;永久重定向，不允许改变方法&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="9050.5" y="3467" width="228" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-96" value="每次访问都是&lt;br&gt;用户访问网站A，重定向到网站B（本地不缓存）" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="8252" y="3595" width="252" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-98" value="用户访问网站A，重定向到网站B&lt;br&gt;浏览器缓存网站B的结果&lt;br&gt;后面即使网站A挂掉了，不影响访问网站B&lt;br&gt;因为浏览器根本不访问网站A，直接重定向到B" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="7984" y="3569" width="252" height="81" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-100" value="可能开始是使用POST方法访问&lt;br&gt;重定向使用Get方法或Head方法" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="8521.5" y="3600" width="228" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-107" value="Nginx立刻关闭连接&lt;br&gt;不再向用户访问任何内容" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="7669" y="3592" width="252" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-112" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-110" target="P8bKrxKqJgt3pFntmFku-111" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-113" value="Text" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="P8bKrxKqJgt3pFntmFku-112" vertex="1" connectable="0">
          <mxGeometry x="0.018" y="-2" relative="1" as="geometry">
            <mxPoint y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-114" value="&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;示例演示&lt;/b&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="P8bKrxKqJgt3pFntmFku-112" vertex="1" connectable="0">
          <mxGeometry x="0.0452" y="-3" relative="1" as="geometry">
            <mxPoint y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-110" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Syntax&amp;nbsp; &amp;nbsp; error_page &lt;/b&gt;code ... [=[reponse]] uri;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Default&amp;nbsp; &amp;nbsp; —&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Context&amp;nbsp; &amp;nbsp;&lt;/b&gt;http,&amp;nbsp;server, location, if in location&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="9394.82" y="3046" width="370" height="120.5" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-111" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;例子：&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;1. error_page 404 /404.html;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;2. error_page 500 502 503 504 /50x.html&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;3. error_page 404 =200 /empty.git;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;4. error_page 404 =/404.php;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;5. location / {&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; error_page 404=@fallback;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;&amp;nbsp; }&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;&amp;nbsp; location@fallback {&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; proxy_pass http://backend;&amp;nbsp;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;&amp;nbsp; }&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;6. error_page 403 http://example.com/forbidden.html&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;7. error_page 404=301 http://example.com/nofound.html&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="9332" y="3244" width="495.63" height="366" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-118" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-116" target="P8bKrxKqJgt3pFntmFku-117" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-116" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;实验对比：error_page 和 return的优先级&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="12482.5" y="2843" width="458" height="90" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-120" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-117" target="P8bKrxKqJgt3pFntmFku-119" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-117" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;server&lt;/span&gt; {                                                                                                                                                                                                                                                                      &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;server_name&lt;/span&gt; &lt;span style=&quot;&quot;&gt;return&lt;/span&gt;.mystical.tech;                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;listen&lt;/span&gt; &lt;span style=&quot;&quot;&gt;8080&lt;/span&gt;;                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;root&lt;/span&gt; html/;                                                                                                                                                                                                                                                               &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;error_page&lt;/span&gt; &lt;span style=&quot;&quot;&gt;404&lt;/span&gt; /&lt;span style=&quot;&quot;&gt;403&lt;/span&gt;.html;                                                                                                                                                                                                                                                 &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;    #return 405&lt;/span&gt;                                                                                                                                                                                                                                                               &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;location&lt;/span&gt; / {                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;        #return 404 &quot;find nothing!\n&quot;;&lt;/span&gt;                                                                                                                                                                                                                                        &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;} &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="12451" y="3046" width="521" height="318" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-119" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;结果:&lt;/b&gt;&lt;/span&gt;&lt;div style=&quot;line-height: 200%;&quot;&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;return 的优先级高于 error_page&lt;br&gt;而在http11个阶段中，server_rewrite先于rewrite&lt;br&gt;因此，return405 优先级高于 return 404 ...&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="12471.5" y="3449" width="480" height="155" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-122" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="1" source="P8bKrxKqJgt3pFntmFku-121" target="P8bKrxKqJgt3pFntmFku-116" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-162" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-121" target="P8bKrxKqJgt3pFntmFku-160" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-185" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-121" target="P8bKrxKqJgt3pFntmFku-184" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-121" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;实验演示&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#6a00ff;strokeColor=#3700CC;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="13337" y="2713" width="194" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-152" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-123" target="P8bKrxKqJgt3pFntmFku-126" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-153" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-123" target="P8bKrxKqJgt3pFntmFku-125" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-154" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-123" target="P8bKrxKqJgt3pFntmFku-127" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-123" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Syntax&amp;nbsp; &amp;nbsp; rewrite &lt;/b&gt;regex replacement [flag];&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Default&amp;nbsp; &amp;nbsp; —&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Context&amp;nbsp; &amp;nbsp;&lt;/b&gt;server, location, if in location&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="10288.5" y="3042.75" width="370" height="120.5" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-130" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-125" target="P8bKrxKqJgt3pFntmFku-129" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-125" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;regex解析&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="9972" y="3226" width="184.5" height="69" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-150" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-126" target="P8bKrxKqJgt3pFntmFku-131" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-126" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;replacement解析&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="10381.25" y="3226" width="184.5" height="69" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-151" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-127" target="P8bKrxKqJgt3pFntmFku-132" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-127" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;flag解析&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="10809.75" y="3226" width="184.5" height="69" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-129" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;将regex指定的URL替换成replacement这个新的URL&lt;br&gt;--可以使用正则表达式及变量提取&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="9877.75" y="3364" width="373" height="102" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-131" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;当replacement以http://或者https://或者$schema开头&lt;br&gt;则直接返回302重定向&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="10266" y="3364" width="415" height="102" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-146" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-132" target="P8bKrxKqJgt3pFntmFku-134" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-147" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-132" target="P8bKrxKqJgt3pFntmFku-133" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-148" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-132" target="P8bKrxKqJgt3pFntmFku-135" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-149" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-132" target="P8bKrxKqJgt3pFntmFku-136" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-132" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;替换后的URL根据flag指定的方式进行处理&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="10695" y="3365" width="415" height="102" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-142" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-133" target="P8bKrxKqJgt3pFntmFku-137" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-133" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;--last&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="10395" y="3538" width="117" height="51" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-143" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-134" target="P8bKrxKqJgt3pFntmFku-138" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-134" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;--break&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="10843.5" y="3538" width="117" height="51" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-144" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-135" target="P8bKrxKqJgt3pFntmFku-139" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-135" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;--redirect&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="11194.5" y="3538" width="117" height="51" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-145" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-136" target="P8bKrxKqJgt3pFntmFku-140" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-136" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;--permanent&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="11414.5" y="3538" width="117" height="51" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-137" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;用replacement这个URL进行新的location匹配&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="10256" y="3639" width="395" height="92" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-138" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;break指令停止当前脚本指令的执行，等价于独立的break指令&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="10668.5" y="3639" width="467" height="92" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-139" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;返回 302 重定向&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="11155.5" y="3637" width="195" height="92" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-140" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;返回 301 重定向&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="11375.5" y="3637" width="195" height="92" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-163" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-160" target="P8bKrxKqJgt3pFntmFku-161" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-160" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;实验对比：rewrite综合实验配置&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="13204" y="2846" width="458" height="90" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-161" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;server&lt;/span&gt; {                                                                                                                                                                                                                                                                      &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;server_name&lt;/span&gt; &lt;span style=&quot;&quot;&gt;rewrite&lt;/span&gt;.mystical.tech;                                                                                                                                                                                                                                        &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;font-weight: bold;&quot;&gt;rewrite_log&lt;/span&gt; &lt;span style=&quot;&quot;&gt;on&lt;/span&gt;;                                                                                                                                                                                                                                                           &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;font-weight: bold;&quot;&gt;error_log&lt;/span&gt; logs/rewrite_error.log &lt;span style=&quot;font-weight: bold;&quot;&gt;notice&lt;/span&gt;;                                                                                                                                                                                                                                  &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;root&lt;/span&gt; html/;                                                                                                                                                                                                                                                               &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;location&lt;/span&gt; /first {                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;rewrite&lt;/span&gt; /first(.*) /second&lt;span style=&quot;font-weight: bold;&quot;&gt;$1&lt;/span&gt; last;                                                                                                                                                                                                                                    &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;&quot;&gt;200&lt;/span&gt; &lt;span style=&quot;&quot;&gt;&#39;first!\n&#39;&lt;/span&gt;;                                                                                                                                                                                                                                                &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;location&lt;/span&gt; /second {                                                                                                                                                                                                                                                        &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;rewrite&lt;/span&gt; /second(.*) /third&lt;span style=&quot;font-weight: bold;&quot;&gt;$1&lt;/span&gt; &lt;span style=&quot;&quot;&gt;break&lt;/span&gt;;                                                                                                                                                                                                                                   &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;        #rewrite /second(.*) /third$1;&lt;/span&gt;                                                                                                                                                                                                                                        &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;&quot;&gt;200&lt;/span&gt; &lt;span style=&quot;&quot;&gt;&#39;second!\n&#39;&lt;/span&gt;;                                                                                                                                                                                                                                               &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;location&lt;/span&gt; /third {                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;&quot;&gt;200&lt;/span&gt; &lt;span style=&quot;&quot;&gt;&#39;third!\n&#39;&lt;/span&gt;;                                                                                                                                                                                                                                                &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;location&lt;/span&gt; /redirect1 {                                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;rewrite&lt;/span&gt; /redirect1(.*) &lt;span style=&quot;font-weight: bold;&quot;&gt;$1&lt;/span&gt; permanent;                                                                                                                                                                                                                                  &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;location&lt;/span&gt; /redirect2 {                                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;rewrite&lt;/span&gt; /redirect2(.*) &lt;span style=&quot;font-weight: bold;&quot;&gt;$1&lt;/span&gt; redirect;                                                                                                                                                                                                                                   &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;location&lt;/span&gt; /redirect3 {                                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;rewrite&lt;/span&gt; /redirect3(.*) http://&lt;span style=&quot;&quot;&gt;rewrite&lt;/span&gt;.mystical.tech&lt;span style=&quot;font-weight: bold;&quot;&gt;$1&lt;/span&gt;;                                                                                                                                                                                                                &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;                                                                                                                                                                                                                                                                              &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;location&lt;/span&gt; /redirect4 {                                                                                                                                                                                                                                                     &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;rewrite&lt;/span&gt; /redirect4(.*) http://&lt;span style=&quot;&quot;&gt;rewrite&lt;/span&gt;.mystical.tech&lt;span style=&quot;font-weight: bold;&quot;&gt;$1&lt;/span&gt; permanent;                                                                                                                                                                                                      &lt;/div&gt;&lt;div&gt;    }                                                                                                                                                                                                                                                                         &lt;/div&gt;&lt;div&gt;} &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;spacingLeft=30;fontColor=default;glass=0;arcSize=7;" parent="1" vertex="1">
          <mxGeometry x="13025.5" y="2986" width="815" height="948" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-89" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-81" target="P8bKrxKqJgt3pFntmFku-84" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-108" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-84" target="P8bKrxKqJgt3pFntmFku-107" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-109" value="&lt;b&gt;&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 16px;&quot;&gt;含义解析&lt;/font&gt;&lt;/b&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="P8bKrxKqJgt3pFntmFku-108" vertex="1" connectable="0">
          <mxGeometry x="-0.2039" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-169" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-166" target="P8bKrxKqJgt3pFntmFku-168" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-166" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Syntax&amp;nbsp; &amp;nbsp; if&lt;/b&gt; (condition) {...};&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Default&amp;nbsp; &amp;nbsp; —&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;Context&amp;nbsp; &amp;nbsp;&lt;/b&gt;server, location&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=30;" parent="1" vertex="1">
          <mxGeometry x="11890" y="3042.75" width="370" height="120.5" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-171" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-168" target="P8bKrxKqJgt3pFntmFku-170" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-168" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;if指令的条件表达式&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="11982.75" y="3226" width="184.5" height="69" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-173" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-170" target="P8bKrxKqJgt3pFntmFku-172" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-170" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;1. 检查变量为空或者是否为0，直接使用&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="11808.5" y="3343" width="533" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-175" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-172" target="P8bKrxKqJgt3pFntmFku-174" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-172" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;2. 将变量与字符串匹配，使用 = 或者 !=&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="11808.5" y="3445" width="533" height="53" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-180" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-174" target="P8bKrxKqJgt3pFntmFku-176" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-174" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;3. 将变量与正则表达式做匹配&lt;br&gt;大小写敏感，~ 或者 !~&lt;br&gt;大小写不敏感, ~* 或者 !~*&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="11808.5" y="3542" width="533" height="108" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-181" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-176" target="P8bKrxKqJgt3pFntmFku-177" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-176" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;4. 检查是否是普通文件，使用 -f 或者 !-f&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="11808.5" y="3694" width="533" height="52" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-182" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-177" target="P8bKrxKqJgt3pFntmFku-178" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-177" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;5. 检查是否是目录文件，使用 -d 或者 !-d&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="11808.5" y="3791" width="533" height="52" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-183" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-178" target="P8bKrxKqJgt3pFntmFku-179" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-178" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;6. 检查文件、目录、软链接是否存在，使用 -e 或者 !-e&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="11808.5" y="3888" width="533" height="52" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-179" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font face=&quot;monospace&quot;&gt;&lt;b&gt;7. 检查是否为可执行文件，使用 -x 或者 !-x&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;align=center;spacingLeft=0;" parent="1" vertex="1">
          <mxGeometry x="11808.5" y="3985" width="533" height="52" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-188" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-184" target="P8bKrxKqJgt3pFntmFku-186" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-184" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;if指令的条件表达式&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="14057" y="2846" width="458" height="90" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-186" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;div&gt;if ($http_user_agent ~ MSIE) {&lt;/div&gt;&lt;div&gt;        rewrite ^(.*)$ /msie/$1 break;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if ($http_cookie ~* &quot;id=([^;]+)(?:;|$)&quot;) {&lt;/div&gt;&lt;div&gt;        set $id $1;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if ($request_method = POST) {&lt;/div&gt;&lt;div&gt;        return 405;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if ($slow) {&lt;/div&gt;&lt;div&gt;        limit_rate 10k;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if ($invalid_referer) {&lt;/div&gt;&lt;div&gt;        return 403;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;spacingLeft=30;fontColor=default;glass=0;arcSize=7;" parent="1" vertex="1">
          <mxGeometry x="13878.5" y="2986" width="815" height="504" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-194" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-190" target="P8bKrxKqJgt3pFntmFku-191" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-190" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;location匹配优先级&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="15407" y="2515" width="223" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-195" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-191" target="P8bKrxKqJgt3pFntmFku-192" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-191" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;匹配上=字符串&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="15407" y="2694" width="223" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-202" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-192" target="P8bKrxKqJgt3pFntmFku-197" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-203" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-192" target="P8bKrxKqJgt3pFntmFku-198" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-205" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-192" target="P8bKrxKqJgt3pFntmFku-204" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-192" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;前缀匹配（普通前缀与 &lt;code data-end=&quot;103&quot; data-start=&quot;99&quot;&gt;^~&lt;/code&gt; 都算前缀）&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="15321" y="2891" width="395" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-197" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;先在所有&lt;span data-end=&quot;128&quot; data-start=&quot;121&quot;&gt;非正则&lt;/span&gt;的 &lt;code data-end=&quot;140&quot; data-start=&quot;130&quot;&gt;location&lt;/code&gt; 里选出&lt;span data-end=&quot;152&quot; data-start=&quot;144&quot;&gt;最长前缀&lt;/span&gt;作为“候选”&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="15818" y="2831" width="520" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-198" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;如果这个“候选”本身带 &lt;span data-end=&quot;187&quot; data-start=&quot;179&quot;&gt;&lt;code data-end=&quot;185&quot; data-start=&quot;181&quot;&gt;^~&lt;/code&gt;&lt;/span&gt;，就&lt;span data-end=&quot;200&quot; data-start=&quot;189&quot;&gt;直接用它并停止&lt;/span&gt;（跳过正则阶段）&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="15818" y="2943" width="596" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-210" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-204" target="P8bKrxKqJgt3pFntmFku-207" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-211" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="1" source="P8bKrxKqJgt3pFntmFku-204" target="P8bKrxKqJgt3pFntmFku-208" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-204" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;正则匹配 &lt;code data-end=&quot;224&quot; data-start=&quot;221&quot;&gt;~&lt;/code&gt; / &lt;code data-end=&quot;231&quot; data-start=&quot;227&quot;&gt;~*&lt;/code&gt;&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="15321" y="3123.25" width="395" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-207" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;按&lt;span data-end=&quot;277&quot; data-start=&quot;269&quot;&gt;书写顺序&lt;/span&gt;逐个测试，&lt;span data-end=&quot;291&quot; data-start=&quot;282&quot;&gt;第一个命中&lt;/span&gt;的正则胜出。&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="15826" y="3067" width="520" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-208" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;strong data-end=&quot;312&quot; data-start=&quot;302&quot;&gt;没有正则命中&lt;/strong&gt; → 回退到第 2 步找到的&lt;strong data-end=&quot;334&quot; data-start=&quot;326&quot;&gt;最长前缀&lt;/strong&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="15826" y="3180" width="520" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-85" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="4563" y="4428" width="11646.5" height="1362" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-232" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#005700;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#008a00;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-212" target="P8bKrxKqJgt3pFntmFku-213" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-212" value="&lt;b style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 23px;&quot;&gt;limit_conn 模块&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="6425.25" y="-12" width="204.5" height="84" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-231" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#005700;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#008a00;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-213" target="P8bKrxKqJgt3pFntmFku-214" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-41" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#005700;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#008a00;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-213" target="P8bKrxKqJgt3pFntmFku-233" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-74" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#005700;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#008a00;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-213" target="kHOiAii6a3aHT2yN3Jd0-42" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-84" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#005700;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#008a00;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-213" target="kHOiAii6a3aHT2yN3Jd0-73" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-213" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;限制客户端并发连接数&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="6328.5" y="136" width="398" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-227" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6F0000;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#a20025;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-214" target="P8bKrxKqJgt3pFntmFku-216" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-228" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6F0000;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#a20025;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-214" target="P8bKrxKqJgt3pFntmFku-217" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-229" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#6F0000;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#a20025;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-214" target="P8bKrxKqJgt3pFntmFku-215" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-230" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6F0000;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#a20025;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-214" target="P8bKrxKqJgt3pFntmFku-218" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-214" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;限制客户端并发连接数的意义&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#a20025;strokeColor=#6F0000;fontColor=#ffffff;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="1016.5" y="298" width="309.5" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-220" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d6b656;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#fff2cc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-215" target="P8bKrxKqJgt3pFntmFku-219" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-215" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;公平性&lt;br&gt;（per-IP 不要吃独食）&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="80" y="486" width="280" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-222" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d6b656;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#fff2cc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-216" target="P8bKrxKqJgt3pFntmFku-221" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-216" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;稳定性&lt;br&gt;（保护后端并发上限）&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="713" y="486" width="235" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-224" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#d6b656;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#fff2cc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-217" target="P8bKrxKqJgt3pFntmFku-223" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-217" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;成本控制（FD/内存）&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="1376.5" y="486" width="235" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-226" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-218" target="P8bKrxKqJgt3pFntmFku-225" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-218" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;抑制异常/滥用&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="1953.5" y="486" width="235" height="72" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-219" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;防止单个 IP（含 NAT/校园网/小区出口）&lt;br&gt;占满 Nginx/上游的并发额度，避免“好人被拖慢”。&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry y="629" width="440" height="100" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-221" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;上游常常有&lt;strong data-end=&quot;250&quot; data-start=&quot;240&quot;&gt;线程/连接池&lt;/strong&gt;或&lt;strong data-end=&quot;261&quot; data-start=&quot;251&quot;&gt;DB 连接池&lt;/strong&gt;上限。&lt;br&gt;&lt;code data-end=&quot;276&quot; data-start=&quot;264&quot;&gt;limit_conn&lt;/code&gt; 把前门的“正在处理的请求数”卡住，减少“过载→排队→超时→雪崩”。&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="465" y="629" width="731" height="100" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-223" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;每个活动请求都会占用&lt;strong data-end=&quot;363&quot; data-start=&quot;346&quot;&gt;文件描述符、缓冲区、上下文&lt;/strong&gt;等。&lt;br&gt;限制并发=限制瞬时资源占用峰值。&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="1233" y="629" width="522" height="100" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-225" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;爬虫/脚本并发冲击、错误重试风暴、WebSocket/长轮询泛滥、&lt;br&gt;HTTP/2 并发流滥用，都能被“并发上限”硬性约束。&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="1784.5" y="629" width="572" height="100" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-34" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-233" target="kHOiAii6a3aHT2yN3Jd0-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-35" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-233" target="kHOiAii6a3aHT2yN3Jd0-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-36" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-233" target="kHOiAii6a3aHT2yN3Jd0-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-37" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-233" target="P8bKrxKqJgt3pFntmFku-234" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-38" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-233" target="kHOiAii6a3aHT2yN3Jd0-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-39" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-233" target="kHOiAii6a3aHT2yN3Jd0-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-40" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-233" target="kHOiAii6a3aHT2yN3Jd0-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-233" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;关于并发连接数的注意事项&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="4479.620000000001" y="298" width="309.5" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-12" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-234" target="kHOiAii6a3aHT2yN3Jd0-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-13" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="P8bKrxKqJgt3pFntmFku-234" target="kHOiAii6a3aHT2yN3Jd0-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P8bKrxKqJgt3pFntmFku-234" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;别把值设太低&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="2696.5" y="486" width="235" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-16" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-1" target="kHOiAii6a3aHT2yN3Jd0-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-1" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;按业务分区限&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="3369.25" y="484.5" width="235" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-18" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-2" target="kHOiAii6a3aHT2yN3Jd0-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-2" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;配合 &lt;code data-end=&quot;886&quot; data-start=&quot;875&quot;&gt;limit_req&lt;/code&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="3933.75" y="486" width="235" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-22" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-3" target="kHOiAii6a3aHT2yN3Jd0-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-3" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;有授权体系就“按用户限”&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="4501.870000000001" y="486" width="265" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-24" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-4" target="kHOiAii6a3aHT2yN3Jd0-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-4" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;如果前面有 WAF/CDN/负载均衡&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="5049" y="484.5" width="335" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-28" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-5" target="kHOiAii6a3aHT2yN3Jd0-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-5" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;先观察再上限&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="5688.5" y="486" width="231" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-33" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-7" target="kHOiAii6a3aHT2yN3Jd0-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-7" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;HTTP/2/3 的并发流上限&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="6318.5" y="484.5" width="231" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-8" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;H1 站点：每 IP 起步放到 &lt;strong data-end=&quot;695&quot; data-start=&quot;686&quot;&gt;20~50&lt;/strong&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="2449.5" y="647" width="317" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-9" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;H2/H3 站点：考虑 &lt;strong data-end=&quot;725&quot; data-start=&quot;715&quot;&gt;50~100&lt;br&gt;&lt;/strong&gt;（因为“并发流”计数更容易被顶满）。&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="2811.5" y="647" width="373" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-14" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;只在动态接口（如 &lt;code data-end=&quot;811&quot; data-start=&quot;804&quot;&gt;/api/&lt;/code&gt;、&lt;code data-end=&quot;820&quot; data-start=&quot;812&quot;&gt;/login&lt;/code&gt;）应用 &lt;code data-end=&quot;836&quot; data-start=&quot;824&quot;&gt;limit_conn&lt;/code&gt;，&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;strong data-end=&quot;845&quot; data-start=&quot;837&quot;&gt;静态资源&lt;/strong&gt;不做或放宽，避免页面静态资源把并发占满。&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="3224.5" y="647" width="524.5" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-17" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;code data-end=&quot;906&quot; data-start=&quot;894&quot;&gt;limit_conn&lt;/code&gt; 限并发，“&lt;strong data-end=&quot;923&quot; data-start=&quot;912&quot;&gt;多少条正在处理&lt;/strong&gt;”；&lt;br&gt;&lt;code data-end=&quot;936&quot; data-start=&quot;925&quot;&gt;limit_req&lt;/code&gt; 限速，“&lt;strong data-end=&quot;951&quot; data-start=&quot;941&quot;&gt;每秒多少请求&lt;/strong&gt;”。两者配合更稳妥&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="3789" y="640" width="524.5" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-21" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-19" target="kHOiAii6a3aHT2yN3Jd0-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-19" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;如果能从 Cookie/JWT 识别用户，&lt;br&gt;可改成“&lt;strong data-end=&quot;1127&quot; data-start=&quot;1094&quot;&gt;按用户（Token）限 + 无 Token 时按 IP 限&lt;/strong&gt;”，更公平&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="4353.5" y="640" width="561.75" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-20" value="&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;# 取 Cookie 中的 sessionid 作为 key，没取到就回落到 IP&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;map $http_cookie $limit_key {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&amp;nbsp; &amp;nbsp; ~*sessionid=([^;]+)&amp;nbsp; &amp;nbsp;$1;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&amp;nbsp; &amp;nbsp; default&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;$binary_remote_addr;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;}&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;limit_conn_zone $limit_key zone=peruser:20m;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;server {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&amp;nbsp; &amp;nbsp; # 每用户(或IP)最多 50 并发&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&amp;nbsp; &amp;nbsp; limit_conn peruser 50;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;arcSize=9;align=left;spacingLeft=30;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="4355.370000000001" y="781" width="558" height="448" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-26" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-23" target="kHOiAii6a3aHT2yN3Jd0-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-23" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;一定要先&lt;strong data-end=&quot;1481&quot; data-start=&quot;1467&quot;&gt;还原真实客户端 IP&lt;/strong&gt;，&lt;br&gt;否则所有请求都被算在“WAF 的那几个出口 IP”上&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="4969.5" y="640" width="494" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-25" value="&lt;div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;# 替换为你的 WAF/LB 出口网段&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;set_real_ip_from 203.0.113.0/24;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;real_ip_header X-Forwarded-For;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;real_ip_recursive on;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;arcSize=9;align=left;spacingLeft=30;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="4937.5" y="786" width="558" height="225" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-30" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-27" target="kHOiAii6a3aHT2yN3Jd0-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-27" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;先启用“演练模式”收集数据，再决定阈值&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="5557" y="647" width="494" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-29" value="&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;limit_conn_dry_run on;&amp;nbsp; &amp;nbsp; &amp;nbsp; # 只记录超限，不真正拒绝&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;limit_conn_log_level warn;&amp;nbsp; # 超限时给出 warn 日志&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;arcSize=9;align=left;spacingLeft=30;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="5525" y="786" width="558" height="225" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-31" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-5" target="kHOiAii6a3aHT2yN3Jd0-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-32" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;可以通过 &lt;code data-end=&quot;1911&quot; data-start=&quot;1881&quot;&gt;http2_max_concurrent_streams&lt;/code&gt; 控制单连接内的并发流数量，&lt;br&gt;避免单连接把 &lt;code data-end=&quot;1944&quot; data-start=&quot;1932&quot;&gt;limit_conn&lt;/code&gt; 的额度吃光（常见 100~128 起步）。&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="6097.5" y="647" width="673" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-70" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-42" target="kHOiAii6a3aHT2yN3Jd0-45" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-71" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-42" target="kHOiAii6a3aHT2yN3Jd0-43" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-72" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-42" target="kHOiAii6a3aHT2yN3Jd0-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-42" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;如何使用&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d80073;strokeColor=#A50040;fontColor=#ffffff;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="8149.5" y="298" width="245" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-66" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-43" target="kHOiAii6a3aHT2yN3Jd0-53" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-67" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-43" target="kHOiAii6a3aHT2yN3Jd0-60" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-68" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-43" target="kHOiAii6a3aHT2yN3Jd0-52" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-69" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-43" target="kHOiAii6a3aHT2yN3Jd0-63" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-43" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;相关指令&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="8793" y="484.5" width="231" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-44" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;默认编译进Nginx&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="6986.5" y="484.5" width="231" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-49" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-45" target="kHOiAii6a3aHT2yN3Jd0-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-50" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-45" target="kHOiAii6a3aHT2yN3Jd0-46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-51" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-45" target="kHOiAii6a3aHT2yN3Jd0-48" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-45" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;生效范围&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="7323" y="486" width="231" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-46" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;全部worker进程&lt;br&gt;（基于共享内存）&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="7043.5" y="647" width="231" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-47" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;进入preaccess阶段不生效&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="7304.5" y="647" width="268" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-48" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;限制的有效性取决于key的设计&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="7602.5" y="647" width="305" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-57" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-52" target="kHOiAii6a3aHT2yN3Jd0-55" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-52" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;定义共享内存（包括大小）&lt;/b&gt;&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;以及key关键字&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="7960.5" y="643" width="305" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-59" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-53" target="kHOiAii6a3aHT2yN3Jd0-58" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-53" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;限制并发连接数&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="8475" y="643" width="305" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-55" value="&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;syntax:&amp;nbsp; &amp;nbsp; limit_conn_zone&lt;span style=&quot;font-weight: normal;&quot;&gt; key zone=name:size;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Default:&lt;span style=&quot;font-weight: normal;&quot;&gt;&amp;nbsp; &amp;nbsp; —&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Context:&lt;span style=&quot;font-weight: normal;&quot;&gt;&amp;nbsp; &amp;nbsp;http&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;arcSize=9;align=left;spacingLeft=30;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="7878" y="786" width="470" height="169" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-56" value="Text" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="6435.5" y="962" width="38" height="25" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-58" value="&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;syntax:&amp;nbsp; &amp;nbsp; limit_conn &lt;span style=&quot;font-weight: normal;&quot;&gt;zone number;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Default:&lt;span style=&quot;font-weight: normal;&quot;&gt;&amp;nbsp; &amp;nbsp; —&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Context:&lt;span style=&quot;font-weight: normal;&quot;&gt;&amp;nbsp; &amp;nbsp;http,server,location&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;arcSize=9;align=left;spacingLeft=30;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="8386.5" y="822" width="470" height="169" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-65" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-60" target="kHOiAii6a3aHT2yN3Jd0-61" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-60" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;限制发生时的日志级别&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="9018" y="643" width="305" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-61" value="&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;syntax:&amp;nbsp; &amp;nbsp; limit_conn_log_level &lt;span style=&quot;font-weight: normal;&quot;&gt;info | notice | warn | error;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Default:&lt;span style=&quot;font-weight: normal;&quot;&gt;&amp;nbsp; &amp;nbsp; limit_conn_log_level error&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Context:&lt;span style=&quot;font-weight: normal;&quot;&gt;&amp;nbsp; &amp;nbsp;http,server,location&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;arcSize=9;align=left;spacingLeft=30;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="8894.5" y="786" width="552" height="169" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-62" value="&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;syntax:&amp;nbsp; &amp;nbsp; &amp;nbsp;limit_conn_status &lt;span style=&quot;font-weight: normal;&quot;&gt;code;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Default:&lt;span style=&quot;font-weight: normal;&quot;&gt;&amp;nbsp; &amp;nbsp; limit_conn_status 503&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Context:&lt;span style=&quot;font-weight: normal;&quot;&gt;&amp;nbsp; &amp;nbsp;http,server,location&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;arcSize=9;align=left;spacingLeft=30;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="9468.5" y="786" width="552" height="169" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-64" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#A50040;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#d80073;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-63" target="kHOiAii6a3aHT2yN3Jd0-62" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-63" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;限制发生时向客户端返回的错误码&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="9592" y="643" width="305" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-82" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-73" target="kHOiAii6a3aHT2yN3Jd0-78" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-83" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-73" target="kHOiAii6a3aHT2yN3Jd0-77" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-73" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;实验演示&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#6a00ff;strokeColor=#3700CC;fontColor=#ffffff;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="10780.5" y="301" width="245" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-75" value="&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;[root@ubuntu2204 nginx]#&lt;/span&gt;cat conf.d/limit_conn.conf                                                                                  &lt;/div&gt;&lt;div&gt;limit_conn_zone $binary_remote_addr zone=addr:10m;                                                                                  &lt;/div&gt;&lt;div&gt;                                                                                                                                    &lt;/div&gt;&lt;div&gt;server {                                                                                                                            &lt;/div&gt;&lt;div&gt;    server_name limit.mystical.tech;                                                                                                &lt;/div&gt;&lt;div&gt;    root html/;                                                                                                                     &lt;/div&gt;&lt;div&gt;    error_log logs/myerror.log info;                                                                                                &lt;/div&gt;&lt;div&gt;                                                                                                                                    &lt;/div&gt;&lt;div&gt;    location / {                                                                                                                    &lt;/div&gt;&lt;div&gt;        limit_conn_status 500;                                                                                                      &lt;/div&gt;&lt;div&gt;        limit_conn_log_level warn;                                                                                                  &lt;/div&gt;&lt;div&gt;        limit_rate 10;   # 限制向用户返回响应的速度，每秒只返回50个字节                                                             &lt;/div&gt;&lt;div&gt;        limit_conn addr 1;                                                                                                          &lt;/div&gt;&lt;div&gt;    }                                                                                                                               &lt;/div&gt;&lt;div&gt;} &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1;arcSize=9;align=left;spacingLeft=30;fontColor=default;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="10921.5" y="643" width="725" height="402" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-81" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-77" target="kHOiAii6a3aHT2yN3Jd0-75" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-77" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;服务端配置&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="11168.5" y="486" width="231" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-80" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#9673a6;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#e1d5e7;" parent="kHOiAii6a3aHT2yN3Jd0-85" source="kHOiAii6a3aHT2yN3Jd0-78" target="kHOiAii6a3aHT2yN3Jd0-79" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-78" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;客户端访问&lt;br&gt;（开两个终端访问）&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=0" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="10366.5" y="484.5" width="231" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-79" value="&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;// 终端1&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;br&gt;[root@NAT ~]#&lt;/span&gt;curl limit.mystical.tech                                                                                               &lt;/div&gt;&lt;div&gt;hello, mystical                                                                                                                     &lt;/div&gt;&lt;div&gt;hello, mystical  &lt;br&gt;......&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;// 终端2&lt;/div&gt;&lt;div&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;span style=&quot;&quot;&gt;[root@NAT ~]#&lt;/span&gt;curl limit.mystical.tech&lt;/div&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;span style=&quot;background-color: rgba(0, 0, 0, 0); white-space: normal;&quot;&gt;......&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;span style=&quot;background-color: rgba(0, 0, 0, 0); white-space: normal;&quot;&gt;500 Internal Server Error&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;span style=&quot;background-color: rgba(0, 0, 0, 0); white-space: normal;&quot;&gt;......&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1;arcSize=9;align=left;spacingLeft=30;fontColor=default;" parent="kHOiAii6a3aHT2yN3Jd0-85" vertex="1">
          <mxGeometry x="10119.5" y="643" width="725" height="371" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-138" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="4537" y="6141" width="4683.5" height="1186" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-88" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#005700;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#008a00;" parent="UmAkyeazDkvLk_dYHvyL-138" source="kHOiAii6a3aHT2yN3Jd0-86" target="kHOiAii6a3aHT2yN3Jd0-87" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-86" value="&lt;b style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 23px;&quot;&gt;limit_req 模块&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="1930.25" width="204.5" height="84" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-135" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="kHOiAii6a3aHT2yN3Jd0-87" target="UmAkyeazDkvLk_dYHvyL-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-136" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="kHOiAii6a3aHT2yN3Jd0-87" target="UmAkyeazDkvLk_dYHvyL-126" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-137" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="kHOiAii6a3aHT2yN3Jd0-87" target="UmAkyeazDkvLk_dYHvyL-107" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kHOiAii6a3aHT2yN3Jd0-87" value="&lt;span style=&quot;font-size: 23px;&quot;&gt;&lt;b&gt;限制客户端每秒处理的请求数&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#008a00;strokeColor=#005700;fontColor=#ffffff;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="1798" y="152" width="469" height="84" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-106" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-1" target="UmAkyeazDkvLk_dYHvyL-104" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-1" value="&lt;span style=&quot;font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; orphans: 4; text-align: start; white-space-collapse: preserve;&quot;&gt;&lt;b style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 21px;&quot;&gt;leaky bucket算法&lt;/font&gt;&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="202.5" y="364.5" width="270" height="85" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-104" value="&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;对于突发流量，使用 Leaky Bucket 可以把它限制为每秒处理一定流量&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;limit_requset 可以把突发流量限制为每秒处理多少个请求&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry y="515.5" width="675" height="100" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-109" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-107" target="UmAkyeazDkvLk_dYHvyL-108" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-107" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;如何使用&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#d80073;strokeColor=#A50040;fontColor=#ffffff;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="1910" y="367" width="245" height="72" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-122" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-108" target="UmAkyeazDkvLk_dYHvyL-111" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-123" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-108" target="UmAkyeazDkvLk_dYHvyL-112" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-124" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-108" target="UmAkyeazDkvLk_dYHvyL-110" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-125" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-108" target="UmAkyeazDkvLk_dYHvyL-113" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-108" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;相关指令&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="1917" y="524" width="231" height="72" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-117" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-110" target="UmAkyeazDkvLk_dYHvyL-114" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-110" value="&lt;strong style=&quot;box-sizing: border-box; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;SF Pro&amp;quot;, sans-serif; font-size: 19px; orphans: 4; white-space-collapse: preserve;&quot;&gt;定义共享内存（包括大小）&lt;br&gt;以及 key 关键字和限制速率&lt;/strong&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0;align=center;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="857" y="726" width="329" height="72" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-116" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-111" target="UmAkyeazDkvLk_dYHvyL-115" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-111" value="&lt;div style=&quot;orphans: 4; text-align: start;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 19px; white-space-collapse: preserve;&quot;&gt;&lt;font face=&quot;Open Sans, Clear Sans, Helvetica Neue, Helvetica, Arial, Segoe UI Emoji, SF Pro, sans-serif&quot; color=&quot;#333333&quot;&gt;&lt;b&gt;限制并发连接数&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="1552.5" y="726" width="236" height="72" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-119" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-112" target="UmAkyeazDkvLk_dYHvyL-118" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-112" value="&lt;div style=&quot;orphans: 4; text-align: start;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 19px; white-space-collapse: preserve;&quot;&gt;&lt;font face=&quot;Open Sans, Clear Sans, Helvetica Neue, Helvetica, Arial, Segoe UI Emoji, SF Pro, sans-serif&quot; color=&quot;#333333&quot;&gt;&lt;b&gt;限制发生时的日志级别&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="2250.25" y="726" width="236" height="72" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-121" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-113" target="UmAkyeazDkvLk_dYHvyL-120" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-113" value="&lt;div style=&quot;orphans: 4;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 19px; white-space-collapse: preserve;&quot;&gt;&lt;font color=&quot;#333333&quot; face=&quot;Open Sans, Clear Sans, Helvetica Neue, Helvetica, Arial, Segoe UI Emoji, SF Pro, sans-serif&quot;&gt;&lt;b&gt;限制发生时向客户端&lt;br&gt;返回错误码&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0;align=center;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="2790.5" y="726" width="236" height="72" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-114" value="&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&amp;nbsp;# rate单位为 r/s 或者 r/m&lt;/span&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;br&gt;Syntax:&amp;nbsp; &amp;nbsp;limit_req_zone &lt;span style=&quot;font-weight: normal;&quot;&gt;key zone=name:size rate=rate&lt;/span&gt;;&amp;nbsp;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Default:&amp;nbsp; &amp;nbsp;—&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Context:&amp;nbsp; http&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;arcSize=9;align=left;spacingLeft=30;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="747" y="881" width="549" height="169" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-115" value="&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;# burst 默认为0&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;# nodelay，对burst中的请求不再采用延时处理的做法，而是立刻处理&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Syntax:&amp;nbsp; limit_req &lt;span style=&quot;font-weight: normal;&quot;&gt;zone=name [burst=number] [nodelay];&lt;/span&gt;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Default: ——&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Context: http,server,location&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;arcSize=9;align=left;spacingLeft=30;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="1342" y="881" width="657" height="169" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-118" value="&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Syntax:&amp;nbsp; limit_req_log_level info | notice | warn | error;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Default: limit_req_log_level error;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Context: http,server,location&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;arcSize=9;align=left;spacingLeft=30;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="2041" y="881" width="657" height="169" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-120" value="&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Syntax:&amp;nbsp; limit_red_status code;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Default: limit_red_status 503;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 19px;&quot;&gt;Context: http,server,location&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;arcSize=9;align=left;spacingLeft=30;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="2740" y="881" width="338" height="169" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-133" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-126" target="UmAkyeazDkvLk_dYHvyL-127" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-134" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-126" target="UmAkyeazDkvLk_dYHvyL-130" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-126" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;实验演示&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#6a00ff;strokeColor=#3700CC;fontColor=#ffffff;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="3850" y="364.5" width="245" height="72" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-129" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-127" target="UmAkyeazDkvLk_dYHvyL-128" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-127" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;服务端配置&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=0" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="3425" y="530" width="231" height="72" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-128" value="&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;limit_conn_zone&lt;/span&gt; &lt;span style=&quot;&quot;&gt;$binary_remote_addr&lt;/span&gt; &lt;span style=&quot;&quot;&gt;zone&lt;/span&gt;=addr:&lt;span style=&quot;&quot;&gt;10m&lt;/span&gt;;                                                                                  &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;limit_req_zone&lt;/span&gt; &lt;span style=&quot;&quot;&gt;$binary_remote_addr&lt;/span&gt; &lt;span style=&quot;&quot;&gt;zone&lt;/span&gt;=one:&lt;span style=&quot;&quot;&gt;10m&lt;/span&gt; rate=&lt;span style=&quot;&quot;&gt;6r&lt;/span&gt;/m;                                                                          &lt;/div&gt;&lt;div&gt;                                                                                                                                    &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;server&lt;/span&gt; {                                                                                                                            &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;server_name&lt;/span&gt; limit.mystical.tech;                                                                                                &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;root&lt;/span&gt; html/;                                                                                                                     &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;error_log&lt;/span&gt; logs/myerror.log info;                                                                                                &lt;/div&gt;&lt;div&gt;                                                                                                                                    &lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;&quot;&gt;location&lt;/span&gt; / {                                                                                                                    &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;limit_conn_status&lt;/span&gt; &lt;span style=&quot;&quot;&gt;500&lt;/span&gt;;                                                                                                      &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;limit_conn_log_level&lt;/span&gt; warn;                                                                                                  &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;        #limit_rate 10;   # 限制向用户返回响应的速度，每秒只返回50个字节&lt;/span&gt;                                                            &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;        #limit_conn addr 1;&lt;/span&gt;                                                                                                         &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;        #limit_req zone=one burst=3;&lt;/span&gt;                                                                                                &lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;&quot;&gt;limit_req&lt;/span&gt; &lt;span style=&quot;&quot;&gt;zone&lt;/span&gt;=one burst=&lt;span style=&quot;&quot;&gt;3&lt;/span&gt; nodelay;                                                                                         &lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;        #limit_req zone=one;&lt;/span&gt;                                                                                                        &lt;/div&gt;&lt;div&gt;    }                                                                                                                               &lt;/div&gt;&lt;div&gt;}  &lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1;arcSize=9;align=left;spacingLeft=30;fontColor=default;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="3160" y="726" width="761" height="460" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-132" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#6c8ebf;strokeWidth=2;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;fillColor=#dae8fc;" parent="UmAkyeazDkvLk_dYHvyL-138" source="UmAkyeazDkvLk_dYHvyL-130" target="UmAkyeazDkvLk_dYHvyL-131" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-130" value="&lt;span style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;客户端测试&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=0" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="4258" y="530" width="231" height="72" as="geometry" />
        </mxCell>
        <mxCell id="UmAkyeazDkvLk_dYHvyL-131" value="&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;; font-size: 18px;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;&lt;pre&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;rate=6r/m，表示每10s，可以访问一次。&lt;/div&gt;&lt;div style=&quot;background-color: rgba(0, 0, 0, 0); font-family: Consolas, monospace-fallback, &amp;quot;monospace&amp;quot;;&quot;&gt;但是实际情况是&lt;br/&gt;访问一次，加桶里3个（burst=3），又因为nodelay，&lt;br/&gt;因此可以连续访问4次，4次后会返回503。&lt;br/&gt;只有每10s能访问一次&lt;br/&gt;如果30s(即3*10s)无访问，则还清欠债，则可以再次连续访问4次。&lt;br/&gt;&lt;br&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=none;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1;arcSize=9;align=left;spacingLeft=30;fontColor=default;" parent="UmAkyeazDkvLk_dYHvyL-138" vertex="1">
          <mxGeometry x="4063.5" y="708" width="620" height="236" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
