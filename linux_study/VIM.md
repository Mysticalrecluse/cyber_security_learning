# kkVIM åŸºç¡€æ“ä½œ



## å¸¸ç”¨æ¨¡å¼



- **æ­£å¸¸ï¼ˆnormalï¼‰æ¨¡å¼**

  > ï¼ˆä¹Ÿç§°ä¸ºæ™®é€šæ¨¡å¼ï¼‰ï¼Œç¼ºçœçš„ç¼–è¾‘æ¨¡å¼ï¼›å¦‚æœä¸åŠ ç‰¹æ®Šè¯´æ˜ï¼Œä¸€èˆ¬æåˆ°çš„å‘½ä»¤éƒ½ç›´æ¥åœ¨æ­£å¸¸æ¨¡å¼ä¸‹è¾“å…¥ï¼›åœ¨ä»»ä½•å…¶ä»–æ¨¡å¼ä¸­ï¼Œéƒ½å¯ä»¥é€šè¿‡é”®ç›˜ä¸Šçš„ Esc é”®å›åˆ°æ­£å¸¸æ¨¡å¼ã€‚

- **æ’å…¥ï¼ˆinsertï¼‰æ¨¡å¼**

  > è¾“å…¥æ–‡æœ¬æ—¶ä½¿ç”¨ï¼›æ¯”å¦‚åœ¨æ­£å¸¸æ¨¡å¼ä¸‹é”®å…¥ iï¼ˆinsertï¼‰æˆ– aï¼ˆappendï¼‰å³å¯è¿›å…¥æ’å…¥æ¨¡å¼ã€‚

- **å¯è§†ï¼ˆvisualï¼‰æ¨¡å¼**

  > ç”¨äºé€‰å®šæ–‡æœ¬å—ï¼›æ•™ç¨‹ä¸­å·²ç»æåˆ°å¯ä»¥ç”¨é”® vï¼ˆå°å†™ï¼‰æ¥æŒ‰å­—ç¬¦é€‰å®šï¼ŒVim é‡Œä¹Ÿæä¾›å…¶ä»–ä¸åŒçš„é€‰å®šæ–¹æ³•ï¼ŒåŒ…æ‹¬æŒ‰è¡Œå’ŒæŒ‰åˆ—å—ã€‚

- **å‘½ä»¤è¡Œï¼ˆcommand-lineï¼‰æ¨¡å¼**

  > ç”¨äºæ‰§è¡Œè¾ƒé•¿ã€è¾ƒå¤æ‚çš„å‘½ä»¤ï¼›åœ¨æ­£å¸¸æ¨¡å¼ä¸‹é”®å…¥å†’å·ï¼ˆ:ï¼‰å³å¯è¿›å…¥è¯¥æ¨¡å¼ï¼›ä½¿ç”¨æ–œæ ï¼ˆ/ï¼‰å’Œé—®å·ï¼ˆ?ï¼‰å¼€å§‹æœç´¢ä¹Ÿç®—ä½œå‘½ä»¤è¡Œæ¨¡å¼ã€‚å‘½ä»¤è¡Œæ¨¡å¼ä¸‹çš„å‘½ä»¤è¦è¾“å…¥å›è½¦é”®ï¼ˆEnterï¼‰æ‰ç®—å®Œæˆã€‚





## å…‰æ ‡ç§»åŠ¨
- hjkl: ä¸Šä¸‹å·¦å³
- Ffï¼šè·³åˆ°å½“å‰è¡ŒæŒ‡å®šå­—ç¬¦
- Ttï¼šè·³åˆ°å½“å‰è¡Œå­—ç¬¦å‰ï¼Œæ¯”å¦‚""
- ï¼›ï¼šé‡å¤å‰ä¸€ä¸ªf/tçš„ç»“æœ
- ï¼Œï¼šé‡å¤åä¸€ä¸ªf/tçš„ç»“æœ
- / + æŒ‡å®šå­—ç¬¦ï¼Œå¯ä»¥è·³åˆ°å½“å‰ä½ç½®ä¹‹åçš„è‡ªå®šå­—ç¬¦ä½ç½®ï¼Œåå¯ä»¥ä½¿ç”¨n/Nè¿›è¡Œè·³è½¬
- ? + æŒ‡å®šå­—ç¬¦, å¯ä»¥è·³è½¬åˆ°å½“å‰ä½ç½®ä¹‹å‰çš„æŒ‡å®šå­—ç¬¦ä½ç½®
- wW,eE,bBï¼Œå•è¯è¿›è¡Œè·³è½¬
- () åœ¨å¥å­é—´è¿›è¡Œè·³è½¬
- {} åœ¨æ®µè½é—´è¿›è¡Œè·³è½¬
- `[{` `]}`  æˆ–`[(` `])`åœ¨ä»£ç çš„{}æˆ–()æ®µé—´è¿›è¡Œè·³è½¬, å‰é¢åŠ æ•°å­—å¯ä»¥è¿›è¡ŒåµŒå¥—è·³è½¬
- 0 è·³è½¬åˆ°è¡Œé¦–
- ^ è·³è½¬åˆ°éç©ºè¡Œé¦–
- $ è·³è½¬åˆ°è¡Œå°¾
- % åœ¨å°±è¿‘çš„ï¼ˆï¼‰ä¹‹é—´è·³è½¬
- `*` æ‰¾åˆ°æ‰€æœ‰å…‰æ ‡æ‰€åœ¨å•è¯ï¼Œå¹¶å‘åè·³è½¬ï¼Œä½¿ç”¨n/Nå¯ä»¥é‡å¤è¯¥åŠ¨ä½œ
- `#` æ‰¾åˆ°æ‰€æœ‰å…‰æ ‡æ‰€åœ¨å•è¯ï¼Œå¹¶å‘å‰è·³è½¬ï¼Œä½¿ç”¨n/Nå¯ä»¥é‡å¤è¯¥åŠ¨ä½œ
- H: è·³åˆ°è¯¥å±å¹•ä¸­çš„é¦–è¡Œè¡Œé¦–
- Lï¼šè·³åˆ°è¯¥å±å¹•çš„å°¾è¡Œè¡Œé¦–
- M: è·³åˆ°è¯¥å±å¹•çš„ä¸­é—´è¡Œé¦–
- `åå¼•å· + æ ‡è®°å­—ç¬¦ï¼šè·³åˆ°æŒ‡å®šæ ‡è®°å¤„
- 'å•å¼•å· + æ ‡è®°å­—ç¬¦ï¼šè·³åˆ°æŒ‡å®šæ ‡è®°çš„æ‰€åœ¨è¡Œçš„å¼€å¤´
- `m + æ ‡è®°å­—ç¬¦`: è®¾ç½®æ ‡è®°ï¼Œa-zä¸ºlocalæ ‡è®°ï¼Œ A-Zä¸ºglobalæ ‡è®°
- `:marks`: æŸ¥çœ‹æ‰€æœ‰æ ‡è®°
- `:delm + æ ‡è®°å­—ç¬¦` åˆ é™¤è¯¥æ ‡è®°
- `|` ï¼š[count] + `|` è·³è½¬åˆ°æŒ‡å®šåˆ—æ•°
- `:num`ï¼šè·³åˆ°æŒ‡å®šè¡Œæ•°
- ggï¼š è·³åˆ°é¦–è¡Œ
- Gï¼šè·³åˆ°æœ€åä¸€è¡Œå¼€å¤´
- `:b+num æˆ– æ–‡ä»¶å`ï¼šè·³è½¬åˆ°æŒ‡å®šæ–‡ä»¶ä¸­

## æ“ä½œ
- y: å¤åˆ¶
    - Y/yy: å¤åˆ¶å½“å‰è¡Œæ‰€æœ‰å­—ç¬¦
- d: åˆ é™¤ï¼ˆç»“æœå­˜å…¥å¯„å­˜å™¨ä¸­ï¼‰
    - D: ç±»ä¼¼äºd$
    - ddï¼šåˆ é™¤å½“å‰è¡Œ
- c: ä¿®æ”¹ï¼ˆåˆ é™¤å¹¶è¿›å…¥insertæ¨¡å¼ï¼‰
    - C/ccï¼šåˆ é™¤ä¸€æ•´è¡Œï¼Œå¹¶è¿›å…¥insertæ¨¡å¼
- p: ç²˜è´´åœ¨åé¢ï¼Œæˆ–ä¸‹è¡Œ
- Pï¼ˆå¤§å†™ï¼‰: ç²˜è´´åœ¨å‰é¢ï¼Œæˆ–è€…ä¸Šè¡Œ 
- s: åˆ é™¤å½“å‰å­—ç¬¦ï¼Œå¹¶è¿›å…¥insertæ¨¡å¼
- S: åˆ é™¤ä¸€æ•´è¡Œï¼Œå¹¶è¿›å…¥insertæ¨¡å¼ï¼Œç±»ä¼¼äºC/cc
- r: æ›¿æ¢å•ä¸ªå­—ç¬¦
- ~ï¼šæ›´æ”¹æ‰€åœ¨å­—ç¬¦å¤§å°å†™
- xï¼šåˆ é™¤å½“å‰å­—ç¬¦
- X: åˆ é™¤åä¸€ä¸ªå­—ç¬¦
- æ“ä½œå­—ç¬¦ï¼ˆydc + i/a + w/s/pï¼‰
    - i: ä¸åŒ…å«ç‰¹æ®Šå­—ç¬¦
    - a: åŒ…å«ç‰¹æ®Šå­—ç¬¦
    - w: å•è¯
    - s: å¥å­
    - p: æ®µè½
- `.` ç‚¹ï¼šé‡å¤æœ€åä¸€æ¬¡æ“ä½œ
- `" + [0-9,a-z]`: å°†æŒ‡å®šæ–‡æœ¬å¤åˆ¶è¿›æŒ‡å®šå¯„å­˜å™¨
- `"[A-Z]`: è¡¨ç¤ºè¿½åŠ å­—ç¬¦åˆ°æŒ‡å®ša-zçš„å¯¹åº”å¯„å­˜å™¨ä¸­
- `:reg`ï¼šæŸ¥çœ‹å¯„å­˜å™¨å†…å®¹
- `:w`: ä¿å­˜
- ZZï¼šä¿å­˜åé€€å‡º
- ZQï¼šä¸ä¿å­˜é€€å‡º
- uï¼šæ’¤é”€

## è§†çª—
- zz: çª—å£ç§»åŠ¨åˆ°ä¸­é—´
- ztï¼šçª—å£å¯¹é¡¶
- zbï¼šçª—å£å¯¹åº•

## åˆ‡æ¢insertæ¨¡å¼
- i: è¿›å…¥insertæ¨¡å¼ï¼Œå¹¶ä¸”å…‰æ ‡ç§»åŠ¨åˆ°æŒ‡å®šå­—ç¬¦ä¹‹å‰
- Iï¼šè¿›å…¥insertæ¨¡å¼ï¼Œå¹¶ä¸”å…‰æ ‡ç§»åŠ¨åˆ°å½“å‰è¡Œå¼€å¤´
- a: è¿›å…¥insertæ¨¡å¼ï¼Œå¹¶ä¸”å…‰æ ‡ç§»åŠ¨åˆ°æŒ‡å®šå­—ç¬¦ä¹‹å
- Aï¼šè¿›å…¥insertæ¨¡å¼ï¼Œå¹¶ä¸”å…‰æ ‡ç§»åŠ¨åˆ°è¡Œå°¾
- oï¼šè¿›å…¥insertæ¨¡å¼ï¼Œå…‰æ ‡ç§»åŠ¨åˆ°ä¸‹é¢ï¼Œæ–°èµ·ä¸€è¡Œ
- O: è¿›å…¥insertæ¨¡å¼ï¼Œå…‰æ ‡ç§»åŠ¨åˆ°ä¸Šé¢ï¼Œæ–°èµ·ä¸€è¡Œ

## æ‰©å±•å‘½ä»¤æ¨¡å¼
### åŸºæœ¬å‘½ä»¤
- w: ä¿å­˜æ–‡ä»¶
- x: ç­‰ä»·äºwqï¼ˆä¿å­˜é€€å‡ºï¼‰
- Xï¼šåŠ å¯†
- w + æ–‡ä»¶åï¼š æ–‡ä»¶å¦å­˜ä¸º
- qï¼šé€€å‡º
- ï¼ï¼šå¼ºåˆ¶æ‰§è¡Œ
- r + æ–‡ä»¶åï¼šè¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹åˆ°å…‰æ ‡ä¸‹
- !commandï¼šæ‰§è¡ŒæŒ‡ä»¤
- r!commandï¼šè¯»å–æ‰§è¡Œå‘½ä»¤çš„ç»“æœ

### åœ°å€å®šç•Œæ ¼å¼
```
M
M, N
.
$
.,$-1
/pattern/
/part1/,/part2/
```

### æ“ä½œ
```shell
p               #è¾“å‡º
d               #åˆ é™¤
y               #å¤åˆ¶
w file          #å°†èŒƒå›´å†…çš„è¡Œå¦å­˜è‡³æŒ‡å®šæ–‡ä»¶ä¸­
r file          #åœ¨æŒ‡å®šä½ç½®æ’å…¥æŒ‡å®šæ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹
tè¡Œå·            #å°†å‰é¢æŒ‡å®šçš„è¡Œå¤åˆ¶åˆ°Nè¡Œå
mè¡Œå·            #å°†å‰é¢æŒ‡å®šçš„è¡Œç§»åŠ¨åˆ°Nè¡Œå
```

### æŸ¥æ‰¾å¹¶æ›¿æ¢
```shell
s/pattern/æ›¿æ¢å­—ç¬¦/ä¿®é¥°ç¬¦
%s              #å…¨æ–‡æŸ¥æ‰¾æ›¿æ¢
```

### å®šåˆ¶VIMå·¥ä½œç‰¹æ€§
- é…ç½®æ–‡ä»¶
    - å…¨å±€ï¼š/etc/vimrc
    - ä¸ªäººï¼š~/.vimrc

- è¡Œå·
```
set nu | number
set nonu | nonumber
```

- å¿½ç•¥å­—ç¬¦å¤§å°å†™
```
set ic | ignorecase
set noic
```

- è‡ªåŠ¨ç¼©è¿›
```
set ai | autoindent
set noai | noautoindent
```

- å¤åˆ¶ä¿ç•™æ ¼å¼
```
set paste
set nopaste
```

- æ˜¾ç¤ºTab(^I)å’Œæ¢è¡Œç¬¦($)
```
set list
set nolist
```

- è¯­æ³•é«˜äº®
```
syntax on
syntax off
```
- å®æ—¶REXé«˜äº®åŒ¹é…
```
set incsearch
```

- é«˜äº®æœç´¢
```
set hlsearch
set nohlsearch|nohl
```

- æ–‡ä»¶æ ¼å¼
```
set ff=dos      #å¯ç”¨Windowsæ ¼å¼
set ff=unix     #å¯ç”¨Unixæ ¼å¼
```

- Tabé”®ç”¨ç©ºæ ¼ä»£æ›¿
```
set expandtab | et
set noexpandtab | noet
```

- ç”¨æŒ‡å®šç©ºæ ¼æ•°ä»£æ›¿Tab
```
set tabstop=N| ts=N     # æŒ‡å®šNä¸ªç©ºæ ¼ä»£æ›¿tabé”®
```

- è®¾ç½®ç¼©è¿›å®½åº¦
```
<<
>>

set shiftwidth=4
```

- è®¾ç½®å…‰æ ‡æ‰€åœ¨è¡Œæ ‡è¯†çº¿
```
set cursorline| cul
set nocursorline| nocul
```

- åŠ å¯†
```
set key=passwd  # æ–‡ä»¶åŠ å¯†ï¼Œç›¸å½“äºX
set key=        # å–æ¶ˆåŠ å¯†
```

## å¯è§†åŒ–æ¨¡å¼
```
ctrl + v è¿›å…¥å—æ¨¡å¼
é€‰å®šå¥½åï¼Œä½¿ç”¨i\shift + i
è¾“å…¥æ·»åŠ çš„å­—ç¬¦
æŒ‰ESC
```


## å¤šçª—å£æ¨¡å¼
```
å•æ–‡ä»¶åˆ†å±
ctrl + w + v   # æ°´å¹³åˆ†å±
ctrl + w + s   # å‚ç›´åˆ†å±
ctrl + w + q   # å–æ¶ˆç›¸é‚»åˆ†å±
ctrl + w + o   # å–æ¶ˆå…¨éƒ¨åˆ†å±
ctrl + w + hjk;| arrow # åˆ‡æ¢çª—å£
```

```
å¤šæ–‡ä»¶åˆ†å±æ‰“å¼€
vim -o|O file1 file2
```







# VIM Script









# vimé›†æˆDeepSeek

**åœ¨.bashrcé‡Œï¼Œæ”¾å…¥ç¯å¢ƒå˜é‡ï¼Œä¿è¯ deepseek çš„ api keys å¯ä»¥è¢«è°ƒç”¨**

```bash
export DEEPSEEK_API_KEY="sk-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
```



**åœ¨PATHè·¯å¾„ä¸­ï¼Œåˆ›å»º deepseek-query.sh è„šæœ¬æ–‡ä»¶**

```bash
root@localhost:~# echo $PATH
/root/.local/bin:/root/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin

# åœ¨/root/binä¸‹ï¼Œåˆ›å»ºdeepseek-query.sh
root@localhost:~# mkdir bin

# å†™è„šæœ¬æ–‡ä»¶
root@localhost:~# cat bin/deepseek-query.sh 
#!/bin/bash

# === é…ç½® ===
API_KEY="${DEEPSEEK_API_KEY}"jjj
MODEL="deepseek-chat"
ENDPOINT="https://api.deepseek.com/v1/chat/completions"

if [[ -z "$API_KEY" ]]; then
  echo "[error] è¯·å…ˆå¯¼å‡º DEEPSEEK_API_KEY ç¯å¢ƒå˜é‡"
  exit 1
fi

#PROMPT="$*"

if [[ -n "$1" ]]; then
  PROMPT="$1"
else
  read -r PROMPT
fi


#DATA=$(cat <<EOF
#{
#  "model": "$MODEL",
#  "messages": [
#    {"role": "user", "content": "$PROMPT"}
#  ]
#}
#EOF
#)


DATA=$(jq -n --arg prompt "$PROMPT" --arg model "$MODEL" '
{
  model: $model,
  messages: [
    { role: "user", content: $prompt }
  ]
}')


#curl -sS "$ENDPOINT" \
#  -H "Content-Type: application/json" \
#  -H "Authorization: Bearer $API_KEY" \
#  -d "$DATA" | jq -r '.choices[0].message.content'

response=$(curl -sS "$ENDPOINT" \
  -H 'Content-Type: application/json' \
  -H "Authorization: Bearer $API_KEY" \
  -d "$DATA")

echo "$response" | jq -r '.choices[0].message.content'
```



**åœ¨.vimrcä¸­é…ç½®ï¼Œè°ƒç”¨deepseekè„šæœ¬**

```bash

" -------------- DeepSeek é›†æˆ -----------------
" Leader é”®ï¼š\  ï¼ˆå¯è‡ªè¡Œ let mapleader = "," â€¦ï¼‰
nnoremap <leader>ds :call DeepSeek_Query_Cursor()<CR>
vnoremap <leader>ds :<C-u>call <SID>DeepSeek_Query_Visual()<CR>
"vnoremap <leader>ds :<C-u>call DeepSeek_Query_Visual()<CR>

" å…³é—­æµ®çª—çš„å¿«æ·é”®
nnoremap <silent> <leader>q :call popup_close(popup_list()[0])<CR>
"
"function! s:popup_show(msg) abort
"  if has('popupwin')          " Vim 8.2+ æ¨èç”¨æµ®çª—
"    call popup_create(a:msg, #{minwidth:60, minheight:8, line:2, col:2,
"          \ border:[1], borderchars:['â”€']})
"  else                        " è€ç‰ˆæœ¬é€€åŒ–ä¸ºåªè¯»æ–°ç¼“å†²
"    new
"    setlocal buftype=nofile bufhidden=wipe nobuflisted noswapfile
"    call setline(1, split(a:msg, "\n"))
"  endif
"endfunction
"
"" æ™®é€šæ¨¡å¼ï¼šå–å…‰æ ‡æ‰€åœ¨è¡Œï¼ˆæˆ–å‡½æ•°åç­‰ï¼‰ï¼Œå¯è‡ªè¡Œæ”¹æˆ expand('<cword>')
"function! DeepSeek_Query_Cursor() abort
""  let l:text = getline('.')
""  let l:answer = system('echo '.shellescape(l:text).' | ~/bin/deepseek-query.sh')
""  call <SID>popup_show(l:answer)
"   let l:prompt = input('ğŸ¤– è¯·è¾“å…¥ä½ çš„é—®é¢˜: ')
"   if empty(l:prompt)
"     echohl WarningMsg | echo '[âŒ] å·²å–æ¶ˆï¼Œé—®é¢˜ä¸ºç©º' | echohl None
"     return
"   endif
""   let l:answer = system('echo '.shellescape(l:prompt).' | ~/bin/deepseek-query.sh')
"   let l:answer = system("echo " . shellescape(l:prompt) . " | bash ~/bin/deepseek-query.sh")
"   call <SID>popup_show(l:answer)
"endfunction
"
"" å¯è§†æ¨¡å¼ï¼šå–é€‰åŒº
"function! DeepSeek_Query_Visual() abort
"  " ä¿å­˜é€‰åŒºä¸¤ç«¯
"  let l_save = @@
"  normal! "vy
"  let l:text = @@
"  let @@ = l_save
"
"  let l:answer = system('echo '.shellescape(l:text).' | ~/bin/deepseek-query.sh')
"  call <SID>popup_show(l:answer)
"endfunction


let mapleader = "\\"

" === å¿«æ·é”® ===
nnoremap <leader>ds :call DeepSeek_Query_Cursor()<CR>
vnoremap <leader>ds :<C-u>call <SID>DeepSeek_Query_Visual()<CR>
nnoremap <silent> <leader>q :call popup_close(popup_list()[0])<CR>

" === æµ®çª—æ˜¾ç¤ºå‡½æ•° ===
function! s:popup_show(msg) abort
  if has('popupwin')
    call popup_create(a:msg, {
          \ 'minwidth': 60, 'minheight': 8,
          \ 'line': 2, 'col': 2,
          \ 'border': [1], 'borderchars': ['â”€'],
          \ })
  else
    new
    setlocal buftype=nofile bufhidden=wipe nobuflisted noswapfile
    call setline(1, split(a:msg, "\n"))
  endif
endfunction

" === æ ¸å¿ƒæé—®å‡½æ•° ===
function! s:deepseek_query_and_popup(text) abort
  if empty(a:text)
    echohl WarningMsg | echo '[âŒ] å†…å®¹ä¸ºç©ºï¼Œæœªå‘é€' | echohl None
    return
  endif
  let l:answer = system('bash ~/bin/deepseek-query.sh ' . shellescape(a:text))
  call s:popup_show(l:answer)
endfunction

" === æ™®é€šæ¨¡å¼ï¼šè¾“å…¥é—®é¢˜ ===
function! DeepSeek_Query_Cursor() abort
  let prompt = input('ğŸ¤– è¯·è¾“å…¥ä½ çš„é—®é¢˜: ')
  if empty(prompt)
    echohl WarningMsg | echo '[å–æ¶ˆå‘é€]' | echohl None
    return
  endif
  call s:deepseek_query_and_popup(prompt)
endfunction

" === å¯è§†æ¨¡å¼ï¼šé€‰æ‹©æé—® ===
"function! s:DeepSeek_Query_Visual() abort
"  let l:save_reg = @@
"  normal! "vy
"  let l:text = @@
"  let @@ = l:save_reg
"  call s:deepseek_query_and_popup(l:text)
"endfunction

"function! s:DeepSeek_Query_Visual() abort
"  " è·å–å¯è§†é€‰åŒºèŒƒå›´ï¼ˆè¡Œå·ï¼‰
"  let start = getpos("'<")[1]
"  let end = getpos("'>")[1]
"
"  " è·å–é€‰ä¸­å†…å®¹çš„æ‰€æœ‰è¡Œ
"  let lines = getline(start, end)
"
"  " å°†å¤šè¡Œæ‹¼æ¥æˆä¸€è¡Œï¼ˆé¿å… JSON è§£æå¤±è´¥ï¼‰
"  let text = join(lines, ' ')
"
"  call s:deepseek_query_and_popup(text)
"endfunction

function! s:DeepSeek_Query_Visual() abort
  " ä¿å­˜å‰ªè´´æ¿å†…å®¹
  let l:save_reg = @@

  " å¤åˆ¶å¯è§†é€‰åŒºå†…å®¹
  normal! "vy
  let l:selected = @@

  " æ¢å¤å‰ªè´´æ¿
  let @@ = l:save_reg

  " æ‰‹åŠ¨è¾“å…¥æé—®å†…å®¹
  let l:prompt = input('ğŸ¤– è¯·è¾“å…¥ä½ çš„é—®é¢˜ï¼ˆé€‰ä¸­å†…å®¹å°†é™„åœ¨æœ«å°¾ï¼‰ï¼š')
  if empty(l:prompt)
    echohl WarningMsg | echo '[âŒ] å·²å–æ¶ˆï¼Œé—®é¢˜ä¸ºç©º' | echohl None
    return
  endif

  " æ‹¼æ¥ç”¨æˆ·é—®é¢˜å’Œé€‰ä¸­å†…å®¹
  let l:final_prompt = l:prompt . "\n\n" . l:selected

  " æ‰§è¡ŒæŸ¥è¯¢
  call s:deepseek_query_and_popup(l:final_prompt)
endfunction 
```





# vimé›†æˆCè¯­è¨€è¯­æ³•è¡¥å…¨



## coc.nvim çš„ vim ç‰ˆæœ¬è¦æ±‚

- **Vim â‰¥ 9.0.0438**ï¼ˆå¸¦å®Œæ•´ `vim9script` åŠŸèƒ½ï¼‰

- **Neovim â‰¥ 0.8.0**



ç›´æ¥å‡çº§vimçš„æ–¹æ³•

```bash
sudo add-apt-repository ppa:jonathonf/vim
sudo apt update
sudo apt install vim
```



## coc.nvim çš„ Node.js ç‰ˆæœ¬è¦æ±‚

- å®˜æ–¹è¦æ±‚ï¼š**Node.js â‰¥ 14**
- æ¨èï¼š**Node.js 16 / 18 LTS**ï¼ˆç¨³å®šä¸”é•¿æœŸæ”¯æŒï¼‰

å®‰è£…å‡çº§ç‰ˆçš„nodejs

```bash
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
apt install -y nodejs
```

```bash
[root@ubuntu2204 ~]#node -v
v18.20.8
```



## åœ¨ Minpac ä¸­æ·»åŠ  coc.nvim

åœ¨ä½ çš„ `.vimrc` é‡Œ **Minpac åˆå§‹åŒ–å—**ä¸­æ·»åŠ ï¼š

```bash
# æ·»åŠ ä¸‹è¡Œ
call minpac#add('neoclide/coc.nvim', {'branch': 'release'})

# è¿è¡Œå®‰è£…
:PackUpdate
```



## **é…ç½® coc.nvim**

å®‰è£…åéœ€è¦åŸºæœ¬é…ç½®ï¼Œä¾‹å¦‚ï¼š

```bash
"  è®© coc.nvim è‡ªåŠ¨å¯åŠ¨
filetype plugin indent on
syntax on

"  è§£å†³è¡¥å…¨èœå•è¡Œä¸º
set completeopt=menu,menuone,noselect

"  å¯ç”¨å›è½¦ç¡®è®¤è¡¥å…¨
inoremap <expr> <CR> pumvisible() ? coc#_select_confirm() : "\<CR>"
```



## **å®‰è£… C è¯­è¨€æ”¯æŒï¼ˆclangdï¼‰**

å®‰è£… LSP æœåŠ¡å™¨ï¼š

```bash
apt install clangd
```

ç„¶ååœ¨ Vim é‡Œæ‰§è¡Œï¼š

```bash
:CocInstall coc-clangd
```



## æŒ‰é”®æ˜ å°„æ¨è

```bash
# å‘ä¸‹ä½¿ç”¨ctrl + n
inoremap <expr> <Tab>   pumvisible() ? "\<C-p>(<BS>" : "\<Tab>"
inoremap <expr> <S-Tab> pumvisible() ? "\<C-p>" : "\<S-Tab>"

# æ­£ç»Ÿçš„æ–¹æ³•ï¼Œä½†å®æµ‹æœ‰é—®é¢˜
" âœ… Tab é€‰æ‹©ä¸‹ä¸€ä¸ªè¡¥å…¨é¡¹ / Enter ç¡®è®¤
inoremap <expr> <Tab>   pumvisible() ? "\<C-n>" : "\<Tab>"
inoremap <expr> <S-Tab> pumvisible() ? "\<C-p>" : "\<S-Tab>"
inoremap <expr> <CR>    pumvisible() ? coc#_select_confirm() : "\<CR>"
```











# é€šè¿‡æ’ä»¶å®ç°å…¨è¯­è¨€è¡¥é½



## å®ç°æ–¹æ¡ˆ

**C/C++ / Python / Go / Rust / Java ç­‰** â†’ ç”± **YCM** è´Ÿè´£ï¼ˆå¿«é€Ÿã€ç¨³å®šï¼‰

**Shell (`sh`, `bash`)** â†’ ç”± **coc.nvim + coc-sh** è´Ÿè´£ï¼ˆæ™ºèƒ½è¡¥å…¨ï¼‰



### å†²çªè§£å†³æ–¹æ¡ˆ

**åªåœ¨ Shell æ–‡ä»¶å¯ç”¨ coc.nvim**

åœ¨ `.vimrc` é‡Œï¼š

```bash
# åªä¸º sh/bash æ–‡ä»¶åŠ è½½ coc.nvim
autocmd FileType sh,Bash packadd coc.nvim
```

**æˆ–è€…ç¦ç”¨ YCM åœ¨ Shell æ–‡ä»¶**

```bash
autocmd FileType sh let g:ycm_filetype_blacklist = {'sh': 1}
```

è¿™æ · YCM ä¸ä¼šåœ¨ `sh` æ–‡ä»¶å¹²æ‰°è¡¥å…¨ã€‚



### æ³¨æ„äº‹é¡¹

ä½¿ç”¨æ™®é€šç”¨æˆ·ä¸‹è½½å®‰è£…ï¼Œåç»­ä½¿ç”¨è½¯è¿æ¥è®©rootç”¨æˆ·ä½¿ç”¨é…ç½®

è®© root **è¯»å–æ™®é€šç”¨æˆ·çš„ Vim é…ç½®**ï¼š

```bash
ln -sf /home/youruser/.vimrc /root/.vimrc
ln -sf /home/youruser/.vim /root/.vim
```



## æå‰å®‰è£…å…¨éƒ¨ä¾èµ–

```bash
# Ubuntu
apt install -y build-essential cmake python3-dev clangd libclang-dev golang rustc cargo openjdk-17-jdk nodejs npm mono-complete libncurses-dev perl libperl-dev ruby-dev liblua5.3-dev git

# Rocky
dnf install -y gcc gcc-c++ make automake autoconf libtool binutils \
  cmake python3-devel clang clang-tools-extra libclang-devel \
  golang rust cargo java-17-openjdk-devel nodejs npm \
  ncurses-devel perl perl-devel ruby-devel lua-devel git

# å¦‚éœ€ C# è¡¥å…¨ï¼ˆMonoï¼‰
dnf install -y epel-release
dnf install -y mono-complete
```





## å‡çº§GO

YCM éœ€è¦ä¸€ä¸ª **è¾ƒæ–°çš„ Go ç‰ˆæœ¬**ï¼ˆè‡³å°‘ 1.20+ï¼‰æ¥æ„å»º goplsã€‚



### ä½¿ç”¨å®˜æ–¹ tar.gz å®‰è£… Go 1.22

```bash
# ä¸‹è½½å®‰è£…
wget https://go.dev/dl/go1.22.5.linux-amd64.tar.gz
rm -rf /usr/local/go
tar -C /usr/local -xzf go1.22.5.linux-amd64.tar.gz

# è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆæ·»åŠ åˆ° ~/.bashrcï¼‰ï¼š
export PATH=/usr/local/go/bin:$PATH

# éªŒè¯
go version
# go version go1.22.5 linux/amd64
```



## å‡çº§ Node.jsï¼ˆæ¨èï¼‰

```bash
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt install -y nodejs
```

```bash
# æŸ¥çœ‹
[root@ubuntu2204 ~]#node -v
v20.19.4
[root@ubuntu2204 ~]#npm -v
10.8.2
```





## å¸è½½é»˜è®¤vimï¼Œå¹¶ç¼–è¯‘å®‰è£…æ–°ç‰ˆvim91

```bash
# å¸è½½
apt remove vim -y

# ç¼–è¯‘å®‰è£…vim91
git clone https://github.com/vim/vim.git
cd vim
./configure \
  --with-features=huge \
  --enable-multibyte \
  --enable-cscope \
  --enable-terminal \
  --enable-perlinterp=yes \
  --enable-python3interp=yes \
  --with-python3-command=python3 \
  --enable-rubyinterp=yes \
  --enable-luainterp=yes \
  --enable-gui=no \
  --without-x \
  --prefix=/usr/local

make -j$(nproc)
make install
```

```bash
# ç¼–è¯‘æˆåŠŸåæŸ¥çœ‹
[root@ubuntu2204 YouCompleteMe]#vim --version
VIM - Vi IMproved 9.1 (2024 Jan 02, compiled Jul 30 2025 10:47:46)
Included patches: 1-1591
Compiled by root@ubuntu2204.wang.org
Huge version without GUI.  Features included (+) or not (-):
+acl               +find_in_path      +multi_byte        +termguicolors
+arabic            +float             +multi_lang        +terminal
+autocmd           +folding           -mzscheme          +terminfo
+autochdir         -footer            +netbeans_intg     +termresponse
-autoservername    +fork()            +num64             +textobjects
-balloon_eval      -gettext           +packages          +textprop
+balloon_eval_term -hangul_input      +path_extra        +timers
-browse            +iconv             +perl              +title
++builtin_terms    +insert_expand     +persistent_undo   -toolbar
+byte_offset       +ipv6              +popupwin          +user_commands
+channel           +job               +postscript        +vartabs
+cindent           +jumplist          +printer           +vertsplit
-clientserver      +keymap            +profile           +vim9script
-clipboard         +lambda            -python            +viminfo
+cmdline_compl     +langmap           +python3           +virtualedit
+cmdline_hist      +libcall           +quickfix          +visual
+cmdline_info      +linebreak         +reltime           +visualextra
+comments          +lispindent        +rightleft         +vreplace
+conceal           +listcmds          +ruby              -wayland
+cryptv            +localmap          +scrollbind        -wayland_clipboard
+cscope            -lua               +signs             +wildignore
+cursorbind        +menu              +smartindent       +wildmenu
+cursorshape       +mksession         -sodium            +windows
+dialog_con        +modify_fname      -sound             +writebackup
+diff              +mouse             +spell             -X11
+digraphs          -mouseshape        +startuptime       +xattr
-dnd               +mouse_dec         +statusline        -xfontset
-ebcdic            -mouse_gpm         -sun_workshop      -xim
+emacs_tags        -mouse_jsbterm     +syntax            -xpm
+eval              +mouse_netterm     +tabpanel          -xsmp
+ex_extra          +mouse_sgr         +tag_binary        -xterm_clipboard
+extra_search      -mouse_sysmouse    -tag_old_static    -xterm_save
-farsi             +mouse_urxvt       -tag_any_white     
+file_in_path      +mouse_xterm       -tcl               
   system vimrc file: "$VIM/vimrc"
     user vimrc file: "$HOME/.vimrc"
 2nd user vimrc file: "~/.vim/vimrc"
 3rd user vimrc file: "~/.config/vim/vimrc"
      user exrc file: "$HOME/.exrc"
       defaults file: "$VIMRUNTIME/defaults.vim"
  fall-back for $VIM: "/usr/local/share/vim"
Compilation: gcc -c -I. -Iproto -DHAVE_CONFIG_H -g -O2 -D_REENTRANT -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=1 
Linking: gcc -Wl,-E -L/usr/local/lib -Wl,--as-needed -o vim -lm -ltinfo -Wl,-E -fstack-protector-strong -L/usr/local/lib -L/usr/lib/x86_64-linux-gnu/perl/5.34/CORE -lperl -ldl -lm -lpthread -lcrypt -L/usr/lib/python3.10/config-3.10-x86_64-linux-gnu -lpython3.10 -lcrypt -ldl -lm -lm -lruby-3.0 -lm -L/usr/lib 
```



## YouCompleteMe

### æ‰‹åŠ¨å®‰è£…YCMï¼ˆæ¨èï¼‰

```bash
# é€‰æ‹©å®‰è£…ç›®å½•
mkdir -p ~/.vim/pack/my/start
cd ~/.vim/pack/my/start
git clone --recurse-submodules --shallow-submodules https://github.com/ycm-core/YouCompleteMe.git

# æŸ¥çœ‹
[root@ubuntu2204 YouCompleteMe]#ls
autoload  codecov.yml  CODE_OF_CONDUCT.md  CONTRIBUTING.md  COPYING.txt  doc  install.py  install.sh  plugin  print_todos.sh  python  README.md  run_tests.py  test  third_party  tox.ini  update-vim-docs  vimrc_ycm_minimal

#ä½¿ç”¨install.pyå®‰è£…ï¼Œå®‰è£…å…¨éƒ¨
python3 install.py --all --clangd-completer

# å®‰è£…æˆåŠŸ
[mystical@ubuntu2204 YouCompleteMe]$python3 install.py --all --clangd-completer
Generating ycmd build configuration...OK
Compiling ycmd target: ycm_core...OK
Building watchdog module...OK
Building regex module...OK
Installing Omnisharp for C# support...OK
Building gopls for go completion...OK
Setting up Tern for JavaScript completion...OK
Installing rust-analyzer "nightly-2024-06-11" for Rust support...OK
Installing jdt.ls for Java support...OK
Setting up TSserver for TypeScript completion...OK
Setting up Clangd completer...OK
```



### å®‰è£…å®æ—¶ç¼©è¿›æ’ä»¶å¹¶é…ç½®

```bash
# å®‰è£…æ ¼å¼åŒ–ä»£ç è½¯ä»¶ clang-format
apt install clang-format -y

# ä¸‹è½½æ’ä»¶
call minpac#add('dense-analysis/ale')

# è‡ªåŠ¨ç¼©è¿›
set autoindent
set smartindent
set cindent

" æ™ºèƒ½è¡¥å…¨
let g:ycm_semantic_triggers =  {
\   'c' : ['->', '.', 're!^\s*[a-zA-Z_]\w{1,}$'],
\   'cpp,objcpp' : ['->', '.', '::', 're!^\s*[a-zA-Z_]\w{1,}$']    
\ }     
        
" ä¿å­˜æ—¶ä¿®å¤ 
let g:ale_fix_on_save = 1
 
" è§¦å‘ clang-format ä½œä¸ºä¿®å¤å·¥å…·
let g:ale_fixers = {
\   'c': ['clang-format'],
\   'cpp': ['clang-format']
\ }     
        
" ï¼ˆå¯é€‰ï¼‰å®æ—¶ç¼©è¿›ï¼šæ’å…¥æ¨¡å¼é€€å‡ºæˆ–æ–‡æœ¬å˜åŒ–æ—¶è‡ªåŠ¨ä¿®å¤
autocmd TextChanged,InsertLeave *.c,*.cpp ALEFix
        
inoremap <C-l> <ESC>$a

```



### ä»£ç æµè§ˆå·¥å…·Cscope

```bash
# åœ¨.vimrcæ·»åŠ æ’ä»¶
call minpac#add('adah1972/cscope_maps.vim') 

# æ·»åŠ ä¸‹åˆ—è¯­å¥
" quickfixçª—å£
set cscopequickfix=s-,-,c-,d-,i-,t-,e-,a-

if !cscope_connection(1, expand("cscope.out"))
    cs add cscope.out 
endif
```



```bash
# Ubuntu
apt install -y cscope

# CentOS
yum install -y cscope

# åˆ›å»ºcscope æ•°æ®åº“
# åœ¨é¡¹ç›®çš„æ ¹ç›®å½•æ‰§è¡Œ
cscpoe -R -b

# è¿›å…¥ä»£ç æ–‡æœ¬
# æ‰§è¡Œä¸‹åˆ—è¯­å¥æŸ¥è¯¢è·³è½¬
<C-\>g
|g
||g
```

- gï¼šæŸ¥æ‰¾ä¸€ä¸ªç¬¦å·çš„å…¨å±€å®šä¹‰ï¼ˆglobal definitionï¼‰
- sï¼šæŸ¥æ‰¾ä¸€ä¸ªç¬¦å·ï¼ˆsymbolï¼‰çš„å¼•ç”¨
- dï¼šæŸ¥æ‰¾è¢«è¿™ä¸ªå‡½æ•°è°ƒç”¨ï¼ˆcalledï¼‰çš„å‡½æ•°
- cï¼šæŸ¥æ‰¾è°ƒç”¨ï¼ˆcallï¼‰è¿™ä¸ªå‡½æ•°çš„å‡½æ•°
- tï¼šæŸ¥æ‰¾è¿™ä¸ªæ–‡æœ¬ï¼ˆtextï¼‰å­—ç¬¦ä¸²çš„æ‰€æœ‰å‡ºç°ä½ç½®
- eï¼šä½¿ç”¨ egrep æœç´¢æ¨¡å¼è¿›è¡ŒæŸ¥æ‰¾
- fï¼šæŒ‰ç…§æ–‡ä»¶ï¼ˆfileï¼‰åæŸ¥æ‰¾ï¼ˆå’Œ Vim çš„ gfã€f å‘½ä»¤ç›¸ä¼¼ï¼‰
- iï¼šæŸ¥æ‰¾åŒ…å«ï¼ˆincludeï¼‰è¿™ä¸ªæ–‡ä»¶çš„æ–‡ä»¶
- aï¼šæŸ¥æ‰¾ä¸€ä¸ªç¬¦å·è¢«èµ‹å€¼ï¼ˆassignedï¼‰çš„åœ°æ–¹



### Go è¯­è¨€è¡¥å…¨ï¼ˆgoplsï¼‰

YCM æ”¯æŒ Go è¯­è¨€ï¼Œé€šè¿‡ **goplsï¼ˆGo å®˜æ–¹ LSP æœåŠ¡å™¨ï¼‰**ï¼š

#### **å®‰è£… gopls**

```bash
go install golang.org/x/tools/gopls@latest
```

> ç¡®ä¿ `$GOPATH/bin` åœ¨ `$PATH` ä¸­ã€‚



####  YCM é…ç½® gopls

```bash
let g:ycm_language_server += [
\ { 'name': 'gopls',
\   'cmdline': [ 'gopls' ],
\   'filetypes': [ 'go' ] }
\ ]
```



### Python è¡¥å…¨

```bash
[root@ubuntu2204 ~]#apt install python3-pip
[root@ubuntu2204 ~]#pip install 'python-lsp-server[all]'
```



```bash
let g:ycm_language_server += [
\ { 'name': 'pylsp',
\   'cmdline': [ 'pylsp' ],
\   'filetypes': [ 'python' ] }
\ ]
```



### Lua è¡¥å…¨ï¼ˆlua-language-serverï¼‰

Lua éœ€è¦ **lua-language-serverï¼ˆsumneko/lua-language-serverï¼‰**ï¼š

#### å®‰è£… lua-language-server

```bash
apt install lua5.3
apt install ninja-build
# å®‰è£… LSPï¼ˆä½¿ç”¨ç³»ç»ŸåŒ…æˆ– GitHub é¢„ç¼–è¯‘ï¼‰
git clone https://github.com/LuaLS/lua-language-server.git
cd lua-language-server
./make.sh   # æˆ–æŒ‰ç…§å®˜æ–¹æ–‡æ¡£å®‰è£…
```



#### é…ç½® YCM è®©å®ƒç”¨ lua-language-server

```bash
let g:ycm_language_server += [
\ { 'name': 'lua_ls',
\   'cmdline': [ '/path/to/lua-language-server' ],
\   'filetypes': [ 'lua' ] }
\ ]
```



### ALE æ ¼å¼åŒ–æ”¯æŒå¤šè¯­è¨€

åœ¨ ALE ä¸­åŒæ—¶æ·»åŠ ï¼š

```bash
let g:ale_fixers = {
\   'c': ['clang-format'],
\   'cpp': ['clang-format'],
\   'python': ['black'],
\   'go': ['gofmt'],
\   'lua': ['stylua']
\ }

```

å¹¶å®‰è£…

```bash
pip install black        # Python æ ¼å¼åŒ–
go install golang.org/x/tools/cmd/gofmt@latest  # Go æ ¼å¼åŒ–
cargo install stylua     # Lua æ ¼å¼åŒ–
```



## **æœ€ç»ˆæ•´åˆé…ç½®ï¼ˆC + Go + Python + Luaï¼‰**

```bash
let g:ycm_auto_trigger = 1

" æ™ºèƒ½è¡¥å…¨
let g:ycm_semantic_triggers =  {
\   'c' : ['->', '.', 're!^\s*[a-zA-Z_]\w{1,}$'],
\   'cpp,objcpp' : ['->', '.', '::', 're!^\s*[a-zA-Z_]\w{1,}$'],
\   'go' : ['re!.*'],
\   'python': ['re!.*'],
\   'lua' : ['.']
\ }


" LSP åç«¯é…ç½®
let g:ycm_language_server = [
\ { 'name': 'gopls',  'cmdline': ['gopls'],  'filetypes': ['go'] },
\ { 'name': 'pylsp',  'cmdline': ['/usr/local/bin/pylsp'],  'filetypes': ['python'] },
\ { 'name': 'lua_ls', 'cmdline': ['/usr/local/src/lua-language-server/bin/lua-language-server', '-E', '/usr/local/src/lua-language-server/main.lua', '--logpath=~/.cache/lua-language-server/log', '--metapath=~/.cache/lua-language-server/meta', '--cwd', expand('%:p:h')], 'filetypes': ['lua'] }
\ ]


" ä¿å­˜æ—¶ä¿®å¤
let g:ale_fix_on_save = 1

" è§¦å‘ clang-format ä½œä¸ºä¿®å¤å·¥å…·
let g:ale_fixers = {
\   'c': ['clang-format'],
\   'cpp': ['clang-format'],
\   'python': ['black'],
\   'go': ['gofmt'],
\   'lua': ['stylua']
\ }

" ï¼ˆå¯é€‰ï¼‰å®æ—¶ç¼©è¿›ï¼šæ’å…¥æ¨¡å¼é€€å‡ºæˆ–æ–‡æœ¬å˜åŒ–æ—¶è‡ªåŠ¨ä¿®å¤
"autocmd TextChanged,InsertLeave *.c,*.cpp ALEFix
"autocmd TextChanged,InsertLeave *.c,*.cpp,*.py,*.go,*.lua ALEFix

```



## é…ç½®è¿è¡Œæ˜¾ç¤ºç»ˆç«¯è¾“å‡º

```bash
" é€šç”¨è¿è¡Œå‡½æ•°
" ========= é€šç”¨ RunCodeInTerminal =========
function! RunCodeInTerminal(cmd)
  " 1. å…³é—­å·²æœ‰ terminal çª—æ ¼ï¼ˆé¿å…å¤šä¸ªï¼‰
  for w in range(1, winnr('$'))
    if getbufvar(winbufnr(w), '&buftype') ==# 'terminal'
      exec w . 'wincmd c'
    endif
  endfor

  " 2. åœ¨åº•éƒ¨æ‰“å¼€ä¸€ä¸ª 12 è¡Œé«˜ terminal çª—æ ¼
  "botright new | resize 12
  execute 'terminal' a:cmd| resize 12
  " 3. è‡ªåŠ¨å›åˆ°ä»£ç çª—æ ¼
  wincmd p
endfunction


" ========= è¯­è¨€è‡ªåŠ¨è¯†åˆ« & è¿è¡Œ =========
function! RunCurrentFile()
  let l:file = expand('%:p')
  let l:ext = expand('%:e')

  if l:ext ==# 'py'
    call RunCodeInTerminal('python3 ' . fnameescape(l:file))
  elseif l:ext ==# 'c'
    let l:exe = expand('%:p:r')
    call RunCodeInTerminal('sh -c "gcc ' . fnameescape(l:file) . ' -o ' . l:exe . ' && ' . l:exe . '"')
  elseif l:ext ==# 'lua'
    call RunCodeInTerminal('lua ' . fnameescape(l:file))
  elseif l:ext ==# 'go'
    call RunCodeInTerminal('go run ' . fnameescape(l:file))
  elseif l:ext ==# 'sh'
    call RunCodeInTerminal('bash ' . fnameescape(l:file))
  else
    echo "âš ï¸ ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹: " . l:ext
  endif
endfunction


" ========= ç»‘å®šå¿«æ·é”® =========
" F5 è¿è¡Œå½“å‰æ–‡ä»¶
nnoremap <C-y> :w<CR>:call RunCurrentFile()<CR>
```





# å®ç”¨æ’ä»¶ä»‹ç»



### Rainbow

ä»£ç ä¸­æ‹¬å·å¤šäº†ï¼Œæœ‰æ—¶å€™çœ¼ç›å°±æœ‰ç‚¹çœ‹ä¸è¿‡æ¥ï¼Œéœ€è¦æœ‰ä¸ªæ›´å¥½çš„é¢œè‰²æç¤ºã€‚å› æ­¤ï¼Œå°±æœ‰äº†å¾ˆå¤šå½©è™¹æ•ˆæœçš„ Vim æ’ä»¶ã€‚

```bash
call minpac#add('frazrepo/vim-rainbow')
```

æ•ˆæœé»˜è®¤ä¸è‡ªåŠ¨å¯ç”¨ï¼Œå¯ä»¥ç”¨ :RainbowToggle å‘½ä»¤æ¥åˆ‡æ¢ï¼Œæˆ–ç”¨ :RainbowLoad å‘½ä»¤æ¥åŠ è½½ã€‚

```bash
" è‡ªåŠ¨å¯ç”¨RainboxToggle
autocmd VimEnter * RainbowToggle
```





### Markdown Preview

ä½ å¦‚æœåƒæˆ‘ä¸€æ ·å¸¸å¸¸å†™ Markdown çš„è¯ï¼Œä½ åº”è¯¥ä¼šå–œæ¬¢ Markdown Preview è¿™ä¸ªæ’ä»¶ã€‚Markdown æœ¬æ¥æœ€é€‚ç”¨çš„åœºæ™¯å°±æ˜¯æµè§ˆå™¨ï¼Œçº¯æ–‡æœ¬çš„ Vim åªèƒ½ç¼–è¾‘ï¼Œæ²¡æœ‰å¥½çš„é¢„è§ˆç»ˆç©¶æ˜¯å¾ˆä¸è¶³çš„ã€‚Markdown Preview è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œè®©ä½ åœ¨ç¼–è¾‘çš„åŒæ—¶ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨é‡Œçœ‹åˆ°å®é™…çš„æ¸²æŸ“æ•ˆæœã€‚æ›´ä»¤æˆ‘åƒæƒŠçš„æ˜¯ï¼Œè¿™ä¸ªé¢„è§ˆæ˜¯å®Œå…¨å®æ—¶ã€åŒæ­¥çš„ï¼Œæ— éœ€å­˜ç›˜ï¼Œè€Œä¸”é¢„è§ˆé¡µé¢éšç€å…‰æ ‡åœ¨ Vim é‡Œç§»åŠ¨è€Œè·Ÿç€æ»šåŠ¨ï¼Œæ•ˆæœç›¸å½“é…·ã€‚ä½ å¯ä»¥ç›´æ¥åˆ° Markdown Preview çš„ä¸»é¡µä¸Šçœ‹ä¸€ä¸‹å®˜æ–¹çš„ç¤ºæ„å›¾ï¼Œæˆ‘å°±ä¸åœ¨è¿™é‡Œæ”¾åŠ¨å›¾äº†ã€‚

è¿™ä¸ªæ’ä»¶å”¯ä¸€éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œä½ ä¸èƒ½ç›´æ¥æŠŠ iamcco/markdown-preview.nvim æ”¾åˆ°ä½ çš„åŒ…ç®¡ç†å™¨é‡Œäº†äº‹ã€‚åŸå› æ˜¯å®ƒé‡Œé¢åŒ…å«äº†éœ€è¦ç¼–è¯‘çš„å‰ç«¯ç»„ä»¶ï¼Œéœ€è¦ä¸‹è½½æˆ–ç¼–è¯‘æ‰è¡Œã€‚åœ¨å®ƒçš„ä¸»é¡µä¸Šæè¿°äº†åœ¨ä¸åŒåŒ…ç®¡ç†å™¨é‡Œçš„å®‰è£…æ–¹å¼ï¼Œä½ åªè¦è·Ÿç€ç…§åšå°±è¡Œ

å®ƒçš„é…ç½®åœ¨ä¸»é¡µä¸Šä¹Ÿæœ‰åˆ—è¡¨ï¼Œä½†é»˜è®¤è®¾ç½®å°±å·²ç»å®Œå…¨å¯ç”¨äº†ã€‚å¦‚æœæœ‰éœ€æ±‚çš„è¯ï¼Œä½ å¯ä»¥ä¿®æ”¹å…¶ä¸­éƒ¨åˆ†å€¼ï¼Œå¦‚ g:mkdp_browser å¯ä»¥ç”¨æ¥è®¾å®šä½ å¸Œæœ›æ‰“å¼€é¡µé¢çš„æµè§ˆå™¨ï¼ˆæˆ‘ç›®å‰è®¾çš„æ˜¯ 'firefox'ï¼‰ã€‚



### Calendar

Calendar æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„æ˜¾ç¤ºæ—¥å†çš„ Vim æ’ä»¶ï¼Œåœ¨åŒ…ç®¡ç†å™¨é‡Œçš„åå­—æ˜¯ mattn/calendar-vimã€‚å®ƒçš„åŠŸèƒ½åº”è¯¥å°±ä¸éœ€è¦è§£é‡Šäº†ï¼Œæ•ˆæœå¯ä»¥ç›´æ¥æŸ¥çœ‹ä¸‹å›¾ã€‚

`mattn/calendar-vim` æ˜¯ä¸€ä¸ª Vim çš„æ—¥å†æ’ä»¶ï¼Œå¯ä»¥åœ¨ Vim é‡Œç›´æ¥æŸ¥çœ‹æ—¥å†ã€æŸ¥çœ‹èŠ‚å‡æ—¥ã€ç®¡ç† Google Calendar äº‹ä»¶ï¼ˆéœ€è¦é…ç½® APIï¼‰ï¼Œæ”¯æŒæœˆè§†å›¾ã€å‘¨è§†å›¾ã€æ—¥è§†å›¾ç­‰ã€‚



####  **å®‰è£…**

å¦‚æœä½ ç”¨ **minpac** ç®¡ç†æ’ä»¶ï¼š

```bash
call minpac#add('mattn/calendar-vim')
```

ç„¶åæ‰§è¡Œï¼š

```bash
:PackUpdate
```



####  **åŸºæœ¬ç”¨æ³•**

âœ… **æ‰“å¼€æ—¥å†**

```bash
:Calendar
```

- é»˜è®¤æ˜¾ç¤º **æœˆè§†å›¾**ã€‚
- ä½¿ç”¨ `hjkl` åœ¨æ—¥æœŸé—´ç§»åŠ¨ã€‚



âœ… **æ‰“å¼€å‘¨è§†å›¾**

```bash
:Calendar -view=week
```



âœ… **æ‰“å¼€æ—¥è§†å›¾**

```bash
:Calendar -view=day
```



âœ… **æ‰“å¼€ Google Calendarï¼ˆæ—¥ç¨‹ç®¡ç†ï¼‰**

```bash
:Calendar -google
```

> éœ€è¦æå‰é…ç½® Google API Key å’Œ OAuthï¼ˆè§ä¸‹æ–¹è¿›é˜¶ï¼‰ã€‚



####  **é”®ä½æ“ä½œ**

åœ¨æ—¥å†çª—å£ä¸­ï¼š

- `q` é€€å‡ºæ—¥å†
- `Enter` æ‰“å¼€å½“å¤©çš„äº‹ä»¶ï¼ˆæˆ–æ—¥è§†å›¾ï¼‰
- `h/j/k/l` åœ¨æ—¥æœŸé—´å¯¼èˆª
- `H/L` ä¸Šä¸ªæœˆ / ä¸‹ä¸ªæœˆ
- `K/J` ä¸Šä¸€å¹´ / ä¸‹ä¸€å¹´



#### **è¿›é˜¶åŠŸèƒ½**

ğŸ”¹ **æ”¯æŒ Google Calendar**

1. éœ€è¦å®‰è£… `curl` å’Œ `python3`ã€‚
2. åœ¨ `.vimrc` è®¾ç½®ï¼š

```bash
let g:calendar_google_calendar = 1
let g:calendar_google_task = 1
```

1. è¿è¡Œ `:Calendar -google`ï¼Œç¬¬ä¸€æ¬¡ä¼šæç¤º OAuth æˆæƒã€‚



#### ç»“åˆå·¥ä½œæµä½¿ç”¨

- **å¿«é€ŸæŸ¥çœ‹æ—¥å†**ï¼š`nnoremap <leader>ca :CalendarH<CR>`
- **æŸ¥çœ‹æŸå¤©äº‹ä»¶**ï¼šå…‰æ ‡ç§»åŠ¨åˆ°æŸå¤©æŒ‰ `Enter`
- **è®°å½• TODO / æ—¥å¿—**ï¼šå¯ä»¥å’Œ `vimwiki` / `taskwarrior` ç»“åˆ



### Fzf æ¨¡ç³Šæ–‡ä»¶æŸ¥æ‰¾

ä½ çŸ¥é“æ–‡ä»¶åæˆ–å…¶ä¸­çš„å…³é”®éƒ¨åˆ†ï¼Œä½†ä½ ä¸çŸ¥é“æˆ–ä¸å…³å¿ƒæ–‡ä»¶åœ¨å“ªé‡Œã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒFzf çš„æ¨¡ç³ŠåŒ¹é…å°±éå¸¸æœ‰ç”¨äº†

```bash
apt install fzf
```

åŠ è½½æ’ä»¶

```bash
call minpac#add('junegunn/fzf', {'do': {-> fzf#install()}})
call minpac#add('junegunn/fzf.vim')
```



è®¾ç½®å¿«æ·é”®

```bash
nnoremap <leader>f :Files<CR>          " æœç´¢æ–‡ä»¶
nnoremap <leader>b :Buffers<CR>        " æœç´¢å·²æ‰“å¼€ç¼“å†²åŒº
nnoremap <leader>l :BLines<CR>         " æœç´¢å½“å‰ buffer è¡Œ
nnoremap <leader>h :History<CR>        " æœç´¢å†å²å‘½ä»¤
nnoremap <leader>g :Rg<SPACE>          " ä½¿ç”¨ ripgrep æœç´¢å…³é”®è¯
```



æŒ‡å®šç›®å½•æŸ¥æ‰¾

```bash
:Files <dir>
```



åŸºæœ¬æ“ä½œ

```bash
C-j            # å‘ä¸‹
C-k            # å‘ä¸Š
C-q            # é€€å‡º
```



### NERDTree æ’ä»¶

åŠ è½½æ’ä»¶

```bash
call minpac#add('preservim/nerdtree')
```



æ¨èæ˜ å°„

```bash
" æ‰“å¼€/å…³é—­ NERDTree
nnoremap <leader>n :NERDTreeToggle<CR>

" å®šä½å½“å‰æ–‡ä»¶
nnoremap <leader>nf :NERDTreeFind<CR>

" ç›´æ¥æ‰“å¼€ NERDTree å¹¶èšç„¦
nnoremap <leader>ne :NERDTreeFocus<CR>
```



**å¸¸è§å‘½ä»¤**

| å‘½ä»¤              | åŠŸèƒ½                     |
| ----------------- | ------------------------ |
| `:NERDTree`       | æ‰“å¼€æ–‡ä»¶æ ‘çª—å£           |
| `:NERDTreeToggle` | æ‰“å¼€/å…³é—­æ–‡ä»¶æ ‘          |
| `:NERDTreeFind`   | å®šä½åˆ°å½“å‰æ–‡ä»¶           |
| `:NERDTreeFocus`  | è®©å…‰æ ‡å›åˆ° NERDTree çª—å£ |
| `:NERDTreeClose`  | å…³é—­ NERDTree çª—å£       |



**NERDTree çª—å£å¸¸ç”¨å¿«æ·é”®**

| é”®ä½ | ä½œç”¨                             |
| ---- | -------------------------------- |
| `o`  | æ‰“å¼€/å…³é—­æ–‡ä»¶æˆ–ç›®å½•              |
| `go` | æ‰“å¼€æ–‡ä»¶ä½†å…‰æ ‡ä¸è·³è¿‡å»           |
| `t`  | åœ¨æ–° tab æ‰“å¼€æ–‡ä»¶                |
| `T`  | åœ¨æ–° tab æ‰“å¼€ç›®å½•                |
| `i`  | åœ¨æ°´å¹³åˆ†å‰²ä¸­æ‰“å¼€æ–‡ä»¶             |
| `s`  | åœ¨å‚ç›´åˆ†å‰²ä¸­æ‰“å¼€æ–‡ä»¶             |
| `C`  | å°†æ ¹ç›®å½•åˆ‡æ¢åˆ°å½“å‰ç›®å½•           |
| `u`  | è¿”å›ä¸Šçº§ç›®å½•                     |
| `r`  | åˆ·æ–°å½“å‰ç›®å½•                     |
| `R`  | é€’å½’åˆ·æ–°æ•´ä¸ªæ ‘                   |
| `m`  | æ‰“å¼€èœå•ï¼ˆåˆ›å»º/åˆ é™¤/é‡å‘½åæ–‡ä»¶ï¼‰ |
| `q`  | å…³é—­ NERDTree çª—å£               |





### NERDCommenter

å®ƒæä¾›çš„æ˜¯åˆä¸€ä¸ªå¼€å‘å¸¸ç”¨çš„åŠŸèƒ½ï¼Œå¯¹æŸä¸ªä»£ç å—æˆ–ä»£ç è¡ŒåŠ ä¸Šæ³¨é‡Šï¼ŒåŠåè¿‡æ¥æŠŠæ³¨é‡Šå»æ‰ã€‚



#### å®‰è£…å’Œé…ç½®

æˆ‘ä»¬éœ€è¦åœ¨åŒ…ç®¡ç†å™¨ä¸­å®‰è£… `preservim/nerdcommenter`ã€‚ç„¶åï¼Œæˆ‘ä¸€èˆ¬åœ¨ vimrc é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ä¸‹é¢çš„ä»£ç ï¼Œè®© NERDCommenter ä¸è¦åœ¨ç»ˆç«¯ Vim ä¸­åŠ å…¥èœå•ï¼Œå¹²æ‰°æˆ‘ä½¿ç”¨ æŸ¥çœ‹æœ€è¿‘çš„æ–‡ä»¶ï¼š

```bash
if !has('gui_running')
  let g:NERDMenuMode = 0
endif
```



#### ä½¿ç”¨

NERDTree æä¾›çš„å‘½ä»¤ï¼Œæœ‰äº›å¯ä»¥å·¥ä½œäºå½“å‰è¡Œæˆ–é€‰å®šçš„è¡Œå†…éƒ¨åˆ†å­—ç¬¦ï¼Œæœ‰äº›åˆ™åªèƒ½å·¥ä½œäºæ•´è¡Œï¼Œå³ä½¿ç”¨å¯è§†æ¨¡å¼çš„è¯é€‰è¡Œå†…éƒ¨åˆ†å­—ç¬¦ç›¸å½“äºé€‰äº†æ•´è¡Œã€‚èƒ½å¤Ÿé€‚ç”¨äºè¡Œå†…çš„æœ‰ä¸‹é¢è¿™äº›å‘½ä»¤ï¼ˆä¹Ÿèƒ½é€‚ç”¨äºæ•´è¡Œï¼‰ï¼š

- `<Leader>cc` æŠŠä»£ç å˜ä¸ºæ³¨é‡Š
- `<Leader>cu` æŠŠæ³¨é‡Šèµ·æ­¢ç¬¦å‰¥æ‰ï¼Œæ¢å¤åŸå…ˆçš„ä»£ç 



ä¸‹é¢è¿™äº›åˆ™åªèƒ½å·¥ä½œäºå®Œæ•´çš„ä¸€è¡Œæˆ–å¤šè¡Œä¸Šï¼š



- `<Leader>c<Space>` ç”¨æ¥åˆ‡æ¢æ³¨é‡Šå’Œéæ³¨é‡Š
- `<Leader>cb` ç”¨æ¥åˆ‡æ¢æ³¨é‡Šå’Œéæ³¨é‡Š
- `<Leader>cs`\ç”¨æ¥åˆ‡æ¢æ³¨é‡Šå’Œéæ³¨é‡Š
