# VIM åŸºç¡€æ“ä½œ
## å…‰æ ‡ç§»åŠ¨
- hjkl: ä¸Šä¸‹å·¦å³
- Ffï¼šè·³åˆ°å½“å‰è¡ŒæŒ‡å®šå­—ç¬¦
- Ttï¼šè·³åˆ°å½“å‰è¡Œå­—ç¬¦å‰ï¼Œæ¯”å¦‚""
- ï¼›ï¼šé‡å¤å‰ä¸€ä¸ªf/tçš„ç»“æœ
- ï¼Œï¼šé‡å¤åä¸€ä¸ªf/tçš„ç»“æœ
- / + æŒ‡å®šå­—ç¬¦ï¼Œå¯ä»¥è·³åˆ°å½“å‰ä½ç½®ä¹‹åçš„è‡ªå®šå­—ç¬¦ä½ç½®ï¼Œåå¯ä»¥ä½¿ç”¨n/Nè¿›è¡Œè·³è½¬
- ? + æŒ‡å®šå­—ç¬¦, å¯ä»¥è·³è½¬åˆ°å½“å‰ä½ç½®ä¹‹å‰çš„æŒ‡å®šå­—ç¬¦ä½ç½®
- wW,eE,bBï¼Œå•è¯è¿›è¡Œè·³è½¬
- () åœ¨å¥å­é—´è¿›è¡Œè·³è½¬
- {} åœ¨æ®µè½é—´è¿›è¡Œè·³è½¬
- `[{` `]}`  æˆ–`[(` `])`åœ¨ä»£ç çš„{}æˆ–()æ®µé—´è¿›è¡Œè·³è½¬, å‰é¢åŠ æ•°å­—å¯ä»¥è¿›è¡ŒåµŒå¥—è·³è½¬
- 0 è·³è½¬åˆ°è¡Œé¦–
- ^ è·³è½¬åˆ°éç©ºè¡Œé¦–
- $ è·³è½¬åˆ°è¡Œå°¾
- % åœ¨å°±è¿‘çš„ï¼ˆï¼‰ä¹‹é—´è·³è½¬
- `*` æ‰¾åˆ°æ‰€æœ‰å…‰æ ‡æ‰€åœ¨å•è¯ï¼Œå¹¶å‘åè·³è½¬ï¼Œä½¿ç”¨n/Nå¯ä»¥é‡å¤è¯¥åŠ¨ä½œ
- `#` æ‰¾åˆ°æ‰€æœ‰å…‰æ ‡æ‰€åœ¨å•è¯ï¼Œå¹¶å‘å‰è·³è½¬ï¼Œä½¿ç”¨n/Nå¯ä»¥é‡å¤è¯¥åŠ¨ä½œ
- H: è·³åˆ°è¯¥å±å¹•ä¸­çš„é¦–è¡Œè¡Œé¦–
- Lï¼šè·³åˆ°è¯¥å±å¹•çš„å°¾è¡Œè¡Œé¦–
- M: è·³åˆ°è¯¥å±å¹•çš„ä¸­é—´è¡Œé¦–
- `åå¼•å· + æ ‡è®°å­—ç¬¦ï¼šè·³åˆ°æŒ‡å®šæ ‡è®°å¤„
- 'å•å¼•å· + æ ‡è®°å­—ç¬¦ï¼šè·³åˆ°æŒ‡å®šæ ‡è®°çš„æ‰€åœ¨è¡Œçš„å¼€å¤´
- `m + æ ‡è®°å­—ç¬¦`: è®¾ç½®æ ‡è®°ï¼Œa-zä¸ºlocalæ ‡è®°ï¼Œ A-Zä¸ºglobalæ ‡è®°
- `:marks`: æŸ¥çœ‹æ‰€æœ‰æ ‡è®°
- `:delm + æ ‡è®°å­—ç¬¦` åˆ é™¤è¯¥æ ‡è®°
- `|` ï¼š[count] + `|` è·³è½¬åˆ°æŒ‡å®šåˆ—æ•°
- `:num`ï¼šè·³åˆ°æŒ‡å®šè¡Œæ•°
- ggï¼š è·³åˆ°é¦–è¡Œ
- Gï¼šè·³åˆ°æœ€åä¸€è¡Œå¼€å¤´
- `:b+num æˆ– æ–‡ä»¶å`ï¼šè·³è½¬åˆ°æŒ‡å®šæ–‡ä»¶ä¸­

## æ“ä½œ
- y: å¤åˆ¶
    - Y/yy: å¤åˆ¶å½“å‰è¡Œæ‰€æœ‰å­—ç¬¦
- d: åˆ é™¤ï¼ˆç»“æœå­˜å…¥å¯„å­˜å™¨ä¸­ï¼‰
    - D: ç±»ä¼¼äºd$
    - ddï¼šåˆ é™¤å½“å‰è¡Œ
- c: ä¿®æ”¹ï¼ˆåˆ é™¤å¹¶è¿›å…¥insertæ¨¡å¼ï¼‰
    - C/ccï¼šåˆ é™¤ä¸€æ•´è¡Œï¼Œå¹¶è¿›å…¥insertæ¨¡å¼
- p: ç²˜è´´åœ¨åé¢ï¼Œæˆ–ä¸‹è¡Œ
- Pï¼ˆå¤§å†™ï¼‰: ç²˜è´´åœ¨å‰é¢ï¼Œæˆ–è€…ä¸Šè¡Œ 
- s: åˆ é™¤å½“å‰å­—ç¬¦ï¼Œå¹¶è¿›å…¥insertæ¨¡å¼
- S: åˆ é™¤ä¸€æ•´è¡Œï¼Œå¹¶è¿›å…¥insertæ¨¡å¼ï¼Œç±»ä¼¼äºC/cc
- r: æ›¿æ¢å•ä¸ªå­—ç¬¦
- ~ï¼šæ›´æ”¹æ‰€åœ¨å­—ç¬¦å¤§å°å†™
- xï¼šåˆ é™¤å½“å‰å­—ç¬¦
- X: åˆ é™¤åä¸€ä¸ªå­—ç¬¦
- æ“ä½œå­—ç¬¦ï¼ˆydc + i/a + w/s/pï¼‰
    - i: ä¸åŒ…å«ç‰¹æ®Šå­—ç¬¦
    - a: åŒ…å«ç‰¹æ®Šå­—ç¬¦
    - w: å•è¯
    - s: å¥å­
    - p: æ®µè½
- `.` ç‚¹ï¼šé‡å¤æœ€åä¸€æ¬¡æ“ä½œ
- `" + [0-9,a-z]`: å°†æŒ‡å®šæ–‡æœ¬å¤åˆ¶è¿›æŒ‡å®šå¯„å­˜å™¨
- `"[A-Z]`: è¡¨ç¤ºè¿½åŠ å­—ç¬¦åˆ°æŒ‡å®ša-zçš„å¯¹åº”å¯„å­˜å™¨ä¸­
- `:reg`ï¼šæŸ¥çœ‹å¯„å­˜å™¨å†…å®¹
- `:w`: ä¿å­˜
- ZZï¼šä¿å­˜åé€€å‡º
- ZQï¼šä¸ä¿å­˜é€€å‡º
- uï¼šæ’¤é”€

## è§†çª—
- zz: çª—å£ç§»åŠ¨åˆ°ä¸­é—´
- ztï¼šçª—å£å¯¹é¡¶
- zbï¼šçª—å£å¯¹åº•

## åˆ‡æ¢insertæ¨¡å¼
- i: è¿›å…¥insertæ¨¡å¼ï¼Œå¹¶ä¸”å…‰æ ‡ç§»åŠ¨åˆ°æŒ‡å®šå­—ç¬¦ä¹‹å‰
- Iï¼šè¿›å…¥insertæ¨¡å¼ï¼Œå¹¶ä¸”å…‰æ ‡ç§»åŠ¨åˆ°å½“å‰è¡Œå¼€å¤´
- a: è¿›å…¥insertæ¨¡å¼ï¼Œå¹¶ä¸”å…‰æ ‡ç§»åŠ¨åˆ°æŒ‡å®šå­—ç¬¦ä¹‹å
- Aï¼šè¿›å…¥insertæ¨¡å¼ï¼Œå¹¶ä¸”å…‰æ ‡ç§»åŠ¨åˆ°è¡Œå°¾
- oï¼šè¿›å…¥insertæ¨¡å¼ï¼Œå…‰æ ‡ç§»åŠ¨åˆ°ä¸‹é¢ï¼Œæ–°èµ·ä¸€è¡Œ
- O: è¿›å…¥insertæ¨¡å¼ï¼Œå…‰æ ‡ç§»åŠ¨åˆ°ä¸Šé¢ï¼Œæ–°èµ·ä¸€è¡Œ

## æ‰©å±•å‘½ä»¤æ¨¡å¼
### åŸºæœ¬å‘½ä»¤
- w: ä¿å­˜æ–‡ä»¶
- x: ç­‰ä»·äºwqï¼ˆä¿å­˜é€€å‡ºï¼‰
- Xï¼šåŠ å¯†
- w + æ–‡ä»¶åï¼š æ–‡ä»¶å¦å­˜ä¸º
- qï¼šé€€å‡º
- ï¼ï¼šå¼ºåˆ¶æ‰§è¡Œ
- r + æ–‡ä»¶åï¼šè¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹åˆ°å…‰æ ‡ä¸‹
- !commandï¼šæ‰§è¡ŒæŒ‡ä»¤
- r!commandï¼šè¯»å–æ‰§è¡Œå‘½ä»¤çš„ç»“æœ

### åœ°å€å®šç•Œæ ¼å¼
```
M
M, N
.
$
.,$-1
/pattern/
/part1/,/part2/
```

### æ“ä½œ
```shell
p               #è¾“å‡º
d               #åˆ é™¤
y               #å¤åˆ¶
w file          #å°†èŒƒå›´å†…çš„è¡Œå¦å­˜è‡³æŒ‡å®šæ–‡ä»¶ä¸­
r file          #åœ¨æŒ‡å®šä½ç½®æ’å…¥æŒ‡å®šæ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹
tè¡Œå·            #å°†å‰é¢æŒ‡å®šçš„è¡Œå¤åˆ¶åˆ°Nè¡Œå
mè¡Œå·            #å°†å‰é¢æŒ‡å®šçš„è¡Œç§»åŠ¨åˆ°Nè¡Œå
```

### æŸ¥æ‰¾å¹¶æ›¿æ¢
```shell
s/pattern/æ›¿æ¢å­—ç¬¦/ä¿®é¥°ç¬¦
%s              #å…¨æ–‡æŸ¥æ‰¾æ›¿æ¢
```

### å®šåˆ¶VIMå·¥ä½œç‰¹æ€§
- é…ç½®æ–‡ä»¶
    - å…¨å±€ï¼š/etc/vimrc
    - ä¸ªäººï¼š~/.vimrc

- è¡Œå·
```
set nu | number
set nonu | nonumber
```

- å¿½ç•¥å­—ç¬¦å¤§å°å†™
```
set ic | ignorecase
set noic
```

- è‡ªåŠ¨ç¼©è¿›
```
set ai | autoindent
set noai | noautoindent
```

- å¤åˆ¶ä¿ç•™æ ¼å¼
```
set paste
set nopaste
```

- æ˜¾ç¤ºTab(^I)å’Œæ¢è¡Œç¬¦($)
```
set list
set nolist
```

- è¯­æ³•é«˜äº®
```
syntax on
syntax off
```
- å®æ—¶REXé«˜äº®åŒ¹é…
```
set incsearch
```

- é«˜äº®æœç´¢
```
set hlsearch
set nohlsearch|nohl
```

- æ–‡ä»¶æ ¼å¼
```
set ff=dos      #å¯ç”¨Windowsæ ¼å¼
set ff=unix     #å¯ç”¨Unixæ ¼å¼
```

- Tabé”®ç”¨ç©ºæ ¼ä»£æ›¿
```
set expandtab | et
set noexpandtab | noet
```

- ç”¨æŒ‡å®šç©ºæ ¼æ•°ä»£æ›¿Tab
```
set tabstop=N| ts=N     # æŒ‡å®šNä¸ªç©ºæ ¼ä»£æ›¿tabé”®
```

- è®¾ç½®ç¼©è¿›å®½åº¦
```
<<
>>

set shiftwidth=4
```

- è®¾ç½®å…‰æ ‡æ‰€åœ¨è¡Œæ ‡è¯†çº¿
```
set cursorline| cul
set nocursorline| nocul
```

- åŠ å¯†
```
set key=passwd  # æ–‡ä»¶åŠ å¯†ï¼Œç›¸å½“äºX
set key=        # å–æ¶ˆåŠ å¯†
```

## å¯è§†åŒ–æ¨¡å¼
```
ctrl + v è¿›å…¥å—æ¨¡å¼
é€‰å®šå¥½åï¼Œä½¿ç”¨i\shift + i
è¾“å…¥æ·»åŠ çš„å­—ç¬¦
æŒ‰ESC
```


## å¤šçª—å£æ¨¡å¼
```
å•æ–‡ä»¶åˆ†å±
ctrl + w + v   # æ°´å¹³åˆ†å±
ctrl + w + s   # å‚ç›´åˆ†å±
ctrl + w + q   # å–æ¶ˆç›¸é‚»åˆ†å±
ctrl + w + o   # å–æ¶ˆå…¨éƒ¨åˆ†å±
ctrl + w + hjk;| arrow # åˆ‡æ¢çª—å£
```

```
å¤šæ–‡ä»¶åˆ†å±æ‰“å¼€
vim -o|O file1 file2
```

















# vimé›†æˆDeepSeek

**åœ¨.bashrcé‡Œï¼Œæ”¾å…¥ç¯å¢ƒå˜é‡ï¼Œä¿è¯ deepseek çš„ api keys å¯ä»¥è¢«è°ƒç”¨**

```bash
export DEEPSEEK_API_KEY="sk-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
```



**åœ¨PATHè·¯å¾„ä¸­ï¼Œåˆ›å»º deepseek-query.sh è„šæœ¬æ–‡ä»¶**

```bash
root@localhost:~# echo $PATH
/root/.local/bin:/root/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin

# åœ¨/root/binä¸‹ï¼Œåˆ›å»ºdeepseek-query.sh
root@localhost:~# mkdir bin

# å†™è„šæœ¬æ–‡ä»¶
root@localhost:~# cat bin/deepseek-query.sh 
#!/bin/bash

# === é…ç½® ===
API_KEY="${DEEPSEEK_API_KEY}"
MODEL="deepseek-chat"
ENDPOINT="https://api.deepseek.com/v1/chat/completions"

if [[ -z "$API_KEY" ]]; then
  echo "[error] è¯·å…ˆå¯¼å‡º DEEPSEEK_API_KEY ç¯å¢ƒå˜é‡"
  exit 1
fi

#PROMPT="$*"

if [[ -n "$1" ]]; then
  PROMPT="$1"
else
  read -r PROMPT
fi


#DATA=$(cat <<EOF
#{
#  "model": "$MODEL",
#  "messages": [
#    {"role": "user", "content": "$PROMPT"}
#  ]
#}
#EOF
#)


DATA=$(jq -n --arg prompt "$PROMPT" --arg model "$MODEL" '
{
  model: $model,
  messages: [
    { role: "user", content: $prompt }
  ]
}')


#curl -sS "$ENDPOINT" \
#  -H "Content-Type: application/json" \
#  -H "Authorization: Bearer $API_KEY" \
#  -d "$DATA" | jq -r '.choices[0].message.content'

response=$(curl -sS "$ENDPOINT" \
  -H 'Content-Type: application/json' \
  -H "Authorization: Bearer $API_KEY" \
  -d "$DATA")

echo "$response" | jq -r '.choices[0].message.content'
```



**åœ¨.vimrcä¸­é…ç½®ï¼Œè°ƒç”¨deepseekè„šæœ¬**

```bash

" -------------- DeepSeek é›†æˆ -----------------
" Leader é”®ï¼š\  ï¼ˆå¯è‡ªè¡Œ let mapleader = "," â€¦ï¼‰
nnoremap <leader>ds :call DeepSeek_Query_Cursor()<CR>
vnoremap <leader>ds :<C-u>call <SID>DeepSeek_Query_Visual()<CR>
"vnoremap <leader>ds :<C-u>call DeepSeek_Query_Visual()<CR>

" å…³é—­æµ®çª—çš„å¿«æ·é”®
nnoremap <silent> <leader>q :call popup_close(popup_list()[0])<CR>
"
"function! s:popup_show(msg) abort
"  if has('popupwin')          " Vim 8.2+ æ¨èç”¨æµ®çª—
"    call popup_create(a:msg, #{minwidth:60, minheight:8, line:2, col:2,
"          \ border:[1], borderchars:['â”€']})
"  else                        " è€ç‰ˆæœ¬é€€åŒ–ä¸ºåªè¯»æ–°ç¼“å†²
"    new
"    setlocal buftype=nofile bufhidden=wipe nobuflisted noswapfile
"    call setline(1, split(a:msg, "\n"))
"  endif
"endfunction
"
"" æ™®é€šæ¨¡å¼ï¼šå–å…‰æ ‡æ‰€åœ¨è¡Œï¼ˆæˆ–å‡½æ•°åç­‰ï¼‰ï¼Œå¯è‡ªè¡Œæ”¹æˆ expand('<cword>')
"function! DeepSeek_Query_Cursor() abort
""  let l:text = getline('.')
""  let l:answer = system('echo '.shellescape(l:text).' | ~/bin/deepseek-query.sh')
""  call <SID>popup_show(l:answer)
"   let l:prompt = input('ğŸ¤– è¯·è¾“å…¥ä½ çš„é—®é¢˜: ')
"   if empty(l:prompt)
"     echohl WarningMsg | echo '[âŒ] å·²å–æ¶ˆï¼Œé—®é¢˜ä¸ºç©º' | echohl None
"     return
"   endif
""   let l:answer = system('echo '.shellescape(l:prompt).' | ~/bin/deepseek-query.sh')
"   let l:answer = system("echo " . shellescape(l:prompt) . " | bash ~/bin/deepseek-query.sh")
"   call <SID>popup_show(l:answer)
"endfunction
"
"" å¯è§†æ¨¡å¼ï¼šå–é€‰åŒº
"function! DeepSeek_Query_Visual() abort
"  " ä¿å­˜é€‰åŒºä¸¤ç«¯
"  let l_save = @@
"  normal! "vy
"  let l:text = @@
"  let @@ = l_save
"
"  let l:answer = system('echo '.shellescape(l:text).' | ~/bin/deepseek-query.sh')
"  call <SID>popup_show(l:answer)
"endfunction


let mapleader = "\\"

" === å¿«æ·é”® ===
nnoremap <leader>ds :call DeepSeek_Query_Cursor()<CR>
vnoremap <leader>ds :<C-u>call <SID>DeepSeek_Query_Visual()<CR>
nnoremap <silent> <leader>q :call popup_close(popup_list()[0])<CR>

" === æµ®çª—æ˜¾ç¤ºå‡½æ•° ===
function! s:popup_show(msg) abort
  if has('popupwin')
    call popup_create(a:msg, {
          \ 'minwidth': 60, 'minheight': 8,
          \ 'line': 2, 'col': 2,
          \ 'border': [1], 'borderchars': ['â”€'],
          \ })
  else
    new
    setlocal buftype=nofile bufhidden=wipe nobuflisted noswapfile
    call setline(1, split(a:msg, "\n"))
  endif
endfunction

" === æ ¸å¿ƒæé—®å‡½æ•° ===
function! s:deepseek_query_and_popup(text) abort
  if empty(a:text)
    echohl WarningMsg | echo '[âŒ] å†…å®¹ä¸ºç©ºï¼Œæœªå‘é€' | echohl None
    return
  endif
  let l:answer = system('bash ~/bin/deepseek-query.sh ' . shellescape(a:text))
  call s:popup_show(l:answer)
endfunction

" === æ™®é€šæ¨¡å¼ï¼šè¾“å…¥é—®é¢˜ ===
function! DeepSeek_Query_Cursor() abort
  let prompt = input('ğŸ¤– è¯·è¾“å…¥ä½ çš„é—®é¢˜: ')
  if empty(prompt)
    echohl WarningMsg | echo '[å–æ¶ˆå‘é€]' | echohl None
    return
  endif
  call s:deepseek_query_and_popup(prompt)
endfunction

" === å¯è§†æ¨¡å¼ï¼šé€‰æ‹©æé—® ===
"function! s:DeepSeek_Query_Visual() abort
"  let l:save_reg = @@
"  normal! "vy
"  let l:text = @@
"  let @@ = l:save_reg
"  call s:deepseek_query_and_popup(l:text)
"endfunction

"function! s:DeepSeek_Query_Visual() abort
"  " è·å–å¯è§†é€‰åŒºèŒƒå›´ï¼ˆè¡Œå·ï¼‰
"  let start = getpos("'<")[1]
"  let end = getpos("'>")[1]
"
"  " è·å–é€‰ä¸­å†…å®¹çš„æ‰€æœ‰è¡Œ
"  let lines = getline(start, end)
"
"  " å°†å¤šè¡Œæ‹¼æ¥æˆä¸€è¡Œï¼ˆé¿å… JSON è§£æå¤±è´¥ï¼‰
"  let text = join(lines, ' ')
"
"  call s:deepseek_query_and_popup(text)
"endfunction

function! s:DeepSeek_Query_Visual() abort
  " ä¿å­˜å‰ªè´´æ¿å†…å®¹
  let l:save_reg = @@

  " å¤åˆ¶å¯è§†é€‰åŒºå†…å®¹
  normal! "vy
  let l:selected = @@

  " æ¢å¤å‰ªè´´æ¿
  let @@ = l:save_reg

  " æ‰‹åŠ¨è¾“å…¥æé—®å†…å®¹
  let l:prompt = input('ğŸ¤– è¯·è¾“å…¥ä½ çš„é—®é¢˜ï¼ˆé€‰ä¸­å†…å®¹å°†é™„åœ¨æœ«å°¾ï¼‰ï¼š')
  if empty(l:prompt)
    echohl WarningMsg | echo '[âŒ] å·²å–æ¶ˆï¼Œé—®é¢˜ä¸ºç©º' | echohl None
    return
  endif

  " æ‹¼æ¥ç”¨æˆ·é—®é¢˜å’Œé€‰ä¸­å†…å®¹
  let l:final_prompt = l:prompt . "\n\n" . l:selected

  " æ‰§è¡ŒæŸ¥è¯¢
  call s:deepseek_query_and_popup(l:final_prompt)
endfunction 
```



