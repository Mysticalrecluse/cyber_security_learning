1. 说说Nginx和apache有什么区别

`````bash
# 架构设计不同
Nginx
事件驱动架构：
使用异步非阻塞 I/O 和事件循环，单线程可以处理成千上万的连接。
每个工作进程使用事件模型处理多个请求，资源占用低。

Apache
进程/线程驱动架构：
默认使用多进程模型（prefork 模式），每个请求由一个独立的进程处理。
也支持多线程模式（worker 模式）或事件模式（event 模式），但线程和进程间的切换开销较高。

# 内存与资源占用
Nginx
内存占用低：
单线程模型更节省内存，适合大规模并发场景。
适合高负载环境。

Apache
内存占用高：
每个连接需要一个独立的线程/进程，资源开销大。
适合小流量环境。

# 负载均衡和反向代理
Nginx
内置强大的负载均衡和反向代理功能，支持多种均衡算法（如轮询、最小连接）。
直接支持健康检查、请求缓存等高级功能。

Apache
虽然可以通过模块（如 mod_proxy、mod_lb）实现负载均衡和反向代理，但配置复杂，性能不如 Nginx。

# HTTPS 和 HTTP/2
Nginx
原生支持 HTTP/2 和 SSL/TLS，性能优化较好。
配置简单，广泛用于 HTTPS 网站。
Apache
支持 HTTP/2 和 SSL/TLS，但需要加载额外模块（如 mod_ssl）。
性能不如 Nginx。
`````





2. 当有攻击者使用未注册的域名访问服务器时，默认的 Nginx 配置可能会处理这些请求。如何解决？

``````
server {
    listen 80 default_server;
    server_name _;
    location / {
        root /var/www/error_pages;
        index 404.html;
    }
}
``````





3. 请简述Nginx的进程结构

``````
Master 进程 --> Worker进程 --> Cache manager --> Cache loader
``````







4. Nginx的优点是什么

``````bash
# 高并发，高性能
大部分的程序或者web服务器，随着并发连接数的上升，它的RPS会下降
   
nginx同时具备高并发，和并性能，往往高并发只要每个连接所使用的内存尽可能少就能达到，而具有高并发的同时具有高性能，需要一个非常好的设计
   
nginx可以达到的标准：比如一些主流服务器，32核64G内存，可以达到千万级别的并发连接，如果处理一些简单的静态资源请求，可以达到一百万级别的RPS
      
# 可扩展性好
模块化设计，生态圈丰富
    
# 高可靠性
nginx可以在服务器上不间断运行数年
   
# 热部署（在不停止服务的情况下，升级Nginx）

# BSD许可证（开源免费，并且在有特定需求的场景下，可以修改Nginx的源代码，然后运行在商业场景下）
``````





5. 什么是正向代理和反向代理？

``````
``````





6. Nginx负载均衡的算法怎么实现的?策略有哪些

``````
``````







7. 你对nginx做过哪些优化

``````
CPU结亲缘
指定worker进程数，使其一个CPU核心上执行一个进程
优先级（worker_priority）
  优先级越高，worker进程分的时间片时间越长，进程间切换频率越低
增加work_connection的数值，默认512，这个是nginx单个work进程能够处理的连接数
开启防惊群设置`accept_mutex on`默认是off,会产生惊群问题
适当设置反向代理的keepalived连接池数量

极端情况下，可以基于url的大小调整连接内存池大小
``````





8. 说一下nginx的location中匹配优先级

``````BASH
# 语法规则
location [ = | ~ | ~* | ^~ ] uri {...}

=  # 用于标准uri前，表示请求字符串和uri精确匹配，大小敏感
^~ # 用于标准uri前,表示包含正则表达式，并且匹配以指定正则开头，对uri的最左边部分做匹配检查，不区分大小写
~  # 用于标准uri前，表示包含正则，区分大小写
~* # 用于标准uri前，表示包含正则，不区分大小写
不带符号 # 匹配起始于此uri的所有uri
\  # 用于标准uri前，表示包含正则表达式并且转义字符，可以将.*?等转译为普通符号

# 匹配优先级：
=， ^~, ~/~*, 不带符号
``````





9. 你用过的nginx的常用模块有哪些

``````
``````





10. 实验题：

公司开发了一个网站：

- 客户端访问proxyServer10.0.0.150, www.magedu.com

- 动态内容由后端服务10.0.0.151处理（比如：www.magedu.com/api/下的文件是动态资源）
- 静态资源有后端服务10.0.0.152处理（比如：www.magedu.com/static/下的文件是静态资源）

为了优化性能，要求：

1. 对静态资源启用缓存，缓存到 `/var/cache/nginx`，缓存有效期为 5分钟，并且每1分钟访问一次后端静态服务看是否有更新。



验证：客户端访问ProxyServer，如果是动态资源，转发到10.0.0.151,如果是静态资源，转发到10.0.0.152

提示：IP地址任选，上述ip仅供参考